import{r as o,j as t,d as C,X as w,e as S}from"./react-vendor-B3RF3lZj.js";import{a as y,C as j,b as E}from"./index-CvM0QPZJ.js";import"./markdown-IOIbAqJG.js";import"./math-render-DqYgiYKz.js";import"./syntax-highlight-BlOvp5OR.js";const L=5;function R(s,n){let r=n||1;const a=()=>(r^=r<<13,r^=r>>17,r^=r<<5,Math.abs(r));return[...s].map(i=>({value:i,sort:a()})).sort((i,u)=>i.sort-u.sort).map(i=>i.value)}function $(s,n){const r=new Date,a=+`${r.getUTCFullYear()}${String(r.getUTCMonth()+1).padStart(2,"0")}${String(r.getUTCDate()).padStart(2,"0")}`;return R(s,a).slice(0,n)}function D(s){const n=s.url?`
Link: ${s.url}`:"";return`${s.source?`Source: ${s.source}. `:""}Give a concise, balanced take on: "${s.title}". Summarize in 5 bullets, list 3 implications, and one action item.${n}`}function _({open:s,onClose:n,onSelectPrompt:r}){const[a,i]=o.useState(""),[u,f]=o.useState(y),[v,p]=o.useState(!1),m=o.useRef(!1),h=o.useRef(null),N=o.useMemo(()=>$(j,L),[]),b=o.useMemo(()=>{const e=u.map(l=>{var c;return{id:`trend-${l.id}`,label:l.title,prompt:D(l),category:((c=l.tags)==null?void 0:c[0])||"Trending",tags:l.tags||["trending"]}});return[...j,...e]},[u]),x=o.useMemo(()=>{if(!a.trim())return[];const e=a.toLowerCase();return b.filter(l=>{var c,d;return l.label.toLowerCase().includes(e)||((c=l.category)==null?void 0:c.toLowerCase().includes(e))||((d=l.tags)==null?void 0:d.some(k=>k.toLowerCase().includes(e)))||l.prompt.toLowerCase().includes(e)}).slice(0,8)},[a,b]),T=a.trim().length>0&&x.length>0;o.useEffect(()=>{if(!s)return;const e=l=>{l.key==="Escape"&&(l.preventDefault(),a?i(""):n())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[s,n,a]),o.useEffect(()=>{if(!s||m.current)return;let e=!1;return(async()=>{p(!0);try{const c=await fetch(E);if(!c.ok)throw new Error(`HTTP ${c.status}`);const d=await c.json();if(!Array.isArray(d))throw new Error("Unexpected feed shape");e||(f(d),m.current=!0)}catch{e||f(y)}finally{!e&&p(!1)}})(),()=>{e=!0}},[s]),o.useEffect(()=>{s||i("")},[s]);const g=e=>{r(e),n()};return s?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"fixed inset-0 z-[100] bg-black/20",onClick:n}),t.jsx("div",{"data-no-arena-scroll":!0,className:"fixed bottom-24 left-1/2 -translate-x-1/2 z-[101] w-[min(640px,calc(100vw-2rem))] animate-in slide-in-from-bottom-4 fade-in duration-200",onClick:e=>e.stopPropagation(),children:t.jsxs("div",{className:"rounded-2xl border border-slate-700/60 bg-slate-900/95 backdrop-blur-xl shadow-2xl overflow-hidden",children:[t.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-slate-800/50",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(C,{size:14,className:"text-amber-400"}),t.jsx("span",{className:"text-sm font-medium text-slate-200",children:"Quick Topics"})]}),t.jsx("button",{onClick:n,className:"w-6 h-6 rounded-md flex items-center justify-center text-slate-500 hover:text-white hover:bg-slate-800/60 transition-colors","aria-label":"Close",children:t.jsx(w,{size:14})})]}),t.jsx("div",{className:"px-4 py-3 flex flex-wrap gap-2",children:N.map(e=>t.jsx("button",{onClick:()=>g(e.prompt),className:"group px-3 py-1.5 rounded-full text-xs font-medium bg-slate-800/70 hover:bg-blue-600/80 text-slate-300 hover:text-white border border-slate-700/50 hover:border-blue-500/50 transition-all duration-150 max-w-[180px] truncate",title:e.label,children:e.label},e.id))}),t.jsxs("div",{className:"px-4 pb-3",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-500",children:t.jsx(S,{size:14})}),t.jsx("input",{ref:h,type:"text",value:a,onChange:e=>i(e.target.value),placeholder:"Search all topics...",className:"w-full pl-9 pr-8 py-2 text-sm bg-slate-800/50 border border-slate-700/50 rounded-lg text-slate-200 placeholder:text-slate-500 focus:outline-none focus:border-slate-600 focus:bg-slate-800/70 transition-colors"}),a&&t.jsx("button",{onClick:()=>{var e;i(""),(e=h.current)==null||e.focus()},className:"absolute right-2 top-1/2 -translate-y-1/2 w-5 h-5 rounded flex items-center justify-center text-slate-500 hover:text-slate-300 transition-colors",children:t.jsx(w,{size:12})})]}),T&&t.jsx("div",{className:"mt-2 max-h-[200px] overflow-y-auto rounded-lg border border-slate-700/50 bg-slate-800/50 divide-y divide-slate-700/30",children:x.map(e=>t.jsx("button",{onClick:()=>g(e.prompt),className:"w-full px-3 py-2.5 text-left hover:bg-slate-700/50 transition-colors group",children:t.jsxs("div",{className:"flex items-center justify-between gap-2",children:[t.jsx("span",{className:"text-sm text-slate-200 group-hover:text-white truncate",children:e.label}),e.category&&t.jsx("span",{className:"text-[10px] text-slate-500 px-1.5 py-0.5 rounded bg-slate-800/80 shrink-0",children:e.category})]})},e.id))}),a.trim()&&x.length===0&&!v&&t.jsxs("div",{className:"mt-2 px-3 py-3 text-center text-xs text-slate-500 bg-slate-800/30 rounded-lg border border-slate-700/30",children:['No topics found for "',a,'"']})]}),t.jsx("div",{className:"px-4 py-2 border-t border-slate-800/50 bg-slate-950/50",children:t.jsxs("span",{className:"text-[10px] text-slate-500",children:["Click a topic to use it as your prompt Â· ",t.jsx("kbd",{className:"px-1 py-0.5 rounded bg-slate-800/80 text-slate-400",children:"esc"})," to close"]})})]})})]}):null}export{_ as default};
