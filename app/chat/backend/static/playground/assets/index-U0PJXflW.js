const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SettingsModal-DFXyJYU8.js","assets/react-vendor-CQxWqugw.js","assets/markdown-BNX5kHMI.js","assets/math-render-D6B7xoul.js","assets/math-render-BqiDbsU2.css","assets/syntax-highlight-K7DiErAG.js","assets/syntax-highlight-BEHUn5zE.css","assets/ResponseModal-reNlrW8D.js","assets/FormattedContent-ClPh4eCb.js","assets/DiscussionTranscript-Bh5W5eM3.js","assets/GestureControl-yVOFAzFj.js","assets/HandBackground-F7iiHyIM.js","assets/mediapipe-BWDqrTQ6.js","assets/ChatView-BIXgzJmL.js"])))=>i.map(i=>d[i]);
var Kn=Object.defineProperty;var qn=(t,n,r)=>n in t?Kn(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r;var tn=(t,n,r)=>qn(t,typeof n!="symbol"?n+"":n,r);import{r as s,j as e,X as Vn,S as Qn,C as Jn,a as Zn,A as es,b as ts,Z as ns,T as ss,R as rs,c as os,d as as}from"./react-vendor-CQxWqugw.js";import"./math-render-D6B7xoul.js";import"./syntax-highlight-K7DiErAG.js";import"./markdown-BNX5kHMI.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))i(u);new MutationObserver(u=>{for(const a of u)if(a.type==="childList")for(const m of a.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&i(m)}).observe(document,{childList:!0,subtree:!0});function r(u){const a={};return u.integrity&&(a.integrity=u.integrity),u.referrerPolicy&&(a.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?a.credentials="include":u.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(u){if(u.ep)return;u.ep=!0;const a=r(u);fetch(u.href,a)}})();const is="modulepreload",ls=function(t){return"/static/playground/"+t},nn={},Be=function(n,r,i){let u=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const m=document.querySelector("meta[property=csp-nonce]"),c=(m==null?void 0:m.nonce)||(m==null?void 0:m.getAttribute("nonce"));u=Promise.allSettled(r.map(d=>{if(d=ls(d),d in nn)return;nn[d]=!0;const f=d.endsWith(".css"),h=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${h}`))return;const p=document.createElement("link");if(p.rel=f?"stylesheet":is,f||(p.as="script"),p.crossOrigin="",p.href=d,c&&p.setAttribute("nonce",c),document.head.appendChild(p),f)return new Promise((w,N)=>{p.addEventListener("load",w),p.addEventListener("error",()=>N(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(m){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=m,window.dispatchEvent(c),!c.defaultPrevented)throw m}return u.then(m=>{for(const c of m||[])c.status==="rejected"&&a(c.reason);return n().catch(a)})},cs={"self-hosted":{color:"#10b981"},github:{color:"#3b82f6"}},ds=["deepseek-r1-distill-qwen-1.5b","r1qwen","smollm3","nanbeige"],us=["gpt-oss","gptoss"],fs=t=>{const n=t.toLowerCase();return ds.some(r=>n.includes(r.toLowerCase()))},ps=t=>{const n=t.toLowerCase();return us.some(r=>n.includes(r.toLowerCase()))},Rt=[{id:"eu-ai-act-enforcement",label:"EU AI Act Enforcement Wave",prompt:"The EU AI Act enters enforcement; high-risk systems must prove data provenance, evals, and risk controls. Outline compliance gaps for a frontier model API and tradeoffs between speed and alignment.",category:"Policy",modes:["analyze","debate"],tags:["governance","compliance"]},{id:"export-controls-blackwell",label:"Export Controls Tighten",prompt:"U.S. export rules tighten again on AI accelerators; Blackwell-class parts face new caps and cloud checks. Map the impact on training roadmaps, costs, and on-device strategies.",category:"Infra",modes:["compare","debate"],tags:["chips","supply-chain"]},{id:"weights-leak",label:"Major Weights Leak",prompt:"A commercial frontier model checkpoint leaks. Assess risks (misuse, impersonation, jailbreak diffusion), legal exposure, and whether open red-team releases mitigate or worsen safety.",category:"Security",modes:["analyze","debate"],tags:["safety","open-weights"]},{id:"on-device-llm-race",label:"On-Device LLM Race",prompt:"Phone OEMs ship 3nm NPUs and 20B-parameter on-device assistants. What actually moves the needle for UX, privacy, and cost vs. cloud? Where do hybrid (edge + cloud) designs win?",category:"Infra",modes:["compare","debate"],tags:["edge","latency"]},{id:"signed-app-prompt-injection",label:"Signed App Prompt Injection",prompt:"A popular signed desktop app shipped with hardcoded system prompts; attackers use supply chain updates to exfiltrate data. How should vendors audit, sandbox, and attest LLM apps?",category:"Security",modes:["compare","analyze"],tags:["supply-chain","prompt-injection"]},{id:"eval-standardization",label:"Safety Eval Standard",prompt:"NIST-style safety eval suites gain traction (jailbreak, autonomy, bio). How should vendors report scores, and what gaps remain for frontier vs. small models?",category:"Policy",modes:["compare","debate"],tags:["evaluation","safety"]},{id:"licensing-standoff",label:"Publisher Licensing Standoff",prompt:"Major news publishers pause AI licensing talks and sue over training. What remedies (revenue share, opt-out registries, model removal) are realistic, and how do they ripple to open models?",category:"Data",modes:["analyze","debate"],tags:["licensing","copyright"]},{id:"sbom-for-llms",label:"SBOM for LLM Pipelines",prompt:"Regulators push SBOMs and signed artifacts for AI stacks. Draft what should appear in an LLM pipeline SBOM (data, weights, evals, guardrails) and how to verify it at runtime.",category:"Security",modes:["compare","analyze"],tags:["sbom","supply-chain"]},{id:"data-poisoning-campaign",label:"Data Poisoning Campaign",prompt:"Researchers find coordinated data poisoning in popular open corpora. How should model hosts detect and mitigate poisoning post-hoc, and what retraining tradeoffs are acceptable?",category:"Security",modes:["compare","debate"],tags:["data","poisoning"]},{id:"copyright-settlement",label:"Copyright Settlement Sets Precedent",prompt:"A major copyright suit settles with dataset disclosure and per-output watermarking. Predict how this precedent affects future training sets and open-weight releases.",category:"Policy",modes:["debate"],tags:["copyright","watermarking"]}],Tr={analyze:["What's the most important programming principle?","Should code comments explain 'what' or 'why'?","Is TypeScript worth the extra complexity?"],debate:["Tabs or spaces? Give your verdict.","Should AI be allowed to write its own code?","What will never be automated by AI?"],compare:[],chat:[]};Rt.filter(t=>t.category==="Policy"||t.category==="Data"),Rt.filter(t=>t.category==="Infra"),Rt.filter(t=>t.category==="Security");const hs=["dots-mesh","dots","dots-fade","grid","mesh","animated-mesh","none"],pt="#0f172a",sn={compare:pt,analyze:pt,debate:pt,chat:pt},Ze={maxTokens:1024,temperature:.7},ms=`You can output interactive UI elements using JSON. When appropriate, include clickable options:

\`\`\`json
{
  "options": [
    {"id": "opt1", "label": "Option 1", "action": "message", "value": "User selected option 1"},
    {"id": "opt2", "label": "Option 2", "action": "message", "value": "User selected option 2"}
  ]
}
\`\`\`

Guidelines:
- Use for choices, confirmations, or navigation
- 2-4 options max
- Keep labels short
- Include JSON after your text response`,ne={cardWidth:256,cardHeight:200,gapX:24,gapY:24,baseRadius:160,minRadius:120,radiusPerModel:15,scrollClamp:200};function xs({showDock:t,availableModels:n,allSelectedByType:r,totalModelsByType:i,handleDragStart:u,handleModelToggle:a,handleAddGroup:m,dockRef:c,mode:d,allModels:f,setShowDock:h,chatSelectedModels:p=new Set,onToggleChatModel:w,onToggleChatGroup:N}){const[A,L]=s.useState(""),[v,l]=s.useState(""),k=s.useRef(null);s.useEffect(()=>{const M=setTimeout(()=>l(A),200);return()=>clearTimeout(M)},[A]);const D=[{type:"self-hosted",title:"Self-Hosted",accentColor:"emerald"},{type:"github",title:"GitHub Models",accentColor:"blue"}],Y=d==="chat",O=Y?f:n,j=s.useMemo(()=>{if(!v)return O;const M=v.toLowerCase();return O.filter(_=>_.name.toLowerCase().includes(M))},[O,v]),Q=s.useCallback(M=>{Y&&w?w(M):a(M)},[Y,w,a]);s.useEffect(()=>{t?setTimeout(()=>{var M;return(M=k.current)==null?void 0:M.focus()},100):L("")},[t]),s.useEffect(()=>{if(!t)return;const M=_=>{_.key==="Escape"&&(_.preventDefault(),h(!1))};return window.addEventListener("keydown",M),()=>window.removeEventListener("keydown",M)},[t,h]);const ee=M=>({emerald:{dot:"bg-emerald-500",text:"text-emerald-400",active:"bg-emerald-500/20 border-emerald-500/30"},blue:{dot:"bg-blue-500",text:"text-blue-400",active:"bg-blue-500/20 border-blue-500/30"},purple:{dot:"bg-purple-500",text:"text-purple-400",active:"bg-purple-500/20 border-purple-500/30"}})[M];return e.jsxs("div",{ref:c,"data-no-arena-scroll":!0,"data-no-background":!0,className:"fixed top-1/2 left-1/2 w-[min(90vw,500px)] max-h-[70vh] rounded-2xl flex flex-col z-[60] transition-all duration-300 shadow-2xl bg-slate-800/95 backdrop-blur-md",style:{transform:t?"translate(-50%, -50%) scale(1)":"translate(-50%, -50%) scale(0.95)",opacity:t?1:0,pointerEvents:t?"auto":"none"},children:[e.jsxs("div",{className:"px-4 py-3 border-b border-slate-700/50 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-200",children:Y?"Select Models":"Add to Arena"}),Y&&e.jsx("p",{className:"text-[10px] text-slate-500 mt-0.5",children:p.size===0?"Click to select":`${p.size} selected`})]}),e.jsx("button",{onClick:()=>h(!1),className:"text-slate-400 hover:text-slate-200",children:e.jsx(Vn,{size:18})})]}),e.jsx("div",{className:"px-4 py-2 border-b border-slate-700/50",children:e.jsxs("div",{className:"relative",children:[e.jsx(Qn,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-500"}),e.jsx("input",{ref:k,type:"text",placeholder:"Search...",value:A,onChange:M=>L(M.target.value),className:"w-full pl-9 pr-3 py-2 text-sm bg-slate-700/50 border border-slate-600/50 rounded-lg text-slate-200 placeholder-slate-500 focus:outline-none focus:border-slate-500"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-3 space-y-4",children:D.map(M=>{const _=j.filter($=>$.type===M.type),W=f.filter($=>$.type===M.type),K=ee(M.accentColor);if(W.length===0)return null;const oe=Y&&W.every($=>p.has($.id));return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between px-1 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${K.dot}`}),e.jsxs("span",{className:"text-[10px] font-semibold text-slate-400 uppercase tracking-wide",children:[M.title," (",W.length,")"]})]}),Y?N&&e.jsx("button",{onClick:()=>N(M.type),className:`text-[10px] font-medium px-2 py-1 rounded ${K.text} hover:bg-white/5`,children:oe?"− Remove All":"+ Add All"}):e.jsx("button",{onClick:()=>m(M.type),className:`text-[10px] font-medium px-2 py-1 rounded ${K.text} hover:bg-white/5`,children:r[M.type]?"− Remove All":"+ Add All"})]}),e.jsx("div",{className:"space-y-1",children:_.map($=>{const F=Y?p.has($.id):!1;return e.jsxs("div",{draggable:!Y,onDragStart:Y?void 0:g=>u(g,$.id),onClick:()=>Q($.id),className:`flex items-center justify-between px-3 py-2 rounded-lg cursor-pointer transition-colors border ${F?K.active:"hover:bg-white/5 border-transparent"}`,children:[e.jsx("span",{className:`text-xs font-medium ${F?"text-slate-200":"text-slate-400"}`,children:$.name}),F&&e.jsx(Jn,{size:14,className:K.text})]},$.id)})})]},M.type)})}),e.jsx("div",{className:"px-4 py-2 border-t border-slate-700/50",children:e.jsxs("p",{className:"text-[10px] text-slate-500 text-center",children:["Press ",e.jsx("kbd",{className:"px-1 py-0.5 rounded bg-slate-700 text-slate-400 text-[9px]",children:"M"})," or ",e.jsx("kbd",{className:"px-1 py-0.5 rounded bg-slate-700 text-slate-400 text-[9px]",children:"Esc"})," to close"]})})]})}function gs({inputRef:t,inputFocused:n,setInputFocused:r,onSendMessage:i,className:u,style:a,placeholder:m,isGenerating:c,onStop:d}){return e.jsx("div",{className:u??"fixed bottom-0 right-0 left-0 z-[100] pb-6 px-3 sm:px-4 flex justify-center items-end pointer-events-none transition-all duration-300",style:a??{paddingBottom:"calc(1.5rem + env(safe-area-inset-bottom))"},children:e.jsx("div",{className:"w-full pointer-events-auto",style:{maxWidth:"600px"},children:e.jsxs("div",{className:`rounded-xl p-2.5 transition-all duration-300 flex items-center gap-2 border border-slate-700/40 header-shell ${n?"prompt-panel-focused":""}`,children:[e.jsx("input",{ref:t,type:"text",placeholder:m||"Ask a question to compare model responses...",className:"w-full bg-transparent text-slate-200 placeholder-slate-500 outline-none text-base sm:text-sm px-2.5 py-2.5",onFocus:()=>r(!0),onBlur:()=>r(!1),onKeyDown:f=>{var h;if(f.key==="Enter"&&!f.shiftKey){if(f.preventDefault(),c)return;(h=t.current)!=null&&h.value&&(i(t.current.value),t.current.value="")}},disabled:c}),e.jsx("button",{onClick:()=>{var f;c?d==null||d():(f=t.current)!=null&&f.value&&(i(t.current.value),t.current.value="")},onMouseDown:f=>f.currentTarget.blur(),className:`min-w-[44px] min-h-[44px] sm:min-w-[36px] sm:min-h-[36px] p-2 rounded-lg transition-colors active:scale-95 flex items-center justify-center focus:outline-none focus-visible:outline-none ${c?"text-red-400 hover:text-red-300 hover:bg-red-500/10":"text-slate-400 hover:text-white hover:bg-white/10"}`,"aria-label":c?"Stop generation":"Send message",children:c?e.jsx(Zn,{className:"w-5 h-5 sm:w-4 sm:h-4 fill-current"}):e.jsx(es,{className:"w-5 h-5 sm:w-4 sm:h-4",strokeWidth:2.5})})]})})})}const bs={chat:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),compare:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2"})}),analyze:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),debate:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})},Ie=[{value:"chat",label:"Chat"},{value:"compare",label:"Compare"},{value:"analyze",label:"Analyze"},{value:"debate",label:"Debate"}];function ys({mode:t,setMode:n,setHoveredCard:r,clearSelection:i,showDock:u,setShowDock:a,onOpenSettings:m,gestureButtonSlot:c}){const[d,f]=s.useState(!1),h=s.useRef(null),[p,w]=s.useState(!0),N=s.useRef(null),[A,L]=s.useState(null),[v,l]=s.useState(0),k=Ie.findIndex(j=>j.value===t),D=k===-1?0:k,Y=Ie[D].label;s.useEffect(()=>{const j=()=>{w(window.innerWidth>=1024)};return j(),window.addEventListener("resize",j),()=>window.removeEventListener("resize",j)},[]),s.useEffect(()=>{if(!N.current)return;const j=()=>{const M=N.current;if(!M)return;const _=M.querySelectorAll('button[role="radio"]');if(_.length===0||D>=_.length)return;const K=_[D].getBoundingClientRect(),oe=M.getBoundingClientRect(),$=K.width,F=K.left,g=oe.left;L($),l(F-g)},Q=setTimeout(j,0),ee=new ResizeObserver(()=>{setTimeout(j,0)});return ee.observe(N.current),window.addEventListener("resize",j),()=>{clearTimeout(Q),ee.disconnect(),window.removeEventListener("resize",j)}},[t,p,D]),s.useEffect(()=>{function j(Q){h.current&&!h.current.contains(Q.target)&&f(!1)}return d&&document.addEventListener("mousedown",j),()=>{document.removeEventListener("mousedown",j)}},[d]);const O=j=>{n(j),r(null),i(),f(!1)};return e.jsxs("div",{className:"fixed top-0 left-0 right-0 flex items-center justify-between mb-2 px-3 sm:px-6 pt-4 sm:pt-6 z-50 pointer-events-none transition-all duration-300",children:[e.jsx("div",{className:"absolute inset-0 pointer-events-auto",style:{height:"100%",zIndex:-1}}),e.jsx("div",{className:"flex items-center gap-2 w-auto pointer-events-auto z-20",children:c}),e.jsx("div",{className:"hidden md:block absolute left-1/2 -translate-x-1/2 pointer-events-auto z-20",children:e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex items-center p-1.5 rounded-xl border border-slate-700/40 header-shell",children:[e.jsx("button",{onClick:()=>a(!u),className:"px-2 sm:px-3 flex items-center justify-center text-slate-400 hover:text-white transition-colors",title:"Toggle Model Dock",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsx("div",{className:"w-px h-5 bg-slate-700/50 mx-0.5 sm:mx-1"}),e.jsxs("div",{ref:N,className:"relative flex p-1 rounded-lg bg-black/20 mode-track",role:"radiogroup","aria-label":"Mode selection","data-gesture-mode-track":"true",children:[e.jsx("div",{className:"absolute top-1 bottom-1 rounded-md transition-all duration-300 ease-out mode-slider",style:{width:A!==null?`${A}px`:`calc((100% - 8px) / ${Ie.length})`,left:A!==null?`${v}px`:`calc(4px + (100% - 8px) * ${D} / ${Ie.length})`}}),Ie.map(j=>e.jsx("button",{tabIndex:-1,onClick:()=>O(j.value),role:"radio","aria-checked":t===j.value,"aria-label":j.label,title:j.label,className:`relative z-10 py-2 sm:py-1.5 px-3 text-[11px] sm:text-xs font-medium transition-colors duration-200 min-h-[44px] sm:min-h-0 active:scale-95 focus:outline-none focus-visible:outline-none flex-1 flex items-center justify-center text-center ${t===j.value?"text-white":"text-slate-400 hover:text-slate-200"}`,children:j.label},j.value))]})]})})}),e.jsx("div",{className:"flex md:hidden flex-1 justify-center pointer-events-auto relative z-20",children:e.jsxs("div",{className:"relative",ref:h,children:[e.jsxs("button",{onClick:()=>f(!d),className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-slate-800/90 border border-slate-700/50 text-slate-200 font-medium text-sm backdrop-blur-md shadow-lg active:scale-95 transition-all",children:[e.jsx("span",{className:"font-bold text-slate-400 hidden xs:inline",children:"Arena"}),e.jsx("span",{className:"font-bold hidden xs:inline text-slate-600",children:"/"}),e.jsx("span",{children:Y}),e.jsx("svg",{className:`w-4 h-4 text-slate-400 transition-transform duration-200 ${d?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),d&&e.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 mt-2 w-48 py-1 rounded-xl bg-slate-800 border border-slate-700 shadow-2xl overflow-hidden flex flex-col animate-in fade-in zoom-in-95 duration-100 origin-top",children:Ie.map(j=>e.jsxs("button",{onClick:()=>O(j.value),className:`px-4 py-3 text-sm text-left w-full transition-colors flex items-center gap-3 ${t===j.value?"bg-blue-500/10 text-blue-400":"text-slate-300 hover:bg-slate-700/50"}`,children:[e.jsx("span",{className:"flex-shrink-0",children:bs[j.value]}),e.jsx("span",{className:"flex-1",children:j.label}),t===j.value&&e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]},j.value))})]})}),e.jsx("div",{className:"flex items-center gap-2 w-auto justify-end pointer-events-auto z-20",children:e.jsx("button",{onClick:m,className:"min-w-[42px] min-h-[42px] w-[42px] h-[42px] rounded-full bg-slate-800/50 flex items-center justify-center border border-slate-700/50 hover:border-slate-600 transition-colors active:scale-95 focus:outline-none focus-visible:outline-none",title:"Settings",children:e.jsxs("svg",{className:"w-4 h-4 text-slate-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),e.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})})})]})}const vs=t=>{if(typeof t=="string")return t;try{return JSON.stringify(t)}catch{return null}},ws=(t,n)=>{if(t===null)return n;try{return JSON.parse(t)}catch{return n}};function Pe(t,n,r={}){const i=r.serialize??vs,u=r.deserialize??ws,[a,m]=s.useState(()=>{if(typeof window>"u")return n;try{const c=window.localStorage.getItem(t);return u(c,n)}catch{return n}});return s.useEffect(()=>{if(!(typeof window>"u"))try{const c=i(a);c===null?window.localStorage.removeItem(t):window.localStorage.setItem(t,c)}catch{}},[t,i,a]),[a,m]}const ks=800,js=3e3,Ss=8;function Ts(){const[t,n]=s.useState([]),[r,i]=s.useState(!0),[u,a]=s.useState(null),[m,c]=s.useState(0),[d,f]=Pe("playground_selected_models",null),h=s.useRef(d!==null),[p,w]=Pe("playground_chat_model",null),N=s.useRef(p!==null),A=s.useMemo(()=>d??[],[d]),L=s.useCallback(_=>{f(W=>typeof _=="function"?_(W??[]):_)},[f]),[v,l]=s.useState(""),k=s.useRef(0),D=s.useRef(null),Y=s.useCallback(async(_,W,K=!1)=>{D.current&&(clearTimeout(D.current),D.current=null),i(!0),K&&(a("Refreshing..."),c(0));const oe=$=>{var me,pe;const F=$.models.filter(X=>X.type!=="external").map(X=>{const le=X.type==="github"?"github":"self-hosted",de=cs[le];return{id:X.id,name:de.name||X.name||X.id,color:de.color,type:le,response:"",priority:X.priority,context_length:X.context_length,default:X.default}});if(n(F),i(!1),a(null),c(0),h.current||(f(F.filter(X=>X.type==="self-hosted"&&X.id!=="nemotron-3-nano-30b-a3b").map(X=>X.id)),h.current=!0),!N.current){const X=F.find(de=>de.default),le=F.find(de=>de.type==="github");w((X==null?void 0:X.id)||(le==null?void 0:le.id)||((me=F[0])==null?void 0:me.id)||null),N.current=!0}const g=F.find(X=>X.type==="github"),ae=F.find(X=>X.default),Ae=((pe=F[0])==null?void 0:pe.id)||"";l((g==null?void 0:g.id)||(ae==null?void 0:ae.id)||Ae)};try{const $=await fetch("/api/models");if(_!==k.current)return;if(!$.ok)throw new Error(`HTTP ${$.status}`);const F=await $.json();if(_!==k.current)return;if(!F.models||F.models.length===0)throw new Error("No models available yet");oe(F)}catch($){if(_!==k.current)return;console.warn("Backend fetch failed:",$);try{console.log("Trying static models.json...");const g=await fetch("/models.json");if(g.ok){const ae=await g.json();if(ae.models&&ae.models.length>0){console.log(`Loaded ${ae.models.length} models from static file`),oe(ae);return}}}catch(g){console.warn("Static models.json not available:",g)}const F=W+1;if(c(F),F<Ss){const g=Math.min(ks*Math.pow(1.4,W),js);a("Connecting to backend..."),D.current=setTimeout(()=>{Y(_,F)},g)}else i(!1),a("Could not load models")}},[f,w]),O=s.useCallback(()=>{k.current+=1,Y(k.current,0,!0)},[Y]);s.useEffect(()=>(k.current+=1,Y(k.current,0),()=>{k.current+=1,D.current&&clearTimeout(D.current)}),[Y]);const j=s.useMemo(()=>t.filter(_=>!A.includes(_.id)),[t,A]),{totalModelsByType:Q,allSelectedByType:ee}=s.useMemo(()=>{const _={"self-hosted":t.filter(K=>K.type==="self-hosted").length,github:t.filter(K=>K.type==="github").length},W={"self-hosted":t.filter(K=>K.type==="self-hosted"&&A.includes(K.id)).length,github:t.filter(K=>K.type==="github"&&A.includes(K.id)).length};return{totalModelsByType:_,allSelectedByType:{"self-hosted":_["self-hosted"]>0&&W["self-hosted"]===_["self-hosted"],github:_.github>0&&W.github===_.github}}},[t,A]),M=s.useCallback(_=>{var W;return((W=t.find(K=>K.id===_))==null?void 0:W.name)||_},[t]);return{modelsData:t,setModelsData:n,selected:A,setSelected:L,chatModelId:p,setChatModelId:w,moderator:v,setModerator:l,availableModels:j,totalModelsByType:Q,allSelectedByType:ee,modelIdToName:M,isLoading:r,loadError:u,retryCount:m,retryNow:O}}function Es(){var t;return typeof chrome<"u"&&((t=chrome.storage)!=null&&t.local)?window.__API_BASE__||"https://chat.neevs.io":""}async function*zt(t,n,r){var f;const u=`${Es()}${t}`,a=await fetch(u,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),signal:r});if(!a.ok){yield{event:"error",error:`HTTP ${a.status}: ${a.statusText}`};return}const m=(f=a.body)==null?void 0:f.getReader();if(!m){yield{event:"error",error:"No response body"};return}const c=new TextDecoder;let d="";try{for(;;){const{done:h,value:p}=await m.read();if(h)break;d+=c.decode(p,{stream:!0});const w=d.split(`
`);d=w.pop()||"";for(const N of w)if(N.startsWith("data: ")){const A=N.slice(6).trim();if(A)try{yield JSON.parse(A)}catch{}}}}finally{m.releaseLock()}}const Ms=async(t,n)=>zt("/api/chat/stream",{models:t.models,messages:t.messages,max_tokens:t.max_tokens,temperature:t.temperature,github_token:t.github_token},n),Cs=async(t,n)=>zt("/api/chat/analyze/stream",t,n),Ns=async(t,n)=>zt("/api/chat/debate/stream",t,n),Lt=async(t,n)=>{try{for await(const r of t)n(r)}catch(r){throw console.error("Stream error:",r),r}};function rn(t){window.__API_BASE__=t}const Rs=[{name:"Chat",path:"chat.yml",category:"core"},{name:"Build Images",path:"build-push-images.yml",category:"core"},{name:"Nanbeige4-3B Thinking",path:"inference.yml",category:"reasoning",serviceKey:"nanbeige"},{name:"Qwen3 4B",path:"inference.yml",category:"small",serviceKey:"qwen"},{name:"SmolLM3 3B",path:"inference.yml",category:"small",serviceKey:"smollm3"},{name:"LFM2.5 1.2B",path:"inference.yml",category:"small",serviceKey:"lfm2"},{name:"DeepSeek R1 1.5B",path:"inference.yml",category:"reasoning",serviceKey:"r1qwen"},{name:"Gemma 3 12B",path:"inference.yml",category:"medium",serviceKey:"gemma"},{name:"Mistral 7B v0.3",path:"inference.yml",category:"medium",serviceKey:"mistral"},{name:"Phi-3 Mini",path:"inference.yml",category:"small",serviceKey:"phi"},{name:"RNJ-1 Instruct",path:"inference.yml",category:"medium",serviceKey:"rnj"},{name:"Llama 3.2-3B",path:"inference.yml",category:"medium",serviceKey:"llama"},{name:"FunctionGemma 270M",path:"inference.yml",category:"small",serviceKey:"functiongemma"},{name:"Nemotron-3 Nano 30B",path:"inference.yml",category:"reasoning",serviceKey:"nemotron"},{name:"GPT-OSS 20B",path:"inference.yml",category:"reasoning",serviceKey:"gptoss"}],Ls={workflows:Rs},dn=Ls.workflows;new Map(dn.map(t=>[t.name,t.path]));new Map(dn.filter(t=>t.serviceKey).map(t=>[t.serviceKey,t.name]));const ze={githubToken:"",profile:"local_all",chatApiBaseUrl:"http://localhost:8080",modelsBaseDomain:"",modelsUseHttps:!1};function on(t){const n={...ze,...t};(!n.chatApiBaseUrl||typeof n.chatApiBaseUrl!="string")&&typeof n.baseDomain=="string"&&(n.chatApiBaseUrl=n.baseDomain?`${n.useHttps===!1?"http":"https"}://chat.${n.baseDomain}`:"http://localhost:8080",n.profile="custom"),(!n.modelsBaseDomain||typeof n.modelsBaseDomain!="string")&&typeof n.baseDomain=="string"&&(n.modelsBaseDomain=n.baseDomain,n.profile="custom"),typeof n.modelsUseHttps!="boolean"&&typeof n.useHttps=="boolean"&&(n.modelsUseHttps=n.useHttps,n.profile="custom");const r=n.profile==="remote_all"||n.profile==="local_chat_remote_models"||n.profile==="local_all"||n.profile==="custom"?n.profile:ze.profile;return{githubToken:typeof n.githubToken=="string"?n.githubToken:ze.githubToken,profile:r,chatApiBaseUrl:_t(typeof n.chatApiBaseUrl=="string"?n.chatApiBaseUrl:""),modelsBaseDomain:typeof n.modelsBaseDomain=="string"?n.modelsBaseDomain:ze.modelsBaseDomain,modelsUseHttps:typeof n.modelsUseHttps=="boolean"?n.modelsUseHttps:ze.modelsUseHttps}}function As(){var t;return typeof chrome<"u"&&!!((t=chrome.storage)!=null&&t.local)}function _t(t){const n=t.trim().replace(/\/+$/,"");return n||"http://localhost:8080"}function _s(){const[t,n]=s.useState(ze),[r,i]=s.useState(!1);return s.useEffect(()=>{if(As()){chrome.storage.local.get(["envConfig"],a=>{const m=on(a.envConfig);n(m),i(!0);const c=_t(m.chatApiBaseUrl);rn(c),console.log("[Config] Extension mode, API base:",c)});const u=(a,m)=>{var c;if(m==="local"&&((c=a.envConfig)!=null&&c.newValue)){const d=on(a.envConfig.newValue);n(d);const f=_t(d.chatApiBaseUrl);rn(f),console.log("[Config] Updated API base:",f)}};return chrome.storage.onChanged.addListener(u),()=>chrome.storage.onChanged.removeListener(u)}else i(!0),console.log("[Config] Web mode, using relative URLs")},[]),{config:t,isLoaded:r}}function Is(){const[t,n]=s.useState([]),r=s.useRef([]),i=s.useCallback(c=>{if(!c.length)return;const d=[...r.current,...c];r.current=d,n(d)},[]),u=s.useCallback(()=>{r.current=[],n([])},[]),a=s.useCallback(c=>c.map(d=>`${d.role==="user"?"User":"Assistant"}: ${d.content}`).join(`

`),[]),m=s.useCallback((c,d)=>{if(d==="compare")return c;const f=c.filter(p=>p.role==="user"),h=[...c].reverse().find(p=>p.role==="assistant"&&p.kind==="analyze_synthesis"&&p.content.trim().length>0);return h?[...f,h]:f},[]);return{history:t,historyRef:r,pushHistoryEntries:i,clearHistory:u,historyToText:a,buildCarryoverHistory:m}}function zs(t){const n=s.useRef({}),r=s.useRef(null),i=s.useCallback(()=>{r.current=null;const d=n.current;n.current={},Object.keys(d).length&&t(h=>h.map(p=>{const w=d[p.id];return w?{...p,response:(p.response||"")+w.answer,thinking:(p.thinking||"")+w.thinking}:p}))},[t]),u=s.useCallback(()=>{r.current==null&&(r.current=requestAnimationFrame(i))},[i]),a=s.useCallback((d,f,h)=>{if(!f&&!h)return;const p=n.current[d]||{answer:"",thinking:""};p.answer+=f,p.thinking+=h,n.current[d]=p,u()},[u]),m=s.useCallback(d=>{n.current[d]&&delete n.current[d]},[]),c=s.useCallback(()=>{n.current={},r.current!=null&&(cancelAnimationFrame(r.current),r.current=null)},[]);return{pendingStreamRef:n,flushStreamRafRef:r,enqueueStreamDelta:a,clearPendingStreamForModel:m,resetPendingStream:c}}function Ps(t,n){const r={...n};let i=r.carry+t;r.carry="";const u=i.lastIndexOf("<");if(u!==-1&&i.length-u<12){const d=i.slice(u);("<think>".startsWith(d)||"</think>".startsWith(d)||"<thinking>".startsWith(d)||"</thinking>".startsWith(d))&&(r.carry=d,i=i.slice(0,u))}let a="",m="";if(r.harmonyFormat){const d="<|channel|>final<|message|>",f=i.indexOf(d);if(f!==-1)r.inThink&&(a+=i.slice(0,f)),r.inThink=!1,m+=i.slice(f+d.length);else if(r.inThink){const h=i.replace(/<\|channel\|>analysis<\|message\|>/gi,"").replace(/<\|end\|>/gi,"").replace(/<\|start\|>/gi,"").replace(/assistant/gi,"");a+=h}else{const h=i.replace(/<\|end\|>/gi,"");m+=h}return{answerAdd:m,thinkingAdd:a,newState:r}}if(!r.inThink&&!r.implicitThinking){const d=i.indexOf("</think>"),f=i.indexOf("</thinking>"),h=d!==-1||f!==-1,p=i.indexOf("<think>")!==-1||i.indexOf("<thinking>")!==-1;h&&!p&&(r.implicitThinking=!0,r.inThink=!0)}let c=0;for(;c<i.length;)if(r.inThink){const d=i.indexOf("</think>",c),f=i.indexOf("</thinking>",c);let h=-1,p=0;if(d!==-1&&(f===-1||d<f)?(h=d,p=8):f!==-1&&(h=f,p=11),h===-1){a+=i.slice(c);break}a+=i.slice(c,h),r.inThink=!1,r.implicitThinking=!1,c=h+p}else{const d=i.indexOf("<think>",c),f=i.indexOf("<thinking>",c);let h=-1,p=0;if(d!==-1&&(f===-1||d<f)?(h=d,p=7):f!==-1&&(h=f,p=10),h===-1){m+=i.slice(c);break}m+=i.slice(c,h),r.inThink=!0,c=h+p}return{answerAdd:m,thinkingAdd:a,newState:r}}function $s(t){const{mode:n,moderator:r,selected:i,selectedCardIds:u,githubToken:a,isGenerating:m,systemPrompt:c,summarizeSessionResponses:d,setLastQuery:f,setHoveredCard:h,setPhaseLabel:p,setModeratorSynthesis:w,setDiscussionTurnsByModel:N,resetFailedModels:A,markModelFailed:L,failedModelsRef:v,currentDiscussionTurnRef:l,sessionModelIdsRef:k,abortControllerRef:D,thinkingStateRef:Y,conversationHistoryRef:O,pushHistoryEntries:j,historyToText:Q,buildCarryoverHistory:ee,setModelsData:M,modelIdToName:_,setExecutionTimes:W,setIsGenerating:K,setIsSynthesizing:oe,setSpeaking:$,enqueueStreamDelta:F,clearPendingStreamForModel:g,resetPendingStream:ae}=t;return{sendMessage:async(me,pe,X,le)=>{if(!me.trim()||i.length===0&&!X||!X&&m)return;const de=(le==null?void 0:le.skipHistory)??!1,ve={role:"user",content:me},te=de?O.current:[...O.current,ve];de||j([ve]);const De=ee(te,n),I=Q(De);f(me);const we=I?`${I}

Continue the conversation above and respond to the latest user request.`:me;let Z;if(X)Z=X;else{const z=Array.from(u).filter(B=>i.includes(B)&&(n==="compare"||B!==r));Z=z.length>0?z:i.slice()}k.current=Z;const ge={},se=(z,B,T)=>{if(!B)return;const b=T!=null&&T.label?`${T.label}: ${B}`:B;ge[z]=T!=null&&T.replace?b:ge[z]?`${ge[z]}

${b}`:b},ue=new AbortController;D.current=ue,K(!0),oe(!1),h(null),p(null),w(""),N({}),A(),l.current=null,ae(),M(z=>z.map(B=>Z.includes(B.id)||B.id===r?pe&&pe[B.id]?{...B,response:pe[B.id],thinking:void 0,error:void 0}:{...B,response:"",thinking:void 0,error:void 0}:B)),W(z=>{const B={...z},T=performance.now();return Z.forEach(b=>{B[b]={startTime:T}}),r&&!B[r]&&(B[r]={startTime:T}),B});const xe=new Set(Z);r&&xe.add(r),xe.forEach(z=>{const B=fs(z),T=ps(z);Y.current[z]={inThink:B||T,carry:"",implicitThinking:B,harmonyFormat:T}});const be=new Set,_e=(z,B)=>{const T=z==null?void 0:z.trim();!T||de||j([{role:"assistant",content:T,kind:B}])},fe=(z,B)=>{const T=Y.current[z]||{inThink:!1,carry:"",implicitThinking:!1},{answerAdd:b,thinkingAdd:E,newState:C}=Ps(B,T);Y.current[z]=C,b&&se(z,b),(E||b)&&F(z,b,E)},Me=z=>{const B=z.toLowerCase();return B.includes("rate limit")||B.includes("waiting")?'<svg width="14" height="14" viewBox="0 0 24 24" fill="none" style="display: inline-block; vertical-align: text-bottom; margin-right: 6px;"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none"/><path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>'+z:B.includes("error")||B.includes("failed")?'<svg width="14" height="14" viewBox="0 0 24 24" fill="none" style="display: inline-block; vertical-align: text-bottom; margin-right: 6px;"><path d="M12 2L2 20h20L12 2z" stroke="currentColor" stroke-width="2" fill="none" stroke-linejoin="round"/><path d="M12 9v4M12 17h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>'+z:z};try{if(n==="compare"){$(new Set(Z));const z=te.map(b=>({role:b.role,content:b.content})),B=c?[{role:"system",content:c},...z]:z,T=await Ms({models:Z,messages:B,max_tokens:Ze.maxTokens,temperature:Ze.temperature,github_token:a||null},ue.signal);if(await Lt(T,b=>{if(b.event==="info"&&b.content){const E=String(b.content),C=Me(E);p(C),b.model_id&&M(q=>q.map(H=>H.id===b.model_id?{...H,statusMessage:C}:H))}if(b.event==="token"&&b.model_id){const E=b.model_id,C=performance.now();be.has(E)||(be.add(E),W(q=>({...q,[E]:{...q[E],firstTokenTime:C}})),M(q=>q.map(H=>H.id===E?{...H,statusMessage:void 0}:H))),fe(E,String(b.content??""))}if(b.event==="done"&&b.model_id){const E=performance.now(),C=b.model_id;W(q=>({...q,[C]:{...q[C],endTime:E}})),$(q=>{const H=new Set(q);return H.delete(C),H})}}),!de){const b=d(ge,Z);b&&j([{role:"assistant",content:b,kind:"compare_summary"}])}return}if(n==="analyze"){const z=Z;if(z.length<2){const b="Select at least 2 participants for Analyze mode.";w(b),r&&M(E=>E.map(C=>C.id===r?{...C,response:b}:C)),p("Error");return}$(new Set(z));const B=await Cs({query:we,participants:z,max_tokens:Ze.maxTokens,github_token:a||null,system_prompt:c||null},ue.signal);let T="";if(await Lt(B,b=>{const E=b.event;if(E==="analyze_start"&&p("Collecting Responses"),E==="model_start"&&b.model_id){const C=b.model_id;$(q=>{const H=new Set(q);return H.add(C),H})}if(E==="model_chunk"&&b.model_id){const C=b.model_id,q=performance.now();be.has(C)||(be.add(C),W(H=>({...H,[C]:{...H[C],firstTokenTime:q}}))),fe(C,String(b.chunk??""))}if(E==="model_response"&&b.model_id){const C=b.model_id,q=performance.now();W(G=>({...G,[C]:{...G[C],endTime:q}})),$(G=>{const J=new Set(G);return J.delete(C),J});const H=String(b.response??"");se(C,H,{replace:!0}),pe&&pe[C]||(M(G=>G.map(J=>J.id===C?{...J,response:H}:J)),_e(`${_(C)}:
${H}`,"analyze_response"))}if(E==="model_error"&&b.model_id){const C=b.model_id,q=performance.now();W(G=>({...G,[C]:{...G[C],endTime:q}})),$(G=>{const J=new Set(G);return J.delete(C),J});const H=String(b.error??"Error generating response.");g(C),M(G=>G.map(J=>J.id===C?{...J,response:H,error:H}:J)),L(C),se(C,H,{replace:!0})}if(E==="analysis_complete"){p("Analysis Complete");const C=b.consensus||[],q=b.unique_contributions||{};let H=`Analysis:

`;if(C.length>0&&(H+=`Consensus:
`+C.map(G=>`• ${G}`).join(`
`)+`

`),Object.keys(q).length>0){H+=`Unique Contributions:
`;for(const[G,J]of Object.entries(q)){const je=_(G);H+=`
${je}:
`+J.map(Te=>`• ${Te}`).join(`
`)+`
`}}T=H,w(H),r&&M(G=>G.map(J=>J.id===r?{...J,response:H}:J))}if(E==="analyze_complete"&&(p("Complete"),$(new Set)),E==="error"){const C=String(b.error??"Analyze error.");w(C),p("Error")}}),!de){const b=T.trim();b&&j([{role:"assistant",content:b,kind:"analyze_synthesis"}])}return}if(n==="debate"){const z=Z;if(z.length<2){const T="Select at least 2 participants for Debate mode.";w(T),r&&M(b=>b.map(E=>E.id===r?{...E,response:T}:E)),p("Error");return}const B=await Ns({query:we,participants:z,turns:2,max_tokens:Ze.maxTokens,temperature:Ze.temperature,github_token:a||null,system_prompt:c||null},ue.signal);await Lt(B,T=>{const b=T.event;if(b==="debate_start"&&p("Debate Starting"),b==="round_start"){const E=T.round_number??0;p(`Round ${E+1}`)}if(b==="turn_start"&&T.model_id){const E=T.model_id,C=T.turn_number??0,q=T.round_number??0;$(new Set([E])),p(`Round ${q+1} · Turn ${C+1}`),l.current={modelId:E,turnNumber:C}}if(b==="turn_chunk"&&T.model_id){const E=T.model_id,C=performance.now();be.has(E)||(be.add(E),W(q=>({...q,[E]:{...q[E],firstTokenTime:C}}))),fe(E,String(T.chunk??""))}if(b==="turn_complete"&&T.model_id){const E=T.model_id,C=performance.now();W(G=>({...G,[E]:{...G[E],endTime:C}})),$(G=>{const J=new Set(G);return J.delete(E),J});const q=String(T.response??""),H=T.turn_number??0;se(E,q,{replace:!0}),M(G=>G.map(J=>J.id===E?{...J,response:q}:J)),N(G=>({...G,[E]:[...G[E]||[],{turn_number:H,response:q}]})),_e(`${_(E)}:
${q}`,"debate_turn")}if(b==="turn_error"&&T.model_id){const E=T.model_id,C=performance.now();W(H=>({...H,[E]:{...H[E],endTime:C}})),$(H=>{const G=new Set(H);return G.delete(E),G});const q=String(T.error??"Turn error.");g(E),M(H=>H.map(G=>G.id===E?{...G,response:q,error:q}:G)),L(E)}if(b==="debate_complete"&&(p("Complete"),$(new Set)),b==="error"){const E=String(T.error??"Debate error.");p("Error"),w(E)}});return}}catch(z){if(z.name==="AbortError")return;if(console.error("Chat error:",z),D.current===ue){const B=z.message||String(z);w(`Session Error: ${B}`),p("Error"),ae(),M(T=>T.map(b=>Z.includes(b.id)&&!b.response?{...b,response:"Error generating response."}:b)),Z.forEach(T=>L(T))}}finally{if(D.current===ue){const z=performance.now();W(B=>{const T={...B};return k.current.forEach(b=>{T[b]&&!T[b].endTime&&(T[b]={...T[b],endTime:z})}),T}),K(!1),oe(!1),p(B=>B==="Error"?B:null),$(new Set)}}}}}function At(t,n){const r=Math.min(t.x,n.x),i=Math.min(t.y,n.y),u=Math.max(t.x,n.x),a=Math.max(t.y,n.y);return{left:r,top:i,right:u,bottom:a,width:u-r,height:a-i}}function Bs({rootContainerRef:t,visualizationAreaRef:n,arenaOffsetYRef:r,arenaTargetYRef:i,wheelRafRef:u,selectedModels:a,cardRefs:m,selectedCardIds:c,setSelectedCardIds:d,suppressClickRef:f}){const[h,p]=s.useState(null),w=s.useRef(!1);s.useEffect(()=>{w.current=h!=null},[h]),s.useEffect(()=>{const L=v=>{if(v.button!==0||!t.current)return;const l=v.target;if(!l)return;const k=l.closest("[data-card]"),D=l.closest('button, a, input, textarea, select, [role="button"]'),Y=l.closest("[draggable]"),O=l.closest("[data-no-arena-scroll]");if(k||D||Y||O||!t.current.contains(l))return;i.current=r.current,u.current!=null&&(cancelAnimationFrame(u.current),u.current=null);const j=t.current.getBoundingClientRect(),Q={x:v.clientX-j.left,y:v.clientY-j.top};v.preventDefault(),w.current=!0,f.current.card=!1,f.current.background=!1,p({origin:Q,current:Q,active:!1})};return window.addEventListener("mousedown",L,!0),()=>window.removeEventListener("mousedown",L,!0)},[r,i,u,t,n,f]),s.useEffect(()=>{if(!h||!t.current)return;const L=k=>k.preventDefault();document.addEventListener("selectstart",L);const v=k=>{const D=t.current.getBoundingClientRect(),Y={x:k.clientX-D.left,y:k.clientY-D.top};p(O=>{if(!O)return O;const j=At(O.origin,Y),Q=O.active||j.width>4||j.height>4;return{...O,current:Y,active:Q}})},l=k=>{w.current=!1;const D=t.current.getBoundingClientRect(),Y={x:k.clientX-D.left,y:k.clientY-D.top},O=k.target,j=!!(O&&O.closest("[data-card]"));p(Q=>{if(!Q)return null;const ee=At(Q.origin,Y);if(Q.active&&ee.width>0&&ee.height>0){const M=[],_=t.current.getBoundingClientRect(),W={left:_.left+ee.left,right:_.left+ee.right,top:_.top+ee.top,bottom:_.top+ee.bottom};for(const K of a){const oe=m.current.get(K.id);if(!oe)continue;const $=oe.getBoundingClientRect();!($.right<W.left||$.left>W.right||$.bottom<W.top||$.top>W.bottom)&&M.push(K.id)}d(new Set(M)),j?f.current.card=!0:M.length>0&&(f.current.background=!0)}return null})};return window.addEventListener("mousemove",v),window.addEventListener("mouseup",l),()=>{window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",l),document.removeEventListener("selectstart",L)}},[h,t,n,a,m,c,d,f]);const N=s.useMemo(()=>{if(!h||!h.active)return null;const L=At(h.origin,h.current);return L.width<=0||L.height<=0?null:{left:L.left,top:L.top,width:L.width,height:L.height}},[h]),A=s.useCallback(()=>{p(null),w.current=!1},[]);return{selectionRect:N,isSelecting:h!=null,dragSelectionActiveRef:w,clearSelection:A}}function Ds({visualizationAreaRef:t,cardRefs:n,selected:r,setSelected:i,mode:u,gridCols:a,getCirclePosition:m}){const[c,d]=s.useState(null),f=s.useCallback((h,p)=>{if(h.button!==0||h.target.closest('button, a, input, textarea, select, [role="button"]'))return;h.preventDefault();const N=n.current.get(p);if(!N||!t.current)return;const A=N.getBoundingClientRect(),L=t.current.getBoundingClientRect(),v=A.left+A.width/2,l=A.top+A.height/2;d({activeId:p,currX:h.clientX,currY:h.clientY,offsetX:v-h.clientX,offsetY:l-h.clientY,containerLeft:L.left,containerTop:L.top,containerWidth:L.width,containerHeight:L.height,cardHeight:A.height}),h.target.setPointerCapture(h.pointerId)},[t]);return s.useEffect(()=>{if(!c)return;const h=w=>{if(d(l=>l?{...l,currX:w.clientX,currY:w.clientY}:null),!t.current)return;const N=t.current.getBoundingClientRect(),A=r.indexOf(c.activeId);let L=1/0,v=-1;if(u==="compare"){const l=w.clientX-(N.left+N.width/2),k=w.clientY-N.top,D=(ne.cardWidth+ne.gapX)*a-ne.gapX;r.forEach((Y,O)=>{const j=Math.floor(O/a),ee=O%a*(ne.cardWidth+ne.gapX)-D/2+ne.cardWidth/2,M=j*(ne.cardHeight+ne.gapY),_=ee,W=M+ne.cardHeight/2,K=(l-_)**2+(k-W)**2;K<L&&(L=K,v=O)})}else{const l=w.clientX-(N.left+N.width/2),k=w.clientY-(N.top+N.height/2),D=Math.max(ne.baseRadius,ne.minRadius+r.length*ne.radiusPerModel);r.forEach((Y,O)=>{const j=m(O,r.length,u,D),Q=(l-j.x)**2+(k-j.y)**2;Q<L&&(L=Q,v=O)})}if(v!==-1&&v!==A){const l=[...r],[k]=l.splice(A,1);l.splice(v,0,k),i(l)}},p=()=>d(null);return window.addEventListener("pointermove",h),window.addEventListener("pointerup",p),()=>{window.removeEventListener("pointermove",h),window.removeEventListener("pointerup",p)}},[c,t,n,r,i,u,a,m]),{dragState:c,handlePointerDown:f}}function Os({mode:t,showSettings:n,showDock:r,contextMenu:i,selectedCardIds:u,selected:a,inputRef:m,setShowSettings:c,setShowDock:d,setContextMenu:f,setSelected:h,setSelectedCardIds:p,clearSelection:w,setHoveredCard:N,handleModeChange:A}){s.useEffect(()=>{const L=v=>{if(v.key==="Escape"){const k=document.activeElement;if(k&&k!==document.body&&k.blur(),n){c(!1);return}if(i){f(null);return}if(u.size>0){w(),N(null);return}if(r){d(!1);return}N(null);return}if((v.metaKey||v.ctrlKey)&&(v.key==="a"||v.key==="A")){const k=v.target;if(k.tagName==="INPUT"||k.tagName==="TEXTAREA"||t==="chat")return;v.preventDefault(),a.length>0&&p(new Set(a));return}const l=v.target;if(!(l.tagName==="INPUT"||l.tagName==="TEXTAREA")){if(v.key==="ArrowRight"||v.key==="ArrowLeft"){v.preventDefault();const k=["chat","compare","analyze","debate"],D=k.indexOf(t);if(D!==-1){const Y=v.key==="ArrowRight"?1:-1,O=(D+Y+k.length)%k.length;A(k[O])}return}if(v.key==="m"||v.key==="M"){v.preventDefault(),d(!r);return}if((v.key==="Delete"||v.key==="Backspace")&&u.size>0){v.preventDefault(),h(k=>k.filter(D=>!u.has(D))),w();return}v.key.length===1&&!v.ctrlKey&&!v.metaKey&&!v.altKey&&m.current&&m.current.focus()}};return window.addEventListener("keydown",L),()=>window.removeEventListener("keydown",L)},[r,n,i,u,t,a,m,c,d,f,h,p,w,N,A])}function Hs({visualizationAreaRef:t,dragSelectionActiveRef:n}){const r=s.useRef(0),i=s.useRef(0),u=s.useRef(null),a=s.useRef(!1),m=s.useRef(0),c=p=>{const w=t.current;w&&w.style.setProperty("--arena-offset-y",`${p}px`)},d=p=>Math.max(-200,Math.min(ne.scrollClamp,p)),f=()=>{const p=r.current,w=i.current,N=w-p;if(Math.abs(N)<.5){r.current=w,c(w),u.current=null;return}const A=p+N*.35;r.current=A,c(A),u.current=requestAnimationFrame(f)},h=()=>{u.current==null&&(u.current=requestAnimationFrame(f))};return s.useEffect(()=>{const p=v=>{if(n.current)return;const l=v.target;if(l&&l.closest("input, textarea, [data-no-arena-scroll]"))return;v.preventDefault();const k=v.deltaY*.9,D=i.current-k;i.current=d(D),h()},w=v=>v?!!v.closest('input, textarea, [data-no-arena-scroll], [data-card], button, a, select, [role="button"]'):!1,N=v=>{if(v.touches.length!==1)return;const l=v.target;w(l)||(a.current=!0,m.current=v.touches[0].clientY)},A=v=>{if(n.current||!a.current||v.touches.length!==1)return;const l=v.target;if(w(l)){a.current=!1;return}const k=v.touches[0].clientY,D=k-m.current;m.current=k,v.preventDefault(),i.current=d(i.current+D),h()},L=()=>{a.current=!1};return window.addEventListener("touchstart",N,{passive:!0}),window.addEventListener("touchmove",A,{passive:!1}),window.addEventListener("touchend",L),window.addEventListener("touchcancel",L),window.addEventListener("wheel",p,{passive:!1}),()=>{window.removeEventListener("touchstart",N),window.removeEventListener("touchmove",A),window.removeEventListener("touchend",L),window.removeEventListener("touchcancel",L),window.removeEventListener("wheel",p),u.current!=null&&cancelAnimationFrame(u.current)}},[]),{arenaOffsetYRef:r,arenaTargetYRef:i,wheelRafRef:u,applyOffset:c,clampTarget:d,ensureRaf:h}}function ke(t,n){return!t||!t.startsWith("#")?t:t.length===7||t.length===4?`${t}${n}`:t}const Ws={idle:"Ready",responding:"Responding",done:"Done",waiting:"Waiting",error:"Error"};function It({state:t,color:n,size:r=16,label:i,className:u=""}){const a={width:`${r}px`,height:`${r}px`},m=i??Ws[t],c=Math.max(2,Math.round(r*.14)),d=Math.max(12,r-2),f="#fbbf24",h=ke(n,"cc"),p=()=>{switch(t){case"responding":return e.jsx("div",{className:"relative flex items-center justify-center",style:a,children:e.jsxs("svg",{width:d,height:d,viewBox:"0 0 24 24",fill:"none",className:"",style:{filter:`drop-shadow(0 0 6px ${ke(f,"55")})`,animation:"spin 0.6s linear infinite"},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"spinnerGradient",gradientUnits:"userSpaceOnUse",x1:"3",y1:"12",x2:"12",y2:"3",children:[e.jsx("stop",{offset:"0%",stopColor:f,stopOpacity:"1"}),e.jsx("stop",{offset:"60%",stopColor:f,stopOpacity:"0.5"}),e.jsx("stop",{offset:"100%",stopColor:f,stopOpacity:"0"})]})}),e.jsx("circle",{cx:"12",cy:"12",r:"9",stroke:ke(f,"15"),strokeWidth:c,fill:"none"}),e.jsx("path",{d:"M 12 3 A 9 9 0 1 1 3 12",stroke:"url(#spinnerGradient)",strokeWidth:c,strokeLinecap:"round",fill:"none"}),e.jsx("circle",{cx:"3",cy:"12",r:c*.7,fill:f})]})});case"done":return e.jsx("div",{className:"flex items-center justify-center rounded-full",style:{...a,background:ke(n,"14"),border:`1px solid ${ke(n,"99")}`},children:e.jsx("svg",{width:d,height:d,viewBox:"0 0 24 24",fill:"none",children:e.jsx("polyline",{points:"5 13 10 18 19 7",stroke:n,strokeWidth:c,strokeLinecap:"round",strokeLinejoin:"round"})})});case"error":const w="#ef4444";return e.jsx("div",{className:"flex items-center justify-center rounded-full",style:{...a,background:ke(w,"14"),border:`1px solid ${ke(w,"99")}`},children:e.jsx("svg",{width:d,height:d,viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M6 6L18 18M6 18L18 6",stroke:w,strokeWidth:c,strokeLinecap:"round",strokeLinejoin:"round"})})});case"waiting":return e.jsxs("div",{className:"relative flex items-center justify-center",style:a,children:[e.jsx("div",{className:"absolute inset-0 rounded-full",style:{border:`1px solid ${ke(h,"99")}`}}),e.jsx("svg",{width:d,height:d,viewBox:"0 0 24 24",fill:"none",style:{animation:"spin 5s linear infinite"},children:e.jsx("circle",{cx:"12",cy:"12",r:"8.5",stroke:ke(h,"44"),strokeWidth:c-1,strokeDasharray:"6 10",strokeLinecap:"round"})}),e.jsx("div",{className:"absolute w-2 h-2 rounded-full",style:{background:ke(h,"aa"),animation:"pulse 1.5s ease-in-out infinite"}})]});default:return e.jsxs("div",{className:"relative flex items-center justify-center",style:a,children:[e.jsx("div",{className:"absolute inset-0 rounded-full",style:{border:"1px solid rgba(71, 85, 105, 0.5)"}}),e.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:"rgba(148, 163, 184, 0.6)",animation:"pulse 2.4s ease-in-out infinite"}})]})}};return e.jsx("div",{className:`inline-flex items-center justify-center ${u}`,title:m,children:p()})}function an({times:t,isFastestTTFT:n,isFastestTotal:r}){const i=(t==null?void 0:t.startTime)!=null,u=(t==null?void 0:t.endTime)!=null,a=(t==null?void 0:t.firstTokenTime)!=null,m=i&&u?((t.endTime-t.startTime)/1e3).toFixed(2):null,c=i&&a?((t.firstTokenTime-t.startTime)/1e3).toFixed(2):null;return e.jsxs("div",{className:"text-[10px] text-slate-500 flex items-center gap-2",children:[e.jsxs("span",{className:r?"text-yellow-400/90 bg-yellow-500/10 px-1.5 py-0.5 rounded":void 0,title:r?"Fastest":void 0,children:[e.jsx("span",{className:r?void 0:"text-slate-400",children:"TIME"})," ",m?`${m}s`:i&&!u?"...":"—"]}),c&&e.jsxs("span",{className:n?"text-amber-400/90 bg-amber-500/10 px-1.5 py-0.5 rounded":"text-slate-600",title:n?"Fastest TTFT":void 0,children:["TTFT ",c,"s"]})]})}const Pt=({text:t,speed:n=5})=>{const[r,i]=s.useState(""),u=s.useRef(0),a=s.useRef(null);return s.useEffect(()=>{!t.startsWith(r)&&r!==""&&(i(""),u.current=0)},[t]),s.useEffect(()=>{a.current!=null&&(clearTimeout(a.current),a.current=null);const m=t.length;if(u.current>=m)return;const c=()=>{const d=u.current,f=m-d;if(f<=0)return;const h=f>120?12:f>40?4:f>10?2:1,p=Math.min(m,d+h);u.current=p,i(t.slice(0,p));const N=m-p>5?0:n;a.current=window.setTimeout(c,N)};return a.current=window.setTimeout(c,n),()=>{a.current!=null&&(clearTimeout(a.current),a.current=null)}},[t,n]),e.jsx("span",{children:r})},ht=96;function Gs(t){switch(t){case"error":return"Error";case"responding":return"Responding";case"done":return"Done";case"waiting":return"Waiting";default:return"Ready"}}function Ys({mode:t,layoutRadius:n,moderatorModel:r,moderatorId:i,orchestratorTransform:u,orchestratorStatus:a,moderatorSynthesis:m,isSynthesizing:c,isGenerating:d,phaseLabel:f,speaking:h,hoveredCard:p,setHoveredCard:w,setSelectedCardIds:N,lastSelectedCardRef:A,orchestratorAutoMode:L,orchestratorAutoScope:v,showOrchestratorMenu:l,setShowOrchestratorMenu:k,setOrchestratorAutoMode:D,setOrchestratorAutoScope:Y,orchestratorMenuRef:O,availableModels:j,setModerator:Q,getTailSnippet:ee}){const[M,_]=s.useState(null),W=Gs(a),K=f||"";s.useEffect(()=>{if(!l)return;const g=ae=>{O.current&&!O.current.contains(ae.target)&&(k(!1),_(null))};return document.addEventListener("mousedown",g,!0),()=>document.removeEventListener("mousedown",g,!0)},[l,O,k]);const oe=()=>{if(m)return c&&i&&h.has(i)?e.jsx(Pt,{text:m,speed:20}):ee(m);if(c)return e.jsx("span",{className:"text-slate-500 italic",children:"Synthesizing responses..."});if(d){if(f!=null&&f.startsWith("<svg"))return e.jsx("span",{className:"text-slate-500 italic",dangerouslySetInnerHTML:{__html:f}});const g=f==="Stage 1 · Responses"?"Waiting for model responses...":f||"Orchestrating...";return e.jsx("span",{className:"text-slate-500 italic",children:g})}return e.jsx("span",{className:"text-slate-500 italic",children:"Send a prompt to see the synthesis."})},$=a==="responding",F=$?"#fbbf24":r.color;return e.jsxs("div",{"data-card":!0,className:"absolute z-20 transition-all duration-700 ease-out cursor-pointer",style:{opacity:1,transform:u,left:"50%",top:t==="analyze"?`calc(50% + ${n}px - 64px)`:"50%"},onClick:g=>{g.stopPropagation(),i&&(N(new Set([i])),A.current=i)},onContextMenu:g=>{g.preventDefault(),g.stopPropagation(),l?(k(!1),_(null)):(_({x:g.clientX,y:g.clientY}),k(!0))},onMouseEnter:()=>w("moderator"),onMouseLeave:()=>w(null),children:[e.jsxs("div",{className:"relative flex items-center justify-center",style:{width:`${ht}px`,height:`${ht}px`},children:[e.jsx("div",{className:"absolute inset-0 rounded-full animate-pulse",style:{background:`radial-gradient(circle, ${F}20 0%, transparent 70%)`,transform:"scale(2.2)",filter:"blur(18px)"}}),e.jsxs("div",{className:"relative rounded-full flex items-center justify-center transition-all duration-300",style:{width:`${ht}px`,height:`${ht}px`,background:$?"linear-gradient(135deg, rgba(251, 191, 36, 0.08), rgba(15, 23, 42, 0.9))":"rgba(15, 23, 42, 0.9)",backdropFilter:"blur(16px)",border:`2px solid ${F}${$?"99":"60"}`,boxShadow:`0 0 36px ${F}${$?"40":"28"}, inset 0 1px 1px rgba(255,255,255,0.1)`},children:[e.jsx("div",{className:"absolute inset-[-4px] rounded-full",style:{background:`conic-gradient(from 0deg, transparent, ${F}60, transparent)`,animation:"spin 4s linear infinite"}}),e.jsx("div",{className:"absolute inset-[2px] rounded-full",style:{background:"rgba(15, 23, 42, 0.96)"}}),e.jsxs("div",{className:"relative text-center z-10 flex flex-col items-center gap-1.5 px-3",children:[e.jsx("div",{className:"text-[7px] tracking-[0.32em] text-slate-400 uppercase",children:W}),e.jsx("div",{className:"text-[10px] font-semibold text-slate-100 leading-tight",children:r.name}),e.jsx(It,{state:a,color:F,size:12})]})]})]}),e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 flex flex-col items-center gap-1 w-max max-w-[200px]",style:{top:"calc(100% + 12px)"},children:e.jsx("span",{className:"text-[10px] text-slate-500",children:K})}),p==="moderator"&&!l&&e.jsxs("div",{"data-card":!0,onClick:g=>g.stopPropagation(),className:"absolute bottom-full mb-4 left-1/2 -translate-x-1/2 w-80 max-w-[calc(100vw-2rem)] p-4 rounded-xl z-[200] transition-all duration-300",style:{background:"rgba(15, 23, 42, 0.95)",backdropFilter:"blur(16px)",border:`1px solid ${F}40`,boxShadow:`0 20px 40px rgba(0,0,0,0.5), 0 0 30px ${F}20`},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"Orchestrator"}),e.jsx("span",{className:"text-xs text-slate-500",children:"·"}),e.jsx("span",{className:"text-xs font-medium text-slate-300",children:r.name}),$&&e.jsx("span",{className:"text-[9px] uppercase tracking-wider px-1.5 py-0.5 rounded bg-yellow-500/20 text-yellow-300 border border-yellow-500/30",children:"Working"})]}),e.jsx("p",{className:"text-sm text-slate-300 leading-relaxed",children:oe()})]}),l&&M&&ts.createPortal(e.jsx("div",{ref:O,className:"w-64 bg-slate-800 border border-slate-700 rounded-lg shadow-xl overflow-hidden",style:{position:"fixed",top:`${M.y}px`,left:`${M.x}px`,transform:"translateY(-50%)",zIndex:9999},onClick:g=>g.stopPropagation(),children:L?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-3 py-2 text-[10px] uppercase tracking-wider text-slate-500 font-semibold border-b border-slate-700/50",children:["Auto Mode: ",v==="self-hosted"?"SELF-HOSTED":v.toUpperCase()]}),["all","self-hosted","api"].map(g=>e.jsxs("button",{onClick:()=>{Y(g),k(!1)},className:`w-full px-3 py-2 text-left text-xs font-medium transition-colors ${v===g?"bg-yellow-500/20 text-yellow-300":"text-slate-300 hover:bg-slate-700/50"}`,children:[g==="all"&&"All",g==="self-hosted"&&"Self-hosted",g==="api"&&"API",e.jsxs("span",{className:"text-[10px] text-slate-500 ml-1",children:[g==="all"&&"(self-hosted → API)",g==="self-hosted"&&"(no quota)",g==="api"&&"(cloud only)"]})]},g)),e.jsx("div",{className:"border-t border-slate-700",children:e.jsx("button",{onClick:()=>{D(!1),k(!1)},className:"w-full px-3 py-2 text-left text-xs font-medium text-slate-400 hover:bg-slate-700/50 transition-colors",children:"Manual Mode"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-3 py-2 text-[10px] uppercase tracking-wider text-slate-500 font-semibold border-b border-slate-700/50",children:"Select Orchestrator"}),j.filter(g=>g.type==="github").length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-3 py-1.5 text-[9px] uppercase tracking-wider text-slate-600 font-semibold",children:"GitHub Models"}),j.filter(g=>g.type==="github").map(g=>e.jsx("button",{onClick:()=>{Q(g.id),k(!1)},className:`w-full px-4 py-2 text-left text-xs font-medium transition-colors ${i===g.id?"bg-blue-500/20 text-blue-300":"text-slate-300 hover:bg-slate-700/50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:g.name}),i===g.id&&e.jsx("span",{className:"text-blue-400",children:"✓"})]})},g.id))]}),j.filter(g=>g.type==="self-hosted").length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-3 py-1.5 text-[9px] uppercase tracking-wider text-slate-600 font-semibold border-t border-slate-700/50 mt-1",children:"Self-Hosted Models"}),j.filter(g=>g.type==="self-hosted").map(g=>e.jsx("button",{onClick:()=>{Q(g.id),k(!1)},className:`w-full px-4 py-2 text-left text-xs font-medium transition-colors ${i===g.id?"bg-blue-500/20 text-blue-300":"text-slate-300 hover:bg-slate-700/50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:g.name}),i===g.id&&e.jsx("span",{className:"text-blue-400",children:"✓"})]})},g.id))]}),e.jsx("div",{className:"border-t border-slate-700",children:e.jsxs("button",{onClick:()=>{D(!0),k(!1)},className:"w-full px-3 py-2 text-left text-xs font-medium text-yellow-400 hover:bg-slate-700/50 transition-colors flex items-center gap-2",children:[e.jsx(ns,{size:12}),e.jsx("span",{children:"Enable Auto Mode"})]})})]})}),document.body)]})}const mt=256,un=200,ln=96;function Fs(t){const{mode:n,selectedModels:r,gridCols:i,speaking:u,selectedCardIds:a,setSelectedCardIds:m,executionTimes:c,failedModels:d,cardRefs:f,handlePointerDown:h,dragState:p,setContextMenu:w,suppressClickRef:N,getTailSnippet:A,hoveredCard:L,setHoveredCard:v,setExpandedModelId:l,layoutRadius:k,getCirclePosition:D,moderatorModel:Y,moderatorId:O,orchestratorTransform:j,orchestratorStatus:Q,moderatorSynthesis:ee,isSynthesizing:M,isGenerating:_,phaseLabel:W,linesTransitioning:K,lastSelectedCardRef:oe,orchestratorAutoMode:$,orchestratorAutoScope:F,showOrchestratorMenu:g,setShowOrchestratorMenu:ae,setOrchestratorAutoMode:Ae,setOrchestratorAutoScope:me,orchestratorMenuRef:pe,availableModels:X,setModerator:le,fastestTTFT:de,fastestTotal:ve}=t,te=n!=="compare",De=n==="analyze"?k-64:0;return e.jsxs(e.Fragment,{children:[r.map((I,we)=>{var Oe;const Z=D(we,r.length,n,k),ge=Xs(we,i),se=u.has(I.id),ue=a.has(I.id),xe=d.has(I.id),be=!se&&!xe&&!!((Oe=c[I.id])!=null&&Oe.endTime)&&I.response.trim().length>0,fe=Zs(se,be,xe,!se&&!be&&!xe&&_&&n==="debate"),Me=Js(fe),z="#fbbf24",B="#ef4444",T=I.type==="self-hosted"?"#10b981":"#3b82f6",b=xe?B:T,E=se&&!xe,C=er({hasError:xe,isProcessing:E,isSelected:ue,errorColor:B,processingColor:z,typeColor:T}),q=Us({mode:n,gridX:ge.gridX,gridY:ge.gridY,circleX:Z.x,circleY:Z.y,dragState:p,modelId:I.id}),H=L===I.id,G=te?ln:mt,J=te?ln:un,je=Math.max(800,k*2+600),Te=je/2,Ee=Te,re=Te,et=Te+(0-Z.x),tt=Te+(De-Z.y);return e.jsxs("div",{ref:ce=>{ce?f.current.set(I.id,ce):f.current.delete(I.id)},onPointerDown:ce=>h(ce,I.id),className:"absolute",onContextMenu:ce=>{ce.preventDefault(),ce.stopPropagation(),w({x:ce.clientX,y:ce.clientY,modelId:I.id})},style:{transform:q,zIndex:te?H?300:ue?40:se?15:5:ue?20:se?10:1,left:"50%",top:te?"50%":"0",transition:(p==null?void 0:p.activeId)===I.id?"none":"transform 300ms cubic-bezier(0.2, 0, 0.2, 1)"},children:[te&&se&&!xe&&!K&&e.jsxs("svg",{className:"absolute pointer-events-none",style:{width:`${je}px`,height:`${je}px`,top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:-1},viewBox:`0 0 ${je} ${je}`,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:`grad-${I.id}`,gradientUnits:"userSpaceOnUse",x1:Ee,y1:re,x2:et,y2:tt,children:[e.jsx("stop",{offset:"0%",stopColor:z,stopOpacity:"0.45"}),e.jsx("stop",{offset:"100%",stopColor:z,stopOpacity:"0.12"})]})}),e.jsx("line",{x1:Ee,y1:re,x2:et,y2:tt,stroke:`url(#grad-${I.id})`,strokeWidth:"2",strokeDasharray:"6,4",strokeLinecap:"round",className:"animate-flow arena-link"})]}),e.jsxs("div",{"data-card":!0,onClick:ce=>Ks({e:ce,modelId:I.id,suppressClickRef:N,setSelectedCardIds:m,selectedModels:r,lastSelectedCardRef:oe}),onDoubleClick:ce=>{ce.stopPropagation(),!te&&l&&l(I.id)},onMouseEnter:()=>te&&v(I.id),onMouseLeave:()=>te&&v(null),className:`relative cursor-grab active:cursor-grabbing card-hover ${te?"rounded-full":""} ${ue?"card-selected":""} ${se?"card-speaking":""}`,style:{background:C.background,backdropFilter:te?void 0:"blur(8px)",WebkitBackdropFilter:te?void 0:"blur(8px)",border:C.border,boxShadow:C.shadow,transform:ue||E?"scale(1.05)":"scale(1)",width:`${G}px`,height:`${J}px`,borderRadius:te?"50%":"12px",transition:"transform 180ms ease-out, box-shadow 180ms ease-out, border-color 180ms ease-out, width 0.7s cubic-bezier(0.4, 0, 0.2, 1), height 0.7s cubic-bezier(0.4, 0, 0.2, 1), border-radius 0.7s cubic-bezier(0.4, 0, 0.2, 1)"},children:[!te&&e.jsxs("div",{style:Qs,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3 gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5 min-w-0",children:[e.jsx(It,{state:fe,color:b,size:16,label:Me}),e.jsx("span",{className:"text-xs font-semibold text-slate-200 truncate",children:I.name})]}),e.jsx("div",{className:"flex items-center gap-1.5 shrink-0",children:e.jsx("span",{className:`text-[9px] uppercase tracking-wider px-1.5 py-0.5 rounded ${I.type==="self-hosted"?"bg-emerald-500/10 text-emerald-300 border border-emerald-500/30":"bg-blue-500/10 text-blue-300 border border-blue-500/30"}`,children:I.type==="self-hosted"?"Self-hosted":"API"})})]}),e.jsx("p",{className:"text-xs text-slate-400 leading-relaxed line-clamp-3 flex-1",children:qs({model:I,isSpeaking:se,thinkingFallback:e.jsx("span",{className:"text-slate-500 italic",children:"Generating…"}),getTailSnippet:A})}),e.jsx("div",{className:"flex items-center gap-4 mt-3 pt-3 border-t border-slate-700/50",children:e.jsx(an,{times:c[I.id],isFastestTTFT:de===I.id,isFastestTotal:ve===I.id})})]}),te&&e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center text-center",style:{transition:"opacity 0.3s ease-out"},children:[e.jsx("div",{className:"absolute inset-[3px] rounded-full border border-white/5",style:{boxShadow:`inset 0 0 20px ${b}15`}}),e.jsx("div",{className:"absolute inset-[-6px] rounded-full opacity-60",style:{background:`radial-gradient(circle, ${b}22 0%, transparent 65%)`,filter:"blur(10px)"}}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center gap-1.5 px-3",children:[e.jsx("div",{className:"text-[7px] tracking-[0.32em] text-slate-400 uppercase",children:Me}),e.jsx("div",{className:"text-[10px] font-semibold text-slate-100 leading-tight",children:I.name}),e.jsx(It,{state:fe,color:b,size:12})]})]})]}),n==="analyze"&&te&&I.personaEmoji&&e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 flex items-center justify-center pointer-events-none select-none",style:{bottom:"-12px",fontSize:"20px",zIndex:100,transition:"transform 180ms ease-out",transform:se?"scale(1.15)":"scale(1)",filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.5)) drop-shadow(0 0 8px rgba(0,0,0,0.3))"},title:I.personaName?`${I.personaName} - ${I.personaTrait}`:"Persona",children:I.personaEmoji}),te&&se&&I.thinking&&I.thinking.trim().length>0&&I.response.trim().length===0&&e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 flex items-center justify-center pointer-events-none select-none animate-pulse",style:{bottom:"-12px",fontSize:"18px",zIndex:100,filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.5)) drop-shadow(0 0 10px rgba(168, 85, 247, 0.4))"},title:"Thinking...",children:"💭"}),te&&L===I.id&&e.jsxs("div",{"data-card":!0,onClick:ce=>ce.stopPropagation(),className:"absolute w-64 max-w-[calc(100vw-2rem)] p-4 rounded-xl transition-all duration-300 z-[220]",style:{top:Z.y>0?"auto":"100%",bottom:Z.y>0?"100%":"auto",left:"50%",transform:"translateX(-50%)",marginTop:Z.y>0?0:"12px",marginBottom:Z.y>0?"12px":0,background:"rgba(15, 23, 42, 0.95)",backdropFilter:"blur(16px)",border:`1px solid ${b}40`,boxShadow:`0 20px 40px rgba(0,0,0,0.5), 0 0 20px ${b}15`},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:b}}),e.jsx("span",{className:"text-xs font-semibold text-slate-300",children:I.name})]}),n==="analyze"&&I.personaEmoji&&I.personaName&&e.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-2 border-b border-slate-700/50",children:[e.jsx("span",{className:"text-base",children:I.personaEmoji}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs font-semibold text-blue-400",children:I.personaName}),I.personaTrait&&e.jsx("div",{className:"text-[10px] text-slate-500",children:I.personaTrait})]})]}),e.jsx("p",{className:"text-xs text-slate-400 leading-relaxed whitespace-pre-wrap",children:Vs({model:I,isSpeaking:se,getTailSnippet:A})}),e.jsx("div",{className:"flex items-center gap-4 mt-3 pt-2 border-t border-slate-700/50",children:e.jsx(an,{times:c[I.id]})})]})]},I.id)}),n!=="compare"&&Y&&e.jsx(Ys,{mode:n,layoutRadius:k,moderatorModel:Y,moderatorId:O,orchestratorTransform:j,orchestratorStatus:Q,moderatorSynthesis:ee,isSynthesizing:M,isGenerating:_,phaseLabel:W,speaking:u,hoveredCard:L,setHoveredCard:v,setSelectedCardIds:m,lastSelectedCardRef:oe,orchestratorAutoMode:$,orchestratorAutoScope:F,showOrchestratorMenu:g,setShowOrchestratorMenu:ae,setOrchestratorAutoMode:Ae,setOrchestratorAutoScope:me,orchestratorMenuRef:pe,availableModels:X,setModerator:le,getTailSnippet:A}),n!=="compare"&&e.jsxs("svg",{className:"absolute pointer-events-none transition-opacity duration-700",style:{width:"1000px",height:"1000px",opacity:.2},children:[e.jsx("circle",{cx:"500",cy:"500",r:k,fill:"none",stroke:"url(#circleGrad)",strokeWidth:"1",strokeDasharray:"8,4"}),e.jsx("defs",{children:e.jsxs("linearGradient",{id:"circleGrad",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#3b82f6"}),e.jsx("stop",{offset:"50%",stopColor:"#8b5cf6"}),e.jsx("stop",{offset:"100%",stopColor:"#3b82f6"})]})})]})]})}function Xs(t,n){const r=Math.floor(t/n),i=t%n,u=(mt+ne.gapX)*n-ne.gapX,a=r*(un+ne.gapY);return{gridX:i*(mt+ne.gapX)-u/2+mt/2,gridY:a}}function Us({mode:t,gridX:n,gridY:r,circleX:i,circleY:u,dragState:a,modelId:m}){if((a==null?void 0:a.activeId)===m){const c=a.currX+a.offsetX,d=a.currY+a.offsetY;if(t==="compare"){const p=c-(a.containerLeft+a.containerWidth/2),w=d-a.containerTop-a.cardHeight/2;return`translate(calc(-50% + ${p}px), ${w}px)`}const f=c-(a.containerLeft+a.containerWidth/2),h=d-(a.containerTop+a.containerHeight/2);return`translate(calc(-50% + ${f}px), calc(-50% + ${h}px))`}return t==="compare"?`translate(calc(-50% + ${n}px), ${r}px)`:`translate(calc(-50% + ${i}px), calc(-50% + ${u}px))`}function Ks({e:t,modelId:n,suppressClickRef:r,setSelectedCardIds:i,selectedModels:u,lastSelectedCardRef:a}){if(t.stopPropagation(),r.current.card){r.current.card=!1;return}const m=t.shiftKey,c=t.metaKey||t.ctrlKey;if(m&&a.current){const d=u.findIndex(h=>h.id===a.current),f=u.findIndex(h=>h.id===n);if(d!==-1&&f!==-1){const h=Math.min(d,f),p=Math.max(d,f),w=u.slice(h,p+1).map(N=>N.id);i(N=>{const A=new Set(N);return w.forEach(L=>A.add(L)),A})}}else c?(i(d=>{const f=new Set(d);return f.has(n)?f.delete(n):f.add(n),f}),a.current=n):(i(new Set([n])),a.current=n)}function qs({model:t,isSpeaking:n,thinkingFallback:r,getTailSnippet:i}){return t.statusMessage?$e(t.statusMessage)??t.statusMessage:n?t.response.trim().length>0?$e(t.response)??e.jsx(Pt,{text:t.response,speed:20}):t.thinking&&t.thinking.trim().length>0?e.jsxs("span",{children:[e.jsx("span",{className:"text-slate-500 italic",children:"Thinking… "}),i(t.thinking.trim(),220)]}):r:$e(t.response)??t.response}function Vs({model:t,isSpeaking:n,getTailSnippet:r,maxChars:i=220}){return t.statusMessage?$e(t.statusMessage)??t.statusMessage:n?t.thinking&&t.thinking.trim().length>0?e.jsxs("span",{children:[e.jsx("span",{className:"text-purple-400/80 text-[10px] uppercase tracking-wider font-medium",children:"Thinking "}),e.jsx("span",{className:"text-slate-400",children:r(t.thinking.trim(),260)})]}):t.response.trim().length>0?$e(t.response)??e.jsx(Pt,{text:t.response,speed:20}):e.jsx("span",{className:"text-slate-500 italic",children:"Generating…"}):t.thinking&&t.thinking.trim().length>0?e.jsxs("span",{children:[e.jsx("span",{className:"text-purple-400/80 text-[10px] uppercase tracking-wider font-medium",children:"Reasoning "}),e.jsx("span",{className:"text-slate-400",children:r(t.thinking.trim(),260)})]}):t.response?$e(t.response)??r(t.response,i):e.jsx("span",{className:"text-slate-500 italic",children:"No response yet."})}const Qs={padding:"16px",height:"100%",display:"flex",flexDirection:"column",isolation:"isolate",WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",textRendering:"optimizeLegibility",opacity:1,transition:"opacity 0.3s ease-out"};function Js(t){switch(t){case"error":return"Error";case"responding":return"Responding";case"done":return"Done";case"waiting":return"Waiting";default:return"Ready"}}function Zs(t,n,r,i){return r?"error":t?"responding":n?"done":i?"waiting":"idle"}function $e(t){return t.startsWith("<svg")?e.jsx("span",{dangerouslySetInnerHTML:{__html:t}}):null}function er({hasError:t,isProcessing:n,isSelected:r,errorColor:i,processingColor:u,typeColor:a}){const m="rgba(30, 41, 59, 0.85)";return t?{background:`linear-gradient(135deg, ${i}14, ${m})`,border:`1px solid ${i}99`,shadow:`0 0 24px ${i}33, inset 0 1px 1px rgba(255,255,255,0.1)`}:n?{background:`linear-gradient(135deg, ${u}14, ${m})`,border:`1px solid ${u}99`,shadow:`0 0 24px ${u}33, inset 0 1px 1px rgba(255,255,255,0.1)`}:r?{background:m,border:`1px solid ${a}d0`,shadow:`0 0 20px ${a}30, inset 0 1px 1px rgba(255,255,255,0.1)`}:{background:m,border:"1px solid rgba(71, 85, 105, 0.5)",shadow:"0 4px 20px rgba(0,0,0,0.3), inset 0 1px 1px rgba(255,255,255,0.05)"}}function tr({rect:t}){return t?e.jsx("div",{className:"absolute pointer-events-none z-30",style:{left:t.left,top:t.top,width:t.width,height:t.height,border:"2px solid rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)"}}):null}const $t=s.createContext(null);function nr({children:t}){const[n,r]=s.useState(!1),[i,u]=s.useState("chat"),a=s.useRef({}),m=s.useCallback(N=>{a.current=N},[]),[c,d]=s.useState({gesture:null,progress:0,triggered:!1}),[f,h]=s.useState(void 0),[p,w]=s.useState(null);return e.jsx($t.Provider,{value:{isActive:n,setIsActive:r,appContext:i,setAppContext:u,callbacks:a,setCallbacks:m,gestureState:c,setGestureState:d,performanceMetrics:f,setPerformanceMetrics:h,cameraError:p,setCameraError:w},children:t})}function sr(){const t=s.useContext($t);if(!t)throw new Error("useGesture must be used within GestureProvider");return t}function Er(){return s.useContext($t)}const rr="https://oauth.neevs.io",cn="Ov23lianHkw0Uog0VGxT",or="read:user";async function ar(){return new Promise((t,n)=>{const r=`${window.location.origin}/static/playground/oauth-callback.html`,i=btoa(JSON.stringify({provider:"github",client_id:cn,redirect_url:r})),u=new URL("https://github.com/login/oauth/authorize");u.searchParams.set("client_id",cn),u.searchParams.set("scope",or),u.searchParams.set("redirect_uri",`${rr}/callback`),u.searchParams.set("state",i);const a=500,m=600,c=window.screenX+(window.innerWidth-a)/2,d=window.screenY+(window.innerHeight-m)/2,f=window.open(u.toString(),"github-oauth",`width=${a},height=${m},left=${c},top=${d},popup=yes`);if(!f){n(new Error("Popup blocked. Please allow popups for this site."));return}const h=async w=>{if(w.origin!==window.location.origin)return;const{type:N,token:A,error:L}=w.data||{};if(N==="oauth-callback"){if(window.removeEventListener("message",h),clearInterval(p),L){n(new Error(L));return}if(!A){n(new Error("No token received"));return}try{const v=await ir(A);t({token:A,username:v})}catch(v){n(v)}}};window.addEventListener("message",h);const p=setInterval(()=>{f.closed&&(clearInterval(p),window.removeEventListener("message",h),n(new Error("OAuth flow cancelled")))},500)})}async function ir(t){const n=await fetch("https://api.github.com/user",{headers:{Authorization:`Bearer ${t}`,Accept:"application/vnd.github+json"}});if(!n.ok)throw new Error("Failed to fetch GitHub user info");return(await n.json()).login}class lr extends s.Component{constructor(r){super(r);tn(this,"handleRetry",()=>{var r,i;this.setState({hasError:!1,error:null}),(i=(r=this.props).onRetry)==null||i.call(r)});this.state={hasError:!1,error:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,i){console.error("ErrorBoundary caught an error:",r,i)}render(){var r;return this.state.hasError?this.props.fallback?this.props.fallback:e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-white/70 gap-4 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-amber-400",children:[e.jsx(ss,{size:20}),e.jsx("span",{className:"text-sm font-medium",children:"Something went wrong"})]}),e.jsx("p",{className:"text-xs text-white/40 text-center max-w-xs",children:((r=this.state.error)==null?void 0:r.message)||"Failed to load component"}),e.jsxs("button",{onClick:this.handleRetry,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white/80 bg-slate-700/50 hover:bg-slate-600/50 rounded-lg transition-all active:scale-95 border border-slate-600/50",children:[e.jsx(rs,{size:14}),"Try Again"]})]}):this.props.children}}const cr=s.lazy(()=>Be(()=>import("./SettingsModal-DFXyJYU8.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),dr=s.lazy(()=>Be(()=>import("./ResponseModal-reNlrW8D.js"),__vite__mapDeps([7,1,2,3,4,5,6,8]))),ur=s.lazy(()=>Be(()=>import("./DiscussionTranscript-Bh5W5eM3.js"),__vite__mapDeps([9,1,2,3,4,5,6,8]))),fr=s.lazy(()=>Be(()=>import("./GestureControl-yVOFAzFj.js"),__vite__mapDeps([10,1,2,3,4,5,6]))),pr=s.lazy(()=>Be(()=>import("./HandBackground-F7iiHyIM.js"),__vite__mapDeps([11,1,2,3,4,5,6,12]))),hr=s.lazy(()=>Be(()=>import("./ChatView-BIXgzJmL.js"),__vite__mapDeps([13,1,2,3,4,5,6,8])).then(t=>({default:t.default}))),mr='button, input, textarea, select, a, [role="button"], [data-no-background], [data-card]';function xr(){const t=sr();_s();const{modelsData:n,setModelsData:r,selected:i,setSelected:u,chatModelId:a,setChatModelId:m,moderator:c,setModerator:d,availableModels:f,totalModelsByType:h,allSelectedByType:p,modelIdToName:w,isLoading:N,loadError:A,retryCount:L,retryNow:v}=Ts(),[l,k]=Pe("playground_mode","chat",{serialize:o=>o,deserialize:(o,x)=>["chat","compare","analyze","debate"].includes(o)?o:x}),[D,Y]=s.useState(!1),O=s.useRef(null),[j,Q]=s.useState(null),[ee,M]=s.useState(!1),[_,W]=s.useState(!1),[K,oe]=s.useState(2),[$,F]=s.useState(!1),[g,ae]=Pe("github_auth",null),Ae=s.useCallback(async()=>{try{const o=await ar();ae(o)}catch(o){console.error("GitHub OAuth failed:",o)}},[ae]),[me,pe]=s.useState(!1),[X,le]=s.useState({}),de=s.useRef(null),ve=s.useRef(null),[te,De]=s.useState(""),[I,we]=s.useState(null),Z=s.useRef(null),ge=s.useCallback(o=>{Z.current&&clearTimeout(Z.current),we(o),Z.current=window.setTimeout(()=>{we(null),Z.current=null},5e3)},[]),se=s.useCallback(o=>{if(l==="chat"||g!=null&&g.token)return!0;const x=n.find(y=>y.id===o);return!x||x.type!=="github"},[l,g,n]),ue=s.useCallback(()=>!!(l==="chat"||g!=null&&g.token),[l,g]),[xe,be]=s.useState([]),[_e,fe]=Pe("playground_chat_selected_models",["gemma-3-12b-it","gpt-oss-20b","lfm2.5-1.2b-instruct"]),Me=s.useMemo(()=>new Set(_e),[_e]),[z,B]=s.useState(!1),T=s.useRef(!1),b=s.useCallback(o=>{fe(x=>{const y=new Set(x);return y.has(o)?y.delete(o):y.add(o),Array.from(y)})},[fe]),E=s.useCallback(o=>{const x=n.filter(y=>y.type===o).map(y=>y.id);fe(y=>{const S=new Set(y);return x.every(P=>S.has(P))?x.forEach(P=>S.delete(P)):x.forEach(P=>S.add(P)),Array.from(S)})},[n,fe]),{history:C,historyRef:q,pushHistoryEntries:H,clearHistory:G,historyToText:J,buildCarryoverHistory:je}=Is(),Te=(o,x)=>{const y=new Set,S=x.filter(Boolean).filter((P,V,U)=>U.indexOf(P)===V),R=[];return S.forEach(P=>{const V=o[P];V&&V.trim()&&(R.push({id:P,text:V.trim()}),y.add(P))}),Object.entries(o).forEach(([P,V])=>{y.has(P)||!V||!V.trim()||R.push({id:P,text:V.trim()})}),R.length?R.map(({id:P,text:V})=>`${w(P)}:
${V}`).join(`

`):null};s.useEffect(()=>{t.isActive&&!T.current&&(pe(!0),fe(["openai/gpt-4o"])),T.current=t.isActive},[t.isActive,fe]);const Ee=i.map(o=>n.find(x=>x.id===o)).filter(o=>!!o&&(l==="compare"||o.id!==c)),re=s.useMemo(()=>l!=="compare"?Ee:[...Ee].sort((o,x)=>{var R,P;const y=(R=X[o.id])==null?void 0:R.firstTokenTime,S=(P=X[x.id])==null?void 0:P.firstTokenTime;return y===void 0&&S===void 0?0:y===void 0?1:S===void 0?-1:y-S}),[l,Ee,X]),{fastestTTFT:et,fastestTotal:tt}=s.useMemo(()=>{if(l!=="compare")return{fastestTTFT:null,fastestTotal:null};let o=null,x=1/0,y=null,S=1/0,R=0,P=0;for(const V of Ee){const U=X[V.id];if(U){if(U.firstTokenTime!==void 0){R++;const ie=U.firstTokenTime-U.startTime;ie<x&&(x=ie,o=V.id)}if(U.endTime!==void 0){P++;const ie=U.endTime-U.startTime;ie<S&&(S=ie,y=V.id)}}}return{fastestTTFT:R>=2?o:null,fastestTotal:P>=2?y:null}},[l,Ee,X]),Oe=(o,x,y,S)=>{if(y==="analyze"){const ut=250+o*220/(x-1)-90,ft=ut*Math.PI/180;return{x:Math.cos(ft)*S,y:Math.sin(ft)*S,angle:ut}}const R=o*360/x-90,P=Math.cos(R*Math.PI/180)*S,V=Math.sin(R*Math.PI/180)*S;return{x:P,y:V,angle:R}},ce=(o,x)=>{Q(x),o.dataTransfer.effectAllowed="move"},fn=o=>{o.preventDefault(),M(!0)},pn=()=>{M(!1)},hn=o=>{if(o.preventDefault(),M(!1),j){if(l==="chat")m(j);else if(!i.includes(j)){if(!se(j)){ge("Add your GitHub token in Settings for API model access with dedicated quota"),Q(null);return}u(x=>[...x,j])}Q(null)}},xt=o=>{if(l==="chat"){m(a===o?null:o);return}if(i.includes(o))if(Se&&bt.current.includes(o)&&te){ve.current&&ve.current.abort();const y=bt.current.filter(R=>R!==o),S={};if(n.forEach(R=>{y.includes(R.id)&&R.response&&!R.error&&(S[R.id]=R.response)}),u(R=>R.filter(P=>P!==o)),Ge.has(o)&&Ye(R=>{const P=new Set(R);return P.delete(o),P}),(l==="analyze"||l==="debate")&&y.length<2){Le(!1),Ue(!1),qe("This mode requires at least 2 participants."),Qe("Error");return}Ct(te,S,y,{skipHistory:!0})}else u(y=>y.filter(S=>S!==o));else{if(!se(o)){ge("Add your GitHub token in Settings for API model access with dedicated quota");return}u(x=>[...x,o])}},mn=o=>{const x=n.filter(R=>R.type===o).map(R=>R.id);if(x.length>0&&x.every(R=>i.includes(R))){u(R=>R.filter(P=>!x.includes(P)));return}if(o==="github"&&!ue()){ge("Add your GitHub token in Settings for API model access with dedicated quota");return}const S=f.filter(R=>R.type===o).map(R=>R.id);S.length>0&&u(R=>[...R,...S])},[xn,He]=s.useState(null),[Ce,nt]=s.useState(null),[We,st]=s.useState(new Set),[gn,bn]=s.useState(!1),[Ge,Ye]=s.useState(new Set),rt=()=>Ye(new Set),[ot,yn]=s.useState(null),gt=s.useMemo(()=>{if(l==="compare")return 0;const o=Math.max(ne.baseRadius,ne.minRadius+re.length*ne.radiusPerModel);if(!ot)return o;const y=Math.min(ot.width,ot.height)/2-140;return Math.max(o,y)},[l,re.length,ot]);s.useEffect(()=>{const o=()=>{if(!he.current)return;const{clientWidth:y,clientHeight:S}=he.current;let R=Math.floor(y/(ne.cardWidth+ne.gapX));R=Math.max(1,R),oe(R),yn({width:y,height:S})},x=new ResizeObserver(y=>{for(let S of y)S.target===he.current&&o()});return he.current&&(x.observe(he.current),o()),()=>{he.current&&x.unobserve(he.current)}},[l]);const Fe=s.useRef(null),he=s.useRef(null),Ne=s.useRef(null),Bt=s.useRef(null),at=s.useRef(new Map),vn=s.useRef(null),Xe=s.useRef({card:!1,background:!1}),wn=s.useRef({}),bt=s.useRef([]),{enqueueStreamDelta:kn,clearPendingStreamForModel:jn,resetPendingStream:yt}=zs(r),Dt=s.useRef(!1),{arenaOffsetYRef:Ot,arenaTargetYRef:vt,wheelRafRef:Sn,clampTarget:Tn,ensureRaf:En}=Hs({visualizationAreaRef:he,dragSelectionActiveRef:Dt}),{selectionRect:Mn,isSelecting:wt,dragSelectionActiveRef:Cn}=Bs({rootContainerRef:Bt,visualizationAreaRef:he,arenaOffsetYRef:Ot,arenaTargetYRef:vt,wheelRafRef:Sn,selectedModels:re,cardRefs:at,selectedCardIds:Ge,setSelectedCardIds:Ye,suppressClickRef:Xe});Dt.current=Cn.current;const{dragState:Nn,handlePointerDown:Rn}=Ds({visualizationAreaRef:he,cardRefs:at,selected:i,setSelected:u,mode:l,gridCols:K,getCirclePosition:Oe});s.useEffect(()=>()=>yt(),[yt]);const[ye,Re]=s.useState(null);s.useEffect(()=>{const o="arena-selecting",x=document.body;return wt?x.classList.add(o):x.classList.remove(o),()=>{x.classList.remove(o)}},[wt]);const it=s.useCallback(o=>o?!o.closest(mr):!1,[]),Ln=s.useCallback(o=>{if(it(o.target)){if(Xe.current.background){Xe.current.background=!1;return}He(null),rt(),Xe.current.background=!1}},[it,rt]),An=s.useCallback(o=>{it(o.target)&&(o.preventDefault(),Re({x:o.clientX,y:o.clientY,type:"background"}))},[it]),Ht=s.useCallback(()=>{Y(!0),O.current&&clearTimeout(O.current),O.current=window.setTimeout(()=>{Y(!1),O.current=null},350)},[]),Wt=s.useRef(l),lt=s.useCallback(o=>{if(o===l)return;Ht();const x=["compare","analyze","debate"];x.includes(l)&&x.includes(o)||Le(!1),k(o)},[l,Ht]);s.useEffect(()=>()=>{Z.current&&clearTimeout(Z.current)},[]),s.useEffect(()=>()=>{O.current&&clearTimeout(O.current)},[]),s.useEffect(()=>{const o=()=>Re(null);return window.addEventListener("click",o),()=>window.removeEventListener("click",o)},[]);const[Se,Le]=s.useState(!1),[ct,Ue]=s.useState(!1),[Ke,qe]=s.useState(""),_n=s.useCallback(()=>{G(),Le(!1),Ue(!1),qe(""),Qe(null),Tt({}),r(o=>o.map(x=>({...x,response:"",thinking:void 0,error:void 0}))),le({}),st(new Set)},[G,r]),[In,zn]=s.useState(!0),[Pn,$n]=s.useState("api"),[kt,jt]=s.useState(!1),St=s.useRef(null);s.useEffect(()=>{const o=y=>{St.current&&!St.current.contains(y.target)&&jt(!1)},x=y=>{y.key==="Escape"&&jt(!1)};return kt&&(document.addEventListener("mousedown",o),document.addEventListener("keydown",x)),()=>{document.removeEventListener("mousedown",o),document.removeEventListener("keydown",x)}},[kt]);const[Ve,Qe]=s.useState(null),[,Tt]=s.useState({}),[Bn,Gt]=s.useState(new Set),Et=s.useRef(new Set),Dn=s.useRef(null),Yt=s.useRef({}),Ft=s.useRef(l),[Mt,Xt]=s.useState(null),On=()=>{const o=new Set;Et.current=o,Gt(o)},Hn=o=>{Gt(x=>{if(x.has(o))return x;const y=new Set(x);return y.add(o),Et.current=y,y})},Ut=s.useRef({compare:{responses:{},moderatorSynthesis:"",phaseLabel:null,executionTimes:{},isGenerating:!1,speaking:new Set},analyze:{responses:{},moderatorSynthesis:"",phaseLabel:null,executionTimes:{},isGenerating:!1,speaking:new Set},debate:{responses:{},moderatorSynthesis:"",phaseLabel:null,executionTimes:{},isGenerating:!1,speaking:new Set}}),Kt=s.useRef(n),qt=s.useRef(Ke),Vt=s.useRef(Ve),Qt=s.useRef(X),Jt=s.useRef(Se),Zt=s.useRef(We);s.useEffect(()=>{Kt.current=n},[n]),s.useEffect(()=>{qt.current=Ke},[Ke]),s.useEffect(()=>{Vt.current=Ve},[Ve]),s.useEffect(()=>{Qt.current=X},[X]),s.useEffect(()=>{Jt.current=Se},[Se]),s.useEffect(()=>{Zt.current=We},[We]),s.useEffect(()=>{const o=["compare","analyze","debate"],x=Wt.current;if(o.includes(x)&&o.includes(l)&&x!==l){const y={};Kt.current.forEach(P=>{y[P.id]={response:P.response,thinking:P.thinking,error:P.error}}),Ut.current[x]={responses:y,moderatorSynthesis:qt.current,phaseLabel:Vt.current,executionTimes:Qt.current,isGenerating:Jt.current,speaking:new Set(Zt.current)};const S=Ut.current[l];Object.values(S.responses).some(P=>P.response&&P.response!=="")||S.isGenerating?(r(P=>P.map(V=>{var U,ie,Je;return{...V,response:((U=S.responses[V.id])==null?void 0:U.response)||"",thinking:(ie=S.responses[V.id])==null?void 0:ie.thinking,error:(Je=S.responses[V.id])==null?void 0:Je.error}})),qe(S.moderatorSynthesis),Qe(S.phaseLabel),le(S.executionTimes),Le(S.isGenerating),st(new Set(S.speaking))):(G(),r(P=>P.map(V=>({...V,response:"",thinking:void 0,error:void 0}))),qe(""),Qe(null),le({}),Le(!1),st(new Set)),Ue(!1),Tt({})}Wt.current=l},[l,G,r]);const{sendMessage:Ct}=$s({mode:l,moderator:c,selected:i,selectedCardIds:Ge,githubToken:g==null?void 0:g.token,isGenerating:Se,systemPrompt:me?ms:void 0,summarizeSessionResponses:Te,setLastQuery:De,setHoveredCard:He,setPhaseLabel:Qe,setModeratorSynthesis:qe,setDiscussionTurnsByModel:Tt,resetFailedModels:On,markModelFailed:Hn,failedModelsRef:Et,currentDiscussionTurnRef:Dn,sessionModelIdsRef:bt,abortControllerRef:ve,thinkingStateRef:wn,conversationHistoryRef:q,pushHistoryEntries:H,historyToText:J,buildCarryoverHistory:je,setModelsData:r,modelIdToName:w,setExecutionTimes:le,setIsGenerating:Le,setIsSynthesizing:Ue,setSpeaking:st,enqueueStreamDelta:kn,clearPendingStreamForModel:jn,resetPendingStream:yt});Os({mode:l,showSettings:$,showDock:_,contextMenu:ye,selectedCardIds:Ge,selected:i,inputRef:Fe,setShowSettings:F,setShowDock:W,setContextMenu:Re,setSelected:u,setSelectedCardIds:Ye,clearSelection:rt,setHoveredCard:He,handleModeChange:lt});const[dt,Wn]=Pe("playground-bg-style","dots",{serialize:o=>o,deserialize:(o,x)=>o&&hs.includes(o)?o:x}),Gn=n.find(o=>o.id===c),Yn=ct?"responding":Se?"waiting":Ke?"done":"idle",Fn=`${Mt?`translate(-50%, -50%) translate(${Mt.x}px, ${Mt.y}px)`:"translate(-50%, -50%)"} scale(1)`;s.useLayoutEffect(()=>{if(l!=="compare")return;const o={};re.forEach(x=>{const y=at.current.get(x.id);y&&(o[x.id]=y.getBoundingClientRect())}),Yt.current=o},[l,re.length,re.map(o=>o.id).join(",")]),s.useEffect(()=>{if(Ft.current==="compare"&&l!=="compare"&&c&&he.current){const x=Yt.current[c],y=he.current.getBoundingClientRect();if(x&&y.width>0&&y.height>0){const S=y.left+y.width/2,R=l==="analyze"?gt-64:0,P=y.top+(y.height*.5+R),V=x.left+x.width/2-S,U=x.top+x.height/2-P;(Math.abs(V)>1||Math.abs(U)>1)&&(Xt({x:V,y:U}),requestAnimationFrame(()=>Xt(null)))}}Ft.current=l},[l,c,gt]);const Xn=dt==="none"?"":`bg-${dt}`,Un=(o,x=280)=>o?o.length<=x?o:`…${o.slice(o.length-x)}`:"",en=()=>{ve.current&&(ve.current.abort(),Le(!1),Ue(!1))};return e.jsxs("div",{ref:Bt,className:`fixed inset-0 overflow-hidden text-white ${Xn}`,style:{backgroundColor:sn[l],transition:"background-color 1s ease",...dt==="none"?{background:sn[l]}:{},...wt?{userSelect:"none",WebkitUserSelect:"none"}:{}},onClick:Ln,onContextMenu:An,children:[t.isActive&&e.jsx(s.Suspense,{fallback:null,children:e.jsx(pr,{onSendMessage:t.callbacks.current.onSendMessage,onScroll:t.callbacks.current.onScroll,onPinch:t.callbacks.current.onPinch,onHover:t.callbacks.current.onHover,gestureActiveArea:{minX:.7,maxX:1,minY:0,maxY:1},onGestureState:t.setGestureState,onError:t.setCameraError,onPerformance:t.setPerformanceMetrics})}),N&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-slate-900/95 backdrop-blur-sm",children:e.jsxs("div",{className:"flex flex-col items-center gap-5 text-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-12 h-12 border-2 border-slate-700 border-t-blue-500 rounded-full animate-spin"}),e.jsx("div",{className:"absolute inset-0 w-12 h-12 border-2 border-transparent border-b-emerald-500/50 rounded-full animate-spin",style:{animationDirection:"reverse",animationDuration:"1.5s"}})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"text-white/80 text-sm font-medium",children:A||"Connecting to models..."}),L>0&&e.jsxs("p",{className:"text-white/40 text-xs tabular-nums",children:["Attempt ",L," of 8"]})]}),e.jsxs("button",{onClick:v,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white/70 hover:text-white bg-white/5 hover:bg-white/10 border border-white/10 hover:border-white/20 rounded-lg transition-all active:scale-95",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh Now"]})]})}),e.jsx(ys,{mode:l,setMode:lt,setHoveredCard:He,clearSelection:rt,showDock:_,setShowDock:W,onOpenSettings:()=>F(!0),gestureButtonSlot:e.jsx(s.Suspense,{fallback:null,children:e.jsx(fr,{inHeader:!0,appContext:l,onStopGeneration:()=>{if(l==="chat"&&Ne.current){Ne.current.stopGeneration();return}en()},onSendMessage:o=>{if(l==="chat"&&Ne.current){Ne.current.sendMessage(o,!0);return}const x=l==="compare"||l==="analyze"||l==="debate"?i:[];x.length>0&&Ct(o,{},x)},onScroll:o=>{if(l==="chat"&&Ne.current){Ne.current.scroll(o);return}vt.current=Tn(vt.current+o),En()},onHover:(o,x)=>{const y=o*window.innerWidth,S=x*window.innerHeight,R=document.elementFromPoint(y,S);if(R){const P=R.closest("[data-gesture-mode-track]");if(P){const ie=P.getBoundingClientRect(),Je=y-ie.left,ut=ie.width,ft=Math.floor(Je/ut*5),Nt=["chat","compare","analyze","debate"][Math.max(0,Math.min(4,ft))];Nt&&Nt!==l&&lt(Nt);return}const V=document.querySelector('[data-gesture-hovered="true"]'),U=R.closest('button, a, [role="button"], [data-clickable], .cursor-pointer, [onclick]')||R;U!==V?(V&&(V.removeAttribute("data-gesture-hovered"),V.dispatchEvent(new PointerEvent("pointerleave",{bubbles:!1,cancelable:!0})),V.dispatchEvent(new MouseEvent("mouseleave",{bubbles:!1,cancelable:!0})),V.dispatchEvent(new MouseEvent("mouseout",{bubbles:!0,cancelable:!0}))),U.setAttribute("data-gesture-hovered","true"),U.dispatchEvent(new PointerEvent("pointerenter",{bubbles:!1,cancelable:!0,clientX:y,clientY:S})),U.dispatchEvent(new PointerEvent("pointermove",{bubbles:!0,cancelable:!0,clientX:y,clientY:S})),U.dispatchEvent(new MouseEvent("mouseenter",{bubbles:!1,cancelable:!0,clientX:y,clientY:S})),U.dispatchEvent(new MouseEvent("mouseover",{bubbles:!0,cancelable:!0,clientX:y,clientY:S}))):U===V&&(U.dispatchEvent(new PointerEvent("pointermove",{bubbles:!0,cancelable:!0,clientX:y,clientY:S})),U.dispatchEvent(new MouseEvent("mousemove",{bubbles:!0,cancelable:!0,clientX:y,clientY:S})))}},onPinch:(o,x)=>{const y=o*window.innerWidth,S=x*window.innerHeight,R=document.elementFromPoint(y,S);if(R){const P=ie=>{ie.dispatchEvent(new PointerEvent("pointerdown",{bubbles:!0,cancelable:!0,clientX:y,clientY:S,pointerId:1,pointerType:"touch",isPrimary:!0})),ie.dispatchEvent(new PointerEvent("pointerup",{bubbles:!0,cancelable:!0,clientX:y,clientY:S,pointerId:1,pointerType:"touch",isPrimary:!0})),ie.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0,clientX:y,clientY:S})),ie.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0,clientX:y,clientY:S})),ie.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,clientX:y,clientY:S}))},V=R.closest('button, a, [role="button"], [data-clickable], .cursor-pointer, [onclick]');P(V||R);const U=document.createElement("div");U.style.position="fixed",U.style.left=`${y}px`,U.style.top=`${S}px`,U.style.width="20px",U.style.height="20px",U.style.background="rgba(236, 72, 153, 0.5)",U.style.borderRadius="50%",U.style.transform="translate(-50%, -50%)",U.style.pointerEvents="none",U.style.zIndex="9999",document.body.appendChild(U),U.animate([{transform:"translate(-50%, -50%) scale(1)",opacity:1},{transform:"translate(-50%, -50%) scale(4)",opacity:0}],{duration:400}).onfinish=()=>U.remove()}},onModeChange:o=>{const x=["chat","compare","analyze","debate"],y=x.indexOf(l);let S;o==="next"?S=(y+1)%x.length:S=(y-1+x.length)%x.length,lt(x[S])}})})}),e.jsxs("div",{style:{paddingLeft:"1.5rem",paddingRight:"0"},children:[_&&e.jsx("div",{className:"fixed inset-0 z-[55] bg-black/10 backdrop-blur-[1px] transition-opacity duration-300",onClick:()=>W(!1)}),e.jsx(xs,{showDock:_,availableModels:f,allSelectedByType:p,totalModelsByType:h,handleDragStart:ce,handleModelToggle:xt,handleAddGroup:mn,dockRef:de,mode:l,allModels:n,setShowDock:W,chatSelectedModels:Me,onToggleChatModel:b,onToggleChatGroup:E}),l==="chat"&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex h-screen w-full relative z-[10]",children:e.jsx("div",{className:"flex-1 relative px-2 sm:px-6 pt-20 pb-6",children:e.jsx(lr,{children:e.jsx(s.Suspense,{fallback:e.jsxs("div",{className:"flex items-center justify-center h-full text-white/50 gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/20 border-t-white/60 rounded-full animate-spin"}),"Loading..."]}),children:e.jsx(hr,{ref:Ne,models:n,selectedModels:Me,onToggleModel:b,githubToken:g==null?void 0:g.token,githubUsername:g==null?void 0:g.username,onConnectGitHub:Ae,messages:xe,setMessages:be,isGenerating:z,setIsGenerating:B,gesturesActive:t.isActive,uiBuilderEnabled:me,setUiBuilderEnabled:pe})})})})})}),l!=="chat"&&e.jsxs("div",{className:"flex h-screen w-full relative",children:[e.jsx("div",{className:"relative flex-1 transition-all duration-300 flex flex-col pt-24",children:e.jsx("div",{ref:he,onDragOver:fn,onDragLeave:pn,onDrop:hn,className:"relative w-full h-full z-10 transition-all duration-300",style:{position:"relative",display:"flex",alignItems:l==="compare"?"flex-start":"center",justifyContent:"center","--arena-offset-y":`${Ot.current}px`,transform:l==="analyze"||l==="debate"?`translateY(calc(var(--arena-offset-y) - 50px)) scale(${ee?1.02:1})`:`translateY(var(--arena-offset-y)) scale(${ee?1.02:1})`,willChange:"transform",border:ee?"2px dashed rgba(59, 130, 246, 0.4)":"2px dashed transparent",borderRadius:ee?"24px":"0px",transition:"transform 0s linear",...l==="compare"?{minHeight:"300px",paddingBottom:"120px"}:l==="analyze"||l==="debate"?{height:"100%",minHeight:"100%",overflow:"hidden"}:{height:"100%",minHeight:"100%",overflow:"hidden"},...ee?{background:"rgba(59, 130, 246, 0.05)"}:{}},children:e.jsx(Fs,{mode:l,selectedModels:re,gridCols:K,speaking:We,selectedCardIds:Ge,setSelectedCardIds:Ye,executionTimes:X,failedModels:Bn,cardRefs:at,handlePointerDown:Rn,dragState:Nn,handleModelToggle:xt,setContextMenu:Re,suppressClickRef:Xe,getTailSnippet:Un,hoveredCard:xn,setHoveredCard:He,setExpandedModelId:nt,layoutRadius:gt,getCirclePosition:Oe,moderatorModel:Gn,moderatorId:c,orchestratorTransform:Fn,orchestratorStatus:Yn,moderatorSynthesis:Ke,isSynthesizing:ct,isGenerating:Se,phaseLabel:Ve,linesTransitioning:D,lastSelectedCardRef:vn,orchestratorAutoMode:In,orchestratorAutoScope:Pn,showOrchestratorMenu:kt,setShowOrchestratorMenu:jt,setOrchestratorAutoMode:zn,setOrchestratorAutoScope:$n,orchestratorMenuRef:St,availableModels:f,setModerator:d,fastestTTFT:et,fastestTotal:tt})})}),l!=="compare"&&e.jsx("div",{className:"transcript-panel w-[400px] xl:w-[480px] flex flex-col border-l border-white/5 bg-slate-900/20 backdrop-blur-sm z-40 relative h-full",children:e.jsx(s.Suspense,{fallback:null,children:e.jsx(ur,{history:C,models:n,mode:l,onSelectPrompt:o=>{Fe.current&&(Fe.current.value=o,Fe.current.focus())},onNewSession:_n,className:"pt-24 pb-6 mask-fade-top",phaseLabel:Ve,isGenerating:Se,isSynthesizing:ct,speakingCount:We.size,totalParticipants:re.length})})})]})]}),e.jsx(tr,{rect:Mn}),I&&e.jsx("div",{className:"fixed bottom-20 left-1/2 -translate-x-1/2 z-[200] animate-in slide-in-from-bottom-4 fade-in duration-300",children:e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 rounded-xl bg-amber-500/10 border border-amber-500/30 backdrop-blur-md shadow-xl",children:[e.jsx("svg",{className:"w-5 h-5 text-amber-400 shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsx("span",{className:"text-sm text-amber-100",children:I}),e.jsx("button",{onClick:()=>{we(null),F(!0)},className:"ml-2 px-3 py-1 text-xs font-medium text-amber-900 bg-amber-400 hover:bg-amber-300 rounded-md transition-colors",children:"Open Settings"}),e.jsx("button",{onClick:()=>we(null),className:"ml-1 p-1 text-amber-400/60 hover:text-amber-400 transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsx(s.Suspense,{fallback:null,children:e.jsx(cr,{open:$,onClose:()=>F(!1),githubAuth:g,setGithubAuth:ae,bgStyle:dt,setBgStyle:Wn})}),Ce&&l==="compare"&&e.jsx(s.Suspense,{fallback:null,children:e.jsx(dr,{model:re.find(o=>o.id===Ce)||null,executionTimes:X[Ce],onClose:()=>nt(null),onPrev:()=>{const o=re.findIndex(x=>x.id===Ce);o>0&&nt(re[o-1].id)},onNext:()=>{const o=re.findIndex(x=>x.id===Ce);o<re.length-1&&nt(re[o+1].id)},hasPrev:re.findIndex(o=>o.id===Ce)>0,hasNext:re.findIndex(o=>o.id===Ce)<re.length-1})}),(l==="compare"||l==="analyze"||l==="debate")&&e.jsx(gs,{inputRef:Fe,inputFocused:gn,setInputFocused:bn,onSendMessage:Ct,isGenerating:Se||ct,onStop:en,placeholder:l==="compare"?void 0:"Steer the discussion...",className:`fixed bottom-0 left-0 z-[100] pb-6 px-3 sm:px-4 flex justify-center items-end pointer-events-none transition-all duration-300 ${l==="compare"?"right-0":"right-[400px] xl:right-[480px]"}`,style:{paddingBottom:"calc(1.5rem + env(safe-area-inset-bottom))"}}),ye&&e.jsx("div",{className:"fixed bg-slate-800 border border-slate-700 rounded-lg shadow-xl py-1 z-[200] min-w-[160px]",style:{top:ye.y,left:ye.x},onClick:o=>o.stopPropagation(),children:ye.type==="background"?e.jsxs("button",{className:"w-full text-left px-4 py-2 text-sm text-slate-200 hover:bg-slate-700 transition-colors flex items-center gap-2",onClick:()=>{W(!0),Re(null)},children:[e.jsx("svg",{className:"w-4 h-4 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Model"]}):ye.modelId?e.jsxs(e.Fragment,{children:[l!=="compare"&&ye.modelId!==c&&e.jsxs("button",{className:"w-full text-left px-4 py-2 text-sm text-slate-200 hover:bg-slate-700 transition-colors flex items-center gap-2",onClick:()=>{d(ye.modelId),Re(null)},children:[e.jsx("svg",{className:"w-4 h-4 text-orange-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})}),"Set as Orchestrator"]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 text-sm text-red-400 hover:bg-slate-700 transition-colors flex items-center gap-2",onClick:()=>{const o=ye.modelId===c;if(xt(ye.modelId),o&&l!=="compare"){const x=i.filter(y=>y!==ye.modelId);x.length>0?d(x[0]):d("")}Re(null)},children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Remove"]})]}):null})]})}function gr(){return e.jsx(nr,{children:e.jsx(xr,{})})}os.createRoot(document.getElementById("root")).render(e.jsx(as.StrictMode,{children:e.jsx(gr,{})}));export{hs as B,an as E,Tr as M,gs as P,ms as U,Er as a,ar as c,Ms as f,Lt as s,sr as u};
