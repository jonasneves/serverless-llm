import{r,j as e,s as we,t as pe,T as se,S as ce,u as ee,U as je,C as fe,v as Ne,w as ye}from"./react-vendor-D3aXD8-_.js";import{F as de}from"./FormattedContent-B-qSs0qx.js";import{a as Se,b as ke,f as Ce,s as Ee,E as ue,P as $e}from"./index-B0lrUQyg.js";import"./markdown-DXw-y-uZ.js";import"./math-render-B8LXoudh.js";import"./syntax-highlight-BO5EbbCt.js";function Ae(l){const[o,i]=r.useState([]);return r.useEffect(()=>{const v=l.match(/```json\s*([\s\S]*?)\s*```/);if(v)try{let x=v[1];x=x.replace(/[\\']/g,'"').replace(/,\s*}/g,"}").replace(/,\s*]/g,"]").replace(/}\s*[\\]+\s*$/g,"}").replace(/"\s*"\s*$/g,"").trim();const h=JSON.parse(x);if(h.options&&Array.isArray(h.options)){const c=h.options.filter(u=>u.id&&u.label&&u.value);c.length>0?i(c):i([])}}catch(x){console.error("Failed to parse gesture options:",x),i([])}else i([])},[l]),o}function Te(l){return l.replace(/```json[\s\S]*?```/g,"").trim()}const ze=1800;function Me({content:l,onSelect:o,isInline:i=!1}){const v=Ae(l),[x,h]=r.useState(null),[c,u]=r.useState({}),b=r.useRef(0),a=r.useRef(0);r.useEffect(()=>{const m=$=>{var T;const N=(T=$.detail)==null?void 0:T.target;if(N&&N.hasAttribute("data-gesture-option")){const y=N.getAttribute("data-gesture-option");y&&y!==x&&(h(y),g(y))}else x&&(h(null),j())};return window.addEventListener("gesture-hover",m),()=>{window.removeEventListener("gesture-hover",m),j()}},[x]);const g=m=>{j(),b.current=Date.now();const $=()=>{const N=Date.now()-b.current,T=Math.min(N/ze*100,100);if(u(y=>({...y,[m]:T})),T>=100){const y=v.find(O=>O.id===m);y&&(o(y.value),j())}else a.current=requestAnimationFrame($)};a.current=requestAnimationFrame($)},j=()=>{a.current&&cancelAnimationFrame(a.current),u({})},w=m=>{h(m),g(m)},C=()=>{h(null),j()};if(v.length===0)return null;const E=i?"w-full mt-3":"w-full",n=i?"grid grid-cols-2 gap-2":"flex flex-col gap-2.5",M=m=>i?`relative overflow-hidden rounded-lg font-medium text-xs border transition-all duration-200 text-center min-h-[40px] flex items-center justify-center px-3 py-2 ${m?"bg-blue-500/20 border-blue-500/50 text-white shadow-lg shadow-blue-500/10":"bg-slate-800/60 border-slate-700/60 text-slate-200 hover:bg-slate-800/80 hover:border-slate-700/80"}`:`relative overflow-hidden rounded-xl font-medium text-sm border transition-all duration-200 w-full text-left min-h-[52px] flex items-center px-4 py-3 ${m?"bg-blue-500/20 border-blue-500/50 text-white shadow-lg shadow-blue-500/10 scale-[1.02]":"bg-slate-800/60 border-slate-700/60 text-slate-200 hover:bg-slate-800/80 hover:border-slate-700/80"}`;return e.jsxs("div",{className:E,children:[!i&&e.jsxs("div",{className:"flex items-center gap-2 mb-3 px-1",children:[e.jsx("div",{className:"text-xs font-semibold uppercase tracking-wider text-slate-400",children:"Quick Actions"}),e.jsx("div",{className:"flex-1 h-px bg-gradient-to-r from-slate-700/50 to-transparent"})]}),e.jsx("div",{className:n,children:v.map(m=>{const $=c[m.id]||0,N=x===m.id;return e.jsxs("button",{onClick:()=>o(m.value),onMouseEnter:()=>w(m.id),onMouseLeave:C,"data-gesture-option":m.id,className:M(N),children:[N&&$>0&&e.jsx("div",{className:"absolute bottom-0 left-0 h-1 bg-gradient-to-r from-blue-400 to-blue-500 transition-all duration-75",style:{width:`${$}%`}}),e.jsx("span",{className:"relative z-10",children:m.label})]},m.id)})})]})}function xe({models:l,selectedModels:o,onToggleModel:i,isGenerating:v,githubToken:x,openrouterKey:h,dropDirection:c="up"}){const[u,b]=r.useState(null),[a,g]=r.useState(""),j=r.useRef(null),w=r.useRef(null),C=r.useMemo(()=>l.filter(s=>s.type==="self-hosted"),[l]),E=r.useMemo(()=>l.filter(s=>s.type==="github"),[l]),n=r.useMemo(()=>l.filter(s=>s.type==="external"),[l]),M=r.useMemo(()=>C.filter(s=>!a||s.name.toLowerCase().includes(a.toLowerCase())),[C,a]),m=r.useMemo(()=>E.filter(s=>!a||s.name.toLowerCase().includes(a.toLowerCase())),[E,a]),$=r.useMemo(()=>n.filter(s=>!a||s.name.toLowerCase().includes(a.toLowerCase())),[n,a]),N=C.filter(s=>o.has(s.id)).length,T=E.filter(s=>o.has(s.id)).length,y=n.filter(s=>o.has(s.id)).length;r.useEffect(()=>{const s=R=>{j.current&&!j.current.contains(R.target)&&(b(null),g(""))};return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[]),r.useEffect(()=>{const s=R=>{R.key==="Escape"&&(b(null),g(""))};return document.addEventListener("keydown",s),()=>document.removeEventListener("keydown",s)},[]);const O=s=>{u===s?(b(null),g("")):(b(s),g(""),setTimeout(()=>{var R;return(R=w.current)==null?void 0:R.focus()},50))},B=s=>{const R=s.every(H=>o.has(H.id));s.forEach(H=>{(R||!o.has(H.id))&&i(H.id)})},F=s=>s==="self-hosted"?"Self-Hosted":s==="github"?"GitHub":"External",z=T>0&&!x,P=y>0&&!h,L=c==="up"?we:pe,U=s=>s?"rotate-180":"",q=(z||P)&&e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[z&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-md bg-yellow-500/10 border border-yellow-500/20 text-yellow-200 text-xs",children:[e.jsx(se,{size:11,className:"shrink-0 text-yellow-500"}),e.jsx("span",{children:"Add GitHub token in Settings for dedicated quota"})]}),P&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-md bg-yellow-500/10 border border-yellow-500/20 text-yellow-200 text-xs",children:[e.jsx(se,{size:11,className:"shrink-0 text-yellow-500"}),e.jsx("span",{children:"Add OpenRouter key in Settings for external models"})]})]});return e.jsxs("div",{className:"flex flex-col items-center gap-2",ref:j,children:[c==="up"&&q,e.jsxs("div",{className:"relative flex items-center gap-1 bg-slate-800/90 rounded-lg p-1 border border-slate-700/50 backdrop-blur-md shadow-lg",children:[C.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative flex items-center",children:[e.jsxs("button",{onClick:()=>O("self-hosted"),disabled:v,className:`h-7 px-3 flex items-center gap-1.5 rounded-md transition-all active:scale-95 text-xs font-medium whitespace-nowrap ${N>0?"bg-emerald-500/20 text-emerald-300":"text-slate-400 hover:text-slate-300 hover:bg-slate-700/30"}`,children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500"}),e.jsx("span",{children:F("self-hosted")}),e.jsxs("span",{className:`text-[10px] ${N>0?"text-emerald-400":"text-slate-500"}`,children:[N,"/",C.length]}),e.jsx(L,{size:12,className:`transition-transform ${U(u==="self-hosted")}`})]}),u==="self-hosted"&&e.jsx(te,{models:M,allModels:C,selectedModels:o,onToggleModel:i,onToggleAll:()=>B(C),searchQuery:a,setSearchQuery:g,searchInputRef:w,color:"emerald",showSearch:C.length>5,direction:c})]}),e.jsx("div",{className:"w-px h-5 bg-slate-600/50"})]}),E.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative flex items-center",children:[e.jsxs("button",{onClick:()=>O("github"),disabled:v,className:`h-7 px-3 flex items-center gap-1.5 rounded-md transition-all active:scale-95 text-xs font-medium whitespace-nowrap ${T>0?"bg-blue-500/20 text-blue-300":"text-slate-400 hover:text-slate-300 hover:bg-slate-700/30"}`,children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),e.jsx("span",{children:F("github")}),e.jsxs("span",{className:`text-[10px] ${T>0?"text-blue-400":"text-slate-500"}`,children:[T,"/",E.length]}),e.jsx(L,{size:12,className:`transition-transform ${U(u==="github")}`})]}),u==="github"&&e.jsx(te,{models:m,allModels:E,selectedModels:o,onToggleModel:i,onToggleAll:()=>B(E),searchQuery:a,setSearchQuery:g,searchInputRef:w,color:"blue",showSearch:E.length>5,direction:c})]}),n.length>0&&e.jsx("div",{className:"w-px h-5 bg-slate-600/50"})]}),n.length>0&&e.jsxs("div",{className:"relative flex items-center",children:[e.jsxs("button",{onClick:()=>O("external"),disabled:v,className:`h-7 px-3 flex items-center gap-1.5 rounded-md transition-all active:scale-95 text-xs font-medium whitespace-nowrap ${y>0?"bg-purple-500/20 text-purple-300":"text-slate-400 hover:text-slate-300 hover:bg-slate-700/30"}`,children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-purple-500"}),e.jsx("span",{children:F("external")}),e.jsxs("span",{className:`text-[10px] ${y>0?"text-purple-400":"text-slate-500"}`,children:[y,"/",n.length]}),e.jsx(L,{size:12,className:`transition-transform ${U(u==="external")}`})]}),u==="external"&&e.jsx(te,{models:$,allModels:n,selectedModels:o,onToggleModel:i,onToggleAll:()=>B(n),searchQuery:a,setSearchQuery:g,searchInputRef:w,color:"purple",showSearch:n.length>5,direction:c})]})]}),c==="down"&&q]})}function te({models:l,allModels:o,selectedModels:i,onToggleModel:v,onToggleAll:x,searchQuery:h,setSearchQuery:c,searchInputRef:u,color:b,showSearch:a,direction:g}){const j=o.every(n=>i.has(n.id)),w={emerald:{bg:"bg-emerald-500/20",text:"text-emerald-300",check:"text-emerald-400",dot:"bg-emerald-500/50",border:"focus:border-emerald-500/50"},blue:{bg:"bg-blue-500/20",text:"text-blue-300",check:"text-blue-400",dot:"bg-blue-500/50",border:"focus:border-blue-500/50"},purple:{bg:"bg-purple-500/20",text:"text-purple-300",check:"text-purple-400",dot:"bg-purple-500/50",border:"focus:border-purple-500/50"}}[b],C=g==="up"?"bottom-full left-0 mb-2":"top-full left-0 mt-2",E=g==="up"?"animate-in fade-in slide-in-from-bottom-2":"animate-in fade-in slide-in-from-top-2";return e.jsxs("div",{className:`absolute ${C} w-56 bg-slate-800/95 backdrop-blur-md border border-slate-700 rounded-lg shadow-2xl z-[100] overflow-hidden ${E} duration-150`,onClick:n=>n.stopPropagation(),"data-no-arena-scroll":!0,children:[g==="down"&&a&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-2 py-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(ce,{size:12,className:"absolute left-2 top-1/2 -translate-y-1/2 text-slate-500"}),e.jsx("input",{ref:u,type:"text",placeholder:"Search...",value:h,onChange:n=>c(n.target.value),className:`w-full pl-7 pr-2 py-1 text-xs bg-slate-700/50 border border-slate-600/50 rounded text-slate-200 placeholder-slate-500 focus:outline-none ${w.border}`})]})}),e.jsx("div",{className:"border-t border-slate-700/50"})]}),g==="down"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:x,className:`w-full px-3 py-2 text-left text-xs font-medium transition-colors flex items-center justify-between ${j?`${w.bg} ${w.text}`:"text-slate-300 hover:bg-slate-700/50"}`,children:[e.jsx("span",{children:j?"Deselect All":"Select All"}),j&&e.jsx("span",{className:w.check,children:"âœ“"})]}),e.jsx("div",{className:"border-t border-slate-700/50"})]}),e.jsx("div",{className:"max-h-48 overflow-y-scroll chat-scroll",style:{WebkitOverflowScrolling:"touch"},children:l.map(n=>{const M=i.has(n.id);return e.jsxs("button",{onClick:()=>v(n.id),className:`w-full px-3 py-2 text-left text-xs font-medium transition-colors flex items-center justify-between ${M?`${w.bg} text-slate-200`:"text-slate-300 hover:bg-slate-700/50"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${w.dot}`}),e.jsx("span",{children:n.name})]}),M&&e.jsx("span",{className:w.check,children:"âœ“"})]},n.id)})}),g==="up"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border-t border-slate-700/50"}),e.jsxs("button",{onClick:x,className:`w-full px-3 py-2 text-left text-xs font-medium transition-colors flex items-center justify-between ${j?`${w.bg} ${w.text}`:"text-slate-300 hover:bg-slate-700/50"}`,children:[e.jsx("span",{children:j?"Deselect All":"Select All"}),j&&e.jsx("span",{className:w.check,children:"âœ“"})]})]}),g==="up"&&a&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border-t border-slate-700/50"}),e.jsx("div",{className:"px-2 py-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(ce,{size:12,className:"absolute left-2 top-1/2 -translate-y-1/2 text-slate-500"}),e.jsx("input",{ref:u,type:"text",placeholder:"Search...",value:h,onChange:n=>c(n.target.value),className:`w-full pl-7 pr-2 py-1 text-xs bg-slate-700/50 border border-slate-600/50 rounded text-slate-200 placeholder-slate-500 focus:outline-none ${w.border}`})]})})]})]})}const Y={none:{id:"none",name:"None",description:"No system prompt",prompt:null},ui_builder:{id:"ui_builder",name:"UI Builder",description:"Interactive JSON buttons for gesture control",prompt:`You can output interactive UI elements using JSON. When appropriate, include clickable options:

\`\`\`json
{
  "options": [
    {"id": "opt1", "label": "Option 1", "action": "message", "value": "User selected option 1"},
    {"id": "opt2", "label": "Option 2", "action": "message", "value": "User selected option 2"}
  ]
}
\`\`\`

Guidelines:
- Use for choices, confirmations, or navigation
- 2-4 options max
- Keep labels short
- Include JSON after your text response`},concise:{id:"concise",name:"Concise",description:"Brief, direct responses",prompt:"Be concise. Give direct answers in 1-3 sentences. No elaboration or pleasantries."},technical:{id:"technical",name:"Technical",description:"Detailed technical explanations",prompt:"Provide detailed technical explanations. Include code examples where relevant. Explain tradeoffs and edge cases. Assume technical proficiency."},creative:{id:"creative",name:"Creative",description:"More expressive and creative responses",prompt:"Be creative and expressive. Use analogies and metaphors. Explore ideas freely. Personality is encouraged."}};function me({systemPreset:l,setSystemPreset:o,showDropdown:i,setShowDropdown:v,dropdownRef:x,direction:h="down",compact:c=!1}){const u=Object.keys(Y);return r.useEffect(()=>{const b=a=>{x.current&&!x.current.contains(a.target)&&v(!1)};if(i)return document.addEventListener("mousedown",b),()=>document.removeEventListener("mousedown",b)},[i,x,v]),e.jsxs("div",{className:`relative z-0 ${c?"":"mt-3"}`,ref:x,children:[e.jsxs("button",{onClick:()=>v(!i),className:`flex items-center gap-1.5 rounded-md transition-all active:scale-95 font-medium ${c?"h-6 px-2 text-[11px]":"h-7 px-2.5 text-xs"} ${l!=="none"?"bg-sky-500/15 text-sky-300 hover:bg-sky-500/25":"bg-slate-800/60 text-slate-400 hover:text-slate-300 hover:bg-slate-700/50"}`,children:[e.jsx(ye,{size:c?11:12}),e.jsxs("span",{children:["System: ",Y[l].name]}),e.jsx(pe,{size:c?10:12,className:`transition-transform ${i?"rotate-180":""}`})]}),i&&e.jsx("div",{className:`absolute ${h==="up"?"bottom-full mb-1":"top-full mt-1"} left-1/2 -translate-x-1/2 min-w-[200px] bg-slate-800/95 backdrop-blur-md rounded-lg border border-slate-700/50 shadow-xl overflow-hidden z-[60]`,children:u.map(b=>{const a=Y[b],g=b===l;return e.jsx("div",{className:"relative group",children:e.jsxs("button",{onClick:()=>{o(b),v(!1)},className:`w-full px-3 py-2 text-left text-xs flex items-center justify-between transition-colors ${g?"bg-sky-500/20 text-sky-300":"text-slate-300 hover:bg-slate-700/50"}`,children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:a.name}),e.jsx("div",{className:"text-[10px] text-slate-500",children:a.description})]}),g&&e.jsx(fe,{size:12,className:"text-sky-400"})]})},b)})})]})}const He=r.forwardRef(({models:l,selectedModels:o,onToggleModel:i,githubToken:v,openrouterKey:x,messages:h,setMessages:c,isGenerating:u,setIsGenerating:b,gesturesActive:a=!1},g)=>{var re,ne;const[j,w]=r.useState(!1),[C,E]=r.useState(null),[n,M]=r.useState(new Map),[m,$]=r.useState(new Map),[N,T]=Se("chat-system-preset","none"),[y,O]=r.useState(!1),B=r.useRef(null),F=r.useRef(new Map),z=r.useRef(null),P=r.useRef(null),L=r.useRef(!1),U=ke(),q=((re=U==null?void 0:U.gestureState)==null?void 0:re.gesture)==="Middle_Finger",s=r.useCallback(()=>{if(!z.current)return!0;const{scrollTop:t,scrollHeight:d,clientHeight:p}=z.current;return d-t-p<100},[]);r.useEffect(()=>{const t=z.current;if(!t)return;const d=()=>{s()?L.current=!1:L.current=!0};return t.addEventListener("scroll",d,{passive:!0}),()=>t.removeEventListener("scroll",d)},[s]),r.useImperativeHandle(g,()=>({sendMessage:(t,d)=>R(t,d),setInput:t=>{P.current&&(P.current.value=t,P.current.focus())},stopGeneration:H,scroll:t=>{z.current&&(L.current=!0,z.current.scrollTop=z.current.scrollTop-t)}})),r.useEffect(()=>{z.current&&!L.current&&(z.current.scrollTop=z.current.scrollHeight)},[h,n]),r.useEffect(()=>{const t=d=>{var A;if(d.ctrlKey||d.metaKey||d.altKey)return;const p=d.target;p.tagName==="INPUT"||p.tagName==="TEXTAREA"||d.key.length===1&&((A=P.current)==null||A.focus())};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[]);const R=async(t,d=!1)=>{if(!t.trim()||u||o.size===0)return;L.current=!1;const p=Array.from(o),A={role:"user",content:t};c(f=>[...f,A]),b(!0),M(new Map(p.map(f=>[f,""])));const _=Date.now();$(new Map(p.map(f=>[f,{startTime:_}])));const G=[...h,A].map(f=>({role:f.role,content:f.content})),W=[],ae=Y[N];ae.prompt&&W.push({role:"system",content:ae.prompt}),d&&W.push({role:"system",content:'User is using gesture control. Available gestures: ðŸ‘ (yes), ðŸ‘Ž (no), ðŸ‘‹ (hello), "ok", "thanks", "stop", pointing finger (select buttons).'}),(t==="ðŸ–•"||t.toLowerCase().includes("middle finger"))&&W.push({role:"system",content:"The user is showing you their middle finger. Respond with humorous, over-the-top mock indignation. Play along with the 'angry robot' persona."});const ge=[...W,...G];let K=0;const le=p.length,ve=p.map(async f=>{const Q=l.find(k=>k.id===f),oe=Date.now();if(!Q){c(k=>[...k,{role:"assistant",content:"Model not found",modelName:f,modelId:f,error:!0}]),M(k=>{const S=new Map(k);return S.delete(f),S}),$(k=>{const S=new Map(k);return S.delete(f),S}),K++,K===le&&b(!1);return}const V=new AbortController;F.current.set(f,V);let J;try{const k=await Ce({models:[f],messages:ge,max_tokens:2048,temperature:.7,github_token:v||null,openrouter_key:x||null},V.signal);let S="";await Ee(k,D=>{if(V.signal.aborted)throw new DOMException("Aborted","AbortError");if(D.event==="error"||D.error)throw new Error(typeof D.error=="string"?D.error:D.content||"Stream failed");D.content&&(J||(J=Date.now(),$(Z=>{const I=new Map(Z),ie=I.get(f);return ie&&I.set(f,{...ie,firstTokenTime:J}),I})),S+=D.content,M(Z=>new Map(Z).set(f,S)))});const X=Date.now();c(D=>[...D,{role:"assistant",content:S,modelName:Q.name,modelId:f,timing:{startTime:oe,firstTokenTime:J,endTime:X}}])}catch(k){const S=Date.now();k.name!=="AbortError"&&c(X=>[...X,{role:"assistant",content:k.message,modelName:Q.name,modelId:f,error:!0,timing:{startTime:oe,firstTokenTime:J,endTime:S}}])}finally{F.current.delete(f),M(k=>{const S=new Map(k);return S.delete(f),S}),$(k=>{const S=new Map(k);return S.delete(f),S}),K++,K===le&&b(!1)}});await Promise.all(ve)},H=()=>{F.current.forEach(p=>p.abort()),F.current.clear();const t=[],d=Date.now();n.forEach((p,A)=>{if(p.trim()){const _=l.find(W=>W.id===A),G=m.get(A);t.push({role:"assistant",content:p,modelName:_==null?void 0:_.name,modelId:A,timing:G?{...G,endTime:d}:void 0})}}),t.length>0&&c(p=>[...p,...t]),M(new Map),$(new Map),b(!1)},he=r.useCallback(async t=>{const d=h[t];if(d)try{await navigator.clipboard.writeText(d.content),E(`${t}`),setTimeout(()=>E(null),2e3)}catch(p){console.error("Copy failed",p)}},[h]),be=o.size===0?"Select models to start...":o.size===1?`Message ${((ne=l.find(t=>t.id===Array.from(o)[0]))==null?void 0:ne.name)||"model"}...`:`Message ${o.size} models...`;return e.jsxs("div",{className:"flex flex-col h-full relative",children:[e.jsx("div",{ref:z,className:"flex-1 overflow-y-scroll p-4 pb-40 chat-scroll",style:{WebkitOverflowScrolling:"touch"},"data-no-arena-scroll":!0,children:e.jsxs("div",{className:"mx-auto max-w-2xl space-y-4",children:[h.length===0&&e.jsxs("div",{className:"flex-1 flex flex-col items-center text-slate-500 select-none pt-[15vh]",children:[q?e.jsxs("div",{className:"mb-6 relative",children:[e.jsx("div",{className:"absolute inset-0 bg-red-500 blur-xl opacity-50 rounded-full"}),e.jsx(ee,{size:72,className:"relative text-red-500"}),e.jsx("div",{className:"absolute -top-2 -right-2 text-3xl",children:"ðŸ’¢"})]}):e.jsx(ee,{size:72,className:"mb-6 opacity-50 transition-all duration-300"}),e.jsx(xe,{models:l,selectedModels:o,onToggleModel:i,isGenerating:u,githubToken:v,openrouterKey:x,dropDirection:"down"}),e.jsx(me,{systemPreset:N,setSystemPreset:T,showDropdown:y,setShowDropdown:O,dropdownRef:B,direction:"down"})]}),h.map((t,d)=>{const p=t.role==="assistant"&&(a||N==="ui_builder")&&t.content.includes("```json");return e.jsxs("div",{className:`flex ${t.role==="user"?"justify-end":"justify-start"}`,children:[e.jsxs("div",{className:`group relative max-w-[85%] rounded-2xl px-4 py-3 ${t.role==="user"?"bg-blue-600/20 border border-blue-500/30 text-white rounded-tr-sm":t.error?"bg-red-500/10 border border-red-500/30 text-red-200 rounded-tl-sm":"bg-slate-800/60 border border-slate-700/60 text-slate-200 rounded-tl-sm"}`,children:[e.jsxs("div",{className:`flex items-center gap-2 mb-1 text-[10px] font-bold uppercase tracking-wider ${t.role==="user"?"text-blue-300 flex-row-reverse":"text-slate-400"}`,children:[t.role==="user"?e.jsx(je,{size:12}):e.jsx(ee,{size:12}),t.role==="user"?"You":t.modelName||"Assistant",t.error&&e.jsx(se,{size:12,className:"text-red-400"})]}),e.jsx("div",{className:"prose prose-invert prose-sm max-w-none",children:e.jsx(de,{text:t.role==="user"?t.content:Te(t.content)})}),t.role==="assistant"&&t.timing&&e.jsx("div",{className:"mt-2 pt-2 border-t border-slate-700/30",children:e.jsx(ue,{times:t.timing})}),t.role==="assistant"&&t.content&&e.jsx("button",{onClick:()=>he(d),className:`absolute bottom-2 right-2 p-1.5 rounded-md transition-all ${C===`${d}`?"bg-emerald-500/20 text-emerald-400":"opacity-0 group-hover:opacity-100 bg-slate-700/70 text-slate-400"}`,children:C===`${d}`?e.jsx(fe,{size:12}):e.jsx(Ne,{size:12})})]}),p&&e.jsx("div",{className:"ml-4",children:e.jsx(Me,{content:t.content,onSelect:A=>R(A,!0),isInline:!1})})]},d)}),u&&n.size>0&&e.jsx(e.Fragment,{children:Array.from(n.entries()).map(([t,d])=>{const p=l.find(_=>_.id===t),A=m.get(t);return e.jsx("div",{className:"flex justify-start",children:e.jsxs("div",{className:"max-w-[85%] rounded-2xl rounded-tl-sm px-4 py-3 bg-slate-800/60 border border-amber-500/30 text-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 text-[10px] font-bold uppercase tracking-wider text-amber-400/80",children:[e.jsx("div",{className:"w-3 h-3 border-2 border-amber-400/50 border-t-amber-400 rounded-full animate-spin"}),(p==null?void 0:p.name)||t]}),e.jsx("div",{className:"prose prose-invert prose-sm max-w-none",children:e.jsx(de,{text:d||"..."})}),A&&e.jsx("div",{className:"mt-2 pt-2 border-t border-slate-700/30",children:e.jsx(ue,{times:A})})]})},t)})})]})}),e.jsxs("div",{className:"fixed bottom-0 left-0 right-0 z-[99] flex flex-col items-center gap-2 px-4 pb-4",style:{paddingBottom:"calc(1rem + env(safe-area-inset-bottom))"},children:[h.length>0&&e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(me,{systemPreset:N,setSystemPreset:T,showDropdown:y,setShowDropdown:O,dropdownRef:B,direction:"up",compact:!0}),e.jsx("div",{className:"relative z-[101] isolate",children:e.jsx(xe,{models:l,selectedModels:o,onToggleModel:i,isGenerating:u,githubToken:v,openrouterKey:x,dropDirection:"up"})})]}),e.jsx($e,{inputRef:P,inputFocused:j,setInputFocused:w,onSendMessage:R,placeholder:be,isGenerating:u,onStop:H,className:"w-full flex justify-center",style:{}})]})]})});export{Y as SYSTEM_PRESETS,He as default};
