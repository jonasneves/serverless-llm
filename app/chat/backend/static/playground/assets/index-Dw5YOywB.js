const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SettingsModal-Bwp3eHZ9.js","assets/react-vendor-CQxWqugw.js","assets/markdown-BNX5kHMI.js","assets/math-render-D6B7xoul.js","assets/math-render-BqiDbsU2.css","assets/syntax-highlight-K7DiErAG.js","assets/syntax-highlight-BEHUn5zE.css","assets/ResponseModal-reNlrW8D.js","assets/FormattedContent-ClPh4eCb.js","assets/DiscussionTranscript-BNM7dRxs.js","assets/GestureControl-DKpH6LsJ.js","assets/HandBackground-F7iiHyIM.js","assets/mediapipe-BWDqrTQ6.js","assets/ChatView-CIHI3azX.js"])))=>i.map(i=>d[i]);
var Xn=Object.defineProperty;var Gn=(t,s,r)=>s in t?Xn(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r;var tn=(t,s,r)=>Gn(t,typeof s!="symbol"?s+"":s,r);import{r as n,j as e,X as Un,S as Kn,C as qn,a as Vn,A as Qn,b as Jn,Z as Zn,T as es,R as ts,c as ns,d as ss}from"./react-vendor-CQxWqugw.js";import"./math-render-D6B7xoul.js";import"./syntax-highlight-K7DiErAG.js";import"./markdown-BNX5kHMI.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))a(p);new MutationObserver(p=>{for(const i of p)if(i.type==="childList")for(const x of i.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&a(x)}).observe(document,{childList:!0,subtree:!0});function r(p){const i={};return p.integrity&&(i.integrity=p.integrity),p.referrerPolicy&&(i.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?i.credentials="include":p.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(p){if(p.ep)return;p.ep=!0;const i=r(p);fetch(p.href,i)}})();const rs="modulepreload",os=function(t){return"/static/playground/"+t},nn={},$e=function(s,r,a){let p=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const x=document.querySelector("meta[property=csp-nonce]"),d=(x==null?void 0:x.nonce)||(x==null?void 0:x.getAttribute("nonce"));p=Promise.allSettled(r.map(c=>{if(c=os(c),c in nn)return;nn[c]=!0;const f=c.endsWith(".css"),u=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const h=document.createElement("link");if(h.rel=f?"stylesheet":rs,f||(h.as="script"),h.crossOrigin="",h.href=c,d&&h.setAttribute("nonce",d),document.head.appendChild(h),f)return new Promise((k,L)=>{h.addEventListener("load",k),h.addEventListener("error",()=>L(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(x){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=x,window.dispatchEvent(d),!d.defaultPrevented)throw x}return p.then(x=>{for(const d of x||[])d.status==="rejected"&&i(d.reason);return s().catch(i)})},as={"self-hosted":{color:"#10b981"},github:{color:"#3b82f6"},external:{color:"#8b5cf6"}},is=["deepseek-r1-distill-qwen-1.5b","r1qwen","smollm3","nanbeige"],ls=["gpt-oss","gptoss"],cs=t=>{const s=t.toLowerCase();return is.some(r=>s.includes(r.toLowerCase()))},ds=t=>{const s=t.toLowerCase();return ls.some(r=>s.includes(r.toLowerCase()))},Rt=[{id:"eu-ai-act-enforcement",label:"EU AI Act Enforcement Wave",prompt:"The EU AI Act enters enforcement; high-risk systems must prove data provenance, evals, and risk controls. Outline compliance gaps for a frontier model API and tradeoffs between speed and alignment.",category:"Policy",modes:["analyze","debate"],tags:["governance","compliance"]},{id:"export-controls-blackwell",label:"Export Controls Tighten",prompt:"U.S. export rules tighten again on AI accelerators; Blackwell-class parts face new caps and cloud checks. Map the impact on training roadmaps, costs, and on-device strategies.",category:"Infra",modes:["compare","debate"],tags:["chips","supply-chain"]},{id:"weights-leak",label:"Major Weights Leak",prompt:"A commercial frontier model checkpoint leaks. Assess risks (misuse, impersonation, jailbreak diffusion), legal exposure, and whether open red-team releases mitigate or worsen safety.",category:"Security",modes:["analyze","debate"],tags:["safety","open-weights"]},{id:"on-device-llm-race",label:"On-Device LLM Race",prompt:"Phone OEMs ship 3nm NPUs and 20B-parameter on-device assistants. What actually moves the needle for UX, privacy, and cost vs. cloud? Where do hybrid (edge + cloud) designs win?",category:"Infra",modes:["compare","debate"],tags:["edge","latency"]},{id:"signed-app-prompt-injection",label:"Signed App Prompt Injection",prompt:"A popular signed desktop app shipped with hardcoded system prompts; attackers use supply chain updates to exfiltrate data. How should vendors audit, sandbox, and attest LLM apps?",category:"Security",modes:["compare","analyze"],tags:["supply-chain","prompt-injection"]},{id:"eval-standardization",label:"Safety Eval Standard",prompt:"NIST-style safety eval suites gain traction (jailbreak, autonomy, bio). How should vendors report scores, and what gaps remain for frontier vs. small models?",category:"Policy",modes:["compare","debate"],tags:["evaluation","safety"]},{id:"licensing-standoff",label:"Publisher Licensing Standoff",prompt:"Major news publishers pause AI licensing talks and sue over training. What remedies (revenue share, opt-out registries, model removal) are realistic, and how do they ripple to open models?",category:"Data",modes:["analyze","debate"],tags:["licensing","copyright"]},{id:"sbom-for-llms",label:"SBOM for LLM Pipelines",prompt:"Regulators push SBOMs and signed artifacts for AI stacks. Draft what should appear in an LLM pipeline SBOM (data, weights, evals, guardrails) and how to verify it at runtime.",category:"Security",modes:["compare","analyze"],tags:["sbom","supply-chain"]},{id:"data-poisoning-campaign",label:"Data Poisoning Campaign",prompt:"Researchers find coordinated data poisoning in popular open corpora. How should model hosts detect and mitigate poisoning post-hoc, and what retraining tradeoffs are acceptable?",category:"Security",modes:["compare","debate"],tags:["data","poisoning"]},{id:"copyright-settlement",label:"Copyright Settlement Sets Precedent",prompt:"A major copyright suit settles with dataset disclosure and per-output watermarking. Predict how this precedent affects future training sets and open-weight releases.",category:"Policy",modes:["debate"],tags:["copyright","watermarking"]}],gr={analyze:["What's the most important programming principle?","Should code comments explain 'what' or 'why'?","Is TypeScript worth the extra complexity?"],debate:["Tabs or spaces? Give your verdict.","Should AI be allowed to write its own code?","What will never be automated by AI?"],compare:[],chat:[]};Rt.filter(t=>t.category==="Policy"||t.category==="Data"),Rt.filter(t=>t.category==="Infra"),Rt.filter(t=>t.category==="Security");const us=["dots-mesh","dots","dots-fade","grid","mesh","animated-mesh","none"],pt="#0f172a",sn={compare:pt,analyze:pt,debate:pt,chat:pt},Qe={maxTokens:1024,temperature:.7},se={cardWidth:256,cardHeight:200,gapX:24,gapY:24,baseRadius:160,minRadius:120,radiusPerModel:15,scrollClamp:200};function fs({showDock:t,availableModels:s,allSelectedByType:r,totalModelsByType:a,handleDragStart:p,handleModelToggle:i,handleAddGroup:x,dockRef:d,mode:c,allModels:f,setShowDock:u,chatSelectedModels:h=new Set,onToggleChatModel:k,onToggleChatGroup:L}){const[A,$]=n.useState(""),[b,l]=n.useState(""),v=n.useRef(null);n.useEffect(()=>{const z=setTimeout(()=>l(A),200);return()=>clearTimeout(z)},[A]);const B=[{type:"self-hosted",title:"Self-Hosted",accentColor:"emerald"},{type:"github",title:"GitHub Models",accentColor:"blue"},{type:"external",title:"External",accentColor:"purple"}],W=c==="chat",P=W?f:s,E=n.useMemo(()=>{if(!b)return P;const z=b.toLowerCase();return P.filter(M=>M.name.toLowerCase().includes(z))},[P,b]),Q=n.useCallback(z=>{W&&k?k(z):i(z)},[W,k,i]);n.useEffect(()=>{t?setTimeout(()=>{var z;return(z=v.current)==null?void 0:z.focus()},100):$("")},[t]),n.useEffect(()=>{if(!t)return;const z=M=>{M.key==="Escape"&&(M.preventDefault(),u(!1))};return window.addEventListener("keydown",z),()=>window.removeEventListener("keydown",z)},[t,u]);const U=z=>({emerald:{dot:"bg-emerald-500",text:"text-emerald-400",active:"bg-emerald-500/20 border-emerald-500/30"},blue:{dot:"bg-blue-500",text:"text-blue-400",active:"bg-blue-500/20 border-blue-500/30"},purple:{dot:"bg-purple-500",text:"text-purple-400",active:"bg-purple-500/20 border-purple-500/30"}})[z];return e.jsxs("div",{ref:d,"data-no-arena-scroll":!0,"data-no-background":!0,className:"fixed top-1/2 left-1/2 w-[min(90vw,500px)] max-h-[70vh] rounded-2xl flex flex-col z-[60] transition-all duration-300 shadow-2xl bg-slate-800/95 backdrop-blur-md",style:{transform:t?"translate(-50%, -50%) scale(1)":"translate(-50%, -50%) scale(0.95)",opacity:t?1:0,pointerEvents:t?"auto":"none"},children:[e.jsxs("div",{className:"px-4 py-3 border-b border-slate-700/50 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-200",children:W?"Select Models":"Add to Arena"}),W&&e.jsx("p",{className:"text-[10px] text-slate-500 mt-0.5",children:h.size===0?"Click to select":`${h.size} selected`})]}),e.jsx("button",{onClick:()=>u(!1),className:"text-slate-400 hover:text-slate-200",children:e.jsx(Un,{size:18})})]}),e.jsx("div",{className:"px-4 py-2 border-b border-slate-700/50",children:e.jsxs("div",{className:"relative",children:[e.jsx(Kn,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-500"}),e.jsx("input",{ref:v,type:"text",placeholder:"Search...",value:A,onChange:z=>$(z.target.value),className:"w-full pl-9 pr-3 py-2 text-sm bg-slate-700/50 border border-slate-600/50 rounded-lg text-slate-200 placeholder-slate-500 focus:outline-none focus:border-slate-500"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-3 space-y-4",children:B.map(z=>{const M=E.filter(X=>X.type===z.type),K=f.filter(X=>X.type===z.type),O=U(z.accentColor);if(K.length===0)return null;const Z=W&&K.every(X=>h.has(X.id));return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between px-1 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${O.dot}`}),e.jsxs("span",{className:"text-[10px] font-semibold text-slate-400 uppercase tracking-wide",children:[z.title," (",K.length,")"]})]}),W?L&&e.jsx("button",{onClick:()=>L(z.type),className:`text-[10px] font-medium px-2 py-1 rounded ${O.text} hover:bg-white/5`,children:Z?"− Remove All":"+ Add All"}):e.jsx("button",{onClick:()=>x(z.type),className:`text-[10px] font-medium px-2 py-1 rounded ${O.text} hover:bg-white/5`,children:r[z.type]?"− Remove All":"+ Add All"})]}),e.jsx("div",{className:"space-y-1",children:M.map(X=>{const H=W?h.has(X.id):!1;return e.jsxs("div",{draggable:!W,onDragStart:W?void 0:y=>p(y,X.id),onClick:()=>Q(X.id),className:`flex items-center justify-between px-3 py-2 rounded-lg cursor-pointer transition-colors border ${H?O.active:"hover:bg-white/5 border-transparent"}`,children:[e.jsx("span",{className:`text-xs font-medium ${H?"text-slate-200":"text-slate-400"}`,children:X.name}),H&&e.jsx(qn,{size:14,className:O.text})]},X.id)})})]},z.type)})}),e.jsx("div",{className:"px-4 py-2 border-t border-slate-700/50",children:e.jsxs("p",{className:"text-[10px] text-slate-500 text-center",children:["Press ",e.jsx("kbd",{className:"px-1 py-0.5 rounded bg-slate-700 text-slate-400 text-[9px]",children:"M"})," or ",e.jsx("kbd",{className:"px-1 py-0.5 rounded bg-slate-700 text-slate-400 text-[9px]",children:"Esc"})," to close"]})})]})}function ps({inputRef:t,inputFocused:s,setInputFocused:r,onSendMessage:a,className:p,style:i,placeholder:x,isGenerating:d,onStop:c}){return e.jsx("div",{className:p??"fixed bottom-0 right-0 left-0 z-[100] pb-6 px-3 sm:px-4 flex justify-center items-end pointer-events-none transition-all duration-300",style:i??{paddingBottom:"calc(1.5rem + env(safe-area-inset-bottom))"},children:e.jsx("div",{className:"w-full pointer-events-auto",style:{maxWidth:"600px"},children:e.jsxs("div",{className:`rounded-xl p-2.5 transition-all duration-300 flex items-center gap-2 border border-slate-700/40 header-shell ${s?"prompt-panel-focused":""}`,children:[e.jsx("input",{ref:t,type:"text",placeholder:x||"Ask a question to compare model responses...",className:"w-full bg-transparent text-slate-200 placeholder-slate-500 outline-none text-base sm:text-sm px-2.5 py-2.5",onFocus:()=>r(!0),onBlur:()=>r(!1),onKeyDown:f=>{var u;if(f.key==="Enter"&&!f.shiftKey){if(f.preventDefault(),d)return;(u=t.current)!=null&&u.value&&(a(t.current.value),t.current.value="")}},disabled:d}),e.jsx("button",{onClick:()=>{var f;d?c==null||c():(f=t.current)!=null&&f.value&&(a(t.current.value),t.current.value="")},onMouseDown:f=>f.currentTarget.blur(),className:`min-w-[44px] min-h-[44px] sm:min-w-[36px] sm:min-h-[36px] p-2 rounded-lg transition-colors active:scale-95 flex items-center justify-center focus:outline-none focus-visible:outline-none ${d?"text-red-400 hover:text-red-300 hover:bg-red-500/10":"text-slate-400 hover:text-white hover:bg-white/10"}`,"aria-label":d?"Stop generation":"Send message",children:d?e.jsx(Vn,{className:"w-5 h-5 sm:w-4 sm:h-4 fill-current"}):e.jsx(Qn,{className:"w-5 h-5 sm:w-4 sm:h-4",strokeWidth:2.5})})]})})})}const hs={chat:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),compare:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2"})}),analyze:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),debate:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})},Ae=[{value:"chat",label:"Chat"},{value:"compare",label:"Compare"},{value:"analyze",label:"Analyze"},{value:"debate",label:"Debate"}];function ms({mode:t,setMode:s,setHoveredCard:r,clearSelection:a,showDock:p,setShowDock:i,onOpenSettings:x,gestureButtonSlot:d}){const[c,f]=n.useState(!1),u=n.useRef(null),[h,k]=n.useState(!0),L=n.useRef(null),[A,$]=n.useState(null),[b,l]=n.useState(0),v=Ae.findIndex(E=>E.value===t),B=v===-1?0:v,W=Ae[B].label;n.useEffect(()=>{const E=()=>{k(window.innerWidth>=1024)};return E(),window.addEventListener("resize",E),()=>window.removeEventListener("resize",E)},[]),n.useEffect(()=>{if(!L.current)return;const E=()=>{const z=L.current;if(!z)return;const M=z.querySelectorAll('button[role="radio"]');if(M.length===0||B>=M.length)return;const O=M[B].getBoundingClientRect(),Z=z.getBoundingClientRect(),X=O.width,H=O.left,y=Z.left;$(X),l(H-y)},Q=setTimeout(E,0),U=new ResizeObserver(()=>{setTimeout(E,0)});return U.observe(L.current),window.addEventListener("resize",E),()=>{clearTimeout(Q),U.disconnect(),window.removeEventListener("resize",E)}},[t,h,B]),n.useEffect(()=>{function E(Q){u.current&&!u.current.contains(Q.target)&&f(!1)}return c&&document.addEventListener("mousedown",E),()=>{document.removeEventListener("mousedown",E)}},[c]);const P=E=>{s(E),r(null),a(),f(!1)};return e.jsxs("div",{className:"fixed top-0 left-0 right-0 flex items-center justify-between mb-2 px-3 sm:px-6 pt-4 sm:pt-6 z-50 pointer-events-none transition-all duration-300",children:[e.jsx("div",{className:"absolute inset-0 pointer-events-auto",style:{height:"100%",zIndex:-1}}),e.jsx("div",{className:"flex items-center gap-2 w-auto pointer-events-auto z-20",children:d}),e.jsx("div",{className:"hidden md:block absolute left-1/2 -translate-x-1/2 pointer-events-auto z-20",children:e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex items-center p-1.5 rounded-xl border border-slate-700/40 header-shell",children:[e.jsx("button",{onClick:()=>i(!p),className:"px-2 sm:px-3 flex items-center justify-center text-slate-400 hover:text-white transition-colors",title:"Toggle Model Dock",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsx("div",{className:"w-px h-5 bg-slate-700/50 mx-0.5 sm:mx-1"}),e.jsxs("div",{ref:L,className:"relative flex p-1 rounded-lg bg-black/20 mode-track",role:"radiogroup","aria-label":"Mode selection","data-gesture-mode-track":"true",children:[e.jsx("div",{className:"absolute top-1 bottom-1 rounded-md transition-all duration-300 ease-out mode-slider",style:{width:A!==null?`${A}px`:`calc((100% - 8px) / ${Ae.length})`,left:A!==null?`${b}px`:`calc(4px + (100% - 8px) * ${B} / ${Ae.length})`}}),Ae.map(E=>e.jsx("button",{tabIndex:-1,onClick:()=>P(E.value),role:"radio","aria-checked":t===E.value,"aria-label":E.label,title:E.label,className:`relative z-10 py-2 sm:py-1.5 px-3 text-[11px] sm:text-xs font-medium transition-colors duration-200 min-h-[44px] sm:min-h-0 active:scale-95 focus:outline-none focus-visible:outline-none flex-1 flex items-center justify-center text-center ${t===E.value?"text-white":"text-slate-400 hover:text-slate-200"}`,children:E.label},E.value))]})]})})}),e.jsx("div",{className:"flex md:hidden flex-1 justify-center pointer-events-auto relative z-20",children:e.jsxs("div",{className:"relative",ref:u,children:[e.jsxs("button",{onClick:()=>f(!c),className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-slate-800/90 border border-slate-700/50 text-slate-200 font-medium text-sm backdrop-blur-md shadow-lg active:scale-95 transition-all",children:[e.jsx("span",{className:"font-bold text-slate-400 hidden xs:inline",children:"Arena"}),e.jsx("span",{className:"font-bold hidden xs:inline text-slate-600",children:"/"}),e.jsx("span",{children:W}),e.jsx("svg",{className:`w-4 h-4 text-slate-400 transition-transform duration-200 ${c?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),c&&e.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 mt-2 w-48 py-1 rounded-xl bg-slate-800 border border-slate-700 shadow-2xl overflow-hidden flex flex-col animate-in fade-in zoom-in-95 duration-100 origin-top",children:Ae.map(E=>e.jsxs("button",{onClick:()=>P(E.value),className:`px-4 py-3 text-sm text-left w-full transition-colors flex items-center gap-3 ${t===E.value?"bg-blue-500/10 text-blue-400":"text-slate-300 hover:bg-slate-700/50"}`,children:[e.jsx("span",{className:"flex-shrink-0",children:hs[E.value]}),e.jsx("span",{className:"flex-1",children:E.label}),t===E.value&&e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]},E.value))})]})}),e.jsx("div",{className:"flex items-center gap-2 w-auto justify-end pointer-events-auto z-20",children:e.jsx("button",{onClick:x,className:"min-w-[42px] min-h-[42px] w-[42px] h-[42px] rounded-full bg-slate-800/50 flex items-center justify-center border border-slate-700/50 hover:border-slate-600 transition-colors active:scale-95 focus:outline-none focus-visible:outline-none",title:"Settings",children:e.jsxs("svg",{className:"w-4 h-4 text-slate-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),e.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})})})]})}const xs=t=>{if(typeof t=="string")return t;try{return JSON.stringify(t)}catch{return null}},gs=(t,s)=>{if(t===null)return s;try{return JSON.parse(t)}catch{return s}};function ze(t,s,r={}){const a=r.serialize??xs,p=r.deserialize??gs,[i,x]=n.useState(()=>{if(typeof window>"u")return s;try{const d=window.localStorage.getItem(t);return p(d,s)}catch{return s}});return n.useEffect(()=>{if(!(typeof window>"u"))try{const d=a(i);d===null?window.localStorage.removeItem(t):window.localStorage.setItem(t,d)}catch{}},[t,a,i]),[i,x]}const bs=800,ys=3e3,vs=8;function ws(){const[t,s]=n.useState([]),[r,a]=n.useState(!0),[p,i]=n.useState(null),[x,d]=n.useState(0),[c,f]=ze("playground_selected_models",null),u=n.useRef(c!==null),[h,k]=ze("playground_chat_model",null),L=n.useRef(h!==null),A=n.useMemo(()=>c??[],[c]),$=n.useCallback(M=>{f(K=>typeof M=="function"?M(K??[]):M)},[f]),[b,l]=n.useState(""),v=n.useRef(0),B=n.useRef(null),W=n.useCallback(async(M,K,O=!1)=>{B.current&&(clearTimeout(B.current),B.current=null),a(!0),O&&(i("Refreshing..."),d(0));const Z=X=>{var xe,ae;const H=X.models.map(V=>{const ue=V.type==="self-hosted"||V.type==="github"||V.type==="external"?V.type:"self-hosted",ie=as[ue];return{id:V.id,name:ie.name||V.name||V.id,color:ie.color,type:ue,response:"",priority:V.priority,context_length:V.context_length,default:V.default}});if(s(H),a(!1),i(null),d(0),u.current||(f(H.filter(V=>V.type==="self-hosted"&&V.id!=="nemotron-3-nano-30b-a3b").map(V=>V.id)),u.current=!0),!L.current){const V=H.find(ie=>ie.default),ue=H.find(ie=>ie.type==="github"||ie.type==="external");k((V==null?void 0:V.id)||(ue==null?void 0:ue.id)||((xe=H[0])==null?void 0:xe.id)||null),L.current=!0}const y=H.find(V=>V.type==="github"||V.type==="external"),pe=H.find(V=>V.default),ge=((ae=H[0])==null?void 0:ae.id)||"";l((y==null?void 0:y.id)||(pe==null?void 0:pe.id)||ge)};try{const X=await fetch("/api/models");if(M!==v.current)return;if(!X.ok)throw new Error(`HTTP ${X.status}`);const H=await X.json();if(M!==v.current)return;if(!H.models||H.models.length===0)throw new Error("No models available yet");Z(H)}catch(X){if(M!==v.current)return;console.warn("Backend fetch failed:",X);try{console.log("Trying static models.json...");const y=await fetch("/models.json");if(y.ok){const pe=await y.json();if(pe.models&&pe.models.length>0){console.log(`Loaded ${pe.models.length} models from static file`),Z(pe);return}}}catch(y){console.warn("Static models.json not available:",y)}const H=K+1;if(d(H),H<vs){const y=Math.min(bs*Math.pow(1.4,K),ys);i("Connecting to backend..."),B.current=setTimeout(()=>{W(M,H)},y)}else a(!1),i("Could not load models")}},[f,k]),P=n.useCallback(()=>{v.current+=1,W(v.current,0,!0)},[W]);n.useEffect(()=>(v.current+=1,W(v.current,0),()=>{v.current+=1,B.current&&clearTimeout(B.current)}),[W]);const E=n.useMemo(()=>t.filter(M=>!A.includes(M.id)),[t,A]),{totalModelsByType:Q,allSelectedByType:U}=n.useMemo(()=>{const M={"self-hosted":t.filter(O=>O.type==="self-hosted").length,github:t.filter(O=>O.type==="github").length,external:t.filter(O=>O.type==="external").length},K={"self-hosted":t.filter(O=>O.type==="self-hosted"&&A.includes(O.id)).length,github:t.filter(O=>O.type==="github"&&A.includes(O.id)).length,external:t.filter(O=>O.type==="external"&&A.includes(O.id)).length};return{totalModelsByType:M,allSelectedByType:{"self-hosted":M["self-hosted"]>0&&K["self-hosted"]===M["self-hosted"],github:M.github>0&&K.github===M.github,external:M.external>0&&K.external===M.external}}},[t,A]),z=n.useCallback(M=>{var K;return((K=t.find(O=>O.id===M))==null?void 0:K.name)||M},[t]);return{modelsData:t,setModelsData:s,selected:A,setSelected:$,chatModelId:h,setChatModelId:k,moderator:b,setModerator:l,availableModels:E,totalModelsByType:Q,allSelectedByType:U,modelIdToName:z,isLoading:r,loadError:p,retryCount:x,retryNow:P}}function ks(){var t;return typeof chrome<"u"&&((t=chrome.storage)!=null&&t.local)?window.__API_BASE__||"https://chat.neevs.io":""}async function*It(t,s,r){var f;const p=`${ks()}${t}`,i=await fetch(p,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s),signal:r});if(!i.ok){yield{event:"error",error:`HTTP ${i.status}: ${i.statusText}`};return}const x=(f=i.body)==null?void 0:f.getReader();if(!x){yield{event:"error",error:"No response body"};return}const d=new TextDecoder;let c="";try{for(;;){const{done:u,value:h}=await x.read();if(u)break;c+=d.decode(h,{stream:!0});const k=c.split(`
`);c=k.pop()||"";for(const L of k)if(L.startsWith("data: ")){const A=L.slice(6).trim();if(A)try{yield JSON.parse(A)}catch{}}}}finally{x.releaseLock()}}const js=async(t,s)=>It("/api/chat/stream",{models:t.models,messages:t.messages,max_tokens:t.max_tokens,temperature:t.temperature,github_token:t.github_token,openrouter_key:t.openrouter_key},s),Ss=async(t,s)=>It("/api/chat/analyze/stream",t,s),Ts=async(t,s)=>It("/api/chat/debate/stream",t,s),Lt=async(t,s)=>{try{for await(const r of t)s(r)}catch(r){throw console.error("Stream error:",r),r}};function rn(t){window.__API_BASE__=t}const Es=[{name:"Chat",path:"chat.yml",category:"core"},{name:"Build Images",path:"build-push-images.yml",category:"core"},{name:"Nanbeige4-3B Thinking",path:"inference.yml",category:"reasoning",serviceKey:"nanbeige"},{name:"Qwen3 4B",path:"inference.yml",category:"small",serviceKey:"qwen"},{name:"SmolLM3 3B",path:"inference.yml",category:"small",serviceKey:"smollm3"},{name:"LFM2.5 1.2B",path:"inference.yml",category:"small",serviceKey:"lfm2"},{name:"DeepSeek R1 1.5B",path:"inference.yml",category:"reasoning",serviceKey:"r1qwen"},{name:"Gemma 3 12B",path:"inference.yml",category:"medium",serviceKey:"gemma"},{name:"Mistral 7B v0.3",path:"inference.yml",category:"medium",serviceKey:"mistral"},{name:"Phi-3 Mini",path:"inference.yml",category:"small",serviceKey:"phi"},{name:"RNJ-1 Instruct",path:"inference.yml",category:"medium",serviceKey:"rnj"},{name:"Llama 3.2-3B",path:"inference.yml",category:"medium",serviceKey:"llama"},{name:"FunctionGemma 270M",path:"inference.yml",category:"small",serviceKey:"functiongemma"},{name:"Nemotron-3 Nano 30B",path:"inference.yml",category:"reasoning",serviceKey:"nemotron"},{name:"GPT-OSS 20B",path:"inference.yml",category:"reasoning",serviceKey:"gptoss"}],Ms={workflows:Es},cn=Ms.workflows;new Map(cn.map(t=>[t.name,t.path]));new Map(cn.filter(t=>t.serviceKey).map(t=>[t.serviceKey,t.name]));const _e={githubToken:"",profile:"local_all",chatApiBaseUrl:"http://localhost:8080",modelsBaseDomain:"",modelsUseHttps:!1};function on(t){const s={..._e,...t};(!s.chatApiBaseUrl||typeof s.chatApiBaseUrl!="string")&&typeof s.baseDomain=="string"&&(s.chatApiBaseUrl=s.baseDomain?`${s.useHttps===!1?"http":"https"}://chat.${s.baseDomain}`:"http://localhost:8080",s.profile="custom"),(!s.modelsBaseDomain||typeof s.modelsBaseDomain!="string")&&typeof s.baseDomain=="string"&&(s.modelsBaseDomain=s.baseDomain,s.profile="custom"),typeof s.modelsUseHttps!="boolean"&&typeof s.useHttps=="boolean"&&(s.modelsUseHttps=s.useHttps,s.profile="custom");const r=s.profile==="remote_all"||s.profile==="local_chat_remote_models"||s.profile==="local_all"||s.profile==="custom"?s.profile:_e.profile;return{githubToken:typeof s.githubToken=="string"?s.githubToken:_e.githubToken,profile:r,chatApiBaseUrl:_t(typeof s.chatApiBaseUrl=="string"?s.chatApiBaseUrl:""),modelsBaseDomain:typeof s.modelsBaseDomain=="string"?s.modelsBaseDomain:_e.modelsBaseDomain,modelsUseHttps:typeof s.modelsUseHttps=="boolean"?s.modelsUseHttps:_e.modelsUseHttps}}function Cs(){var t;return typeof chrome<"u"&&!!((t=chrome.storage)!=null&&t.local)}function _t(t){const s=t.trim().replace(/\/+$/,"");return s||"http://localhost:8080"}function Ns(){const[t,s]=n.useState(_e),[r,a]=n.useState(!1);return n.useEffect(()=>{if(Cs()){chrome.storage.local.get(["envConfig"],i=>{const x=on(i.envConfig);s(x),a(!0);const d=_t(x.chatApiBaseUrl);rn(d),console.log("[Config] Extension mode, API base:",d)});const p=(i,x)=>{var d;if(x==="local"&&((d=i.envConfig)!=null&&d.newValue)){const c=on(i.envConfig.newValue);s(c);const f=_t(c.chatApiBaseUrl);rn(f),console.log("[Config] Updated API base:",f)}};return chrome.storage.onChanged.addListener(p),()=>chrome.storage.onChanged.removeListener(p)}else a(!0),console.log("[Config] Web mode, using relative URLs")},[]),{config:t,isLoaded:r}}function Rs(){const[t,s]=n.useState([]),r=n.useRef([]),a=n.useCallback(d=>{if(!d.length)return;const c=[...r.current,...d];r.current=c,s(c)},[]),p=n.useCallback(()=>{r.current=[],s([])},[]),i=n.useCallback(d=>d.map(c=>`${c.role==="user"?"User":"Assistant"}: ${c.content}`).join(`

`),[]),x=n.useCallback((d,c)=>{if(c==="compare")return d;const f=d.filter(h=>h.role==="user"),u=[...d].reverse().find(h=>h.role==="assistant"&&h.kind==="analyze_synthesis"&&h.content.trim().length>0);return u?[...f,u]:f},[]);return{history:t,historyRef:r,pushHistoryEntries:a,clearHistory:p,historyToText:i,buildCarryoverHistory:x}}function Ls(t){const s=n.useRef({}),r=n.useRef(null),a=n.useCallback(()=>{r.current=null;const c=s.current;s.current={},Object.keys(c).length&&t(u=>u.map(h=>{const k=c[h.id];return k?{...h,response:(h.response||"")+k.answer,thinking:(h.thinking||"")+k.thinking}:h}))},[t]),p=n.useCallback(()=>{r.current==null&&(r.current=requestAnimationFrame(a))},[a]),i=n.useCallback((c,f,u)=>{if(!f&&!u)return;const h=s.current[c]||{answer:"",thinking:""};h.answer+=f,h.thinking+=u,s.current[c]=h,p()},[p]),x=n.useCallback(c=>{s.current[c]&&delete s.current[c]},[]),d=n.useCallback(()=>{s.current={},r.current!=null&&(cancelAnimationFrame(r.current),r.current=null)},[]);return{pendingStreamRef:s,flushStreamRafRef:r,enqueueStreamDelta:i,clearPendingStreamForModel:x,resetPendingStream:d}}function As(t,s){const r={...s};let a=r.carry+t;r.carry="";const p=a.lastIndexOf("<");if(p!==-1&&a.length-p<12){const c=a.slice(p);("<think>".startsWith(c)||"</think>".startsWith(c)||"<thinking>".startsWith(c)||"</thinking>".startsWith(c))&&(r.carry=c,a=a.slice(0,p))}let i="",x="";if(r.harmonyFormat){const c="<|channel|>final<|message|>",f=a.indexOf(c);if(f!==-1)r.inThink&&(i+=a.slice(0,f)),r.inThink=!1,x+=a.slice(f+c.length);else if(r.inThink){const u=a.replace(/<\|channel\|>analysis<\|message\|>/gi,"").replace(/<\|end\|>/gi,"").replace(/<\|start\|>/gi,"").replace(/assistant/gi,"");i+=u}else{const u=a.replace(/<\|end\|>/gi,"");x+=u}return{answerAdd:x,thinkingAdd:i,newState:r}}if(!r.inThink&&!r.implicitThinking){const c=a.indexOf("</think>"),f=a.indexOf("</thinking>"),u=c!==-1||f!==-1,h=a.indexOf("<think>")!==-1||a.indexOf("<thinking>")!==-1;u&&!h&&(r.implicitThinking=!0,r.inThink=!0)}let d=0;for(;d<a.length;)if(r.inThink){const c=a.indexOf("</think>",d),f=a.indexOf("</thinking>",d);let u=-1,h=0;if(c!==-1&&(f===-1||c<f)?(u=c,h=8):f!==-1&&(u=f,h=11),u===-1){i+=a.slice(d);break}i+=a.slice(d,u),r.inThink=!1,r.implicitThinking=!1,d=u+h}else{const c=a.indexOf("<think>",d),f=a.indexOf("<thinking>",d);let u=-1,h=0;if(c!==-1&&(f===-1||c<f)?(u=c,h=7):f!==-1&&(u=f,h=10),u===-1){x+=a.slice(d);break}x+=a.slice(d,u),r.inThink=!0,d=u+h}return{answerAdd:x,thinkingAdd:i,newState:r}}function _s(t){const{mode:s,moderator:r,selected:a,selectedCardIds:p,githubToken:i,isGenerating:x,summarizeSessionResponses:d,setLastQuery:c,setHoveredCard:f,setPhaseLabel:u,setModeratorSynthesis:h,setDiscussionTurnsByModel:k,resetFailedModels:L,markModelFailed:A,failedModelsRef:$,currentDiscussionTurnRef:b,sessionModelIdsRef:l,abortControllerRef:v,thinkingStateRef:B,conversationHistoryRef:W,pushHistoryEntries:P,historyToText:E,buildCarryoverHistory:Q,setModelsData:U,modelIdToName:z,setExecutionTimes:M,setIsGenerating:K,setIsSynthesizing:O,setSpeaking:Z,enqueueStreamDelta:X,clearPendingStreamForModel:H,resetPendingStream:y}=t;return{sendMessage:async(ge,xe,ae,V)=>{if(!ge.trim()||a.length===0&&!ae||!ae&&x)return;const ue=(V==null?void 0:V.skipHistory)??!1,ie={role:"user",content:ge},Se=ue?W.current:[...W.current,ie];ue||P([ie]);const re=Q(Se,s),Te=E(re);c(ge);const _=Te?`${Te}

Continue the conversation above and respond to the latest user request.`:ge;let te;if(ae)te=ae;else{const D=Array.from(p).filter(S=>a.includes(S)&&(s==="compare"||S!==r));te=D.length>0?D:a.slice()}l.current=te;const ce={},ye=(D,S,w)=>{if(!S)return;const T=w!=null&&w.label?`${w.label}: ${S}`:S;ce[D]=w!=null&&w.replace?T:ce[D]?`${ce[D]}

${T}`:T},oe=new AbortController;v.current=oe,K(!0),O(!1),f(null),u(null),h(""),k({}),L(),b.current=null,y(),U(D=>D.map(S=>te.includes(S.id)||S.id===r?xe&&xe[S.id]?{...S,response:xe[S.id],thinking:void 0,error:void 0}:{...S,response:"",thinking:void 0,error:void 0}:S)),M(D=>{const S={...D},w=performance.now();return te.forEach(T=>{S[T]={startTime:w}}),r&&!S[r]&&(S[r]={startTime:w}),S});const ve=new Set(te);r&&ve.add(r),ve.forEach(D=>{const S=cs(D),w=ds(D);B.current[D]={inThink:S||w,carry:"",implicitThinking:S,harmonyFormat:w}});const fe=new Set,je=(D,S)=>{const w=D==null?void 0:D.trim();!w||ue||P([{role:"assistant",content:w,kind:S}])},Ee=(D,S)=>{const w=B.current[D]||{inThink:!1,carry:"",implicitThinking:!1},{answerAdd:T,thinkingAdd:j,newState:R}=As(S,w);B.current[D]=R,T&&ye(D,T),(j||T)&&X(D,T,j)},Me=D=>{const S=D.toLowerCase();return S.includes("rate limit")||S.includes("waiting")?'<svg width="14" height="14" viewBox="0 0 24 24" fill="none" style="display: inline-block; vertical-align: text-bottom; margin-right: 6px;"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none"/><path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>'+D:S.includes("error")||S.includes("failed")?'<svg width="14" height="14" viewBox="0 0 24 24" fill="none" style="display: inline-block; vertical-align: text-bottom; margin-right: 6px;"><path d="M12 2L2 20h20L12 2z" stroke="currentColor" stroke-width="2" fill="none" stroke-linejoin="round"/><path d="M12 9v4M12 17h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>'+D:D};try{if(s==="compare"){Z(new Set(te));const D=await js({models:te,messages:Se.map(S=>({role:S.role,content:S.content})),max_tokens:Qe.maxTokens,temperature:Qe.temperature,github_token:i||null},oe.signal);if(await Lt(D,S=>{if(S.event==="info"&&S.content){const w=String(S.content),T=Me(w);u(T),S.model_id&&U(j=>j.map(R=>R.id===S.model_id?{...R,statusMessage:T}:R))}if(S.event==="token"&&S.model_id){const w=S.model_id,T=performance.now();fe.has(w)||(fe.add(w),M(j=>({...j,[w]:{...j[w],firstTokenTime:T}})),U(j=>j.map(R=>R.id===w?{...R,statusMessage:void 0}:R))),Ee(w,String(S.content??""))}if(S.event==="done"&&S.model_id){const w=performance.now(),T=S.model_id;M(j=>({...j,[T]:{...j[T],endTime:w}})),Z(j=>{const R=new Set(j);return R.delete(T),R})}}),!ue){const S=d(ce,te);S&&P([{role:"assistant",content:S,kind:"compare_summary"}])}return}if(s==="analyze"){const D=te;if(D.length<2){const T="Select at least 2 participants for Analyze mode.";h(T),r&&U(j=>j.map(R=>R.id===r?{...R,response:T}:R)),u("Error");return}Z(new Set(D));const S=await Ss({query:_,participants:D,max_tokens:Qe.maxTokens,github_token:i||null},oe.signal);let w="";if(await Lt(S,T=>{const j=T.event;if(j==="analyze_start"&&u("Collecting Responses"),j==="model_start"&&T.model_id){const R=T.model_id;Z(ee=>{const q=new Set(ee);return q.add(R),q})}if(j==="model_chunk"&&T.model_id){const R=T.model_id,ee=performance.now();fe.has(R)||(fe.add(R),M(q=>({...q,[R]:{...q[R],firstTokenTime:ee}}))),Ee(R,String(T.chunk??""))}if(j==="model_response"&&T.model_id){const R=T.model_id,ee=performance.now();M(Y=>({...Y,[R]:{...Y[R],endTime:ee}})),Z(Y=>{const J=new Set(Y);return J.delete(R),J});const q=String(T.response??"");ye(R,q,{replace:!0}),xe&&xe[R]||(U(Y=>Y.map(J=>J.id===R?{...J,response:q}:J)),je(`${z(R)}:
${q}`,"analyze_response"))}if(j==="model_error"&&T.model_id){const R=T.model_id,ee=performance.now();M(Y=>({...Y,[R]:{...Y[R],endTime:ee}})),Z(Y=>{const J=new Set(Y);return J.delete(R),J});const q=String(T.error??"Error generating response.");H(R),U(Y=>Y.map(J=>J.id===R?{...J,response:q,error:q}:J)),A(R),ye(R,q,{replace:!0})}if(j==="analysis_complete"){u("Analysis Complete");const R=T.consensus||[],ee=T.unique_contributions||{};let q=`Analysis:

`;if(R.length>0&&(q+=`Consensus:
`+R.map(Y=>`• ${Y}`).join(`
`)+`

`),Object.keys(ee).length>0){q+=`Unique Contributions:
`;for(const[Y,J]of Object.entries(ee)){const De=z(Y);q+=`
${De}:
`+J.map(he=>`• ${he}`).join(`
`)+`
`}}w=q,h(q),r&&U(Y=>Y.map(J=>J.id===r?{...J,response:q}:J))}if(j==="analyze_complete"&&(u("Complete"),Z(new Set)),j==="error"){const R=String(T.error??"Analyze error.");h(R),u("Error")}}),!ue){const T=w.trim();T&&P([{role:"assistant",content:T,kind:"analyze_synthesis"}])}return}if(s==="debate"){const D=te;if(D.length<2){const w="Select at least 2 participants for Debate mode.";h(w),r&&U(T=>T.map(j=>j.id===r?{...j,response:w}:j)),u("Error");return}const S=await Ts({query:_,participants:D,turns:2,max_tokens:Qe.maxTokens,temperature:Qe.temperature,github_token:i||null},oe.signal);await Lt(S,w=>{const T=w.event;if(T==="debate_start"&&u("Debate Starting"),T==="round_start"){const j=w.round_number??0;u(`Round ${j+1}`)}if(T==="turn_start"&&w.model_id){const j=w.model_id,R=w.turn_number??0,ee=w.round_number??0;Z(new Set([j])),u(`Round ${ee+1} · Turn ${R+1}`),b.current={modelId:j,turnNumber:R}}if(T==="turn_chunk"&&w.model_id){const j=w.model_id,R=performance.now();fe.has(j)||(fe.add(j),M(ee=>({...ee,[j]:{...ee[j],firstTokenTime:R}}))),Ee(j,String(w.chunk??""))}if(T==="turn_complete"&&w.model_id){const j=w.model_id,R=performance.now();M(Y=>({...Y,[j]:{...Y[j],endTime:R}})),Z(Y=>{const J=new Set(Y);return J.delete(j),J});const ee=String(w.response??""),q=w.turn_number??0;ye(j,ee,{replace:!0}),U(Y=>Y.map(J=>J.id===j?{...J,response:ee}:J)),k(Y=>({...Y,[j]:[...Y[j]||[],{turn_number:q,response:ee}]})),je(`${z(j)}:
${ee}`,"debate_turn")}if(T==="turn_error"&&w.model_id){const j=w.model_id,R=performance.now();M(q=>({...q,[j]:{...q[j],endTime:R}})),Z(q=>{const Y=new Set(q);return Y.delete(j),Y});const ee=String(w.error??"Turn error.");H(j),U(q=>q.map(Y=>Y.id===j?{...Y,response:ee,error:ee}:Y)),A(j)}if(T==="debate_complete"&&(u("Complete"),Z(new Set)),T==="error"){const j=String(w.error??"Debate error.");u("Error"),h(j)}});return}}catch(D){if(D.name==="AbortError")return;if(console.error("Chat error:",D),v.current===oe){const S=D.message||String(D);h(`Session Error: ${S}`),u("Error"),y(),U(w=>w.map(T=>te.includes(T.id)&&!T.response?{...T,response:"Error generating response."}:T)),te.forEach(w=>A(w))}}finally{if(v.current===oe){const D=performance.now();M(S=>{const w={...S};return l.current.forEach(T=>{w[T]&&!w[T].endTime&&(w[T]={...w[T],endTime:D})}),w}),K(!1),O(!1),u(S=>S==="Error"?S:null),Z(new Set)}}}}}function At(t,s){const r=Math.min(t.x,s.x),a=Math.min(t.y,s.y),p=Math.max(t.x,s.x),i=Math.max(t.y,s.y);return{left:r,top:a,right:p,bottom:i,width:p-r,height:i-a}}function zs({rootContainerRef:t,visualizationAreaRef:s,arenaOffsetYRef:r,arenaTargetYRef:a,wheelRafRef:p,selectedModels:i,cardRefs:x,selectedCardIds:d,setSelectedCardIds:c,suppressClickRef:f}){const[u,h]=n.useState(null),k=n.useRef(!1);n.useEffect(()=>{k.current=u!=null},[u]),n.useEffect(()=>{const $=b=>{if(b.button!==0||!t.current)return;const l=b.target;if(!l)return;const v=l.closest("[data-card]"),B=l.closest('button, a, input, textarea, select, [role="button"]'),W=l.closest("[draggable]"),P=l.closest("[data-no-arena-scroll]");if(v||B||W||P||!t.current.contains(l))return;a.current=r.current,p.current!=null&&(cancelAnimationFrame(p.current),p.current=null);const E=t.current.getBoundingClientRect(),Q={x:b.clientX-E.left,y:b.clientY-E.top};b.preventDefault(),k.current=!0,f.current.card=!1,f.current.background=!1,h({origin:Q,current:Q,active:!1})};return window.addEventListener("mousedown",$,!0),()=>window.removeEventListener("mousedown",$,!0)},[r,a,p,t,s,f]),n.useEffect(()=>{if(!u||!t.current)return;const $=v=>v.preventDefault();document.addEventListener("selectstart",$);const b=v=>{const B=t.current.getBoundingClientRect(),W={x:v.clientX-B.left,y:v.clientY-B.top};h(P=>{if(!P)return P;const E=At(P.origin,W),Q=P.active||E.width>4||E.height>4;return{...P,current:W,active:Q}})},l=v=>{k.current=!1;const B=t.current.getBoundingClientRect(),W={x:v.clientX-B.left,y:v.clientY-B.top},P=v.target,E=!!(P&&P.closest("[data-card]"));h(Q=>{if(!Q)return null;const U=At(Q.origin,W);if(Q.active&&U.width>0&&U.height>0){const z=[],M=t.current.getBoundingClientRect(),K={left:M.left+U.left,right:M.left+U.right,top:M.top+U.top,bottom:M.top+U.bottom};for(const O of i){const Z=x.current.get(O.id);if(!Z)continue;const X=Z.getBoundingClientRect();!(X.right<K.left||X.left>K.right||X.bottom<K.top||X.top>K.bottom)&&z.push(O.id)}c(new Set(z)),E?f.current.card=!0:z.length>0&&(f.current.background=!0)}return null})};return window.addEventListener("mousemove",b),window.addEventListener("mouseup",l),()=>{window.removeEventListener("mousemove",b),window.removeEventListener("mouseup",l),document.removeEventListener("selectstart",$)}},[u,t,s,i,x,d,c,f]);const L=n.useMemo(()=>{if(!u||!u.active)return null;const $=At(u.origin,u.current);return $.width<=0||$.height<=0?null:{left:$.left,top:$.top,width:$.width,height:$.height}},[u]),A=n.useCallback(()=>{h(null),k.current=!1},[]);return{selectionRect:L,isSelecting:u!=null,dragSelectionActiveRef:k,clearSelection:A}}function Is({visualizationAreaRef:t,cardRefs:s,selected:r,setSelected:a,mode:p,gridCols:i,getCirclePosition:x}){const[d,c]=n.useState(null),f=n.useCallback((u,h)=>{if(u.button!==0||u.target.closest('button, a, input, textarea, select, [role="button"]'))return;u.preventDefault();const L=s.current.get(h);if(!L||!t.current)return;const A=L.getBoundingClientRect(),$=t.current.getBoundingClientRect(),b=A.left+A.width/2,l=A.top+A.height/2;c({activeId:h,currX:u.clientX,currY:u.clientY,offsetX:b-u.clientX,offsetY:l-u.clientY,containerLeft:$.left,containerTop:$.top,containerWidth:$.width,containerHeight:$.height,cardHeight:A.height}),u.target.setPointerCapture(u.pointerId)},[t]);return n.useEffect(()=>{if(!d)return;const u=k=>{if(c(l=>l?{...l,currX:k.clientX,currY:k.clientY}:null),!t.current)return;const L=t.current.getBoundingClientRect(),A=r.indexOf(d.activeId);let $=1/0,b=-1;if(p==="compare"){const l=k.clientX-(L.left+L.width/2),v=k.clientY-L.top,B=(se.cardWidth+se.gapX)*i-se.gapX;r.forEach((W,P)=>{const E=Math.floor(P/i),U=P%i*(se.cardWidth+se.gapX)-B/2+se.cardWidth/2,z=E*(se.cardHeight+se.gapY),M=U,K=z+se.cardHeight/2,O=(l-M)**2+(v-K)**2;O<$&&($=O,b=P)})}else{const l=k.clientX-(L.left+L.width/2),v=k.clientY-(L.top+L.height/2),B=Math.max(se.baseRadius,se.minRadius+r.length*se.radiusPerModel);r.forEach((W,P)=>{const E=x(P,r.length,p,B),Q=(l-E.x)**2+(v-E.y)**2;Q<$&&($=Q,b=P)})}if(b!==-1&&b!==A){const l=[...r],[v]=l.splice(A,1);l.splice(b,0,v),a(l)}},h=()=>c(null);return window.addEventListener("pointermove",u),window.addEventListener("pointerup",h),()=>{window.removeEventListener("pointermove",u),window.removeEventListener("pointerup",h)}},[d,t,s,r,a,p,i,x]),{dragState:d,handlePointerDown:f}}function $s({mode:t,showSettings:s,showDock:r,contextMenu:a,selectedCardIds:p,selected:i,inputRef:x,setShowSettings:d,setShowDock:c,setContextMenu:f,setSelected:u,setSelectedCardIds:h,clearSelection:k,setHoveredCard:L,handleModeChange:A}){n.useEffect(()=>{const $=b=>{if(b.key==="Escape"){const v=document.activeElement;if(v&&v!==document.body&&v.blur(),s){d(!1);return}if(a){f(null);return}if(p.size>0){k(),L(null);return}if(r){c(!1);return}L(null);return}if((b.metaKey||b.ctrlKey)&&(b.key==="a"||b.key==="A")){const v=b.target;if(v.tagName==="INPUT"||v.tagName==="TEXTAREA"||t==="chat")return;b.preventDefault(),i.length>0&&h(new Set(i));return}const l=b.target;if(!(l.tagName==="INPUT"||l.tagName==="TEXTAREA")){if(b.key==="ArrowRight"||b.key==="ArrowLeft"){b.preventDefault();const v=["chat","compare","analyze","debate"],B=v.indexOf(t);if(B!==-1){const W=b.key==="ArrowRight"?1:-1,P=(B+W+v.length)%v.length;A(v[P])}return}if(b.key==="m"||b.key==="M"){b.preventDefault(),c(!r);return}if((b.key==="Delete"||b.key==="Backspace")&&p.size>0){b.preventDefault(),u(v=>v.filter(B=>!p.has(B))),k();return}b.key.length===1&&!b.ctrlKey&&!b.metaKey&&!b.altKey&&x.current&&x.current.focus()}};return window.addEventListener("keydown",$),()=>window.removeEventListener("keydown",$)},[r,s,a,p,t,i,x,d,c,f,u,h,k,L,A])}function Ds({visualizationAreaRef:t,dragSelectionActiveRef:s}){const r=n.useRef(0),a=n.useRef(0),p=n.useRef(null),i=n.useRef(!1),x=n.useRef(0),d=h=>{const k=t.current;k&&k.style.setProperty("--arena-offset-y",`${h}px`)},c=h=>Math.max(-200,Math.min(se.scrollClamp,h)),f=()=>{const h=r.current,k=a.current,L=k-h;if(Math.abs(L)<.5){r.current=k,d(k),p.current=null;return}const A=h+L*.35;r.current=A,d(A),p.current=requestAnimationFrame(f)},u=()=>{p.current==null&&(p.current=requestAnimationFrame(f))};return n.useEffect(()=>{const h=b=>{if(s.current)return;const l=b.target;if(l&&l.closest("input, textarea, [data-no-arena-scroll]"))return;b.preventDefault();const v=b.deltaY*.9,B=a.current-v;a.current=c(B),u()},k=b=>b?!!b.closest('input, textarea, [data-no-arena-scroll], [data-card], button, a, select, [role="button"]'):!1,L=b=>{if(b.touches.length!==1)return;const l=b.target;k(l)||(i.current=!0,x.current=b.touches[0].clientY)},A=b=>{if(s.current||!i.current||b.touches.length!==1)return;const l=b.target;if(k(l)){i.current=!1;return}const v=b.touches[0].clientY,B=v-x.current;x.current=v,b.preventDefault(),a.current=c(a.current+B),u()},$=()=>{i.current=!1};return window.addEventListener("touchstart",L,{passive:!0}),window.addEventListener("touchmove",A,{passive:!1}),window.addEventListener("touchend",$),window.addEventListener("touchcancel",$),window.addEventListener("wheel",h,{passive:!1}),()=>{window.removeEventListener("touchstart",L),window.removeEventListener("touchmove",A),window.removeEventListener("touchend",$),window.removeEventListener("touchcancel",$),window.removeEventListener("wheel",h),p.current!=null&&cancelAnimationFrame(p.current)}},[]),{arenaOffsetYRef:r,arenaTargetYRef:a,wheelRafRef:p,applyOffset:d,clampTarget:c,ensureRaf:u}}function we(t,s){return!t||!t.startsWith("#")?t:t.length===7||t.length===4?`${t}${s}`:t}const Ps={idle:"Ready",responding:"Responding",done:"Done",waiting:"Waiting",error:"Error"};function zt({state:t,color:s,size:r=16,label:a,className:p=""}){const i={width:`${r}px`,height:`${r}px`},x=a??Ps[t],d=Math.max(2,Math.round(r*.14)),c=Math.max(12,r-2),f="#fbbf24",u=we(s,"cc"),h=()=>{switch(t){case"responding":return e.jsx("div",{className:"relative flex items-center justify-center",style:i,children:e.jsxs("svg",{width:c,height:c,viewBox:"0 0 24 24",fill:"none",className:"",style:{filter:`drop-shadow(0 0 6px ${we(f,"55")})`,animation:"spin 0.6s linear infinite"},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"spinnerGradient",gradientUnits:"userSpaceOnUse",x1:"3",y1:"12",x2:"12",y2:"3",children:[e.jsx("stop",{offset:"0%",stopColor:f,stopOpacity:"1"}),e.jsx("stop",{offset:"60%",stopColor:f,stopOpacity:"0.5"}),e.jsx("stop",{offset:"100%",stopColor:f,stopOpacity:"0"})]})}),e.jsx("circle",{cx:"12",cy:"12",r:"9",stroke:we(f,"15"),strokeWidth:d,fill:"none"}),e.jsx("path",{d:"M 12 3 A 9 9 0 1 1 3 12",stroke:"url(#spinnerGradient)",strokeWidth:d,strokeLinecap:"round",fill:"none"}),e.jsx("circle",{cx:"3",cy:"12",r:d*.7,fill:f})]})});case"done":return e.jsx("div",{className:"flex items-center justify-center rounded-full",style:{...i,background:we(s,"14"),border:`1px solid ${we(s,"99")}`},children:e.jsx("svg",{width:c,height:c,viewBox:"0 0 24 24",fill:"none",children:e.jsx("polyline",{points:"5 13 10 18 19 7",stroke:s,strokeWidth:d,strokeLinecap:"round",strokeLinejoin:"round"})})});case"error":const k="#ef4444";return e.jsx("div",{className:"flex items-center justify-center rounded-full",style:{...i,background:we(k,"14"),border:`1px solid ${we(k,"99")}`},children:e.jsx("svg",{width:c,height:c,viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M6 6L18 18M6 18L18 6",stroke:k,strokeWidth:d,strokeLinecap:"round",strokeLinejoin:"round"})})});case"waiting":return e.jsxs("div",{className:"relative flex items-center justify-center",style:i,children:[e.jsx("div",{className:"absolute inset-0 rounded-full",style:{border:`1px solid ${we(u,"99")}`}}),e.jsx("svg",{width:c,height:c,viewBox:"0 0 24 24",fill:"none",style:{animation:"spin 5s linear infinite"},children:e.jsx("circle",{cx:"12",cy:"12",r:"8.5",stroke:we(u,"44"),strokeWidth:d-1,strokeDasharray:"6 10",strokeLinecap:"round"})}),e.jsx("div",{className:"absolute w-2 h-2 rounded-full",style:{background:we(u,"aa"),animation:"pulse 1.5s ease-in-out infinite"}})]});default:return e.jsxs("div",{className:"relative flex items-center justify-center",style:i,children:[e.jsx("div",{className:"absolute inset-0 rounded-full",style:{border:"1px solid rgba(71, 85, 105, 0.5)"}}),e.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:"rgba(148, 163, 184, 0.6)",animation:"pulse 2.4s ease-in-out infinite"}})]})}};return e.jsx("div",{className:`inline-flex items-center justify-center ${p}`,title:x,children:h()})}function an({times:t,isFastestTTFT:s,isFastestTotal:r}){const a=(t==null?void 0:t.startTime)!=null,p=(t==null?void 0:t.endTime)!=null,i=(t==null?void 0:t.firstTokenTime)!=null,x=a&&p?((t.endTime-t.startTime)/1e3).toFixed(2):null,d=a&&i?((t.firstTokenTime-t.startTime)/1e3).toFixed(2):null;return e.jsxs("div",{className:"text-[10px] text-slate-500 flex items-center gap-2",children:[e.jsxs("span",{className:r?"text-yellow-400/90 bg-yellow-500/10 px-1.5 py-0.5 rounded":void 0,title:r?"Fastest":void 0,children:[e.jsx("span",{className:r?void 0:"text-slate-400",children:"TIME"})," ",x?`${x}s`:a&&!p?"...":"—"]}),d&&e.jsxs("span",{className:s?"text-amber-400/90 bg-amber-500/10 px-1.5 py-0.5 rounded":"text-slate-600",title:s?"Fastest TTFT":void 0,children:["TTFT ",d,"s"]})]})}const $t=({text:t,speed:s=5})=>{const[r,a]=n.useState(""),p=n.useRef(0),i=n.useRef(null);return n.useEffect(()=>{!t.startsWith(r)&&r!==""&&(a(""),p.current=0)},[t]),n.useEffect(()=>{i.current!=null&&(clearTimeout(i.current),i.current=null);const x=t.length;if(p.current>=x)return;const d=()=>{const c=p.current,f=x-c;if(f<=0)return;const u=f>120?12:f>40?4:f>10?2:1,h=Math.min(x,c+u);p.current=h,a(t.slice(0,h));const L=x-h>5?0:s;i.current=window.setTimeout(d,L)};return i.current=window.setTimeout(d,s),()=>{i.current!=null&&(clearTimeout(i.current),i.current=null)}},[t,s]),e.jsx("span",{children:r})},ht=96;function Bs(t){switch(t){case"error":return"Error";case"responding":return"Responding";case"done":return"Done";case"waiting":return"Waiting";default:return"Ready"}}function Os({mode:t,layoutRadius:s,moderatorModel:r,moderatorId:a,orchestratorTransform:p,orchestratorStatus:i,moderatorSynthesis:x,isSynthesizing:d,isGenerating:c,phaseLabel:f,speaking:u,hoveredCard:h,setHoveredCard:k,setSelectedCardIds:L,lastSelectedCardRef:A,orchestratorAutoMode:$,orchestratorAutoScope:b,showOrchestratorMenu:l,setShowOrchestratorMenu:v,setOrchestratorAutoMode:B,setOrchestratorAutoScope:W,orchestratorMenuRef:P,availableModels:E,setModerator:Q,getTailSnippet:U}){const[z,M]=n.useState(null),K=Bs(i),O=f||"";n.useEffect(()=>{if(!l)return;const y=pe=>{P.current&&!P.current.contains(pe.target)&&(v(!1),M(null))};return document.addEventListener("mousedown",y,!0),()=>document.removeEventListener("mousedown",y,!0)},[l,P,v]);const Z=()=>{if(x)return d&&a&&u.has(a)?e.jsx($t,{text:x,speed:20}):U(x);if(d)return e.jsx("span",{className:"text-slate-500 italic",children:"Synthesizing responses..."});if(c){if(f!=null&&f.startsWith("<svg"))return e.jsx("span",{className:"text-slate-500 italic",dangerouslySetInnerHTML:{__html:f}});const y=f==="Stage 1 · Responses"?"Waiting for model responses...":f||"Orchestrating...";return e.jsx("span",{className:"text-slate-500 italic",children:y})}return e.jsx("span",{className:"text-slate-500 italic",children:"Send a prompt to see the synthesis."})},X=i==="responding",H=X?"#fbbf24":r.color;return e.jsxs("div",{"data-card":!0,className:"absolute z-20 transition-all duration-700 ease-out cursor-pointer",style:{opacity:1,transform:p,left:"50%",top:t==="analyze"?`calc(50% + ${s}px - 64px)`:"50%"},onClick:y=>{y.stopPropagation(),a&&(L(new Set([a])),A.current=a)},onContextMenu:y=>{y.preventDefault(),y.stopPropagation(),l?(v(!1),M(null)):(M({x:y.clientX,y:y.clientY}),v(!0))},onMouseEnter:()=>k("moderator"),onMouseLeave:()=>k(null),children:[e.jsxs("div",{className:"relative flex items-center justify-center",style:{width:`${ht}px`,height:`${ht}px`},children:[e.jsx("div",{className:"absolute inset-0 rounded-full animate-pulse",style:{background:`radial-gradient(circle, ${H}20 0%, transparent 70%)`,transform:"scale(2.2)",filter:"blur(18px)"}}),e.jsxs("div",{className:"relative rounded-full flex items-center justify-center transition-all duration-300",style:{width:`${ht}px`,height:`${ht}px`,background:X?"linear-gradient(135deg, rgba(251, 191, 36, 0.08), rgba(15, 23, 42, 0.9))":"rgba(15, 23, 42, 0.9)",backdropFilter:"blur(16px)",border:`2px solid ${H}${X?"99":"60"}`,boxShadow:`0 0 36px ${H}${X?"40":"28"}, inset 0 1px 1px rgba(255,255,255,0.1)`},children:[e.jsx("div",{className:"absolute inset-[-4px] rounded-full",style:{background:`conic-gradient(from 0deg, transparent, ${H}60, transparent)`,animation:"spin 4s linear infinite"}}),e.jsx("div",{className:"absolute inset-[2px] rounded-full",style:{background:"rgba(15, 23, 42, 0.96)"}}),e.jsxs("div",{className:"relative text-center z-10 flex flex-col items-center gap-1.5 px-3",children:[e.jsx("div",{className:"text-[7px] tracking-[0.32em] text-slate-400 uppercase",children:K}),e.jsx("div",{className:"text-[10px] font-semibold text-slate-100 leading-tight",children:r.name}),e.jsx(zt,{state:i,color:H,size:12})]})]})]}),e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 flex flex-col items-center gap-1 w-max max-w-[200px]",style:{top:"calc(100% + 12px)"},children:e.jsx("span",{className:"text-[10px] text-slate-500",children:O})}),h==="moderator"&&!l&&e.jsxs("div",{"data-card":!0,onClick:y=>y.stopPropagation(),className:"absolute bottom-full mb-4 left-1/2 -translate-x-1/2 w-80 max-w-[calc(100vw-2rem)] p-4 rounded-xl z-[200] transition-all duration-300",style:{background:"rgba(15, 23, 42, 0.95)",backdropFilter:"blur(16px)",border:`1px solid ${H}40`,boxShadow:`0 20px 40px rgba(0,0,0,0.5), 0 0 30px ${H}20`},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"Orchestrator"}),e.jsx("span",{className:"text-xs text-slate-500",children:"·"}),e.jsx("span",{className:"text-xs font-medium text-slate-300",children:r.name}),X&&e.jsx("span",{className:"text-[9px] uppercase tracking-wider px-1.5 py-0.5 rounded bg-yellow-500/20 text-yellow-300 border border-yellow-500/30",children:"Working"})]}),e.jsx("p",{className:"text-sm text-slate-300 leading-relaxed",children:Z()})]}),l&&z&&Jn.createPortal(e.jsx("div",{ref:P,className:"w-64 bg-slate-800 border border-slate-700 rounded-lg shadow-xl overflow-hidden",style:{position:"fixed",top:`${z.y}px`,left:`${z.x}px`,transform:"translateY(-50%)",zIndex:9999},onClick:y=>y.stopPropagation(),children:$?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-3 py-2 text-[10px] uppercase tracking-wider text-slate-500 font-semibold border-b border-slate-700/50",children:["Auto Mode: ",b==="self-hosted"?"SELF-HOSTED":b.toUpperCase()]}),["all","self-hosted","api"].map(y=>e.jsxs("button",{onClick:()=>{W(y),v(!1)},className:`w-full px-3 py-2 text-left text-xs font-medium transition-colors ${b===y?"bg-yellow-500/20 text-yellow-300":"text-slate-300 hover:bg-slate-700/50"}`,children:[y==="all"&&"All",y==="self-hosted"&&"Self-hosted",y==="api"&&"API",e.jsxs("span",{className:"text-[10px] text-slate-500 ml-1",children:[y==="all"&&"(self-hosted → API)",y==="self-hosted"&&"(no quota)",y==="api"&&"(cloud only)"]})]},y)),e.jsx("div",{className:"border-t border-slate-700",children:e.jsx("button",{onClick:()=>{B(!1),v(!1)},className:"w-full px-3 py-2 text-left text-xs font-medium text-slate-400 hover:bg-slate-700/50 transition-colors",children:"Manual Mode"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-3 py-2 text-[10px] uppercase tracking-wider text-slate-500 font-semibold border-b border-slate-700/50",children:"Select Orchestrator"}),E.filter(y=>y.type==="github"||y.type==="external").length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-3 py-1.5 text-[9px] uppercase tracking-wider text-slate-600 font-semibold",children:"GitHub Models"}),E.filter(y=>y.type==="github"||y.type==="external").map(y=>e.jsx("button",{onClick:()=>{Q(y.id),v(!1)},className:`w-full px-4 py-2 text-left text-xs font-medium transition-colors ${a===y.id?"bg-blue-500/20 text-blue-300":"text-slate-300 hover:bg-slate-700/50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:y.name}),a===y.id&&e.jsx("span",{className:"text-blue-400",children:"✓"})]})},y.id))]}),E.filter(y=>y.type==="self-hosted").length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-3 py-1.5 text-[9px] uppercase tracking-wider text-slate-600 font-semibold border-t border-slate-700/50 mt-1",children:"Self-Hosted Models"}),E.filter(y=>y.type==="self-hosted").map(y=>e.jsx("button",{onClick:()=>{Q(y.id),v(!1)},className:`w-full px-4 py-2 text-left text-xs font-medium transition-colors ${a===y.id?"bg-blue-500/20 text-blue-300":"text-slate-300 hover:bg-slate-700/50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:y.name}),a===y.id&&e.jsx("span",{className:"text-blue-400",children:"✓"})]})},y.id))]}),e.jsx("div",{className:"border-t border-slate-700",children:e.jsxs("button",{onClick:()=>{B(!0),v(!1)},className:"w-full px-3 py-2 text-left text-xs font-medium text-yellow-400 hover:bg-slate-700/50 transition-colors flex items-center gap-2",children:[e.jsx(Zn,{size:12}),e.jsx("span",{children:"Enable Auto Mode"})]})})]})}),document.body)]})}const mt=256,dn=200,ln=96;function Hs(t){const{mode:s,selectedModels:r,gridCols:a,speaking:p,selectedCardIds:i,setSelectedCardIds:x,executionTimes:d,failedModels:c,cardRefs:f,handlePointerDown:u,dragState:h,setContextMenu:k,suppressClickRef:L,getTailSnippet:A,hoveredCard:$,setHoveredCard:b,setExpandedModelId:l,layoutRadius:v,getCirclePosition:B,moderatorModel:W,moderatorId:P,orchestratorTransform:E,orchestratorStatus:Q,moderatorSynthesis:U,isSynthesizing:z,isGenerating:M,phaseLabel:K,linesTransitioning:O,lastSelectedCardRef:Z,orchestratorAutoMode:X,orchestratorAutoScope:H,showOrchestratorMenu:y,setShowOrchestratorMenu:pe,setOrchestratorAutoMode:ge,setOrchestratorAutoScope:xe,orchestratorMenuRef:ae,availableModels:V,setModerator:ue,fastestTTFT:ie,fastestTotal:Se}=t,re=s!=="compare",Te=s==="analyze"?v-64:0;return e.jsxs(e.Fragment,{children:[r.map((_,te)=>{var tt;const ce=B(te,r.length,s,v),ye=Ws(te,a),oe=p.has(_.id),ve=i.has(_.id),fe=c.has(_.id),je=!oe&&!fe&&!!((tt=d[_.id])!=null&&tt.endTime)&&_.response.trim().length>0,Me=qs(oe,je,fe,!oe&&!je&&!fe&&M&&s==="debate"),D=Ks(Me),S="#fbbf24",w="#ef4444",T=_.type==="self-hosted"?"#10b981":"#3b82f6",j=fe?w:T,R=oe&&!fe,ee=Vs({hasError:fe,isProcessing:R,isSelected:ve,errorColor:w,processingColor:S,typeColor:T}),q=Ys({mode:s,gridX:ye.gridX,gridY:ye.gridY,circleX:ce.x,circleY:ce.y,dragState:h,modelId:_.id}),Y=$===_.id,J=re?ln:mt,De=re?ln:dn,he=Math.max(800,v*2+600),ne=he/2,Je=ne,Ze=ne,Pe=ne+(0-ce.x),et=ne+(Te-ce.y);return e.jsxs("div",{ref:de=>{de?f.current.set(_.id,de):f.current.delete(_.id)},onPointerDown:de=>u(de,_.id),className:"absolute",onContextMenu:de=>{de.preventDefault(),de.stopPropagation(),k({x:de.clientX,y:de.clientY,modelId:_.id})},style:{transform:q,zIndex:re?Y?300:ve?40:oe?15:5:ve?20:oe?10:1,left:"50%",top:re?"50%":"0",transition:(h==null?void 0:h.activeId)===_.id?"none":"transform 300ms cubic-bezier(0.2, 0, 0.2, 1)"},children:[re&&oe&&!fe&&!O&&e.jsxs("svg",{className:"absolute pointer-events-none",style:{width:`${he}px`,height:`${he}px`,top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:-1},viewBox:`0 0 ${he} ${he}`,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:`grad-${_.id}`,gradientUnits:"userSpaceOnUse",x1:Je,y1:Ze,x2:Pe,y2:et,children:[e.jsx("stop",{offset:"0%",stopColor:S,stopOpacity:"0.45"}),e.jsx("stop",{offset:"100%",stopColor:S,stopOpacity:"0.12"})]})}),e.jsx("line",{x1:Je,y1:Ze,x2:Pe,y2:et,stroke:`url(#grad-${_.id})`,strokeWidth:"2",strokeDasharray:"6,4",strokeLinecap:"round",className:"animate-flow arena-link"})]}),e.jsxs("div",{"data-card":!0,onClick:de=>Fs({e:de,modelId:_.id,suppressClickRef:L,setSelectedCardIds:x,selectedModels:r,lastSelectedCardRef:Z}),onDoubleClick:de=>{de.stopPropagation(),!re&&l&&l(_.id)},onMouseEnter:()=>re&&b(_.id),onMouseLeave:()=>re&&b(null),className:`relative cursor-grab active:cursor-grabbing card-hover ${re?"rounded-full":""} ${ve?"card-selected":""} ${oe?"card-speaking":""}`,style:{background:ee.background,backdropFilter:re?void 0:"blur(8px)",WebkitBackdropFilter:re?void 0:"blur(8px)",border:ee.border,boxShadow:ee.shadow,transform:ve||R?"scale(1.05)":"scale(1)",width:`${J}px`,height:`${De}px`,borderRadius:re?"50%":"12px",transition:"transform 180ms ease-out, box-shadow 180ms ease-out, border-color 180ms ease-out, width 0.7s cubic-bezier(0.4, 0, 0.2, 1), height 0.7s cubic-bezier(0.4, 0, 0.2, 1), border-radius 0.7s cubic-bezier(0.4, 0, 0.2, 1)"},children:[!re&&e.jsxs("div",{style:Us,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3 gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5 min-w-0",children:[e.jsx(zt,{state:Me,color:j,size:16,label:D}),e.jsx("span",{className:"text-xs font-semibold text-slate-200 truncate",children:_.name})]}),e.jsx("div",{className:"flex items-center gap-1.5 shrink-0",children:e.jsx("span",{className:`text-[9px] uppercase tracking-wider px-1.5 py-0.5 rounded ${_.type==="self-hosted"?"bg-emerald-500/10 text-emerald-300 border border-emerald-500/30":"bg-blue-500/10 text-blue-300 border border-blue-500/30"}`,children:_.type==="self-hosted"?"Self-hosted":"API"})})]}),e.jsx("p",{className:"text-xs text-slate-400 leading-relaxed line-clamp-3 flex-1",children:Xs({model:_,isSpeaking:oe,thinkingFallback:e.jsx("span",{className:"text-slate-500 italic",children:"Thinking…"}),getTailSnippet:A})}),e.jsx("div",{className:"flex items-center gap-4 mt-3 pt-3 border-t border-slate-700/50",children:e.jsx(an,{times:d[_.id],isFastestTTFT:ie===_.id,isFastestTotal:Se===_.id})})]}),re&&e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center text-center",style:{transition:"opacity 0.3s ease-out"},children:[e.jsx("div",{className:"absolute inset-[3px] rounded-full border border-white/5",style:{boxShadow:`inset 0 0 20px ${j}15`}}),e.jsx("div",{className:"absolute inset-[-6px] rounded-full opacity-60",style:{background:`radial-gradient(circle, ${j}22 0%, transparent 65%)`,filter:"blur(10px)"}}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center gap-1.5 px-3",children:[e.jsx("div",{className:"text-[7px] tracking-[0.32em] text-slate-400 uppercase",children:D}),e.jsx("div",{className:"text-[10px] font-semibold text-slate-100 leading-tight",children:_.name}),e.jsx(zt,{state:Me,color:j,size:12})]})]})]}),s==="analyze"&&re&&_.personaEmoji&&e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 flex items-center justify-center pointer-events-none select-none",style:{bottom:"-12px",fontSize:"20px",zIndex:100,transition:"transform 180ms ease-out",transform:oe?"scale(1.15)":"scale(1)",filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.5)) drop-shadow(0 0 8px rgba(0,0,0,0.3))"},title:_.personaName?`${_.personaName} - ${_.personaTrait}`:"Persona",children:_.personaEmoji}),re&&oe&&_.thinking&&_.thinking.trim().length>0&&_.response.trim().length===0&&e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 flex items-center justify-center pointer-events-none select-none animate-pulse",style:{bottom:"-12px",fontSize:"18px",zIndex:100,filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.5)) drop-shadow(0 0 10px rgba(168, 85, 247, 0.4))"},title:"Thinking...",children:"💭"}),re&&$===_.id&&e.jsxs("div",{"data-card":!0,onClick:de=>de.stopPropagation(),className:"absolute w-64 max-w-[calc(100vw-2rem)] p-4 rounded-xl transition-all duration-300 z-[220]",style:{top:ce.y>0?"auto":"100%",bottom:ce.y>0?"100%":"auto",left:"50%",transform:"translateX(-50%)",marginTop:ce.y>0?0:"12px",marginBottom:ce.y>0?"12px":0,background:"rgba(15, 23, 42, 0.95)",backdropFilter:"blur(16px)",border:`1px solid ${j}40`,boxShadow:`0 20px 40px rgba(0,0,0,0.5), 0 0 20px ${j}15`},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:j}}),e.jsx("span",{className:"text-xs font-semibold text-slate-300",children:_.name})]}),s==="analyze"&&_.personaEmoji&&_.personaName&&e.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-2 border-b border-slate-700/50",children:[e.jsx("span",{className:"text-base",children:_.personaEmoji}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs font-semibold text-blue-400",children:_.personaName}),_.personaTrait&&e.jsx("div",{className:"text-[10px] text-slate-500",children:_.personaTrait})]})]}),e.jsx("p",{className:"text-xs text-slate-400 leading-relaxed whitespace-pre-wrap",children:Gs({model:_,isSpeaking:oe,getTailSnippet:A})}),e.jsx("div",{className:"flex items-center gap-4 mt-3 pt-2 border-t border-slate-700/50",children:e.jsx(an,{times:d[_.id]})})]})]},_.id)}),s!=="compare"&&W&&e.jsx(Os,{mode:s,layoutRadius:v,moderatorModel:W,moderatorId:P,orchestratorTransform:E,orchestratorStatus:Q,moderatorSynthesis:U,isSynthesizing:z,isGenerating:M,phaseLabel:K,speaking:p,hoveredCard:$,setHoveredCard:b,setSelectedCardIds:x,lastSelectedCardRef:Z,orchestratorAutoMode:X,orchestratorAutoScope:H,showOrchestratorMenu:y,setShowOrchestratorMenu:pe,setOrchestratorAutoMode:ge,setOrchestratorAutoScope:xe,orchestratorMenuRef:ae,availableModels:V,setModerator:ue,getTailSnippet:A}),s!=="compare"&&e.jsxs("svg",{className:"absolute pointer-events-none transition-opacity duration-700",style:{width:"1000px",height:"1000px",opacity:.2},children:[e.jsx("circle",{cx:"500",cy:"500",r:v,fill:"none",stroke:"url(#circleGrad)",strokeWidth:"1",strokeDasharray:"8,4"}),e.jsx("defs",{children:e.jsxs("linearGradient",{id:"circleGrad",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#3b82f6"}),e.jsx("stop",{offset:"50%",stopColor:"#8b5cf6"}),e.jsx("stop",{offset:"100%",stopColor:"#3b82f6"})]})})]})]})}function Ws(t,s){const r=Math.floor(t/s),a=t%s,p=(mt+se.gapX)*s-se.gapX,i=r*(dn+se.gapY);return{gridX:a*(mt+se.gapX)-p/2+mt/2,gridY:i}}function Ys({mode:t,gridX:s,gridY:r,circleX:a,circleY:p,dragState:i,modelId:x}){if((i==null?void 0:i.activeId)===x){const d=i.currX+i.offsetX,c=i.currY+i.offsetY;if(t==="compare"){const h=d-(i.containerLeft+i.containerWidth/2),k=c-i.containerTop-i.cardHeight/2;return`translate(calc(-50% + ${h}px), ${k}px)`}const f=d-(i.containerLeft+i.containerWidth/2),u=c-(i.containerTop+i.containerHeight/2);return`translate(calc(-50% + ${f}px), calc(-50% + ${u}px))`}return t==="compare"?`translate(calc(-50% + ${s}px), ${r}px)`:`translate(calc(-50% + ${a}px), calc(-50% + ${p}px))`}function Fs({e:t,modelId:s,suppressClickRef:r,setSelectedCardIds:a,selectedModels:p,lastSelectedCardRef:i}){if(t.stopPropagation(),r.current.card){r.current.card=!1;return}const x=t.shiftKey,d=t.metaKey||t.ctrlKey;if(x&&i.current){const c=p.findIndex(u=>u.id===i.current),f=p.findIndex(u=>u.id===s);if(c!==-1&&f!==-1){const u=Math.min(c,f),h=Math.max(c,f),k=p.slice(u,h+1).map(L=>L.id);a(L=>{const A=new Set(L);return k.forEach($=>A.add($)),A})}}else d?(a(c=>{const f=new Set(c);return f.has(s)?f.delete(s):f.add(s),f}),i.current=s):(a(new Set([s])),i.current=s)}function Xs({model:t,isSpeaking:s,thinkingFallback:r,getTailSnippet:a}){return t.statusMessage?Ie(t.statusMessage)??t.statusMessage:s?t.response.trim().length>0?Ie(t.response)??e.jsx($t,{text:t.response,speed:20}):t.thinking&&t.thinking.trim().length>0?e.jsxs("span",{children:[e.jsx("span",{className:"text-slate-500 italic",children:"Thinking… "}),a(t.thinking.trim(),220)]}):r:Ie(t.response)??t.response}function Gs({model:t,isSpeaking:s,getTailSnippet:r,maxChars:a=220}){return t.statusMessage?Ie(t.statusMessage)??t.statusMessage:s?t.thinking&&t.thinking.trim().length>0?e.jsxs("span",{children:[e.jsx("span",{className:"text-purple-400/80 text-[10px] uppercase tracking-wider font-medium",children:"Thinking "}),e.jsx("span",{className:"text-slate-400",children:r(t.thinking.trim(),260)})]}):t.response.trim().length>0?Ie(t.response)??e.jsx($t,{text:t.response,speed:20}):e.jsx("span",{className:"text-slate-500 italic",children:"Thinking…"}):t.thinking&&t.thinking.trim().length>0?e.jsxs("span",{children:[e.jsx("span",{className:"text-purple-400/80 text-[10px] uppercase tracking-wider font-medium",children:"Reasoning "}),e.jsx("span",{className:"text-slate-400",children:r(t.thinking.trim(),260)})]}):t.response?Ie(t.response)??r(t.response,a):e.jsx("span",{className:"text-slate-500 italic",children:"No response yet."})}const Us={padding:"16px",height:"100%",display:"flex",flexDirection:"column",isolation:"isolate",WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",textRendering:"optimizeLegibility",opacity:1,transition:"opacity 0.3s ease-out"};function Ks(t){switch(t){case"error":return"Error";case"responding":return"Responding";case"done":return"Done";case"waiting":return"Waiting";default:return"Ready"}}function qs(t,s,r,a){return r?"error":t?"responding":s?"done":a?"waiting":"idle"}function Ie(t){return t.startsWith("<svg")?e.jsx("span",{dangerouslySetInnerHTML:{__html:t}}):null}function Vs({hasError:t,isProcessing:s,isSelected:r,errorColor:a,processingColor:p,typeColor:i}){const x="rgba(30, 41, 59, 0.85)";return t?{background:`linear-gradient(135deg, ${a}14, ${x})`,border:`1px solid ${a}99`,shadow:`0 0 24px ${a}33, inset 0 1px 1px rgba(255,255,255,0.1)`}:s?{background:`linear-gradient(135deg, ${p}14, ${x})`,border:`1px solid ${p}99`,shadow:`0 0 24px ${p}33, inset 0 1px 1px rgba(255,255,255,0.1)`}:r?{background:x,border:`1px solid ${i}d0`,shadow:`0 0 20px ${i}30, inset 0 1px 1px rgba(255,255,255,0.1)`}:{background:x,border:"1px solid rgba(71, 85, 105, 0.5)",shadow:"0 4px 20px rgba(0,0,0,0.3), inset 0 1px 1px rgba(255,255,255,0.05)"}}function Qs({rect:t}){return t?e.jsx("div",{className:"absolute pointer-events-none z-30",style:{left:t.left,top:t.top,width:t.width,height:t.height,border:"2px solid rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)"}}):null}const Dt=n.createContext(null);function Js({children:t}){const[s,r]=n.useState(!1),[a,p]=n.useState("chat"),i=n.useRef({}),x=n.useCallback(L=>{i.current=L},[]),[d,c]=n.useState({gesture:null,progress:0,triggered:!1}),[f,u]=n.useState(void 0),[h,k]=n.useState(null);return e.jsx(Dt.Provider,{value:{isActive:s,setIsActive:r,appContext:a,setAppContext:p,callbacks:i,setCallbacks:x,gestureState:d,setGestureState:c,performanceMetrics:f,setPerformanceMetrics:u,cameraError:h,setCameraError:k},children:t})}function Zs(){const t=n.useContext(Dt);if(!t)throw new Error("useGesture must be used within GestureProvider");return t}function br(){return n.useContext(Dt)}class er extends n.Component{constructor(r){super(r);tn(this,"handleRetry",()=>{var r,a;this.setState({hasError:!1,error:null}),(a=(r=this.props).onRetry)==null||a.call(r)});this.state={hasError:!1,error:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,a){console.error("ErrorBoundary caught an error:",r,a)}render(){var r;return this.state.hasError?this.props.fallback?this.props.fallback:e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-white/70 gap-4 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-amber-400",children:[e.jsx(es,{size:20}),e.jsx("span",{className:"text-sm font-medium",children:"Something went wrong"})]}),e.jsx("p",{className:"text-xs text-white/40 text-center max-w-xs",children:((r=this.state.error)==null?void 0:r.message)||"Failed to load component"}),e.jsxs("button",{onClick:this.handleRetry,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white/80 bg-slate-700/50 hover:bg-slate-600/50 rounded-lg transition-all active:scale-95 border border-slate-600/50",children:[e.jsx(ts,{size:14}),"Try Again"]})]}):this.props.children}}const tr=n.lazy(()=>$e(()=>import("./SettingsModal-Bwp3eHZ9.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),nr=n.lazy(()=>$e(()=>import("./ResponseModal-reNlrW8D.js"),__vite__mapDeps([7,1,2,3,4,5,6,8]))),sr=n.lazy(()=>$e(()=>import("./DiscussionTranscript-BNM7dRxs.js"),__vite__mapDeps([9,1,2,3,4,5,6,8]))),rr=n.lazy(()=>$e(()=>import("./GestureControl-DKpH6LsJ.js"),__vite__mapDeps([10,1,2,3,4,5,6]))),or=n.lazy(()=>$e(()=>import("./HandBackground-F7iiHyIM.js"),__vite__mapDeps([11,1,2,3,4,5,6,12]))),ar=n.lazy(()=>$e(()=>import("./ChatView-CIHI3azX.js"),__vite__mapDeps([13,1,2,3,4,5,6,8])).then(t=>({default:t.default}))),ir='button, input, textarea, select, a, [role="button"], [data-no-background], [data-card]';function lr(){const t=Zs();Ns();const{modelsData:s,setModelsData:r,selected:a,setSelected:p,chatModelId:i,setChatModelId:x,moderator:d,setModerator:c,availableModels:f,totalModelsByType:u,allSelectedByType:h,modelIdToName:k,isLoading:L,loadError:A,retryCount:$,retryNow:b}=ws(),[l,v]=ze("playground_mode","chat",{serialize:o=>o,deserialize:(o,m)=>["chat","compare","analyze","debate"].includes(o)?o:m}),[B,W]=n.useState(!1),P=n.useRef(null),[E,Q]=n.useState(null),[U,z]=n.useState(!1),[M,K]=n.useState(!1),[O,Z]=n.useState(2),[X,H]=n.useState(!1),[y,pe]=ze("github_models_token","",{serialize:o=>o||null,deserialize:(o,m)=>o??m}),[ge,xe]=ze("openrouter_api_key","",{serialize:o=>o||null,deserialize:(o,m)=>o??m}),[ae,V]=n.useState({}),ue=n.useRef(null),ie=n.useRef(null),[Se,re]=n.useState(""),[Te,_]=n.useState(null),te=n.useRef(null),ce=n.useCallback(o=>{te.current&&clearTimeout(te.current),_(o),te.current=window.setTimeout(()=>{_(null),te.current=null},5e3)},[]),ye=n.useCallback(o=>{if(l==="chat"||y)return!0;const m=s.find(g=>g.id===o);return!m||m.type!=="github"&&m.type!=="external"},[l,y,s]),oe=n.useCallback(()=>!!(l==="chat"||y),[l,y]),[ve,fe]=n.useState([]),[je,Ee]=n.useState(()=>new Set(["lfm2.5-1.2b-instruct"])),[Me,D]=n.useState(!1),S=n.useRef(!1),w=n.useCallback(o=>{Ee(m=>{const g=new Set(m);return g.has(o)?g.delete(o):g.add(o),g})},[]),T=n.useCallback(o=>{const m=s.filter(g=>g.type===o).map(g=>g.id);Ee(g=>{const C=m.every(I=>g.has(I)),N=new Set(g);return C?m.forEach(I=>N.delete(I)):m.forEach(I=>N.add(I)),N})},[s]),{history:j,historyRef:R,pushHistoryEntries:ee,clearHistory:q,historyToText:Y,buildCarryoverHistory:J}=Rs(),De=(o,m)=>{const g=new Set,C=m.filter(Boolean).filter((I,G,F)=>F.indexOf(I)===G),N=[];return C.forEach(I=>{const G=o[I];G&&G.trim()&&(N.push({id:I,text:G.trim()}),g.add(I))}),Object.entries(o).forEach(([I,G])=>{g.has(I)||!G||!G.trim()||N.push({id:I,text:G.trim()})}),N.length?N.map(({id:I,text:G})=>`${k(I)}:
${G}`).join(`

`):null};n.useEffect(()=>{S.current=t.isActive},[t.isActive]);const he=a.map(o=>s.find(m=>m.id===o)).filter(o=>!!o&&(l==="compare"||o.id!==d)),ne=n.useMemo(()=>l!=="compare"?he:[...he].sort((o,m)=>{var N,I;const g=(N=ae[o.id])==null?void 0:N.firstTokenTime,C=(I=ae[m.id])==null?void 0:I.firstTokenTime;return g===void 0&&C===void 0?0:g===void 0?1:C===void 0?-1:g-C}),[l,he,ae]),{fastestTTFT:Je,fastestTotal:Ze}=n.useMemo(()=>{if(l!=="compare")return{fastestTTFT:null,fastestTotal:null};let o=null,m=1/0,g=null,C=1/0,N=0,I=0;for(const G of he){const F=ae[G.id];if(F){if(F.firstTokenTime!==void 0){N++;const le=F.firstTokenTime-F.startTime;le<m&&(m=le,o=G.id)}if(F.endTime!==void 0){I++;const le=F.endTime-F.startTime;le<C&&(C=le,g=G.id)}}}return{fastestTTFT:N>=2?o:null,fastestTotal:I>=2?g:null}},[l,he,ae]),Pe=(o,m,g,C)=>{if(g==="analyze"){const ut=250+o*220/(m-1)-90,ft=ut*Math.PI/180;return{x:Math.cos(ft)*C,y:Math.sin(ft)*C,angle:ut}}const N=o*360/m-90,I=Math.cos(N*Math.PI/180)*C,G=Math.sin(N*Math.PI/180)*C;return{x:I,y:G,angle:N}},et=(o,m)=>{Q(m),o.dataTransfer.effectAllowed="move"},tt=o=>{o.preventDefault(),z(!0)},de=()=>{z(!1)},un=o=>{if(o.preventDefault(),z(!1),E){if(l==="chat")x(E);else if(!a.includes(E)){if(!ye(E)){ce("Add your GitHub token in Settings for API model access with dedicated quota"),Q(null);return}p(m=>[...m,E])}Q(null)}},xt=o=>{if(l==="chat"){x(i===o?null:o);return}if(a.includes(o))if(ke&&bt.current.includes(o)&&Se){ie.current&&ie.current.abort();const g=bt.current.filter(N=>N!==o),C={};if(s.forEach(N=>{g.includes(N.id)&&N.response&&!N.error&&(C[N.id]=N.response)}),p(N=>N.filter(I=>I!==o)),He.has(o)&&We(N=>{const I=new Set(N);return I.delete(o),I}),(l==="analyze"||l==="debate")&&g.length<2){Le(!1),Xe(!1),Ue("This mode requires at least 2 participants."),qe("Error");return}Ct(Se,C,g,{skipHistory:!0})}else p(g=>g.filter(C=>C!==o));else{if(!ye(o)){ce("Add your GitHub token in Settings for API model access with dedicated quota");return}p(m=>[...m,o])}},fn=o=>{const m=s.filter(N=>N.type===o).map(N=>N.id);if(m.length>0&&m.every(N=>a.includes(N))){p(N=>N.filter(I=>!m.includes(I)));return}if((o==="github"||o==="external")&&!oe()){ce("Add your GitHub token in Settings for API model access with dedicated quota");return}const C=f.filter(N=>N.type===o).map(N=>N.id);C.length>0&&p(N=>[...N,...C])},[pn,Be]=n.useState(null),[Ce,nt]=n.useState(null),[Oe,st]=n.useState(new Set),[hn,mn]=n.useState(!1),[He,We]=n.useState(new Set),rt=()=>We(new Set),[ot,xn]=n.useState(null),gt=n.useMemo(()=>{if(l==="compare")return 0;const o=Math.max(se.baseRadius,se.minRadius+ne.length*se.radiusPerModel);if(!ot)return o;const g=Math.min(ot.width,ot.height)/2-140;return Math.max(o,g)},[l,ne.length,ot]);n.useEffect(()=>{const o=()=>{if(!me.current)return;const{clientWidth:g,clientHeight:C}=me.current;let N=Math.floor(g/(se.cardWidth+se.gapX));N=Math.max(1,N),Z(N),xn({width:g,height:C})},m=new ResizeObserver(g=>{for(let C of g)C.target===me.current&&o()});return me.current&&(m.observe(me.current),o()),()=>{me.current&&m.unobserve(me.current)}},[l]);const Ye=n.useRef(null),me=n.useRef(null),Ne=n.useRef(null),Pt=n.useRef(null),at=n.useRef(new Map),gn=n.useRef(null),Fe=n.useRef({card:!1,background:!1}),bn=n.useRef({}),bt=n.useRef([]),{enqueueStreamDelta:yn,clearPendingStreamForModel:vn,resetPendingStream:yt}=Ls(r),Bt=n.useRef(!1),{arenaOffsetYRef:Ot,arenaTargetYRef:vt,wheelRafRef:wn,clampTarget:kn,ensureRaf:jn}=Ds({visualizationAreaRef:me,dragSelectionActiveRef:Bt}),{selectionRect:Sn,isSelecting:wt,dragSelectionActiveRef:Tn}=zs({rootContainerRef:Pt,visualizationAreaRef:me,arenaOffsetYRef:Ot,arenaTargetYRef:vt,wheelRafRef:wn,selectedModels:ne,cardRefs:at,selectedCardIds:He,setSelectedCardIds:We,suppressClickRef:Fe});Bt.current=Tn.current;const{dragState:En,handlePointerDown:Mn}=Is({visualizationAreaRef:me,cardRefs:at,selected:a,setSelected:p,mode:l,gridCols:O,getCirclePosition:Pe});n.useEffect(()=>()=>yt(),[yt]);const[be,Re]=n.useState(null);n.useEffect(()=>{const o="arena-selecting",m=document.body;return wt?m.classList.add(o):m.classList.remove(o),()=>{m.classList.remove(o)}},[wt]);const it=n.useCallback(o=>o?!o.closest(ir):!1,[]),Cn=n.useCallback(o=>{if(it(o.target)){if(Fe.current.background){Fe.current.background=!1;return}Be(null),rt(),Fe.current.background=!1}},[it,rt]),Nn=n.useCallback(o=>{it(o.target)&&(o.preventDefault(),Re({x:o.clientX,y:o.clientY,type:"background"}))},[it]),Ht=n.useCallback(()=>{W(!0),P.current&&clearTimeout(P.current),P.current=window.setTimeout(()=>{W(!1),P.current=null},350)},[]),Wt=n.useRef(l),lt=n.useCallback(o=>{if(o===l)return;Ht();const m=["compare","analyze","debate"];m.includes(l)&&m.includes(o)||Le(!1),v(o)},[l,Ht]);n.useEffect(()=>()=>{te.current&&clearTimeout(te.current)},[]),n.useEffect(()=>()=>{P.current&&clearTimeout(P.current)},[]),n.useEffect(()=>{const o=()=>Re(null);return window.addEventListener("click",o),()=>window.removeEventListener("click",o)},[]);const[ke,Le]=n.useState(!1),[ct,Xe]=n.useState(!1),[Ge,Ue]=n.useState(""),Rn=n.useCallback(()=>{q(),Le(!1),Xe(!1),Ue(""),qe(null),Tt({}),r(o=>o.map(m=>({...m,response:"",thinking:void 0,error:void 0}))),V({}),st(new Set)},[q,r]),[Ln,An]=n.useState(!0),[_n,zn]=n.useState("api"),[kt,jt]=n.useState(!1),St=n.useRef(null);n.useEffect(()=>{const o=g=>{St.current&&!St.current.contains(g.target)&&jt(!1)},m=g=>{g.key==="Escape"&&jt(!1)};return kt&&(document.addEventListener("mousedown",o),document.addEventListener("keydown",m)),()=>{document.removeEventListener("mousedown",o),document.removeEventListener("keydown",m)}},[kt]);const[Ke,qe]=n.useState(null),[,Tt]=n.useState({}),[In,Yt]=n.useState(new Set),Et=n.useRef(new Set),$n=n.useRef(null),Ft=n.useRef({}),Xt=n.useRef(l),[Mt,Gt]=n.useState(null),Dn=()=>{const o=new Set;Et.current=o,Yt(o)},Pn=o=>{Yt(m=>{if(m.has(o))return m;const g=new Set(m);return g.add(o),Et.current=g,g})},Ut=n.useRef({compare:{responses:{},moderatorSynthesis:"",phaseLabel:null,executionTimes:{},isGenerating:!1,speaking:new Set},analyze:{responses:{},moderatorSynthesis:"",phaseLabel:null,executionTimes:{},isGenerating:!1,speaking:new Set},debate:{responses:{},moderatorSynthesis:"",phaseLabel:null,executionTimes:{},isGenerating:!1,speaking:new Set}}),Kt=n.useRef(s),qt=n.useRef(Ge),Vt=n.useRef(Ke),Qt=n.useRef(ae),Jt=n.useRef(ke),Zt=n.useRef(Oe);n.useEffect(()=>{Kt.current=s},[s]),n.useEffect(()=>{qt.current=Ge},[Ge]),n.useEffect(()=>{Vt.current=Ke},[Ke]),n.useEffect(()=>{Qt.current=ae},[ae]),n.useEffect(()=>{Jt.current=ke},[ke]),n.useEffect(()=>{Zt.current=Oe},[Oe]),n.useEffect(()=>{const o=["compare","analyze","debate"],m=Wt.current;if(o.includes(m)&&o.includes(l)&&m!==l){const g={};Kt.current.forEach(I=>{g[I.id]={response:I.response,thinking:I.thinking,error:I.error}}),Ut.current[m]={responses:g,moderatorSynthesis:qt.current,phaseLabel:Vt.current,executionTimes:Qt.current,isGenerating:Jt.current,speaking:new Set(Zt.current)};const C=Ut.current[l];Object.values(C.responses).some(I=>I.response&&I.response!=="")||C.isGenerating?(r(I=>I.map(G=>{var F,le,Ve;return{...G,response:((F=C.responses[G.id])==null?void 0:F.response)||"",thinking:(le=C.responses[G.id])==null?void 0:le.thinking,error:(Ve=C.responses[G.id])==null?void 0:Ve.error}})),Ue(C.moderatorSynthesis),qe(C.phaseLabel),V(C.executionTimes),Le(C.isGenerating),st(new Set(C.speaking))):(q(),r(I=>I.map(G=>({...G,response:"",thinking:void 0,error:void 0}))),Ue(""),qe(null),V({}),Le(!1),st(new Set)),Xe(!1),Tt({})}Wt.current=l},[l,q,r]);const{sendMessage:Ct}=_s({mode:l,moderator:d,selected:a,selectedCardIds:He,githubToken:y,isGenerating:ke,summarizeSessionResponses:De,setLastQuery:re,setHoveredCard:Be,setPhaseLabel:qe,setModeratorSynthesis:Ue,setDiscussionTurnsByModel:Tt,resetFailedModels:Dn,markModelFailed:Pn,failedModelsRef:Et,currentDiscussionTurnRef:$n,sessionModelIdsRef:bt,abortControllerRef:ie,thinkingStateRef:bn,conversationHistoryRef:R,pushHistoryEntries:ee,historyToText:Y,buildCarryoverHistory:J,setModelsData:r,modelIdToName:k,setExecutionTimes:V,setIsGenerating:Le,setIsSynthesizing:Xe,setSpeaking:st,enqueueStreamDelta:yn,clearPendingStreamForModel:vn,resetPendingStream:yt});$s({mode:l,showSettings:X,showDock:M,contextMenu:be,selectedCardIds:He,selected:a,inputRef:Ye,setShowSettings:H,setShowDock:K,setContextMenu:Re,setSelected:p,setSelectedCardIds:We,clearSelection:rt,setHoveredCard:Be,handleModeChange:lt});const[dt,Bn]=ze("playground-bg-style","dots",{serialize:o=>o,deserialize:(o,m)=>o&&us.includes(o)?o:m}),On=s.find(o=>o.id===d),Hn=ct?"responding":ke?"waiting":Ge?"done":"idle",Wn=`${Mt?`translate(-50%, -50%) translate(${Mt.x}px, ${Mt.y}px)`:"translate(-50%, -50%)"} scale(1)`;n.useLayoutEffect(()=>{if(l!=="compare")return;const o={};ne.forEach(m=>{const g=at.current.get(m.id);g&&(o[m.id]=g.getBoundingClientRect())}),Ft.current=o},[l,ne.length,ne.map(o=>o.id).join(",")]),n.useEffect(()=>{if(Xt.current==="compare"&&l!=="compare"&&d&&me.current){const m=Ft.current[d],g=me.current.getBoundingClientRect();if(m&&g.width>0&&g.height>0){const C=g.left+g.width/2,N=l==="analyze"?gt-64:0,I=g.top+(g.height*.5+N),G=m.left+m.width/2-C,F=m.top+m.height/2-I;(Math.abs(G)>1||Math.abs(F)>1)&&(Gt({x:G,y:F}),requestAnimationFrame(()=>Gt(null)))}}Xt.current=l},[l,d,gt]);const Yn=dt==="none"?"":`bg-${dt}`,Fn=(o,m=280)=>o?o.length<=m?o:`…${o.slice(o.length-m)}`:"",en=()=>{ie.current&&(ie.current.abort(),Le(!1),Xe(!1))};return e.jsxs("div",{ref:Pt,className:`fixed inset-0 overflow-hidden text-white ${Yn}`,style:{backgroundColor:sn[l],transition:"background-color 1s ease",...dt==="none"?{background:sn[l]}:{},...wt?{userSelect:"none",WebkitUserSelect:"none"}:{}},onClick:Cn,onContextMenu:Nn,children:[t.isActive&&e.jsx(n.Suspense,{fallback:null,children:e.jsx(or,{onSendMessage:t.callbacks.current.onSendMessage,onScroll:t.callbacks.current.onScroll,onPinch:t.callbacks.current.onPinch,onHover:t.callbacks.current.onHover,gestureActiveArea:{minX:.7,maxX:1,minY:0,maxY:1},onGestureState:t.setGestureState,onError:t.setCameraError,onPerformance:t.setPerformanceMetrics})}),L&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-slate-900/95 backdrop-blur-sm",children:e.jsxs("div",{className:"flex flex-col items-center gap-5 text-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-12 h-12 border-2 border-slate-700 border-t-blue-500 rounded-full animate-spin"}),e.jsx("div",{className:"absolute inset-0 w-12 h-12 border-2 border-transparent border-b-emerald-500/50 rounded-full animate-spin",style:{animationDirection:"reverse",animationDuration:"1.5s"}})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"text-white/80 text-sm font-medium",children:A||"Connecting to models..."}),$>0&&e.jsxs("p",{className:"text-white/40 text-xs tabular-nums",children:["Attempt ",$," of 8"]})]}),e.jsxs("button",{onClick:b,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white/70 hover:text-white bg-white/5 hover:bg-white/10 border border-white/10 hover:border-white/20 rounded-lg transition-all active:scale-95",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh Now"]})]})}),e.jsx(ms,{mode:l,setMode:lt,setHoveredCard:Be,clearSelection:rt,showDock:M,setShowDock:K,onOpenSettings:()=>H(!0),gestureButtonSlot:e.jsx(n.Suspense,{fallback:null,children:e.jsx(rr,{inHeader:!0,appContext:l,onStopGeneration:()=>{if(l==="chat"&&Ne.current){Ne.current.stopGeneration();return}en()},onSendMessage:o=>{if(l==="chat"&&Ne.current){Ne.current.sendMessage(o,!0);return}const m=l==="compare"||l==="analyze"||l==="debate"?a:[];m.length>0&&Ct(o,{},m)},onScroll:o=>{if(l==="chat"&&Ne.current){Ne.current.scroll(o);return}vt.current=kn(vt.current+o),jn()},onHover:(o,m)=>{const g=o*window.innerWidth,C=m*window.innerHeight,N=document.elementFromPoint(g,C);if(N){const I=N.closest("[data-gesture-mode-track]");if(I){const le=I.getBoundingClientRect(),Ve=g-le.left,ut=le.width,ft=Math.floor(Ve/ut*5),Nt=["chat","compare","analyze","debate"][Math.max(0,Math.min(4,ft))];Nt&&Nt!==l&&lt(Nt);return}const G=document.querySelector('[data-gesture-hovered="true"]'),F=N.closest('button, a, [role="button"], [data-clickable], .cursor-pointer, [onclick]')||N;F!==G?(G&&(G.removeAttribute("data-gesture-hovered"),G.dispatchEvent(new PointerEvent("pointerleave",{bubbles:!1,cancelable:!0})),G.dispatchEvent(new MouseEvent("mouseleave",{bubbles:!1,cancelable:!0})),G.dispatchEvent(new MouseEvent("mouseout",{bubbles:!0,cancelable:!0}))),F.setAttribute("data-gesture-hovered","true"),F.dispatchEvent(new PointerEvent("pointerenter",{bubbles:!1,cancelable:!0,clientX:g,clientY:C})),F.dispatchEvent(new PointerEvent("pointermove",{bubbles:!0,cancelable:!0,clientX:g,clientY:C})),F.dispatchEvent(new MouseEvent("mouseenter",{bubbles:!1,cancelable:!0,clientX:g,clientY:C})),F.dispatchEvent(new MouseEvent("mouseover",{bubbles:!0,cancelable:!0,clientX:g,clientY:C}))):F===G&&(F.dispatchEvent(new PointerEvent("pointermove",{bubbles:!0,cancelable:!0,clientX:g,clientY:C})),F.dispatchEvent(new MouseEvent("mousemove",{bubbles:!0,cancelable:!0,clientX:g,clientY:C})))}},onPinch:(o,m)=>{const g=o*window.innerWidth,C=m*window.innerHeight,N=document.elementFromPoint(g,C);if(N){const I=le=>{le.dispatchEvent(new PointerEvent("pointerdown",{bubbles:!0,cancelable:!0,clientX:g,clientY:C,pointerId:1,pointerType:"touch",isPrimary:!0})),le.dispatchEvent(new PointerEvent("pointerup",{bubbles:!0,cancelable:!0,clientX:g,clientY:C,pointerId:1,pointerType:"touch",isPrimary:!0})),le.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0,clientX:g,clientY:C})),le.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0,clientX:g,clientY:C})),le.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,clientX:g,clientY:C}))},G=N.closest('button, a, [role="button"], [data-clickable], .cursor-pointer, [onclick]');I(G||N);const F=document.createElement("div");F.style.position="fixed",F.style.left=`${g}px`,F.style.top=`${C}px`,F.style.width="20px",F.style.height="20px",F.style.background="rgba(236, 72, 153, 0.5)",F.style.borderRadius="50%",F.style.transform="translate(-50%, -50%)",F.style.pointerEvents="none",F.style.zIndex="9999",document.body.appendChild(F),F.animate([{transform:"translate(-50%, -50%) scale(1)",opacity:1},{transform:"translate(-50%, -50%) scale(4)",opacity:0}],{duration:400}).onfinish=()=>F.remove()}},onModeChange:o=>{const m=["chat","compare","analyze","debate"],g=m.indexOf(l);let C;o==="next"?C=(g+1)%m.length:C=(g-1+m.length)%m.length,lt(m[C])}})})}),e.jsxs("div",{style:{paddingLeft:"1.5rem",paddingRight:"0"},children:[M&&e.jsx("div",{className:"fixed inset-0 z-[55] bg-black/10 backdrop-blur-[1px] transition-opacity duration-300",onClick:()=>K(!1)}),e.jsx(fs,{showDock:M,availableModels:f,allSelectedByType:h,totalModelsByType:u,handleDragStart:et,handleModelToggle:xt,handleAddGroup:fn,dockRef:ue,mode:l,allModels:s,setShowDock:K,chatSelectedModels:je,onToggleChatModel:w,onToggleChatGroup:T}),l==="chat"&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex h-screen w-full relative z-[10]",children:e.jsx("div",{className:"flex-1 relative px-2 sm:px-6 pt-20 pb-6",children:e.jsx(er,{children:e.jsx(n.Suspense,{fallback:e.jsxs("div",{className:"flex items-center justify-center h-full text-white/50 gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/20 border-t-white/60 rounded-full animate-spin"}),"Loading..."]}),children:e.jsx(ar,{ref:Ne,models:s,selectedModels:je,onToggleModel:w,githubToken:y,openrouterKey:ge,messages:ve,setMessages:fe,isGenerating:Me,setIsGenerating:D,gesturesActive:t.isActive})})})})})}),l!=="chat"&&e.jsxs("div",{className:"flex h-screen w-full relative",children:[e.jsx("div",{className:"relative flex-1 transition-all duration-300 flex flex-col pt-24",children:e.jsx("div",{ref:me,onDragOver:tt,onDragLeave:de,onDrop:un,className:"relative w-full h-full z-10 transition-all duration-300",style:{position:"relative",display:"flex",alignItems:l==="compare"?"flex-start":"center",justifyContent:"center","--arena-offset-y":`${Ot.current}px`,transform:l==="analyze"||l==="debate"?`translateY(calc(var(--arena-offset-y) - 50px)) scale(${U?1.02:1})`:`translateY(var(--arena-offset-y)) scale(${U?1.02:1})`,willChange:"transform",border:U?"2px dashed rgba(59, 130, 246, 0.4)":"2px dashed transparent",borderRadius:U?"24px":"0px",transition:"transform 0s linear",...l==="compare"?{minHeight:"300px",paddingBottom:"120px"}:l==="analyze"||l==="debate"?{height:"100%",minHeight:"100%",overflow:"hidden"}:{height:"100%",minHeight:"100%",overflow:"hidden"},...U?{background:"rgba(59, 130, 246, 0.05)"}:{}},children:e.jsx(Hs,{mode:l,selectedModels:ne,gridCols:O,speaking:Oe,selectedCardIds:He,setSelectedCardIds:We,executionTimes:ae,failedModels:In,cardRefs:at,handlePointerDown:Mn,dragState:En,handleModelToggle:xt,setContextMenu:Re,suppressClickRef:Fe,getTailSnippet:Fn,hoveredCard:pn,setHoveredCard:Be,setExpandedModelId:nt,layoutRadius:gt,getCirclePosition:Pe,moderatorModel:On,moderatorId:d,orchestratorTransform:Wn,orchestratorStatus:Hn,moderatorSynthesis:Ge,isSynthesizing:ct,isGenerating:ke,phaseLabel:Ke,linesTransitioning:B,lastSelectedCardRef:gn,orchestratorAutoMode:Ln,orchestratorAutoScope:_n,showOrchestratorMenu:kt,setShowOrchestratorMenu:jt,setOrchestratorAutoMode:An,setOrchestratorAutoScope:zn,orchestratorMenuRef:St,availableModels:f,setModerator:c,fastestTTFT:Je,fastestTotal:Ze})})}),l!=="compare"&&e.jsx("div",{className:"transcript-panel w-[400px] xl:w-[480px] flex flex-col border-l border-white/5 bg-slate-900/20 backdrop-blur-sm z-40 relative h-full",children:e.jsx(n.Suspense,{fallback:null,children:e.jsx(sr,{history:j,models:s,mode:l,onSelectPrompt:o=>{Ye.current&&(Ye.current.value=o,Ye.current.focus())},onNewSession:Rn,className:"pt-24 pb-6 mask-fade-top",phaseLabel:Ke,isGenerating:ke,isSynthesizing:ct,speakingCount:Oe.size,totalParticipants:ne.length})})})]})]}),e.jsx(Qs,{rect:Sn}),Te&&e.jsx("div",{className:"fixed bottom-20 left-1/2 -translate-x-1/2 z-[200] animate-in slide-in-from-bottom-4 fade-in duration-300",children:e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 rounded-xl bg-amber-500/10 border border-amber-500/30 backdrop-blur-md shadow-xl",children:[e.jsx("svg",{className:"w-5 h-5 text-amber-400 shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsx("span",{className:"text-sm text-amber-100",children:Te}),e.jsx("button",{onClick:()=>{_(null),H(!0)},className:"ml-2 px-3 py-1 text-xs font-medium text-amber-900 bg-amber-400 hover:bg-amber-300 rounded-md transition-colors",children:"Open Settings"}),e.jsx("button",{onClick:()=>_(null),className:"ml-1 p-1 text-amber-400/60 hover:text-amber-400 transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsx(n.Suspense,{fallback:null,children:e.jsx(tr,{open:X,onClose:()=>H(!1),token:y,setToken:pe,openrouterKey:ge,setOpenrouterKey:xe,bgStyle:dt,setBgStyle:Bn})}),Ce&&l==="compare"&&e.jsx(n.Suspense,{fallback:null,children:e.jsx(nr,{model:ne.find(o=>o.id===Ce)||null,executionTimes:ae[Ce],onClose:()=>nt(null),onPrev:()=>{const o=ne.findIndex(m=>m.id===Ce);o>0&&nt(ne[o-1].id)},onNext:()=>{const o=ne.findIndex(m=>m.id===Ce);o<ne.length-1&&nt(ne[o+1].id)},hasPrev:ne.findIndex(o=>o.id===Ce)>0,hasNext:ne.findIndex(o=>o.id===Ce)<ne.length-1})}),(l==="compare"||l==="analyze"||l==="debate")&&e.jsx(ps,{inputRef:Ye,inputFocused:hn,setInputFocused:mn,onSendMessage:Ct,isGenerating:ke||ct,onStop:en,placeholder:l==="compare"?void 0:"Steer the discussion...",className:`fixed bottom-0 left-0 z-[100] pb-6 px-3 sm:px-4 flex justify-center items-end pointer-events-none transition-all duration-300 ${l==="compare"?"right-0":"right-[400px] xl:right-[480px]"}`,style:{paddingBottom:"calc(1.5rem + env(safe-area-inset-bottom))"}}),be&&e.jsx("div",{className:"fixed bg-slate-800 border border-slate-700 rounded-lg shadow-xl py-1 z-[200] min-w-[160px]",style:{top:be.y,left:be.x},onClick:o=>o.stopPropagation(),children:be.type==="background"?e.jsxs("button",{className:"w-full text-left px-4 py-2 text-sm text-slate-200 hover:bg-slate-700 transition-colors flex items-center gap-2",onClick:()=>{K(!0),Re(null)},children:[e.jsx("svg",{className:"w-4 h-4 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Model"]}):be.modelId?e.jsxs(e.Fragment,{children:[l!=="compare"&&be.modelId!==d&&e.jsxs("button",{className:"w-full text-left px-4 py-2 text-sm text-slate-200 hover:bg-slate-700 transition-colors flex items-center gap-2",onClick:()=>{c(be.modelId),Re(null)},children:[e.jsx("svg",{className:"w-4 h-4 text-orange-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})}),"Set as Orchestrator"]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 text-sm text-red-400 hover:bg-slate-700 transition-colors flex items-center gap-2",onClick:()=>{const o=be.modelId===d;if(xt(be.modelId),o&&l!=="compare"){const m=a.filter(g=>g!==be.modelId);m.length>0?c(m[0]):c("")}Re(null)},children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Remove"]})]}):null})]})}function cr(){return e.jsx(Js,{children:e.jsx(lr,{})})}ns.createRoot(document.getElementById("root")).render(e.jsx(ss.StrictMode,{children:e.jsx(cr,{})}));export{us as B,an as E,gr as M,ps as P,ze as a,br as b,js as f,Lt as s,Zs as u};
