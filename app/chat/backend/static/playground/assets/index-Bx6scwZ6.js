const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SettingsModal-SCebNl6W.js","assets/react-vendor-VqckXmoY.js","assets/markdown-rIyYVYgH.js","assets/math-render-Q06Bpsm3.js","assets/math-render-BqiDbsU2.css","assets/syntax-highlight-BzG5Erai.js","assets/syntax-highlight-BEHUn5zE.css","assets/DiscussionTranscript-BBT7wb0y.js","assets/FormattedContent-CtYzWev5.js","assets/GestureControl-V3Zz4FIy.js","assets/HandBackground-DFMjYCtB.js","assets/mediapipe-YSlczgt6.js","assets/ChatView-D_EBmQSv.js"])))=>i.map(i=>d[i]);
var Bn=Object.defineProperty;var Hn=(t,n,o)=>n in t?Bn(t,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[n]=o;var Vt=(t,n,o)=>Hn(t,typeof n!="symbol"?n+"":n,o);import{r as s,j as e,X as Wn,S as Fn,Z as rn,C as Qt,a as Yn,A as Xn,b as Gn,T as Un,R as Kn,c as qn,d as Vn}from"./react-vendor-VqckXmoY.js";import"./math-render-Q06Bpsm3.js";import"./syntax-highlight-BzG5Erai.js";import"./markdown-rIyYVYgH.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))d(u);new MutationObserver(u=>{for(const a of u)if(a.type==="childList")for(const b of a.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&d(b)}).observe(document,{childList:!0,subtree:!0});function o(u){const a={};return u.integrity&&(a.integrity=u.integrity),u.referrerPolicy&&(a.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?a.credentials="include":u.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function d(u){if(u.ep)return;u.ep=!0;const a=o(u);fetch(u.href,a)}})();const Qn="modulepreload",Jn=function(t){return"/static/playground/"+t},Jt={},Ke=function(n,o,d){let u=Promise.resolve();if(o&&o.length>0){document.getElementsByTagName("link");const b=document.querySelector("meta[property=csp-nonce]"),f=(b==null?void 0:b.nonce)||(b==null?void 0:b.getAttribute("nonce"));u=Promise.allSettled(o.map(p=>{if(p=Jn(p),p in Jt)return;Jt[p]=!0;const g=p.endsWith(".css"),x=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${x}`))return;const y=document.createElement("link");if(y.rel=g?"stylesheet":Qn,g||(y.as="script"),y.crossOrigin="",y.href=p,f&&y.setAttribute("nonce",f),document.head.appendChild(y),g)return new Promise((A,$)=>{y.addEventListener("load",A),y.addEventListener("error",()=>$(new Error(`Unable to preload CSS for ${p}`)))})}))}function a(b){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=b,window.dispatchEvent(f),!f.defaultPrevented)throw b}return u.then(b=>{for(const f of b||[])f.status==="rejected"&&a(f.reason);return n().catch(a)})},Zn={"self-hosted":{color:"#10b981"},github:{color:"#3b82f6"},external:{color:"#8b5cf6"}},es=50,ts=100,ns=150,ss=["deepseek-r1-distill-qwen-1.5b","r1qwen","smollm3","nanbeige"],rs=["gpt-oss","gptoss"],os=t=>{const n=t.toLowerCase();return ss.some(o=>n.includes(o.toLowerCase()))},as=t=>{const n=t.toLowerCase();return rs.some(o=>n.includes(o.toLowerCase()))};function ur(t,n,o){if(o!==void 0)return o;let d;switch(n){case"self-hosted":d=es;break;case"github":d=ts;break;case"external":d=ns;break}return d}const Ct=[{id:"eu-ai-act-enforcement",label:"EU AI Act Enforcement Wave",prompt:"The EU AI Act enters enforcement; high-risk systems must prove data provenance, evals, and risk controls. Outline compliance gaps for a frontier model API and tradeoffs between speed and alignment.",category:"Policy",modes:["analyze","debate"],tags:["governance","compliance"]},{id:"export-controls-blackwell",label:"Export Controls Tighten",prompt:"U.S. export rules tighten again on AI accelerators; Blackwell-class parts face new caps and cloud checks. Map the impact on training roadmaps, costs, and on-device strategies.",category:"Infra",modes:["compare","debate"],tags:["chips","supply-chain"]},{id:"weights-leak",label:"Major Weights Leak",prompt:"A commercial frontier model checkpoint leaks. Assess risks (misuse, impersonation, jailbreak diffusion), legal exposure, and whether open red-team releases mitigate or worsen safety.",category:"Security",modes:["analyze","debate"],tags:["safety","open-weights"]},{id:"on-device-llm-race",label:"On-Device LLM Race",prompt:"Phone OEMs ship 3nm NPUs and 20B-parameter on-device assistants. What actually moves the needle for UX, privacy, and cost vs. cloud? Where do hybrid (edge + cloud) designs win?",category:"Infra",modes:["compare","debate"],tags:["edge","latency"]},{id:"signed-app-prompt-injection",label:"Signed App Prompt Injection",prompt:"A popular signed desktop app shipped with hardcoded system prompts; attackers use supply chain updates to exfiltrate data. How should vendors audit, sandbox, and attest LLM apps?",category:"Security",modes:["compare","analyze"],tags:["supply-chain","prompt-injection"]},{id:"eval-standardization",label:"Safety Eval Standard",prompt:"NIST-style safety eval suites gain traction (jailbreak, autonomy, bio). How should vendors report scores, and what gaps remain for frontier vs. small models?",category:"Policy",modes:["compare","debate"],tags:["evaluation","safety"]},{id:"licensing-standoff",label:"Publisher Licensing Standoff",prompt:"Major news publishers pause AI licensing talks and sue over training. What remedies (revenue share, opt-out registries, model removal) are realistic, and how do they ripple to open models?",category:"Data",modes:["analyze","debate"],tags:["licensing","copyright"]},{id:"sbom-for-llms",label:"SBOM for LLM Pipelines",prompt:"Regulators push SBOMs and signed artifacts for AI stacks. Draft what should appear in an LLM pipeline SBOM (data, weights, evals, guardrails) and how to verify it at runtime.",category:"Security",modes:["compare","analyze"],tags:["sbom","supply-chain"]},{id:"data-poisoning-campaign",label:"Data Poisoning Campaign",prompt:"Researchers find coordinated data poisoning in popular open corpora. How should model hosts detect and mitigate poisoning post-hoc, and what retraining tradeoffs are acceptable?",category:"Security",modes:["compare","debate"],tags:["data","poisoning"]},{id:"copyright-settlement",label:"Copyright Settlement Sets Precedent",prompt:"A major copyright suit settles with dataset disclosure and per-output watermarking. Predict how this precedent affects future training sets and open-weight releases.",category:"Policy",modes:["debate"],tags:["copyright","watermarking"]}],fr={analyze:["What's the most important programming principle?","Should code comments explain 'what' or 'why'?","Is TypeScript worth the extra complexity?"],debate:["Tabs or spaces? Give your verdict.","Should AI be allowed to write its own code?","What will never be automated by AI?"],compare:[],chat:[]};Ct.filter(t=>t.category==="Policy"||t.category==="Data"),Ct.filter(t=>t.category==="Infra"),Ct.filter(t=>t.category==="Security");const is=["dots-mesh","dots","dots-fade","grid","mesh","animated-mesh","none"],it="#0f172a",Zt={compare:it,analyze:it,debate:it,chat:it},Ue={maxTokens:1024,temperature:.7},ue={cardWidth:256,cardHeight:200,gapX:24,gapY:24,baseRadius:160,minRadius:120,radiusPerModel:15,scrollClamp:200};function ls({showDock:t,availableModels:n,allSelectedByType:o,totalModelsByType:d,handleDragStart:u,handleModelToggle:a,handleAddGroup:b,dockRef:f,mode:p,allModels:g,chatModelId:x,setChatModelId:y,chatAutoMode:A,setChatAutoMode:$,chatAutoModeScope:B,setChatAutoModeScope:H,setShowDock:Y}){const[c,W]=s.useState(""),[P,V]=s.useState(""),[I,k]=s.useState(-1),[J,X]=s.useState(!1),oe=s.useRef(null);s.useRef(null),s.useEffect(()=>{const R=setTimeout(()=>{V(c)},200);return()=>clearTimeout(R)},[c]);const M=[{type:"self-hosted",title:"Self-Hosted Models",accentColor:"emerald",chatAutoScope:"self-hosted"},{type:"github",title:"GitHub Models",accentColor:"blue",chatAutoScope:"api"},{type:"external",title:"External Models",accentColor:"purple",chatAutoScope:"external"}],_=p==="chat",G=_?g:n,ne=s.useMemo(()=>{if(!P)return G;const R=P.toLowerCase();return G.filter(T=>T.name.toLowerCase().includes(R))},[G,P]),se=s.useCallback(R=>{_&&($(!0),H(R),Y(!1))},[_,$,H,Y]),K=s.useCallback(R=>{_?($(!1),y(R),Y(!1)):a(R)},[_,$,y,Y,a]);s.useEffect(()=>{t?(setTimeout(()=>{var R;return(R=oe.current)==null?void 0:R.focus()},100),k(-1)):(W(""),k(-1))},[t]),s.useEffect(()=>{if(!t)return;const R=T=>{var U;const re=[];if(M.forEach(ae=>{const ve=ne.filter(ee=>ee.type===ae.type);ve.length>0&&_&&re.push({type:"auto",scope:ae.chatAutoScope}),ve.forEach(ee=>{re.push({type:"model",modelId:ee.id})})}),T.key==="ArrowDown")T.preventDefault(),X(!0),k(ae=>Math.min(ae+1,re.length-1));else if(T.key==="ArrowUp")T.preventDefault(),X(!0),k(ae=>Math.max(ae-1,-1)),I===0&&((U=oe.current)==null||U.focus());else if(T.key==="Enter"&&I>=0&&I<re.length){T.preventDefault();const ae=re[I];ae.type==="auto"&&ae.scope?se(ae.scope):ae.type==="model"&&ae.modelId&&K(ae.modelId)}else T.key==="Escape"?(T.preventDefault(),Y(!1)):T.key==="Tab"&&(T.preventDefault(),I===-1&&k(0))};return window.addEventListener("keydown",R),()=>window.removeEventListener("keydown",R)},[t,I,ne,_,M,se,K,Y]);const Z=R=>_?!A&&x===R:!1,ie=R=>_&&A&&B===R,me=R=>({emerald:{button:"text-emerald-400 hover:text-emerald-300 hover:bg-emerald-500/10",autoActive:"text-emerald-400 hover:text-emerald-300 bg-emerald-500/10 hover:bg-emerald-500/20 border-emerald-500/20",autoInactive:"hover:bg-white/5 text-slate-400 hover:text-slate-200 border-transparent",dot:"bg-emerald-500",textColor:"text-emerald-500",modelActive:"text-emerald-400 hover:text-emerald-300 bg-emerald-500/10 hover:bg-emerald-500/20 border-emerald-500/20",focus:"ring-2 ring-emerald-500/50"},blue:{button:"text-blue-400 hover:text-blue-300 hover:bg-blue-500/10",autoActive:"text-blue-400 hover:text-blue-300 bg-blue-500/10 hover:bg-blue-500/20 border-blue-500/20",autoInactive:"hover:bg-white/5 text-slate-400 hover:text-slate-200 border-transparent",dot:"bg-blue-500",textColor:"text-blue-500",modelActive:"text-blue-400 hover:text-blue-300 bg-blue-500/10 hover:bg-blue-500/20 border-blue-500/20",focus:"ring-2 ring-blue-500/50"},purple:{button:"text-purple-400 hover:text-purple-300 hover:bg-purple-500/10",autoActive:"text-purple-400 hover:text-purple-300 bg-purple-500/10 hover:bg-purple-500/20 border-purple-500/20",autoInactive:"hover:bg-white/5 text-slate-400 hover:text-slate-200 border-transparent",dot:"bg-purple-500",textColor:"text-purple-500",modelActive:"text-purple-400 hover:text-purple-300 bg-purple-500/10 hover:bg-purple-500/20 border-purple-500/20",focus:"ring-2 ring-purple-500/50"}})[R],fe=(R,T,re)=>{let U=0;for(let ae=0;ae<R;ae++){const ve=M[ae],ee=ne.filter(xe=>xe.type===ve.type);ee.length>0&&(_&&U++,U+=ee.length)}return re?U:U+(_?1:0)+T};return e.jsxs("div",{ref:f,"data-no-arena-scroll":!0,"data-no-background":!0,className:"fixed top-1/2 left-1/2 w-[min(90vw,600px)] max-h-[80vh] rounded-2xl flex flex-col z-[60] transition-all duration-300 shadow-2xl",style:{transform:t?"translate(-50%, -50%) scale(1)":"translate(-50%, -50%) scale(0.95)",opacity:t?1:0,pointerEvents:t?"auto":"none"},children:[e.jsxs("div",{className:"px-5 py-4 border-b border-slate-700/50 bg-slate-800/95 backdrop-blur-md rounded-t-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-200",children:"Model Selection"}),e.jsx("p",{className:"text-[10px] text-slate-500 mt-0.5",children:"Click to add to arena or select for chat"})]}),e.jsx("button",{onClick:()=>Y(!1),className:"text-slate-400 hover:text-slate-200 transition-colors",title:"Close",children:e.jsx(Wn,{size:18})})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Fn,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-500"}),e.jsx("input",{ref:oe,type:"text",placeholder:"Search models...",value:c,onChange:R=>W(R.target.value),className:"w-full pl-9 pr-3 py-2 text-sm bg-slate-700/50 border border-slate-600/50 rounded-lg text-slate-200 placeholder-slate-500 focus:outline-none focus:border-slate-500"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-5 py-4 space-y-5 bg-slate-800/95 backdrop-blur-md",children:M.map((R,T)=>{const re=ne.filter(te=>te.type===R.type),U=n.filter(te=>te.type===R.type),ae=o[R.type],ve=d[R.type]>0,ee=me(R.accentColor),xe=ie(R.chatAutoScope);if(U.length===0)return null;const i=fe(T,0,!0),ce=I===i;return e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between px-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${ee.dot}`}),e.jsx("h3",{className:"text-[11px] font-semibold text-slate-300 uppercase tracking-wide",children:R.title}),e.jsxs("span",{className:"text-[10px] text-slate-500",children:["(",U.length,")"]})]}),!_&&e.jsx("button",{onClick:()=>b(R.type),className:`text-[10px] font-medium px-2 py-1 rounded transition-colors duration-150 ${ee.button} ${ve?"":"opacity-40 cursor-not-allowed"}`,disabled:!ve,children:ae?"− Remove All":"+ Add All"})]}),_&&e.jsxs("button",{onClick:()=>se(R.chatAutoScope),onMouseEnter:()=>{X(!1),k(i)},className:`group flex items-center justify-between gap-2 px-3 py-2 rounded-lg transition-[background-color,border-color,box-shadow] duration-150 border ${xe?ee.autoActive:ee.autoInactive} ${ce&&J?ee.focus:""}`,title:"Auto mode with smart fallback",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(rn,{size:14,className:xe?ee.textColor:"text-slate-500"}),e.jsx("span",{className:"text-xs font-medium",children:"Auto (Smart Fallback)"})]}),xe&&e.jsx(Qt,{size:14,className:ee.textColor})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[re.map((te,pe)=>{const le=Z(te.id),he=fe(T,pe,!1),ye=I===he;return e.jsxs("div",{draggable:!_,onDragStart:_?void 0:Me=>u(Me,te.id),onClick:()=>K(te.id),onMouseEnter:()=>{X(!1),k(he)},className:`group flex items-center justify-between gap-3 px-3 py-2 rounded-lg transition-[background-color,border-color,box-shadow] duration-150 border ${_?`cursor-pointer ${le?ee.modelActive:"hover:bg-white/5 border-transparent"}`:"cursor-grab active:cursor-grabbing hover:bg-white/5 border-transparent"} ${ye&&J?ee.focus:""}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${ee.dot} ${le?"opacity-100":"opacity-60 group-hover:opacity-100"} transition-opacity`}),e.jsx("span",{className:`text-xs font-medium ${le?"text-slate-200":"text-slate-400 group-hover:text-slate-200"} transition-colors`,children:te.name})]}),le&&e.jsx(Qt,{size:14,className:ee.textColor})]},te.id)}),re.length===0&&c&&e.jsx("div",{className:"text-[10px] text-slate-600 italic px-3 py-2",children:"No models match your search"}),re.length===0&&!c&&e.jsx("div",{className:"text-[10px] text-slate-600 italic px-3 py-2",children:"All models are in the arena"})]})]},R.type)})}),e.jsx("div",{className:"px-5 py-3 border-t border-slate-700/50 bg-slate-900/50 backdrop-blur-md rounded-b-2xl",children:e.jsxs("p",{className:"text-[10px] text-slate-500 text-center",children:["Press ",e.jsx("kbd",{className:"px-1 py-0.5 rounded bg-slate-800 text-slate-400 font-mono text-[9px]",children:"M"})," or ",e.jsx("kbd",{className:"px-1 py-0.5 rounded bg-slate-800 text-slate-400 font-mono text-[9px]",children:"Esc"})," to close"]})})]})}function cs({inputRef:t,inputFocused:n,setInputFocused:o,onSendMessage:d,className:u,style:a,placeholder:b,isGenerating:f,onStop:p}){return e.jsx("div",{className:u??"fixed bottom-0 right-0 left-0 z-[100] pb-6 px-3 sm:px-4 flex justify-center items-end pointer-events-none transition-all duration-300",style:a??{paddingBottom:"calc(1.5rem + env(safe-area-inset-bottom))"},children:e.jsx("div",{className:"w-full pointer-events-auto",style:{maxWidth:"600px"},children:e.jsxs("div",{className:`rounded-xl p-2.5 transition-all duration-300 flex items-center gap-2 border border-slate-700/40 header-shell ${n?"prompt-panel-focused":""}`,children:[e.jsx("input",{ref:t,type:"text",placeholder:b||"Ask a question to compare model responses...",className:"w-full bg-transparent text-slate-200 placeholder-slate-500 outline-none text-base sm:text-sm px-2.5 py-2.5",onFocus:()=>o(!0),onBlur:()=>o(!1),onKeyDown:g=>{var x;if(g.key==="Enter"&&!g.shiftKey){if(g.preventDefault(),f)return;(x=t.current)!=null&&x.value&&(d(t.current.value),t.current.value="")}},disabled:f}),e.jsx("button",{onClick:()=>{var g;f?p==null||p():(g=t.current)!=null&&g.value&&(d(t.current.value),t.current.value="")},onMouseDown:g=>g.currentTarget.blur(),className:`min-w-[44px] min-h-[44px] sm:min-w-[36px] sm:min-h-[36px] p-2 rounded-lg transition-colors active:scale-95 flex items-center justify-center focus:outline-none focus-visible:outline-none ${f?"text-red-400 hover:text-red-300 hover:bg-red-500/10":"text-slate-400 hover:text-white hover:bg-white/10"}`,"aria-label":f?"Stop generation":"Send message",children:f?e.jsx(Yn,{className:"w-5 h-5 sm:w-4 sm:h-4 fill-current"}):e.jsx(Xn,{className:"w-5 h-5 sm:w-4 sm:h-4",strokeWidth:2.5})})]})})})}const ds={chat:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),compare:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2"})}),analyze:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),debate:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})},Oe=[{value:"chat",label:"Chat"},{value:"compare",label:"Compare"},{value:"analyze",label:"Analyze"},{value:"debate",label:"Debate"}];function us({mode:t,setMode:n,setHoveredCard:o,clearSelection:d,showDock:u,setShowDock:a,onOpenSettings:b,gestureButtonSlot:f}){const[p,g]=s.useState(!1),x=s.useRef(null),[y,A]=s.useState(!0),$=s.useRef(null),[B,H]=s.useState(null),[Y,c]=s.useState(0),W=Oe.findIndex(k=>k.value===t),P=W===-1?0:W,V=Oe[P].label;s.useEffect(()=>{const k=()=>{A(window.innerWidth>=1024)};return k(),window.addEventListener("resize",k),()=>window.removeEventListener("resize",k)},[]),s.useEffect(()=>{if(!$.current)return;const k=()=>{const oe=$.current;if(!oe)return;const M=oe.querySelectorAll('button[role="radio"]');if(M.length===0||P>=M.length)return;const G=M[P].getBoundingClientRect(),ne=oe.getBoundingClientRect(),se=G.width,K=G.left,Z=ne.left;H(se),c(K-Z)},J=setTimeout(k,0),X=new ResizeObserver(()=>{setTimeout(k,0)});return X.observe($.current),window.addEventListener("resize",k),()=>{clearTimeout(J),X.disconnect(),window.removeEventListener("resize",k)}},[t,y,P]),s.useEffect(()=>{function k(J){x.current&&!x.current.contains(J.target)&&g(!1)}return p&&document.addEventListener("mousedown",k),()=>{document.removeEventListener("mousedown",k)}},[p]);const I=k=>{n(k),o(null),d(),g(!1)};return e.jsxs("div",{className:"fixed top-0 left-0 right-0 flex items-center justify-between mb-2 px-3 sm:px-6 pt-4 sm:pt-6 z-50 pointer-events-none transition-all duration-300",children:[e.jsx("div",{className:"absolute inset-0 pointer-events-auto",style:{height:"100%",zIndex:-1}}),e.jsx("div",{className:"flex items-center gap-2 w-auto pointer-events-auto z-20",children:f}),e.jsx("div",{className:"hidden md:block absolute left-1/2 -translate-x-1/2 pointer-events-auto z-20",children:e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex items-center p-1.5 rounded-xl border border-slate-700/40 header-shell",children:[e.jsx("button",{onClick:()=>a(!u),className:"px-2 sm:px-3 flex items-center justify-center text-slate-400 hover:text-white transition-colors",title:"Toggle Model Dock",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsx("div",{className:"w-px h-5 bg-slate-700/50 mx-0.5 sm:mx-1"}),e.jsxs("div",{ref:$,className:"relative flex p-1 rounded-lg bg-black/20 mode-track",role:"radiogroup","aria-label":"Mode selection","data-gesture-mode-track":"true",children:[e.jsx("div",{className:"absolute top-1 bottom-1 rounded-md transition-all duration-300 ease-out mode-slider",style:{width:B!==null?`${B}px`:`calc((100% - 8px) / ${Oe.length})`,left:B!==null?`${Y}px`:`calc(4px + (100% - 8px) * ${P} / ${Oe.length})`}}),Oe.map(k=>e.jsx("button",{tabIndex:-1,onClick:()=>I(k.value),role:"radio","aria-checked":t===k.value,"aria-label":k.label,title:k.label,className:`relative z-10 py-2 sm:py-1.5 px-3 text-[11px] sm:text-xs font-medium transition-colors duration-200 min-h-[44px] sm:min-h-0 active:scale-95 focus:outline-none focus-visible:outline-none flex-1 flex items-center justify-center text-center ${t===k.value?"text-white":"text-slate-400 hover:text-slate-200"}`,children:k.label},k.value))]})]})})}),e.jsx("div",{className:"flex md:hidden flex-1 justify-center pointer-events-auto relative z-20",children:e.jsxs("div",{className:"relative",ref:x,children:[e.jsxs("button",{onClick:()=>g(!p),className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-slate-800/90 border border-slate-700/50 text-slate-200 font-medium text-sm backdrop-blur-md shadow-lg active:scale-95 transition-all",children:[e.jsx("span",{className:"font-bold text-slate-400 hidden xs:inline",children:"Arena"}),e.jsx("span",{className:"font-bold hidden xs:inline text-slate-600",children:"/"}),e.jsx("span",{children:V}),e.jsx("svg",{className:`w-4 h-4 text-slate-400 transition-transform duration-200 ${p?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),p&&e.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 mt-2 w-48 py-1 rounded-xl bg-slate-800 border border-slate-700 shadow-2xl overflow-hidden flex flex-col animate-in fade-in zoom-in-95 duration-100 origin-top",children:Oe.map(k=>e.jsxs("button",{onClick:()=>I(k.value),className:`px-4 py-3 text-sm text-left w-full transition-colors flex items-center gap-3 ${t===k.value?"bg-blue-500/10 text-blue-400":"text-slate-300 hover:bg-slate-700/50"}`,children:[e.jsx("span",{className:"flex-shrink-0",children:ds[k.value]}),e.jsx("span",{className:"flex-1",children:k.label}),t===k.value&&e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]},k.value))})]})}),e.jsx("div",{className:"flex items-center gap-2 w-auto justify-end pointer-events-auto z-20",children:e.jsx("button",{onClick:b,className:"min-w-[42px] min-h-[42px] w-[42px] h-[42px] rounded-full bg-slate-800/50 flex items-center justify-center border border-slate-700/50 hover:border-slate-600 transition-colors active:scale-95 focus:outline-none focus-visible:outline-none",title:"Settings",children:e.jsxs("svg",{className:"w-4 h-4 text-slate-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),e.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})})})]})}const fs=t=>{if(typeof t=="string")return t;try{return JSON.stringify(t)}catch{return null}},ps=(t,n)=>{if(t===null)return n;try{return JSON.parse(t)}catch{return n}};function Be(t,n,o={}){const d=o.serialize??fs,u=o.deserialize??ps,[a,b]=s.useState(()=>{if(typeof window>"u")return n;try{const f=window.localStorage.getItem(t);return u(f,n)}catch{return n}});return s.useEffect(()=>{if(!(typeof window>"u"))try{const f=d(a);f===null?window.localStorage.removeItem(t):window.localStorage.setItem(t,f)}catch{}},[t,d,a]),[a,b]}const hs=800,ms=3e3,xs=8;function gs(){const[t,n]=s.useState([]),[o,d]=s.useState(!0),[u,a]=s.useState(null),[b,f]=s.useState(0),[p,g]=Be("playground_selected_models",null),x=s.useRef(p!==null),[y,A]=Be("playground_chat_model",null),$=s.useRef(y!==null),B=s.useMemo(()=>p??[],[p]),H=s.useCallback(M=>{g(_=>typeof M=="function"?M(_??[]):M)},[g]),[Y,c]=s.useState(""),W=s.useRef(0),P=s.useRef(null),V=s.useCallback(async(M,_,G=!1)=>{P.current&&(clearTimeout(P.current),P.current=null),d(!0),G&&(a("Refreshing..."),f(0));const ne=se=>{var fe,R;const K=se.models.map(T=>{const re=T.type==="self-hosted"||T.type==="github"||T.type==="external"?T.type:"self-hosted",U=Zn[re];return{id:T.id,name:U.name||T.name||T.id,color:U.color,type:re,response:"Ready to generate...",priority:T.priority,context_length:T.context_length,default:T.default}});if(n(K),d(!1),a(null),f(0),x.current||(g(K.filter(T=>T.type==="self-hosted"&&T.id!=="nemotron-3-nano-30b-a3b").map(T=>T.id)),x.current=!0),!$.current){const T=K.find(U=>U.default),re=K.find(U=>U.type==="github"||U.type==="external");A((T==null?void 0:T.id)||(re==null?void 0:re.id)||((fe=K[0])==null?void 0:fe.id)||null),$.current=!0}const Z=K.find(T=>T.type==="github"||T.type==="external"),ie=K.find(T=>T.default),me=((R=K[0])==null?void 0:R.id)||"";c((Z==null?void 0:Z.id)||(ie==null?void 0:ie.id)||me)};try{const se=await fetch("/api/models");if(M!==W.current)return;if(!se.ok)throw new Error(`HTTP ${se.status}`);const K=await se.json();if(M!==W.current)return;if(!K.models||K.models.length===0)throw new Error("No models available yet");ne(K)}catch(se){if(M!==W.current)return;console.warn("Backend fetch failed:",se);try{console.log("Trying static models.json...");const Z=await fetch("/models.json");if(Z.ok){const ie=await Z.json();if(ie.models&&ie.models.length>0){console.log(`Loaded ${ie.models.length} models from static file`),ne(ie);return}}}catch(Z){console.warn("Static models.json not available:",Z)}const K=_+1;if(f(K),K<xs){const Z=Math.min(hs*Math.pow(1.4,_),ms);a("Connecting to backend..."),P.current=setTimeout(()=>{V(M,K)},Z)}else d(!1),a("Could not load models")}},[g,A]),I=s.useCallback(()=>{W.current+=1,V(W.current,0,!0)},[V]);s.useEffect(()=>(W.current+=1,V(W.current,0),()=>{W.current+=1,P.current&&clearTimeout(P.current)}),[V]);const k=s.useMemo(()=>t.filter(M=>!B.includes(M.id)),[t,B]),{totalModelsByType:J,allSelectedByType:X}=s.useMemo(()=>{const M={"self-hosted":t.filter(G=>G.type==="self-hosted").length,github:t.filter(G=>G.type==="github").length,external:t.filter(G=>G.type==="external").length},_={"self-hosted":t.filter(G=>G.type==="self-hosted"&&B.includes(G.id)).length,github:t.filter(G=>G.type==="github"&&B.includes(G.id)).length,external:t.filter(G=>G.type==="external"&&B.includes(G.id)).length};return{totalModelsByType:M,allSelectedByType:{"self-hosted":M["self-hosted"]>0&&_["self-hosted"]===M["self-hosted"],github:M.github>0&&_.github===M.github,external:M.external>0&&_.external===M.external}}},[t,B]),oe=s.useCallback(M=>{var _;return((_=t.find(G=>G.id===M))==null?void 0:_.name)||M},[t]);return{modelsData:t,setModelsData:n,selected:B,setSelected:H,chatModelId:y,setChatModelId:A,moderator:Y,setModerator:c,availableModels:k,totalModelsByType:J,allSelectedByType:X,modelIdToName:oe,isLoading:o,loadError:u,retryCount:b,retryNow:I}}function bs(){var t;return typeof chrome<"u"&&((t=chrome.storage)!=null&&t.local)?window.__API_BASE__||"https://chat.neevs.io":""}async function*Rt(t,n,o){var g;const u=`${bs()}${t}`,a=await fetch(u,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),signal:o});if(!a.ok){yield{event:"error",error:`HTTP ${a.status}: ${a.statusText}`};return}const b=(g=a.body)==null?void 0:g.getReader();if(!b){yield{event:"error",error:"No response body"};return}const f=new TextDecoder;let p="";try{for(;;){const{done:x,value:y}=await b.read();if(x)break;p+=f.decode(y,{stream:!0});const A=p.split(`
`);p=A.pop()||"";for(const $ of A)if($.startsWith("data: ")){const B=$.slice(6).trim();if(B)try{yield JSON.parse(B)}catch{}}}}finally{b.releaseLock()}}const ys=async(t,n)=>Rt("/api/chat/stream",{models:t.models,messages:t.messages,max_tokens:t.max_tokens,temperature:t.temperature,github_token:t.github_token,openrouter_key:t.openrouter_key},n),vs=async(t,n)=>Rt("/api/chat/analyze/stream",t,n),ws=async(t,n)=>Rt("/api/chat/debate/stream",t,n),Nt=async(t,n)=>{try{for await(const o of t)n(o)}catch(o){throw console.error("Stream error:",o),o}};function en(t){window.__API_BASE__=t}const ks=[{name:"Chat",path:"chat.yml",category:"core"},{name:"Build Images",path:"build-push-images.yml",category:"core"},{name:"Nanbeige4-3B Thinking",path:"inference.yml",category:"reasoning",serviceKey:"nanbeige"},{name:"Qwen3 4B",path:"inference.yml",category:"small",serviceKey:"qwen"},{name:"SmolLM3 3B",path:"inference.yml",category:"small",serviceKey:"smollm3"},{name:"LFM2 2.6B",path:"inference.yml",category:"small",serviceKey:"lfm2"},{name:"DeepSeek R1 1.5B",path:"inference.yml",category:"reasoning",serviceKey:"r1qwen"},{name:"Gemma 3 12B",path:"inference.yml",category:"medium",serviceKey:"gemma"},{name:"Mistral 7B v0.3",path:"inference.yml",category:"medium",serviceKey:"mistral"},{name:"Phi-3 Mini",path:"inference.yml",category:"small",serviceKey:"phi"},{name:"RNJ-1 Instruct",path:"inference.yml",category:"medium",serviceKey:"rnj"},{name:"Llama 3.2-3B",path:"inference.yml",category:"medium",serviceKey:"llama"},{name:"FunctionGemma 270M",path:"inference.yml",category:"small",serviceKey:"functiongemma"},{name:"Nemotron-3 Nano 30B",path:"inference.yml",category:"reasoning",serviceKey:"nemotron"},{name:"GPT-OSS 20B",path:"inference.yml",category:"reasoning",serviceKey:"gptoss"}],js={workflows:ks},on=js.workflows;new Map(on.map(t=>[t.name,t.path]));new Map(on.filter(t=>t.serviceKey).map(t=>[t.serviceKey,t.name]));const Pe={githubToken:"",profile:"local_all",chatApiBaseUrl:"http://localhost:8080",modelsBaseDomain:"",modelsUseHttps:!1};function tn(t){const n={...Pe,...t};(!n.chatApiBaseUrl||typeof n.chatApiBaseUrl!="string")&&typeof n.baseDomain=="string"&&(n.chatApiBaseUrl=n.baseDomain?`${n.useHttps===!1?"http":"https"}://chat.${n.baseDomain}`:"http://localhost:8080",n.profile="custom"),(!n.modelsBaseDomain||typeof n.modelsBaseDomain!="string")&&typeof n.baseDomain=="string"&&(n.modelsBaseDomain=n.baseDomain,n.profile="custom"),typeof n.modelsUseHttps!="boolean"&&typeof n.useHttps=="boolean"&&(n.modelsUseHttps=n.useHttps,n.profile="custom");const o=n.profile==="remote_all"||n.profile==="local_chat_remote_models"||n.profile==="local_all"||n.profile==="custom"?n.profile:Pe.profile;return{githubToken:typeof n.githubToken=="string"?n.githubToken:Pe.githubToken,profile:o,chatApiBaseUrl:At(typeof n.chatApiBaseUrl=="string"?n.chatApiBaseUrl:""),modelsBaseDomain:typeof n.modelsBaseDomain=="string"?n.modelsBaseDomain:Pe.modelsBaseDomain,modelsUseHttps:typeof n.modelsUseHttps=="boolean"?n.modelsUseHttps:Pe.modelsUseHttps}}function Ss(){var t;return typeof chrome<"u"&&!!((t=chrome.storage)!=null&&t.local)}function At(t){const n=t.trim().replace(/\/+$/,"");return n||"http://localhost:8080"}function Ms(){const[t,n]=s.useState(Pe),[o,d]=s.useState(!1);return s.useEffect(()=>{if(Ss()){chrome.storage.local.get(["envConfig"],a=>{const b=tn(a.envConfig);n(b),d(!0);const f=At(b.chatApiBaseUrl);en(f),console.log("[Config] Extension mode, API base:",f)});const u=(a,b)=>{var f;if(b==="local"&&((f=a.envConfig)!=null&&f.newValue)){const p=tn(a.envConfig.newValue);n(p);const g=At(p.chatApiBaseUrl);en(g),console.log("[Config] Updated API base:",g)}};return chrome.storage.onChanged.addListener(u),()=>chrome.storage.onChanged.removeListener(u)}else d(!0),console.log("[Config] Web mode, using relative URLs")},[]),{config:t,isLoaded:o}}function Es(){const[t,n]=s.useState([]),o=s.useRef([]),d=s.useCallback(f=>{if(!f.length)return;const p=[...o.current,...f];o.current=p,n(p)},[]),u=s.useCallback(()=>{o.current=[],n([])},[]),a=s.useCallback(f=>f.map(p=>`${p.role==="user"?"User":"Assistant"}: ${p.content}`).join(`

`),[]),b=s.useCallback((f,p)=>{if(p==="compare")return f;const g=f.filter(y=>y.role==="user"),x=[...f].reverse().find(y=>y.role==="assistant"&&y.kind==="analyze_synthesis"&&y.content.trim().length>0);return x?[...g,x]:g},[]);return{history:t,historyRef:o,pushHistoryEntries:d,clearHistory:u,historyToText:a,buildCarryoverHistory:b}}function Cs(t){const n=s.useRef({}),o=s.useRef(null),d=s.useCallback(()=>{o.current=null;const p=n.current;n.current={},Object.keys(p).length&&t(x=>x.map(y=>{const A=p[y.id];return A?{...y,response:(y.response||"")+A.answer,thinking:(y.thinking||"")+A.thinking}:y}))},[t]),u=s.useCallback(()=>{o.current==null&&(o.current=requestAnimationFrame(d))},[d]),a=s.useCallback((p,g,x)=>{if(!g&&!x)return;const y=n.current[p]||{answer:"",thinking:""};y.answer+=g,y.thinking+=x,n.current[p]=y,u()},[u]),b=s.useCallback(p=>{n.current[p]&&delete n.current[p]},[]),f=s.useCallback(()=>{n.current={},o.current!=null&&(cancelAnimationFrame(o.current),o.current=null)},[]);return{pendingStreamRef:n,flushStreamRafRef:o,enqueueStreamDelta:a,clearPendingStreamForModel:b,resetPendingStream:f}}function Ns(t){const{mode:n,moderator:o,selected:d,selectedCardIds:u,githubToken:a,isGenerating:b,summarizeSessionResponses:f,setLastQuery:p,setHoveredCard:g,setPhaseLabel:x,setModeratorSynthesis:y,setDiscussionTurnsByModel:A,resetFailedModels:$,markModelFailed:B,failedModelsRef:H,currentDiscussionTurnRef:Y,sessionModelIdsRef:c,abortControllerRef:W,thinkingStateRef:P,conversationHistoryRef:V,pushHistoryEntries:I,historyToText:k,buildCarryoverHistory:J,setModelsData:X,modelIdToName:oe,setExecutionTimes:M,setIsGenerating:_,setIsSynthesizing:G,setSpeaking:ne,enqueueStreamDelta:se,clearPendingStreamForModel:K,resetPendingStream:Z}=t;return{sendMessage:async(me,fe,R,T)=>{if(!me.trim()||d.length===0&&!R||!R&&b)return;const re=(T==null?void 0:T.skipHistory)??!1,U={role:"user",content:me},ae=re?V.current:[...V.current,U];re||I([U]);const ve=J(ae,n),ee=k(ve);p(me);const xe=ee?`${ee}

Continue the conversation above and respond to the latest user request.`:me;let i;if(R)i=R;else{const L=Array.from(u).filter(j=>d.includes(j)&&(n==="compare"||j!==o));i=L.length>0?L:d.slice()}c.current=i;const ce={},te=(L,j,m)=>{if(!j)return;const h=m!=null&&m.label?`${m.label}: ${j}`:j;ce[L]=m!=null&&m.replace?h:ce[L]?`${ce[L]}

${h}`:h},pe=new AbortController;W.current=pe,_(!0),G(!1),g(null),x(null),y(""),A({}),$(),Y.current=null,Z(),X(L=>L.map(j=>i.includes(j.id)||j.id===o?fe&&fe[j.id]?{...j,response:fe[j.id],thinking:void 0,error:void 0}:{...j,response:"",thinking:void 0,error:void 0}:j)),M(L=>{const j={...L},m=performance.now();return i.forEach(h=>{j[h]={startTime:m}}),o&&!j[o]&&(j[o]={startTime:m}),j});const le=new Set(i);o&&le.add(o),le.forEach(L=>{const j=os(L),m=as(L);P.current[L]={inThink:j||m,carry:"",implicitThinking:j,harmonyFormat:m}});const he=new Set,ye=(L,j)=>{const m=L==null?void 0:L.trim();!m||re||I([{role:"assistant",content:m,kind:j}])},Me=(L,j)=>{const m=P.current[L]||{inThink:!1,carry:"",implicitThinking:!1};let h=m.carry+j;m.carry="";const S=h.lastIndexOf("<");if(S!==-1&&h.length-S<12){const E=h.slice(S);("<think>".startsWith(E)||"</think>".startsWith(E)||"<thinking>".startsWith(E)||"</thinking>".startsWith(E))&&(m.carry=E,h=h.slice(0,S))}let v="",F="",D=0;if(m.harmonyFormat){const E="<|channel|>final<|message|>",z=h.indexOf(E);if(z!==-1)m.inThink&&(v+=h.slice(0,z)),m.inThink=!1,F+=h.slice(z+E.length);else if(m.inThink){const de=h.replace(/<\|channel\|>analysis<\|message\|>/gi,"").replace(/<\|end\|>/gi,"").replace(/<\|start\|>/gi,"").replace(/assistant/gi,"");v+=de}else{const de=h.replace(/<\|end\|>/gi,"");F+=de}P.current[L]=m,F&&te(L,F),(v||F)&&se(L,F,v);return}if(!m.inThink&&!m.implicitThinking){const E=h.indexOf("</think>"),z=h.indexOf("</thinking>"),de=E!==-1||z!==-1,ge=h.indexOf("<think>")!==-1||h.indexOf("<thinking>")!==-1;de&&!ge&&(m.implicitThinking=!0,m.inThink=!0)}for(;D<h.length;)if(m.inThink){const E=h.indexOf("</think>",D),z=h.indexOf("</thinking>",D);let de=-1,ge=0;if(E!==-1&&(z===-1||E<z)?(de=E,ge=8):z!==-1&&(de=z,ge=11),de===-1){v+=h.slice(D);break}v+=h.slice(D,de),m.inThink=!1,m.implicitThinking=!1,D=de+ge}else{const E=h.indexOf("<think>",D),z=h.indexOf("<thinking>",D);let de=-1,ge=0;if(E!==-1&&(z===-1||E<z)?(de=E,ge=7):z!==-1&&(de=z,ge=10),de===-1){F+=h.slice(D);break}F+=h.slice(D,de),m.inThink=!0,D=de+ge}P.current[L]=m,F&&te(L,F),(v||F)&&se(L,F,v)},qe=L=>{const j=L.toLowerCase();return j.includes("rate limit")||j.includes("waiting")?'<svg width="14" height="14" viewBox="0 0 24 24" fill="none" style="display: inline-block; vertical-align: text-bottom; margin-right: 6px;"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none"/><path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>'+L:j.includes("error")||j.includes("failed")?'<svg width="14" height="14" viewBox="0 0 24 24" fill="none" style="display: inline-block; vertical-align: text-bottom; margin-right: 6px;"><path d="M12 2L2 20h20L12 2z" stroke="currentColor" stroke-width="2" fill="none" stroke-linejoin="round"/><path d="M12 9v4M12 17h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>'+L:L};try{if(n==="compare"){ne(new Set(i));const L=await ys({models:i,messages:ae.map(j=>({role:j.role,content:j.content})),max_tokens:Ue.maxTokens,temperature:Ue.temperature,github_token:a||null},pe.signal);if(await Nt(L,j=>{if(j.event==="info"&&j.content){const m=String(j.content),h=qe(m);x(h),j.model_id&&X(S=>S.map(v=>v.id===j.model_id?{...v,statusMessage:h}:v))}if(j.event==="token"&&j.model_id){const m=j.model_id,h=performance.now();he.has(m)||(he.add(m),M(S=>({...S,[m]:{...S[m],firstTokenTime:h}})),X(S=>S.map(v=>v.id===m?{...v,statusMessage:void 0}:v))),Me(m,String(j.content??""))}if(j.event==="done"&&j.model_id){const m=performance.now(),h=j.model_id;M(S=>({...S,[h]:{...S[h],endTime:m}})),ne(S=>{const v=new Set(S);return v.delete(h),v})}}),!re){const j=f(ce,i);j&&I([{role:"assistant",content:j,kind:"compare_summary"}])}return}if(n==="analyze"){const L=i;if(L.length<2){const h="Select at least 2 participants for Analyze mode.";y(h),o&&X(S=>S.map(v=>v.id===o?{...v,response:h}:v)),x("Error");return}ne(new Set(L));const j=await vs({query:xe,participants:L,max_tokens:Ue.maxTokens,github_token:a||null},pe.signal);let m="";if(await Nt(j,h=>{const S=h.event;if(S==="analyze_start"&&x("Collecting Responses"),S==="model_start"&&h.model_id){const v=h.model_id;ne(F=>{const D=new Set(F);return D.add(v),D})}if(S==="model_chunk"&&h.model_id){const v=h.model_id,F=performance.now();he.has(v)||(he.add(v),M(D=>({...D,[v]:{...D[v],firstTokenTime:F}}))),Me(v,String(h.chunk??""))}if(S==="model_response"&&h.model_id){const v=h.model_id,F=performance.now();M(E=>({...E,[v]:{...E[v],endTime:F}})),ne(E=>{const z=new Set(E);return z.delete(v),z});const D=String(h.response??"");te(v,D,{replace:!0}),fe&&fe[v]||(X(E=>E.map(z=>z.id===v?{...z,response:D}:z)),ye(`${oe(v)}:
${D}`,"analyze_response"))}if(S==="model_error"&&h.model_id){const v=h.model_id,F=performance.now();M(E=>({...E,[v]:{...E[v],endTime:F}})),ne(E=>{const z=new Set(E);return z.delete(v),z});const D=String(h.error??"Error generating response.");K(v),X(E=>E.map(z=>z.id===v?{...z,response:D,error:D}:z)),B(v),te(v,D,{replace:!0})}if(S==="analysis_complete"){x("Analysis Complete");const v=h.consensus||[],F=h.unique_contributions||{};let D=`Analysis:

`;if(v.length>0&&(D+=`Consensus:
`+v.map(E=>`• ${E}`).join(`
`)+`

`),Object.keys(F).length>0){D+=`Unique Contributions:
`;for(const[E,z]of Object.entries(F)){const de=oe(E);D+=`
${de}:
`+z.map(ge=>`• ${ge}`).join(`
`)+`
`}}m=D,y(D),o&&X(E=>E.map(z=>z.id===o?{...z,response:D}:z))}if(S==="analyze_complete"&&(x("Complete"),ne(new Set)),S==="error"){const v=String(h.error??"Analyze error.");y(v),x("Error")}}),!re){const h=m.trim();h&&I([{role:"assistant",content:h,kind:"analyze_synthesis"}])}return}if(n==="debate"){const L=i;if(L.length<2){const m="Select at least 2 participants for Debate mode.";y(m),o&&X(h=>h.map(S=>S.id===o?{...S,response:m}:S)),x("Error");return}const j=await ws({query:xe,participants:L,turns:2,max_tokens:Ue.maxTokens,temperature:Ue.temperature,github_token:a||null},pe.signal);await Nt(j,m=>{const h=m.event;if(h==="debate_start"&&x("Debate Starting"),h==="round_start"){const S=m.round_number??0;x(`Round ${S+1}`)}if(h==="turn_start"&&m.model_id){const S=m.model_id,v=m.turn_number??0,F=m.round_number??0;ne(new Set([S])),x(`Round ${F+1} · Turn ${v+1}`),Y.current={modelId:S,turnNumber:v}}if(h==="turn_chunk"&&m.model_id){const S=m.model_id,v=performance.now();he.has(S)||(he.add(S),M(F=>({...F,[S]:{...F[S],firstTokenTime:v}}))),Me(S,String(m.chunk??""))}if(h==="turn_complete"&&m.model_id){const S=m.model_id,v=performance.now();M(E=>({...E,[S]:{...E[S],endTime:v}})),ne(E=>{const z=new Set(E);return z.delete(S),z});const F=String(m.response??""),D=m.turn_number??0;te(S,F,{replace:!0}),X(E=>E.map(z=>z.id===S?{...z,response:F}:z)),A(E=>({...E,[S]:[...E[S]||[],{turn_number:D,response:F}]})),ye(`${oe(S)}:
${F}`,"debate_turn")}if(h==="turn_error"&&m.model_id){const S=m.model_id,v=performance.now();M(D=>({...D,[S]:{...D[S],endTime:v}})),ne(D=>{const E=new Set(D);return E.delete(S),E});const F=String(m.error??"Turn error.");K(S),X(D=>D.map(E=>E.id===S?{...E,response:F,error:F}:E)),B(S)}if(h==="debate_complete"&&(x("Complete"),ne(new Set)),h==="error"){const S=String(m.error??"Debate error.");x("Error"),y(S)}});return}}catch(L){if(L.name==="AbortError")return;if(console.error("Chat error:",L),W.current===pe){const j=L.message||String(L);y(`Session Error: ${j}`),x("Error"),Z(),X(m=>m.map(h=>i.includes(h.id)&&!h.response?{...h,response:"Error generating response."}:h)),i.forEach(m=>B(m))}}finally{if(W.current===pe){const L=performance.now();M(j=>{const m={...j};return c.current.forEach(h=>{m[h]&&!m[h].endTime&&(m[h]={...m[h],endTime:L})}),m}),_(!1),G(!1),x(j=>j==="Error"?j:null),ne(new Set)}}}}}function Tt(t,n){const o=Math.min(t.x,n.x),d=Math.min(t.y,n.y),u=Math.max(t.x,n.x),a=Math.max(t.y,n.y);return{left:o,top:d,right:u,bottom:a,width:u-o,height:a-d}}function Ts({rootContainerRef:t,visualizationAreaRef:n,arenaOffsetYRef:o,arenaTargetYRef:d,wheelRafRef:u,selectedModels:a,cardRefs:b,selectedCardIds:f,setSelectedCardIds:p,suppressClickRef:g}){const[x,y]=s.useState(null),A=s.useRef(!1);s.useEffect(()=>{A.current=x!=null},[x]),s.useEffect(()=>{const H=Y=>{if(Y.button!==0||!t.current)return;const c=Y.target;if(!c)return;const W=c.closest("[data-card]"),P=c.closest('button, a, input, textarea, select, [role="button"]'),V=c.closest("[draggable]"),I=c.closest("[data-no-arena-scroll]");if(W||P||V||I||!t.current.contains(c))return;d.current=o.current,u.current!=null&&(cancelAnimationFrame(u.current),u.current=null);const k=t.current.getBoundingClientRect(),J={x:Y.clientX-k.left,y:Y.clientY-k.top};Y.preventDefault(),A.current=!0,g.current.card=!1,g.current.background=!1,y({origin:J,current:J,active:!1})};return window.addEventListener("mousedown",H,!0),()=>window.removeEventListener("mousedown",H,!0)},[o,d,u,t,n,g]),s.useEffect(()=>{if(!x||!t.current)return;const H=W=>W.preventDefault();document.addEventListener("selectstart",H);const Y=W=>{const P=t.current.getBoundingClientRect(),V={x:W.clientX-P.left,y:W.clientY-P.top};y(I=>{if(!I)return I;const k=Tt(I.origin,V),J=I.active||k.width>4||k.height>4;return{...I,current:V,active:J}})},c=W=>{A.current=!1;const P=t.current.getBoundingClientRect(),V={x:W.clientX-P.left,y:W.clientY-P.top},I=W.target,k=!!(I&&I.closest("[data-card]"));y(J=>{if(!J)return null;const X=Tt(J.origin,V);if(J.active&&X.width>0&&X.height>0){const oe=[],M=t.current.getBoundingClientRect(),_={left:M.left+X.left,right:M.left+X.right,top:M.top+X.top,bottom:M.top+X.bottom};for(const G of a){const ne=b.current.get(G.id);if(!ne)continue;const se=ne.getBoundingClientRect();!(se.right<_.left||se.left>_.right||se.bottom<_.top||se.top>_.bottom)&&oe.push(G.id)}p(new Set(oe)),k?g.current.card=!0:oe.length>0&&(g.current.background=!0)}return null})};return window.addEventListener("mousemove",Y),window.addEventListener("mouseup",c),()=>{window.removeEventListener("mousemove",Y),window.removeEventListener("mouseup",c),document.removeEventListener("selectstart",H)}},[x,t,n,a,b,f,p,g]);const $=s.useMemo(()=>{if(!x||!x.active)return null;const H=Tt(x.origin,x.current);return H.width<=0||H.height<=0?null:{left:H.left,top:H.top,width:H.width,height:H.height}},[x]),B=s.useCallback(()=>{y(null),A.current=!1},[]);return{selectionRect:$,isSelecting:x!=null,dragSelectionActiveRef:A,clearSelection:B}}function Ls({visualizationAreaRef:t,cardRefs:n,selected:o,setSelected:d,mode:u,gridCols:a,getCirclePosition:b}){const[f,p]=s.useState(null),g=s.useCallback((x,y)=>{if(x.button!==0||x.target.closest('button, a, input, textarea, select, [role="button"]'))return;x.preventDefault();const $=n.current.get(y);if(!$||!t.current)return;const B=$.getBoundingClientRect(),H=t.current.getBoundingClientRect(),Y=B.left+B.width/2,c=B.top+B.height/2;p({activeId:y,currX:x.clientX,currY:x.clientY,offsetX:Y-x.clientX,offsetY:c-x.clientY,containerLeft:H.left,containerTop:H.top,containerWidth:H.width,containerHeight:H.height,cardHeight:B.height}),x.target.setPointerCapture(x.pointerId)},[t]);return s.useEffect(()=>{if(!f)return;const x=A=>{if(p(c=>c?{...c,currX:A.clientX,currY:A.clientY}:null),!t.current)return;const $=t.current.getBoundingClientRect(),B=o.indexOf(f.activeId);let H=1/0,Y=-1;if(u==="compare"){const c=A.clientX-($.left+$.width/2),W=A.clientY-$.top,P=(ue.cardWidth+ue.gapX)*a-ue.gapX;o.forEach((V,I)=>{const k=Math.floor(I/a),X=I%a*(ue.cardWidth+ue.gapX)-P/2+ue.cardWidth/2,oe=k*(ue.cardHeight+ue.gapY),M=X,_=oe+ue.cardHeight/2,G=(c-M)**2+(W-_)**2;G<H&&(H=G,Y=I)})}else{const c=A.clientX-($.left+$.width/2),W=A.clientY-($.top+$.height/2),P=Math.max(ue.baseRadius,ue.minRadius+o.length*ue.radiusPerModel);o.forEach((V,I)=>{const k=b(I,o.length,u,P),J=(c-k.x)**2+(W-k.y)**2;J<H&&(H=J,Y=I)})}if(Y!==-1&&Y!==B){const c=[...o],[W]=c.splice(B,1);c.splice(Y,0,W),d(c)}},y=()=>p(null);return window.addEventListener("pointermove",x),window.addEventListener("pointerup",y),()=>{window.removeEventListener("pointermove",x),window.removeEventListener("pointerup",y)}},[f,t,n,o,d,u,a,b]),{dragState:f,handlePointerDown:g}}const As={autoMode:!0,autoModeScope:"self-hosted",selectedModelId:null};function Rs(t,n){switch(n.type){case"SET_AUTO_MODE":return{...t,autoMode:n.payload};case"SET_AUTO_MODE_SCOPE":return{...t,autoMode:!0,autoModeScope:n.payload};case"SELECT_MODEL":return{...t,selectedModelId:n.payload};default:return t}}function _s(t){const[n,o]=s.useReducer(Rs,{...As,...t});return{autoMode:n.autoMode,autoModeScope:n.autoModeScope,selectedModelId:n.selectedModelId,setAutoMode:d=>o({type:"SET_AUTO_MODE",payload:d}),setAutoModeScope:d=>o({type:"SET_AUTO_MODE_SCOPE",payload:d}),selectModel:d=>o({type:"SELECT_MODEL",payload:d})}}const Ee=(t,n)=>!t||!t.startsWith("#")?t:t.length===7||t.length===4?`${t}${n}`:t,Is={idle:"Ready",responding:"Responding",done:"Done",waiting:"Waiting",error:"Error"};function Lt({state:t,color:n,size:o=16,label:d,className:u=""}){const a={width:`${o}px`,height:`${o}px`},b=d??Is[t],f=Math.max(2,Math.round(o*.14)),p=Math.max(12,o-2),g="#fbbf24",x=Ee(n,"cc"),y=()=>{switch(t){case"responding":return e.jsx("div",{className:"relative flex items-center justify-center",style:a,children:e.jsxs("svg",{width:p,height:p,viewBox:"0 0 24 24",fill:"none",className:"",style:{filter:`drop-shadow(0 0 6px ${Ee(g,"55")})`,animation:"spin 0.6s linear infinite"},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"spinnerGradient",gradientUnits:"userSpaceOnUse",x1:"3",y1:"12",x2:"12",y2:"3",children:[e.jsx("stop",{offset:"0%",stopColor:g,stopOpacity:"1"}),e.jsx("stop",{offset:"60%",stopColor:g,stopOpacity:"0.5"}),e.jsx("stop",{offset:"100%",stopColor:g,stopOpacity:"0"})]})}),e.jsx("circle",{cx:"12",cy:"12",r:"9",stroke:Ee(g,"15"),strokeWidth:f,fill:"none"}),e.jsx("path",{d:"M 12 3 A 9 9 0 1 1 3 12",stroke:"url(#spinnerGradient)",strokeWidth:f,strokeLinecap:"round",fill:"none"}),e.jsx("circle",{cx:"3",cy:"12",r:f*.7,fill:g})]})});case"done":return e.jsx("div",{className:"flex items-center justify-center rounded-full",style:{...a,background:Ee(n,"14"),border:`1px solid ${Ee(n,"99")}`},children:e.jsx("svg",{width:p,height:p,viewBox:"0 0 24 24",fill:"none",children:e.jsx("polyline",{points:"5 13 10 18 19 7",stroke:n,strokeWidth:f,strokeLinecap:"round",strokeLinejoin:"round"})})});case"error":const A="#ef4444";return e.jsx("div",{className:"flex items-center justify-center rounded-full",style:{...a,background:Ee(A,"14"),border:`1px solid ${Ee(A,"99")}`},children:e.jsx("svg",{width:p,height:p,viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M6 6L18 18M6 18L18 6",stroke:A,strokeWidth:f,strokeLinecap:"round",strokeLinejoin:"round"})})});case"waiting":return e.jsxs("div",{className:"relative flex items-center justify-center",style:a,children:[e.jsx("div",{className:"absolute inset-0 rounded-full",style:{border:`1px solid ${Ee(x,"99")}`}}),e.jsx("svg",{width:p,height:p,viewBox:"0 0 24 24",fill:"none",style:{animation:"spin 5s linear infinite"},children:e.jsx("circle",{cx:"12",cy:"12",r:"8.5",stroke:Ee(x,"44"),strokeWidth:f-1,strokeDasharray:"6 10",strokeLinecap:"round"})}),e.jsx("div",{className:"absolute w-2 h-2 rounded-full",style:{background:Ee(x,"aa"),animation:"pulse 1.5s ease-in-out infinite"}})]});default:return e.jsxs("div",{className:"relative flex items-center justify-center",style:a,children:[e.jsx("div",{className:"absolute inset-0 rounded-full",style:{border:"1px solid rgba(71, 85, 105, 0.5)"}}),e.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:"rgba(148, 163, 184, 0.6)",animation:"pulse 2.4s ease-in-out infinite"}})]})}};return e.jsx("div",{className:`inline-flex items-center justify-center ${u}`,title:b,children:y()})}function nn({times:t}){const n=(t==null?void 0:t.startTime)!=null,o=(t==null?void 0:t.endTime)!=null,d=(t==null?void 0:t.firstTokenTime)!=null,u=n&&o?((t.endTime-t.startTime)/1e3).toFixed(2):null,a=n&&d?((t.firstTokenTime-t.startTime)/1e3).toFixed(2):null;return e.jsxs("div",{className:"text-[10px] text-slate-500",children:[e.jsx("span",{className:"text-slate-400",children:"TIME"})," ",u?`${u}s`:n&&!o?"...":"—",a&&e.jsxs("span",{className:"ml-2 text-slate-600",children:["TTFT ",a,"s"]})]})}const _t=({text:t,speed:n=5})=>{const[o,d]=s.useState(""),u=s.useRef(0),a=s.useRef(null);return s.useEffect(()=>{!t.startsWith(o)&&o!==""&&(d(""),u.current=0)},[t]),s.useEffect(()=>{a.current!=null&&(clearTimeout(a.current),a.current=null);const b=t.length;if(u.current>=b)return;const f=()=>{const p=u.current,g=b-p;if(g<=0)return;const x=g>120?12:g>40?4:g>10?2:1,y=Math.min(b,p+x);u.current=y,d(t.slice(0,y));const $=b-y>5?0:n;a.current=window.setTimeout(f,$)};return a.current=window.setTimeout(f,n),()=>{a.current!=null&&(clearTimeout(a.current),a.current=null)}},[t,n]),e.jsx("span",{children:o})},lt=256,an=200,$e=96;function Ds(t){const{mode:n,selectedModels:o,gridCols:d,speaking:u,selectedCardIds:a,setSelectedCardIds:b,executionTimes:f,failedModels:p,cardRefs:g,handlePointerDown:x,dragState:y,setContextMenu:A,suppressClickRef:$,getTailSnippet:B,hoveredCard:H,setHoveredCard:Y,layoutRadius:c,getCirclePosition:W,moderatorModel:P,moderatorId:V,orchestratorTransform:I,orchestratorStatus:k,orchestratorPhaseLabel:J,moderatorSynthesis:X,isSynthesizing:oe,isGenerating:M,phaseLabel:_,linesTransitioning:G,lastSelectedCardRef:ne,orchestratorAutoMode:se,orchestratorAutoScope:K,showOrchestratorMenu:Z,setShowOrchestratorMenu:ie,setOrchestratorAutoMode:me,setOrchestratorAutoScope:fe,orchestratorMenuRef:R,availableModels:T,setModerator:re}=t,U=n!=="compare",ae=n==="analyze"?c-64:0,ve=sn(k),[ee,xe]=s.useState(null);return s.useEffect(()=>{if(!Z)return;const i=ce=>{R.current&&!R.current.contains(ce.target)&&(ie(!1),xe(null))};return document.addEventListener("mousedown",i,!0),()=>document.removeEventListener("mousedown",i,!0)},[Z,R,ie]),e.jsxs(e.Fragment,{children:[o.map((i,ce)=>{var Je;const te=W(ce,o.length,n,c),pe=zs(ce,d),le=u.has(i.id),he=a.has(i.id),ye=p.has(i.id),Me=!le&&!ye&&!!((Je=f[i.id])!=null&&Je.endTime)&&i.response.trim().length>0,L=Fs(le,Me,ye,!le&&!Me&&!ye&&M&&n==="debate"),j=sn(L),m="#fbbf24",h="#ef4444",S=i.type==="self-hosted"?"#10b981":"#3b82f6",v=ye?h:S,F=le&&!ye,D=Ys({hasError:ye,isProcessing:F,isSelected:he,errorColor:h,processingColor:m,typeColor:S}),E=Os({mode:n,gridX:pe.gridX,gridY:pe.gridY,circleX:te.x,circleY:te.y,dragState:y,modelId:i.id}),z=H===i.id,de=U?$e:lt,ge=U?$e:an,Ce=Math.max(800,c*2+600),_e=Ce/2,Ve=_e,Qe=_e,Se=_e+(0-te.x),He=_e+(ae-te.y);return e.jsxs("div",{ref:be=>{be?g.current.set(i.id,be):g.current.delete(i.id)},onPointerDown:be=>x(be,i.id),className:"absolute",onContextMenu:be=>{be.preventDefault(),be.stopPropagation(),A({x:be.clientX,y:be.clientY,modelId:i.id})},style:{transform:E,zIndex:U?z?300:he?40:le?15:5:he?20:le?10:1,left:"50%",top:U?"50%":"0",transition:(y==null?void 0:y.activeId)===i.id?"none":"transform 300ms cubic-bezier(0.2, 0, 0.2, 1)"},children:[U&&le&&!ye&&!G&&e.jsxs("svg",{className:"absolute pointer-events-none",style:{width:`${Ce}px`,height:`${Ce}px`,top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:-1},viewBox:`0 0 ${Ce} ${Ce}`,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:`grad-${i.id}`,gradientUnits:"userSpaceOnUse",x1:Ve,y1:Qe,x2:Se,y2:He,children:[e.jsx("stop",{offset:"0%",stopColor:m,stopOpacity:"0.45"}),e.jsx("stop",{offset:"100%",stopColor:m,stopOpacity:"0.12"})]})}),e.jsx("line",{x1:Ve,y1:Qe,x2:Se,y2:He,stroke:`url(#grad-${i.id})`,strokeWidth:"2",strokeDasharray:"6,4",strokeLinecap:"round",className:"animate-flow arena-link"})]}),e.jsxs("div",{"data-card":!0,onClick:be=>$s({e:be,modelId:i.id,suppressClickRef:$,setSelectedCardIds:b,selectedModels:o,lastSelectedCardRef:ne}),onMouseEnter:()=>U&&Y(i.id),onMouseLeave:()=>U&&Y(null),className:`relative cursor-grab active:cursor-grabbing card-hover ${U?"rounded-full":""} ${he?"card-selected":""} ${le?"card-speaking":""}`,style:{background:D.background,backdropFilter:U?void 0:"blur(8px)",WebkitBackdropFilter:U?void 0:"blur(8px)",border:D.border,boxShadow:D.shadow,transform:he||F?"scale(1.05)":"scale(1)",width:`${de}px`,height:`${ge}px`,borderRadius:U?"50%":"12px",transition:"transform 180ms ease-out, box-shadow 180ms ease-out, border-color 180ms ease-out, width 0.7s cubic-bezier(0.4, 0, 0.2, 1), height 0.7s cubic-bezier(0.4, 0, 0.2, 1), border-radius 0.7s cubic-bezier(0.4, 0, 0.2, 1)"},children:[!U&&e.jsxs("div",{style:Ws,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3 gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5 min-w-0",children:[e.jsx(Lt,{state:L,color:v,size:16,label:j}),e.jsx("span",{className:"text-xs font-semibold text-slate-200 truncate",children:i.name})]}),e.jsx("div",{className:"flex items-center gap-1.5 shrink-0",children:e.jsx("span",{className:`text-[9px] uppercase tracking-wider px-1.5 py-0.5 rounded ${i.type==="self-hosted"?"bg-emerald-500/10 text-emerald-300 border border-emerald-500/30":"bg-blue-500/10 text-blue-300 border border-blue-500/30"}`,children:i.type==="self-hosted"?"Self-hosted":"API"})})]}),e.jsx("p",{className:"text-xs text-slate-400 leading-relaxed line-clamp-3 flex-1",children:Ps({model:i,isSpeaking:le,thinkingFallback:e.jsx("span",{className:"text-slate-500 italic",children:"Thinking…"}),getTailSnippet:B})}),e.jsx("div",{className:"flex items-center gap-4 mt-3 pt-3 border-t border-slate-700/50",children:e.jsx(nn,{times:f[i.id]})})]}),U&&e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center text-center",style:{transition:"opacity 0.3s ease-out"},children:[e.jsx("div",{className:"absolute inset-[3px] rounded-full border border-white/5",style:{boxShadow:`inset 0 0 20px ${v}15`}}),e.jsx("div",{className:"absolute inset-[-6px] rounded-full opacity-60",style:{background:`radial-gradient(circle, ${v}22 0%, transparent 65%)`,filter:"blur(10px)"}}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center gap-1.5 px-3",children:[e.jsx("div",{className:"text-[7px] tracking-[0.32em] text-slate-400 uppercase",children:j}),e.jsx("div",{className:"text-[10px] font-semibold text-slate-100 leading-tight",children:i.name}),e.jsx(Lt,{state:L,color:v,size:12})]})]})]}),n==="analyze"&&U&&i.personaEmoji&&e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 flex items-center justify-center pointer-events-none select-none",style:{bottom:"-12px",fontSize:"20px",zIndex:100,transition:"transform 180ms ease-out",transform:le?"scale(1.15)":"scale(1)",filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.5)) drop-shadow(0 0 8px rgba(0,0,0,0.3))"},title:i.personaName?`${i.personaName} - ${i.personaTrait}`:"Persona",children:i.personaEmoji}),U&&le&&i.thinking&&i.thinking.trim().length>0&&i.response.trim().length===0&&e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 flex items-center justify-center pointer-events-none select-none animate-pulse",style:{bottom:"-12px",fontSize:"18px",zIndex:100,filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.5)) drop-shadow(0 0 10px rgba(168, 85, 247, 0.4))"},title:"Thinking...",children:"💭"}),U&&H===i.id&&e.jsxs("div",{"data-card":!0,onClick:be=>be.stopPropagation(),className:"absolute w-64 max-w-[calc(100vw-2rem)] p-4 rounded-xl transition-all duration-300 z-[220]",style:{top:te.y>0?"auto":"100%",bottom:te.y>0?"100%":"auto",left:"50%",transform:"translateX(-50%)",marginTop:te.y>0?0:"12px",marginBottom:te.y>0?"12px":0,background:"rgba(15, 23, 42, 0.95)",backdropFilter:"blur(16px)",border:`1px solid ${v}40`,boxShadow:`0 20px 40px rgba(0,0,0,0.5), 0 0 20px ${v}15`},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:v}}),e.jsx("span",{className:"text-xs font-semibold text-slate-300",children:i.name})]}),n==="analyze"&&i.personaEmoji&&i.personaName&&e.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-2 border-b border-slate-700/50",children:[e.jsx("span",{className:"text-base",children:i.personaEmoji}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs font-semibold text-blue-400",children:i.personaName}),i.personaTrait&&e.jsx("div",{className:"text-[10px] text-slate-500",children:i.personaTrait})]})]}),e.jsx("p",{className:"text-xs text-slate-400 leading-relaxed whitespace-pre-wrap",children:Bs({model:i,isSpeaking:le,getTailSnippet:B})}),e.jsx("div",{className:"flex items-center gap-4 mt-3 pt-2 border-t border-slate-700/50",children:e.jsx(nn,{times:f[i.id]})})]})]},i.id)}),n!=="compare"&&P&&e.jsxs("div",{"data-card":!0,className:"absolute z-20 transition-all duration-700 ease-out cursor-pointer",style:{opacity:1,transform:I,left:"50%",top:n==="analyze"?`calc(50% + ${c}px - 64px)`:"50%"},onClick:i=>{i.stopPropagation(),V&&(b(new Set([V])),ne.current=V)},onContextMenu:i=>{i.preventDefault(),i.stopPropagation(),Z?(ie(!1),xe(null)):(xe({x:i.clientX,y:i.clientY}),ie(!0))},onMouseEnter:()=>Y("moderator"),onMouseLeave:()=>Y(null),children:[e.jsx("div",{className:"relative flex items-center justify-center",style:{width:`${$e}px`,height:`${$e}px`},children:(()=>{const i=k==="responding",ce=i?"#fbbf24":P.color;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0 rounded-full animate-pulse",style:{background:`radial-gradient(circle, ${ce}20 0%, transparent 70%)`,transform:"scale(2.2)",filter:"blur(18px)"}}),e.jsxs("div",{className:"relative rounded-full flex items-center justify-center transition-all duration-300",style:{width:`${$e}px`,height:`${$e}px`,background:i?"linear-gradient(135deg, rgba(251, 191, 36, 0.08), rgba(15, 23, 42, 0.9))":"rgba(15, 23, 42, 0.9)",backdropFilter:"blur(16px)",border:`2px solid ${ce}${i?"99":"60"}`,boxShadow:`0 0 36px ${ce}${i?"40":"28"}, inset 0 1px 1px rgba(255,255,255,0.1)`},children:[e.jsx("div",{className:"absolute inset-[-4px] rounded-full",style:{background:`conic-gradient(from 0deg, transparent, ${ce}60, transparent)`,animation:"spin 4s linear infinite"}}),e.jsx("div",{className:"absolute inset-[2px] rounded-full",style:{background:"rgba(15, 23, 42, 0.96)"}}),e.jsxs("div",{className:"relative text-center z-10 flex flex-col items-center gap-1.5 px-3",children:[e.jsx("div",{className:"text-[7px] tracking-[0.32em] text-slate-400 uppercase",children:ve}),e.jsx("div",{className:"text-[10px] font-semibold text-slate-100 leading-tight",children:P.name}),e.jsx(Lt,{state:k,color:ce,size:12})]})]})]})})()}),e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 flex flex-col items-center gap-1 w-max max-w-[200px]",style:{top:"calc(100% + 12px)"},children:e.jsx("span",{className:"text-[10px] text-slate-500",children:J})}),H==="moderator"&&!Z&&(()=>{const i=k==="responding",ce=i?"#fbbf24":P.color;return e.jsxs("div",{"data-card":!0,onClick:te=>te.stopPropagation(),className:"absolute bottom-full mb-4 left-1/2 -translate-x-1/2 w-80 max-w-[calc(100vw-2rem)] p-4 rounded-xl z-[200] transition-all duration-300",style:{background:"rgba(15, 23, 42, 0.95)",backdropFilter:"blur(16px)",border:`1px solid ${ce}40`,boxShadow:`0 20px 40px rgba(0,0,0,0.5), 0 0 30px ${ce}20`},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"Orchestrator"}),e.jsx("span",{className:"text-xs text-slate-500",children:"·"}),e.jsx("span",{className:"text-xs font-medium text-slate-300",children:P.name}),i&&e.jsx("span",{className:"text-[9px] uppercase tracking-wider px-1.5 py-0.5 rounded bg-yellow-500/20 text-yellow-300 border border-yellow-500/30",children:"Working"})]}),e.jsx("p",{className:"text-sm text-slate-300 leading-relaxed",children:Hs({moderatorSynthesis:X,isSynthesizing:oe,moderatorId:V,speaking:u,phaseLabel:_,isGenerating:M,getTailSnippet:B})})]})})(),Z&&ee&&Gn.createPortal(e.jsx("div",{ref:R,className:"w-64 bg-slate-800 border border-slate-700 rounded-lg shadow-xl overflow-hidden",style:{position:"fixed",top:`${ee.y}px`,left:`${ee.x}px`,transform:"translateY(-50%)",zIndex:9999},onClick:i=>i.stopPropagation(),children:se?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-3 py-2 text-[10px] uppercase tracking-wider text-slate-500 font-semibold border-b border-slate-700/50",children:["Auto Mode: ",K==="self-hosted"?"SELF-HOSTED":K.toUpperCase()]}),["all","self-hosted","api"].map(i=>e.jsxs("button",{onClick:()=>{fe(i),ie(!1)},className:`w-full px-3 py-2 text-left text-xs font-medium transition-colors ${K===i?"bg-yellow-500/20 text-yellow-300":"text-slate-300 hover:bg-slate-700/50"}`,children:[i==="all"&&"All",i==="self-hosted"&&"Self-hosted",i==="api"&&"API",e.jsxs("span",{className:"text-[10px] text-slate-500 ml-1",children:[i==="all"&&"(self-hosted → API)",i==="self-hosted"&&"(no quota)",i==="api"&&"(cloud only)"]})]},i)),e.jsx("div",{className:"border-t border-slate-700",children:e.jsx("button",{onClick:()=>{me(!1),ie(!1)},className:"w-full px-3 py-2 text-left text-xs font-medium text-slate-400 hover:bg-slate-700/50 transition-colors",children:"Manual Mode"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-3 py-2 text-[10px] uppercase tracking-wider text-slate-500 font-semibold border-b border-slate-700/50",children:"Select Orchestrator"}),T.filter(i=>i.type==="github"||i.type==="external").length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-3 py-1.5 text-[9px] uppercase tracking-wider text-slate-600 font-semibold",children:"GitHub Models"}),T.filter(i=>i.type==="github"||i.type==="external").map(i=>e.jsx("button",{onClick:()=>{re(i.id),ie(!1)},className:`w-full px-4 py-2 text-left text-xs font-medium transition-colors ${V===i.id?"bg-blue-500/20 text-blue-300":"text-slate-300 hover:bg-slate-700/50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:i.name}),V===i.id&&e.jsx("span",{className:"text-blue-400",children:"✓"})]})},i.id))]}),T.filter(i=>i.type==="self-hosted").length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-3 py-1.5 text-[9px] uppercase tracking-wider text-slate-600 font-semibold border-t border-slate-700/50 mt-1",children:"Self-Hosted Models"}),T.filter(i=>i.type==="self-hosted").map(i=>e.jsx("button",{onClick:()=>{re(i.id),ie(!1)},className:`w-full px-4 py-2 text-left text-xs font-medium transition-colors ${V===i.id?"bg-blue-500/20 text-blue-300":"text-slate-300 hover:bg-slate-700/50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:i.name}),V===i.id&&e.jsx("span",{className:"text-blue-400",children:"✓"})]})},i.id))]}),e.jsx("div",{className:"border-t border-slate-700",children:e.jsxs("button",{onClick:()=>{me(!0),ie(!1)},className:"w-full px-3 py-2 text-left text-xs font-medium text-yellow-400 hover:bg-slate-700/50 transition-colors flex items-center gap-2",children:[e.jsx(rn,{size:12}),e.jsx("span",{children:"Enable Auto Mode"})]})})]})}),document.body)]}),n!=="compare"&&e.jsxs("svg",{className:"absolute pointer-events-none transition-opacity duration-700",style:{width:"1000px",height:"1000px",opacity:.2},children:[e.jsx("circle",{cx:"500",cy:"500",r:c,fill:"none",stroke:"url(#circleGrad)",strokeWidth:"1",strokeDasharray:"8,4"}),e.jsx("defs",{children:e.jsxs("linearGradient",{id:"circleGrad",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#3b82f6"}),e.jsx("stop",{offset:"50%",stopColor:"#8b5cf6"}),e.jsx("stop",{offset:"100%",stopColor:"#3b82f6"})]})})]})]})}function zs(t,n){const o=Math.floor(t/n),d=t%n,u=(lt+ue.gapX)*n-ue.gapX,a=o*(an+ue.gapY);return{gridX:d*(lt+ue.gapX)-u/2+lt/2,gridY:a}}function Os({mode:t,gridX:n,gridY:o,circleX:d,circleY:u,dragState:a,modelId:b}){if((a==null?void 0:a.activeId)===b){const f=a.currX+a.offsetX,p=a.currY+a.offsetY;if(t==="compare"){const y=f-(a.containerLeft+a.containerWidth/2),A=p-a.containerTop-a.cardHeight/2;return`translate(calc(-50% + ${y}px), ${A}px)`}const g=f-(a.containerLeft+a.containerWidth/2),x=p-(a.containerTop+a.containerHeight/2);return`translate(calc(-50% + ${g}px), calc(-50% + ${x}px))`}return t==="compare"?`translate(calc(-50% + ${n}px), ${o}px)`:`translate(calc(-50% + ${d}px), calc(-50% + ${u}px))`}function $s({e:t,modelId:n,suppressClickRef:o,setSelectedCardIds:d,selectedModels:u,lastSelectedCardRef:a}){if(t.stopPropagation(),o.current.card){o.current.card=!1;return}const b=t.shiftKey,f=t.metaKey||t.ctrlKey;if(b&&a.current){const p=u.findIndex(x=>x.id===a.current),g=u.findIndex(x=>x.id===n);if(p!==-1&&g!==-1){const x=Math.min(p,g),y=Math.max(p,g),A=u.slice(x,y+1).map($=>$.id);d($=>{const B=new Set($);return A.forEach(H=>B.add(H)),B})}}else f?(d(p=>{const g=new Set(p);return g.has(n)?g.delete(n):g.add(n),g}),a.current=n):(d(new Set([n])),a.current=n)}function Ps({model:t,isSpeaking:n,thinkingFallback:o,getTailSnippet:d}){return t.statusMessage?Re(t.statusMessage)??t.statusMessage:n?t.response.trim().length>0?Re(t.response)??e.jsx(_t,{text:t.response,speed:20}):t.thinking&&t.thinking.trim().length>0?e.jsxs("span",{children:[e.jsx("span",{className:"text-slate-500 italic",children:"Thinking… "}),d(t.thinking.trim(),220)]}):o:Re(t.response)??t.response}function Bs({model:t,isSpeaking:n,getTailSnippet:o,maxChars:d=220}){return t.statusMessage?Re(t.statusMessage)??t.statusMessage:n?t.thinking&&t.thinking.trim().length>0?e.jsxs("span",{children:[e.jsx("span",{className:"text-purple-400/80 text-[10px] uppercase tracking-wider font-medium",children:"Thinking "}),e.jsx("span",{className:"text-slate-400",children:o(t.thinking.trim(),260)})]}):t.response.trim().length>0?Re(t.response)??e.jsx(_t,{text:t.response,speed:20}):e.jsx("span",{className:"text-slate-500 italic",children:"Thinking…"}):t.thinking&&t.thinking.trim().length>0?e.jsxs("span",{children:[e.jsx("span",{className:"text-purple-400/80 text-[10px] uppercase tracking-wider font-medium",children:"Reasoning "}),e.jsx("span",{className:"text-slate-400",children:o(t.thinking.trim(),260)})]}):t.response?Re(t.response)??o(t.response,d):e.jsx("span",{className:"text-slate-500 italic",children:"No response yet."})}function Hs({moderatorSynthesis:t,isSynthesizing:n,moderatorId:o,speaking:d,phaseLabel:u,isGenerating:a,getTailSnippet:b}){if(t)return n&&o&&d.has(o)?e.jsx(_t,{text:t,speed:20}):b(t);if(n)return e.jsx("span",{className:"text-slate-500 italic",children:"Synthesizing responses..."});if(a){const f=u?Re(u):null;if(f)return e.jsx("span",{className:"text-slate-500 italic",children:f});const p=u==="Stage 1 · Responses"?"Waiting for model responses...":u||"Orchestrating...";return e.jsx("span",{className:"text-slate-500 italic",children:p})}return e.jsx("span",{className:"text-slate-500 italic",children:"Send a prompt to see the synthesis."})}const Ws={padding:"16px",height:"100%",display:"flex",flexDirection:"column",isolation:"isolate",WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",textRendering:"optimizeLegibility",opacity:1,transition:"opacity 0.3s ease-out"};function sn(t){switch(t){case"error":return"Error";case"responding":return"Responding";case"done":return"Done";case"waiting":return"Waiting";default:return"Ready"}}function Fs(t,n,o,d){return o?"error":t?"responding":n?"done":d?"waiting":"idle"}function Re(t){return t.startsWith("<svg")?e.jsx("span",{dangerouslySetInnerHTML:{__html:t}}):null}function Ys({hasError:t,isProcessing:n,isSelected:o,errorColor:d,processingColor:u,typeColor:a}){const b="rgba(30, 41, 59, 0.85)";return t?{background:`linear-gradient(135deg, ${d}14, ${b})`,border:`1px solid ${d}99`,shadow:`0 0 24px ${d}33, inset 0 1px 1px rgba(255,255,255,0.1)`}:n?{background:`linear-gradient(135deg, ${u}14, ${b})`,border:`1px solid ${u}99`,shadow:`0 0 24px ${u}33, inset 0 1px 1px rgba(255,255,255,0.1)`}:o?{background:b,border:`1px solid ${a}d0`,shadow:`0 0 20px ${a}30, inset 0 1px 1px rgba(255,255,255,0.1)`}:{background:b,border:"1px solid rgba(71, 85, 105, 0.5)",shadow:"0 4px 20px rgba(0,0,0,0.3), inset 0 1px 1px rgba(255,255,255,0.05)"}}function Xs({rect:t}){return t?e.jsx("div",{className:"absolute pointer-events-none z-30",style:{left:t.left,top:t.top,width:t.width,height:t.height,border:"2px solid rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)"}}):null}const Gs={twoFingerTapWindow:500,twoFingerTapCooldown:400,twoFingerMinFrames:4,minPointingTime:100,dwellTime:1200,cursorSmoothing:.5},It=s.createContext(null);function Us({children:t}){const[n,o]=s.useState(!1),[d,u]=s.useState("navigation"),[a,b]=s.useState("chat"),[f,p]=s.useState(Gs),[g,x]=s.useState(!1),y=s.useRef({}),A=s.useCallback(M=>{y.current=M},[]),[$,B]=s.useState({gesture:null,progress:0,triggered:!1}),[H,Y]=s.useState(null),[c,W]=s.useState(void 0),[P,V]=s.useState(void 0),[I,k]=s.useState(void 0),[J,X]=s.useState(null),oe={isActive:n,setIsActive:o,gestureMode:d,setGestureMode:u,appContext:a,setAppContext:b,gestureConfig:f,setGestureConfig:p,mouseSimulation:g,setMouseSimulation:x,callbacks:y,setCallbacks:A,gestureState:$,setGestureState:B,aslResult:H,setASLResult:Y,debugInfo:c,setDebugInfo:W,landmarkData:P,setLandmarkData:V,performanceMetrics:I,setPerformanceMetrics:k,cameraError:J,setCameraError:X};return e.jsx(It.Provider,{value:oe,children:t})}function Ks(){const t=s.useContext(It);if(!t)throw new Error("useGesture must be used within a GestureProvider");return t}function pr(){return s.useContext(It)}class qs extends s.Component{constructor(o){super(o);Vt(this,"handleRetry",()=>{var o,d;this.setState({hasError:!1,error:null}),(d=(o=this.props).onRetry)==null||d.call(o)});this.state={hasError:!1,error:null}}static getDerivedStateFromError(o){return{hasError:!0,error:o}}componentDidCatch(o,d){console.error("ErrorBoundary caught an error:",o,d)}render(){var o;return this.state.hasError?this.props.fallback?this.props.fallback:e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-white/70 gap-4 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-amber-400",children:[e.jsx(Un,{size:20}),e.jsx("span",{className:"text-sm font-medium",children:"Something went wrong"})]}),e.jsx("p",{className:"text-xs text-white/40 text-center max-w-xs",children:((o=this.state.error)==null?void 0:o.message)||"Failed to load component"}),e.jsxs("button",{onClick:this.handleRetry,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white/80 bg-slate-700/50 hover:bg-slate-600/50 rounded-lg transition-all active:scale-95 border border-slate-600/50",children:[e.jsx(Kn,{size:14}),"Try Again"]})]}):this.props.children}}const Vs=s.lazy(()=>Ke(()=>import("./SettingsModal-SCebNl6W.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),Qs=s.lazy(()=>Ke(()=>import("./DiscussionTranscript-BBT7wb0y.js"),__vite__mapDeps([7,1,2,3,4,5,6,8]))),Js=s.lazy(()=>Ke(()=>import("./GestureControl-V3Zz4FIy.js"),__vite__mapDeps([9,1,2,3,4,5,6]))),Zs=s.lazy(()=>Ke(()=>import("./HandBackground-DFMjYCtB.js"),__vite__mapDeps([10,1,2,3,4,5,6,11]))),er=s.lazy(()=>Ke(()=>import("./ChatView-D_EBmQSv.js"),__vite__mapDeps([12,1,2,3,4,5,6,8])).then(t=>({default:t.default}))),tr='button, input, textarea, select, a, [role="button"], [data-no-background], [data-card]';function nr(){const t=Ks();Ms();const{modelsData:n,setModelsData:o,selected:d,setSelected:u,chatModelId:a,setChatModelId:b,moderator:f,setModerator:p,availableModels:g,totalModelsByType:x,allSelectedByType:y,modelIdToName:A,isLoading:$,loadError:B,retryCount:H,retryNow:Y}=gs(),[c,W]=Be("playground_mode","chat",{serialize:r=>r,deserialize:(r,l)=>["chat","compare","analyze","debate"].includes(r)?r:l}),[P,V]=s.useState(!1),I=s.useRef(null),[k,J]=s.useState(null),[X,oe]=s.useState(!1),[M,_]=s.useState(!1),[G,ne]=s.useState(2),se=s.useRef(0),K=s.useRef(0),Z=s.useRef(null),[ie,me]=s.useState(!1),[fe,R]=Be("github_models_token","",{serialize:r=>r||null,deserialize:(r,l)=>r??l}),[T,re]=Be("openrouter_api_key","",{serialize:r=>r||null,deserialize:(r,l)=>r??l}),[U,ae]=s.useState({}),ve=s.useRef(null),ee=s.useRef(null),[xe,i]=s.useState(""),[ce,te]=s.useState(null),pe=s.useRef(null),le=s.useCallback(r=>{pe.current&&clearTimeout(pe.current),te(r),pe.current=window.setTimeout(()=>{te(null),pe.current=null},5e3)},[]),he=s.useCallback(r=>{if(c==="chat"||fe)return!0;const l=n.find(w=>w.id===r);return!l||l.type!=="github"&&l.type!=="external"},[c,fe,n]),ye=s.useCallback(()=>!!(c==="chat"||fe),[c,fe]),[Me,qe]=s.useState([]),{autoMode:L,autoModeScope:j,setAutoMode:m,setAutoModeScope:h}=_s({autoMode:!0,autoModeScope:"self-hosted"}),[S,v]=s.useState(""),[F,D]=s.useState(!1),E=s.useRef(!1),{history:z,historyRef:de,pushHistoryEntries:ge,clearHistory:Ce,historyToText:_e,buildCarryoverHistory:Ve}=Es(),Qe=(r,l)=>{const w=new Set,C=l.filter(Boolean).filter((O,q,Q)=>Q.indexOf(O)===q),N=[];return C.forEach(O=>{const q=r[O];q&&q.trim()&&(N.push({id:O,text:q.trim()}),w.add(O))}),Object.entries(r).forEach(([O,q])=>{w.has(O)||!q||!q.trim()||N.push({id:O,text:q.trim()})}),N.length?N.map(({id:O,text:q})=>`${A(O)}:
${q}`).join(`

`):null};s.useEffect(()=>{const r=E.current;E.current=t.isActive,c==="chat"&&t.isActive&&!r&&h("api")},[t.isActive,c,h]);const Se=d.map(r=>n.find(l=>l.id===r)).filter(r=>!!r&&(c==="compare"||r.id!==f)),He=(r,l,w,C)=>{if(w==="analyze"){const ot=250+r*220/(l-1)-90,at=ot*Math.PI/180;return{x:Math.cos(at)*C,y:Math.sin(at)*C,angle:ot}}const N=r*360/l-90,O=Math.cos(N*Math.PI/180)*C,q=Math.sin(N*Math.PI/180)*C;return{x:O,y:q,angle:N}},Je=(r,l)=>{J(l),r.dataTransfer.effectAllowed="move"},be=r=>{r.preventDefault(),oe(!0)},ln=()=>{oe(!1)},cn=r=>{if(r.preventDefault(),oe(!1),k){if(c==="chat")b(k);else if(!d.includes(k)){if(!he(k)){le("Add your GitHub token in Settings for API model access with dedicated quota"),J(null);return}u(l=>[...l,k])}J(null)}},ct=r=>{if(c==="chat"){b(a===r?null:r);return}if(d.includes(r))if(Ae&&ut.current.includes(r)&&xe){ee.current&&ee.current.abort();const w=ut.current.filter(N=>N!==r),C={};if(n.forEach(N=>{w.includes(N.id)&&N.response&&!N.error&&(C[N.id]=N.response)}),u(N=>N.filter(O=>O!==r)),Ne.has(r)&&We(N=>{const O=new Set(N);return O.delete(r),O}),(c==="analyze"||c==="debate")&&w.length<2){Xe(!1),nt(!1),mt("This mode requires at least 2 participants."),yt("Error");return}kt(xe,C,w,{skipHistory:!0})}else u(w=>w.filter(C=>C!==r));else{if(!he(r)){le("Add your GitHub token in Settings for API model access with dedicated quota");return}u(l=>[...l,r])}},dn=r=>{const l=n.filter(N=>N.type===r).map(N=>N.id);if(l.length>0&&l.every(N=>d.includes(N))){u(N=>N.filter(O=>!l.includes(O)));return}if((r==="github"||r==="external")&&!ye()){le("Add your GitHub token in Settings for API model access with dedicated quota");return}const C=g.filter(N=>N.type===r).map(N=>N.id);C.length>0&&u(N=>[...N,...C])},[un,Ie]=s.useState(null),[Dt,zt]=s.useState(new Set),[fn,pn]=s.useState(!1),[Ne,We]=s.useState(new Set),De=()=>We(new Set),[Ze,hn]=s.useState(null),dt=s.useMemo(()=>{if(c==="compare")return 0;const r=Math.max(ue.baseRadius,ue.minRadius+Se.length*ue.radiusPerModel);if(!Ze)return r;const w=Math.min(Ze.width,Ze.height)/2-140;return Math.max(r,w)},[c,Se.length,Ze]);s.useEffect(()=>{const r=()=>{if(!we.current)return;const{clientWidth:w,clientHeight:C}=we.current;let N=Math.floor(w/(ue.cardWidth+ue.gapX));N=Math.max(1,N),ne(N),hn({width:w,height:C})},l=new ResizeObserver(w=>{for(let C of w)C.target===we.current&&r()});return we.current&&(l.observe(we.current),r()),()=>{we.current&&l.unobserve(we.current)}},[c]);const ze=s.useRef(null),we=s.useRef(null),Te=s.useRef(null),Ot=s.useRef(null),et=s.useRef(new Map),mn=s.useRef(null),Fe=s.useRef({card:!1,background:!1}),xn=s.useRef({}),ut=s.useRef([]),{enqueueStreamDelta:gn,clearPendingStreamForModel:bn,resetPendingStream:ft}=Cs(o),{selectionRect:yn,isSelecting:pt,dragSelectionActiveRef:$t}=Ts({rootContainerRef:Ot,visualizationAreaRef:we,arenaOffsetYRef:se,arenaTargetYRef:K,wheelRafRef:Z,selectedModels:Se,cardRefs:et,selectedCardIds:Ne,setSelectedCardIds:We,suppressClickRef:Fe}),{dragState:vn,handlePointerDown:wn}=Ls({visualizationAreaRef:we,cardRefs:et,selected:d,setSelected:u,mode:c,gridCols:G,getCirclePosition:He});s.useEffect(()=>()=>ft(),[ft]);const[je,Le]=s.useState(null);s.useEffect(()=>{const r="arena-selecting",l=document.body;return pt?l.classList.add(r):l.classList.remove(r),()=>{l.classList.remove(r)}},[pt]);const tt=s.useCallback(r=>r?!r.closest(tr):!1,[]),kn=s.useCallback(r=>{if(tt(r.target)){if(Fe.current.background){Fe.current.background=!1;return}Ie(null),De(),Fe.current.background=!1}},[tt,De]),jn=s.useCallback(r=>{tt(r.target)&&(r.preventDefault(),Le({x:r.clientX,y:r.clientY,type:"background"}))},[tt]),Pt=s.useCallback(()=>{V(!0),I.current&&clearTimeout(I.current),I.current=window.setTimeout(()=>{V(!1),I.current=null},350)},[]),Ye=s.useCallback(r=>{r!==c&&(Pt(),Xe(!1),W(r))},[c,Pt]);s.useEffect(()=>()=>{pe.current&&clearTimeout(pe.current)},[]),s.useEffect(()=>()=>{I.current&&clearTimeout(I.current)},[]),s.useEffect(()=>{const r=()=>Le(null);return window.addEventListener("click",r),()=>window.removeEventListener("click",r)},[]);const[Ae,Xe]=s.useState(!1),[Ge,nt]=s.useState(!1),[ht,mt]=s.useState(""),Sn=s.useCallback(()=>{Ce(),Xe(!1),nt(!1),mt(""),yt(null),Ht({}),o(r=>r.map(l=>({...l,response:"Ready to generate...",thinking:void 0,error:void 0}))),ae({}),zt(new Set)},[Ce,o]),[Mn,En]=s.useState(!0),[Cn,Nn]=s.useState("api"),[xt,gt]=s.useState(!1),bt=s.useRef(null);s.useEffect(()=>{const r=w=>{bt.current&&!bt.current.contains(w.target)&&gt(!1)},l=w=>{w.key==="Escape"&&gt(!1)};return xt&&(document.addEventListener("mousedown",r),document.addEventListener("keydown",l)),()=>{document.removeEventListener("mousedown",r),document.removeEventListener("keydown",l)}},[xt]);const[Bt,yt]=s.useState(null),[,Ht]=s.useState({}),[Tn,Wt]=s.useState(new Set),vt=s.useRef(new Set),Ln=s.useRef(null),Ft=s.useRef({}),Yt=s.useRef(c),[wt,Xt]=s.useState(null),An=()=>{const r=new Set;vt.current=r,Wt(r)},Rn=r=>{Wt(l=>{if(l.has(r))return l;const w=new Set(l);return w.add(r),vt.current=w,w})},{sendMessage:kt}=Ns({mode:c,moderator:f,selected:d,selectedCardIds:Ne,githubToken:fe,isGenerating:Ae,summarizeSessionResponses:Qe,setLastQuery:i,setHoveredCard:Ie,setPhaseLabel:yt,setModeratorSynthesis:mt,setDiscussionTurnsByModel:Ht,resetFailedModels:An,markModelFailed:Rn,failedModelsRef:vt,currentDiscussionTurnRef:Ln,sessionModelIdsRef:ut,abortControllerRef:ee,thinkingStateRef:xn,conversationHistoryRef:de,pushHistoryEntries:ge,historyToText:_e,buildCarryoverHistory:Ve,setModelsData:o,modelIdToName:A,setExecutionTimes:ae,setIsGenerating:Xe,setIsSynthesizing:nt,setSpeaking:zt,enqueueStreamDelta:gn,clearPendingStreamForModel:bn,resetPendingStream:ft});s.useEffect(()=>{const r=l=>{if(l.key==="Escape"){const C=document.activeElement;if(C&&C!==document.body&&C.blur(),ie){me(!1);return}if(je){Le(null);return}if(Ne.size>0){De(),Ie(null);return}if(M){_(!1);return}Ie(null);return}if((l.metaKey||l.ctrlKey)&&(l.key==="a"||l.key==="A")){const C=l.target;if(C.tagName==="INPUT"||C.tagName==="TEXTAREA"||c==="chat")return;l.preventDefault(),d.length>0&&We(new Set(d));return}const w=l.target;if(!(w.tagName==="INPUT"||w.tagName==="TEXTAREA")){if(l.key==="ArrowRight"||l.key==="ArrowLeft"){l.preventDefault();const C=["chat","compare","analyze","debate"],N=C.indexOf(c);if(N!==-1){const O=l.key==="ArrowRight"?1:-1,q=(N+O+C.length)%C.length;Ye(C[q])}return}if(l.key==="m"||l.key==="M"){l.preventDefault(),_(!M);return}if((l.key==="Delete"||l.key==="Backspace")&&Ne.size>0){l.preventDefault(),u(C=>C.filter(N=>!Ne.has(N))),De();return}l.key.length===1&&!l.ctrlKey&&!l.metaKey&&!l.altKey&&ze.current&&ze.current.focus()}};return window.addEventListener("keydown",r),()=>{window.removeEventListener("keydown",r)}},[M,ie,je,Ne,c,Ye,De]);const st=s.useRef(!1),jt=s.useRef(0),Gt=r=>{const l=we.current;l&&l.style.setProperty("--arena-offset-y",`${r}px`)},St=r=>Math.max(-200,Math.min(ue.scrollClamp,r)),Ut=()=>{const r=se.current,l=K.current,w=l-r;if(Math.abs(w)<.5){se.current=l,Gt(l),Z.current=null;return}const C=r+w*.35;se.current=C,Gt(C),Z.current=requestAnimationFrame(Ut)},Mt=()=>{Z.current==null&&(Z.current=requestAnimationFrame(Ut))};s.useEffect(()=>{const r=O=>{if($t.current)return;const q=O.target;if(q&&q.closest("input, textarea, [data-no-arena-scroll]"))return;O.preventDefault();const Q=O.deltaY*.9,ke=K.current-Q;K.current=St(ke),Mt()},l=O=>O?!!O.closest('input, textarea, [data-no-arena-scroll], [data-card], button, a, select, [role="button"]'):!1,w=O=>{if(O.touches.length!==1)return;const q=O.target;l(q)||(st.current=!0,jt.current=O.touches[0].clientY)},C=O=>{if($t.current||!st.current||O.touches.length!==1)return;const q=O.target;if(l(q)){st.current=!1;return}const Q=O.touches[0].clientY,ke=Q-jt.current;jt.current=Q,O.preventDefault(),K.current=St(K.current+ke),Mt()},N=()=>{st.current=!1};return window.addEventListener("touchstart",w,{passive:!0}),window.addEventListener("touchmove",C,{passive:!1}),window.addEventListener("touchend",N),window.addEventListener("touchcancel",N),window.addEventListener("wheel",r,{passive:!1}),()=>{window.removeEventListener("touchstart",w),window.removeEventListener("touchmove",C),window.removeEventListener("touchend",N),window.removeEventListener("touchcancel",N),window.removeEventListener("wheel",r),Z.current!=null&&cancelAnimationFrame(Z.current)}},[]);const[rt,_n]=Be("playground-bg-style","dots",{serialize:r=>r,deserialize:(r,l)=>r&&is.includes(r)?r:l}),In=n.find(r=>r.id===f),Dn=Ge?"responding":Ae?"waiting":ht?"done":"idle",zn=Ge?"Synthesizing...":Ae?"Observing":ht?"Complete":"Ready",On=`${wt?`translate(-50%, -50%) translate(${wt.x}px, ${wt.y}px)`:"translate(-50%, -50%)"} scale(1)`;s.useLayoutEffect(()=>{if(c!=="compare")return;const r={};Se.forEach(l=>{const w=et.current.get(l.id);w&&(r[l.id]=w.getBoundingClientRect())}),Ft.current=r},[c,Se.length,Se.map(r=>r.id).join(",")]),s.useEffect(()=>{if(Yt.current==="compare"&&c!=="compare"&&f&&we.current){const l=Ft.current[f],w=we.current.getBoundingClientRect();if(l&&w.width>0&&w.height>0){const C=w.left+w.width/2,N=c==="analyze"?dt-64:0,O=w.top+(w.height*.5+N),q=l.left+l.width/2-C,Q=l.top+l.height/2-O;(Math.abs(q)>1||Math.abs(Q)>1)&&(Xt({x:q,y:Q}),requestAnimationFrame(()=>Xt(null)))}}Yt.current=c},[c,f,dt]);const $n=rt==="none"?"":`bg-${rt}`,Pn=(r,l=280)=>r?r.length<=l?r:`…${r.slice(r.length-l)}`:"",Kt=()=>{ee.current&&(ee.current.abort(),Xe(!1),nt(!1))};return e.jsxs("div",{ref:Ot,className:`fixed inset-0 overflow-hidden text-white ${$n}`,style:{backgroundColor:Zt[c],transition:"background-color 1s ease",...rt==="none"?{background:Zt[c]}:{},...pt?{userSelect:"none",WebkitUserSelect:"none"}:{}},onClick:kn,onContextMenu:jn,children:[t.isActive&&!t.mouseSimulation&&e.jsx(s.Suspense,{fallback:null,children:e.jsx(Zs,{onStopGeneration:t.callbacks.current.onStopGeneration,onSendMessage:t.callbacks.current.onSendMessage,onScroll:t.callbacks.current.onScroll,onPinch:t.callbacks.current.onPinch,onHover:t.callbacks.current.onHover,onModeChange:t.callbacks.current.onModeChange,config:t.gestureConfig,mode:t.gestureMode,appContext:t.appContext,onGestureModeToggle:()=>t.setGestureMode(t.gestureMode==="navigation"?"asl":"navigation"),gestureActiveArea:{minX:.7,maxX:1,minY:0,maxY:1},onGestureState:t.setGestureState,onASLResult:t.setASLResult,onError:t.setCameraError,onDebugInfo:t.setDebugInfo,onLandmarkData:t.setLandmarkData,onPerformance:t.setPerformanceMetrics})}),$&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-slate-900/95 backdrop-blur-sm",children:e.jsxs("div",{className:"flex flex-col items-center gap-5 text-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-12 h-12 border-2 border-slate-700 border-t-blue-500 rounded-full animate-spin"}),e.jsx("div",{className:"absolute inset-0 w-12 h-12 border-2 border-transparent border-b-emerald-500/50 rounded-full animate-spin",style:{animationDirection:"reverse",animationDuration:"1.5s"}})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"text-white/80 text-sm font-medium",children:B||"Connecting to models..."}),H>0&&e.jsxs("p",{className:"text-white/40 text-xs tabular-nums",children:["Attempt ",H," of 8"]})]}),e.jsxs("button",{onClick:Y,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white/70 hover:text-white bg-white/5 hover:bg-white/10 border border-white/10 hover:border-white/20 rounded-lg transition-all active:scale-95",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh Now"]})]})}),e.jsx(us,{mode:c,setMode:Ye,setHoveredCard:Ie,clearSelection:De,showDock:M,setShowDock:_,onOpenSettings:()=>me(!0),gestureButtonSlot:e.jsx(s.Suspense,{fallback:null,children:e.jsx(Js,{inHeader:!0,appContext:c,onStopGeneration:()=>{if(c==="chat"&&Te.current){Te.current.stopGeneration();return}Kt()},onSendMessage:r=>{if(c==="chat"&&Te.current){Te.current.sendMessage(r,!0);return}const l=c==="compare"||c==="analyze"||c==="debate"?d:[];l.length>0&&kt(r,{},l)},onScroll:r=>{if(c==="chat"&&Te.current){Te.current.scroll(r);return}K.current=St(K.current+r),Mt()},onHover:(r,l)=>{const w=r*window.innerWidth,C=l*window.innerHeight,N=document.elementFromPoint(w,C);if(N){const O=N.closest("[data-gesture-mode-track]");if(O){const ke=O.getBoundingClientRect(),qt=w-ke.left,ot=ke.width,at=Math.floor(qt/ot*5),Et=["chat","compare","analyze","debate"][Math.max(0,Math.min(4,at))];Et&&Et!==c&&Ye(Et);return}const q=document.querySelector('[data-gesture-hovered="true"]'),Q=N.closest('button, a, [role="button"], [data-clickable], .cursor-pointer, [onclick]')||N;Q!==q?(q&&(q.removeAttribute("data-gesture-hovered"),q.dispatchEvent(new PointerEvent("pointerleave",{bubbles:!1,cancelable:!0})),q.dispatchEvent(new MouseEvent("mouseleave",{bubbles:!1,cancelable:!0})),q.dispatchEvent(new MouseEvent("mouseout",{bubbles:!0,cancelable:!0}))),Q.setAttribute("data-gesture-hovered","true"),Q.dispatchEvent(new PointerEvent("pointerenter",{bubbles:!1,cancelable:!0,clientX:w,clientY:C})),Q.dispatchEvent(new PointerEvent("pointermove",{bubbles:!0,cancelable:!0,clientX:w,clientY:C})),Q.dispatchEvent(new MouseEvent("mouseenter",{bubbles:!1,cancelable:!0,clientX:w,clientY:C})),Q.dispatchEvent(new MouseEvent("mouseover",{bubbles:!0,cancelable:!0,clientX:w,clientY:C}))):Q===q&&(Q.dispatchEvent(new PointerEvent("pointermove",{bubbles:!0,cancelable:!0,clientX:w,clientY:C})),Q.dispatchEvent(new MouseEvent("mousemove",{bubbles:!0,cancelable:!0,clientX:w,clientY:C})))}},onPinch:(r,l)=>{const w=r*window.innerWidth,C=l*window.innerHeight,N=document.elementFromPoint(w,C);if(N){const O=ke=>{ke.dispatchEvent(new PointerEvent("pointerdown",{bubbles:!0,cancelable:!0,clientX:w,clientY:C,pointerId:1,pointerType:"touch",isPrimary:!0})),ke.dispatchEvent(new PointerEvent("pointerup",{bubbles:!0,cancelable:!0,clientX:w,clientY:C,pointerId:1,pointerType:"touch",isPrimary:!0})),ke.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0,clientX:w,clientY:C})),ke.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0,clientX:w,clientY:C})),ke.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,clientX:w,clientY:C}))},q=N.closest('button, a, [role="button"], [data-clickable], .cursor-pointer, [onclick]');O(q||N);const Q=document.createElement("div");Q.style.position="fixed",Q.style.left=`${w}px`,Q.style.top=`${C}px`,Q.style.width="20px",Q.style.height="20px",Q.style.background="rgba(236, 72, 153, 0.5)",Q.style.borderRadius="50%",Q.style.transform="translate(-50%, -50%)",Q.style.pointerEvents="none",Q.style.zIndex="9999",document.body.appendChild(Q),Q.animate([{transform:"translate(-50%, -50%) scale(1)",opacity:1},{transform:"translate(-50%, -50%) scale(4)",opacity:0}],{duration:400}).onfinish=()=>Q.remove()}},onModeChange:r=>{const l=["chat","compare","analyze","debate"],w=l.indexOf(c);let C;r==="next"?C=(w+1)%l.length:C=(w-1+l.length)%l.length,Ye(l[C])}})})}),e.jsxs("div",{style:{paddingLeft:"1.5rem",paddingRight:"0"},children:[M&&e.jsx("div",{className:"fixed inset-0 z-[55] bg-black/10 backdrop-blur-[1px] transition-opacity duration-300",onClick:()=>_(!1)}),e.jsx(ls,{showDock:M,availableModels:g,allSelectedByType:y,totalModelsByType:x,handleDragStart:Je,handleModelToggle:ct,handleAddGroup:dn,dockRef:ve,mode:c,allModels:n,chatModelId:a,setChatModelId:b,chatAutoMode:L,setChatAutoMode:m,chatAutoModeScope:j,setChatAutoModeScope:h,setShowDock:_}),c==="chat"&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex h-screen w-full relative z-[10]",children:e.jsx("div",{className:"flex-1 relative px-2 sm:px-6 pt-20 pb-6",children:e.jsx(qs,{children:e.jsx(s.Suspense,{fallback:e.jsxs("div",{className:"flex items-center justify-center h-full text-white/50 gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/20 border-t-white/60 rounded-full animate-spin"}),"Loading..."]}),children:e.jsx(er,{ref:Te,models:n,selectedModelId:a,onSelectModel:b,githubToken:fe,openrouterKey:T,messages:Me,setMessages:qe,autoMode:L,setAutoMode:m,autoModeScope:j,setAutoModeScope:h,currentResponse:S,setCurrentResponse:v,isGenerating:F,setIsGenerating:D,onModelUsed:b,gesturesActive:t.isActive})})})})})}),c!=="chat"&&e.jsxs("div",{className:"flex h-screen w-full relative",children:[e.jsx("div",{className:"relative flex-1 transition-all duration-300 flex flex-col pt-24",children:e.jsx("div",{ref:we,onDragOver:be,onDragLeave:ln,onDrop:cn,className:"relative w-full h-full z-10 transition-all duration-300",style:{position:"relative",display:"flex",alignItems:c==="compare"?"flex-start":"center",justifyContent:"center","--arena-offset-y":`${se.current}px`,transform:c==="analyze"||c==="debate"?`translateY(calc(var(--arena-offset-y) - 50px)) scale(${X?1.02:1})`:`translateY(var(--arena-offset-y)) scale(${X?1.02:1})`,willChange:"transform",border:X?"2px dashed rgba(59, 130, 246, 0.4)":"2px dashed transparent",borderRadius:X?"24px":"0px",transition:"transform 0s linear",...c==="compare"?{minHeight:"300px",paddingBottom:"120px"}:c==="analyze"||c==="debate"?{height:"100%",minHeight:"100%",overflow:"hidden"}:{height:"100%",minHeight:"100%",overflow:"hidden"},...X?{background:"rgba(59, 130, 246, 0.05)"}:{}},children:e.jsx(Ds,{mode:c,selectedModels:Se,gridCols:G,speaking:Dt,selectedCardIds:Ne,setSelectedCardIds:We,executionTimes:U,failedModels:Tn,cardRefs:et,handlePointerDown:wn,dragState:vn,handleModelToggle:ct,setContextMenu:Le,suppressClickRef:Fe,getTailSnippet:Pn,hoveredCard:un,setHoveredCard:Ie,layoutRadius:dt,getCirclePosition:He,moderatorModel:In,moderatorId:f,orchestratorTransform:On,orchestratorStatus:Dn,orchestratorPhaseLabel:zn,moderatorSynthesis:ht,isSynthesizing:Ge,isGenerating:Ae,phaseLabel:Bt,linesTransitioning:P,lastSelectedCardRef:mn,orchestratorAutoMode:Mn,orchestratorAutoScope:Cn,showOrchestratorMenu:xt,setShowOrchestratorMenu:gt,setOrchestratorAutoMode:En,setOrchestratorAutoScope:Nn,orchestratorMenuRef:bt,availableModels:g,setModerator:p})})}),c!=="compare"&&e.jsx("div",{className:"transcript-panel w-[400px] xl:w-[480px] flex flex-col border-l border-white/5 bg-slate-900/20 backdrop-blur-sm z-40 relative h-full",children:e.jsx(s.Suspense,{fallback:null,children:e.jsx(Qs,{history:z,models:n,mode:c,onSelectPrompt:r=>{ze.current&&(ze.current.value=r,ze.current.focus())},onNewSession:Sn,className:"pt-24 pb-6 mask-fade-top",phaseLabel:Bt,isGenerating:Ae,isSynthesizing:Ge,speakingCount:Dt.size,totalParticipants:Se.length})})})]})]}),e.jsx(Xs,{rect:yn}),ce&&e.jsx("div",{className:"fixed bottom-20 left-1/2 -translate-x-1/2 z-[200] animate-in slide-in-from-bottom-4 fade-in duration-300",children:e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 rounded-xl bg-amber-500/10 border border-amber-500/30 backdrop-blur-md shadow-xl",children:[e.jsx("svg",{className:"w-5 h-5 text-amber-400 shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsx("span",{className:"text-sm text-amber-100",children:ce}),e.jsx("button",{onClick:()=>{te(null),me(!0)},className:"ml-2 px-3 py-1 text-xs font-medium text-amber-900 bg-amber-400 hover:bg-amber-300 rounded-md transition-colors",children:"Open Settings"}),e.jsx("button",{onClick:()=>te(null),className:"ml-1 p-1 text-amber-400/60 hover:text-amber-400 transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsx(s.Suspense,{fallback:null,children:e.jsx(Vs,{open:ie,onClose:()=>me(!1),token:fe,setToken:R,openrouterKey:T,setOpenrouterKey:re,bgStyle:rt,setBgStyle:_n})}),(c==="compare"||c==="analyze"||c==="debate")&&e.jsx(cs,{inputRef:ze,inputFocused:fn,setInputFocused:pn,onSendMessage:kt,isGenerating:Ae||Ge,onStop:Kt,placeholder:c==="compare"?void 0:"Steer the discussion...",className:`fixed bottom-0 left-0 z-[100] pb-6 px-3 sm:px-4 flex justify-center items-end pointer-events-none transition-all duration-300 ${c==="compare"?"right-0":"right-[400px] xl:right-[480px]"}`,style:{paddingBottom:"calc(1.5rem + env(safe-area-inset-bottom))"}}),je&&e.jsx("div",{className:"fixed bg-slate-800 border border-slate-700 rounded-lg shadow-xl py-1 z-[200] min-w-[160px]",style:{top:je.y,left:je.x},onClick:r=>r.stopPropagation(),children:je.type==="background"?e.jsxs("button",{className:"w-full text-left px-4 py-2 text-sm text-slate-200 hover:bg-slate-700 transition-colors flex items-center gap-2",onClick:()=>{_(!0),Le(null)},children:[e.jsx("svg",{className:"w-4 h-4 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Model"]}):je.modelId?e.jsxs(e.Fragment,{children:[c!=="compare"&&je.modelId!==f&&e.jsxs("button",{className:"w-full text-left px-4 py-2 text-sm text-slate-200 hover:bg-slate-700 transition-colors flex items-center gap-2",onClick:()=>{p(je.modelId),Le(null)},children:[e.jsx("svg",{className:"w-4 h-4 text-orange-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})}),"Set as Orchestrator"]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 text-sm text-red-400 hover:bg-slate-700 transition-colors flex items-center gap-2",onClick:()=>{const r=je.modelId===f;if(ct(je.modelId),r&&c!=="compare"){const l=d.filter(w=>w!==je.modelId);l.length>0?p(l[0]):p("")}Le(null)},children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Remove"]})]}):null})]})}function sr(){return e.jsx(Us,{children:e.jsx(nr,{})})}qn.createRoot(document.getElementById("root")).render(e.jsx(Vn.StrictMode,{children:e.jsx(sr,{})}));export{is as B,fr as M,cs as P,Xs as S,pr as a,ys as f,ur as g,Nt as s,Ks as u};
