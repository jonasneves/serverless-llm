import{s as Er,r as d,j as ve}from"./react-vendor-BNniwcTg.js";import{U as kr,m as Lr,_ as Or}from"./mediapipe-YSlczgt6.js";import"./markdown-C9gPvUVj.js";import"./math-render-CUINwOeU.js";import"./syntax-highlight-BxeShyTs.js";var Pr={exports:{}};(function($e,Mr){(function(He,re){$e.exports=re()})(typeof self<"u"?self:Er,function(){return function(He){var re={};function I(D){if(re[D])return re[D].exports;var x=re[D]={i:D,l:!1,exports:{}};return He[D].call(x.exports,x,x.exports,I),x.l=!0,x.exports}return I.m=He,I.c=re,I.d=function(D,x,g){I.o(D,x)||Object.defineProperty(D,x,{enumerable:!0,get:g})},I.r=function(D){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(D,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(D,"__esModule",{value:!0})},I.t=function(D,x){if(1&x&&(D=I(D)),8&x||4&x&&typeof D=="object"&&D&&D.__esModule)return D;var g=Object.create(null);if(I.r(g),Object.defineProperty(g,"default",{enumerable:!0,value:D}),2&x&&typeof D!="string")for(var _ in D)I.d(g,_,(function(C){return D[C]}).bind(null,_));return g},I.n=function(D){var x=D&&D.__esModule?function(){return D.default}:function(){return D};return I.d(x,"a",x),x},I.o=function(D,x){return Object.prototype.hasOwnProperty.call(D,x)},I.p="",I(I.s=0)}([function(He,re,I){I.r(re);var D={};function x(n){return(x=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(l){return typeof l}:function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l})(n)}I.r(D),I.d(D,"VictoryGesture",function(){return hr}),I.d(D,"ThumbsUpGesture",function(){return pe});var g={Thumb:0,Index:1,Middle:2,Ring:3,Pinky:4,all:[0,1,2,3,4],nameMapping:{0:"Thumb",1:"Index",2:"Middle",3:"Ring",4:"Pinky"},pointsMapping:{0:[[0,1],[1,2],[2,3],[3,4]],1:[[0,5],[5,6],[6,7],[7,8]],2:[[0,9],[9,10],[10,11],[11,12]],3:[[0,13],[13,14],[14,15],[15,16]],4:[[0,17],[17,18],[18,19],[19,20]]},getName:function(n){return x(this.nameMapping[n])!==void 0&&this.nameMapping[n]},getPoints:function(n){return x(this.pointsMapping[n])!==void 0&&this.pointsMapping[n]}},_={NoCurl:0,HalfCurl:1,FullCurl:2,nameMapping:{0:"No Curl",1:"Half Curl",2:"Full Curl"},getName:function(n){return x(this.nameMapping[n])!==void 0&&this.nameMapping[n]}},C={VerticalUp:0,VerticalDown:1,HorizontalLeft:2,HorizontalRight:3,DiagonalUpRight:4,DiagonalUpLeft:5,DiagonalDownRight:6,DiagonalDownLeft:7,nameMapping:{0:"Vertical Up",1:"Vertical Down",2:"Horizontal Left",3:"Horizontal Right",4:"Diagonal Up Right",5:"Diagonal Up Left",6:"Diagonal Down Right",7:"Diagonal Down Left"},getName:function(n){return x(this.nameMapping[n])!==void 0&&this.nameMapping[n]}};function Ue(n,l){var i=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!i){if(Array.isArray(n)||(i=function(t,v){if(t){if(typeof t=="string")return cr(t,v);var h=Object.prototype.toString.call(t).slice(8,-1);if(h==="Object"&&t.constructor&&(h=t.constructor.name),h==="Map"||h==="Set")return Array.from(t);if(h==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(h))return cr(t,v)}}(n))||l){i&&(n=i);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(t){throw t},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o,s=!0,c=!1;return{s:function(){i=i.call(n)},n:function(){var t=i.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||i.return==null||i.return()}finally{if(c)throw o}}}}function cr(n,l){(l==null||l>n.length)&&(l=n.length);for(var i=0,r=new Array(l);i<l;i++)r[i]=n[i];return r}function dr(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);l&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),i.push.apply(i,r)}return i}function gr(n){for(var l=1;l<arguments.length;l++){var i=arguments[l]!=null?arguments[l]:{};l%2?dr(Object(i),!0).forEach(function(r){fr(n,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):dr(Object(i)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(i,r))})}return n}function fr(n,l,i){return l in n?Object.defineProperty(n,l,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[l]=i,n}function yr(n,l){for(var i=0;i<l.length;i++){var r=l[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}var vr=function(){function n(r){(function(a,o){if(!(a instanceof o))throw new TypeError("Cannot call a class as a function")})(this,n),this.options=gr(gr({},{HALF_CURL_START_LIMIT:60,NO_CURL_START_LIMIT:130,DISTANCE_VOTE_POWER:1.1,SINGLE_ANGLE_VOTE_POWER:.9,TOTAL_ANGLE_VOTE_POWER:1.6}),r)}var l,i;return l=n,(i=[{key:"estimate",value:function(r){var a,o=[],s=[],c=Ue(g.all);try{for(c.s();!(a=c.n()).done;){var t,v=a.value,h=g.getPoints(v),w=[],P=[],M=Ue(h);try{for(M.s();!(t=M.n()).done;){var j=t.value,O=r[j[0]],X=r[j[1]],z=this.getSlopes(O,X),Y=z[0],B=z[1];w.push(Y),P.push(B)}}catch(ee){M.e(ee)}finally{M.f()}o.push(w),s.push(P)}}catch(ee){c.e(ee)}finally{c.f()}var le,ae=[],Q=[],V=Ue(g.all);try{for(V.s();!(le=V.n()).done;){var $=le.value,ue=$==g.Thumb?1:0,ne=g.getPoints($),oe=r[ne[ue][0]],De=r[ne[ue+1][1]],Ve=r[ne[3][1]],Se=this.estimateFingerCurl(oe,De,Ve),Ge=this.calculateFingerDirection(oe,De,Ve,o[$].slice(ue));ae[$]=Se,Q[$]=Ge}}catch(ee){V.e(ee)}finally{V.f()}return{curls:ae,directions:Q}}},{key:"getSlopes",value:function(r,a){var o=this.calculateSlope(r[0],r[1],a[0],a[1]);return r.length==2?o:[o,this.calculateSlope(r[1],r[2],a[1],a[2])]}},{key:"angleOrientationAt",value:function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=0,s=0,c=0;return r>=75&&r<=105?o=1*a:r>=25&&r<=155?s=1*a:c=1*a,[o,s,c]}},{key:"estimateFingerCurl",value:function(r,a,o){var s=r[0]-a[0],c=r[0]-o[0],t=a[0]-o[0],v=r[1]-a[1],h=r[1]-o[1],w=a[1]-o[1],P=r[2]-a[2],M=r[2]-o[2],j=a[2]-o[2],O=Math.sqrt(s*s+v*v+P*P),X=Math.sqrt(c*c+h*h+M*M),z=Math.sqrt(t*t+w*w+j*j),Y=(z*z+O*O-X*X)/(2*z*O);Y>1?Y=1:Y<-1&&(Y=-1);var B=Math.acos(Y);return(B=57.2958*B%180)>this.options.NO_CURL_START_LIMIT?_.NoCurl:B>this.options.HALF_CURL_START_LIMIT?_.HalfCurl:_.FullCurl}},{key:"estimateHorizontalDirection",value:function(r,a,o,s){return s==Math.abs(r)?r>0?C.HorizontalLeft:C.HorizontalRight:s==Math.abs(a)?a>0?C.HorizontalLeft:C.HorizontalRight:o>0?C.HorizontalLeft:C.HorizontalRight}},{key:"estimateVerticalDirection",value:function(r,a,o,s){return s==Math.abs(r)?r<0?C.VerticalDown:C.VerticalUp:s==Math.abs(a)?a<0?C.VerticalDown:C.VerticalUp:o<0?C.VerticalDown:C.VerticalUp}},{key:"estimateDiagonalDirection",value:function(r,a,o,s,c,t,v,h){var w=this.estimateVerticalDirection(r,a,o,s),P=this.estimateHorizontalDirection(c,t,v,h);return w==C.VerticalUp?P==C.HorizontalLeft?C.DiagonalUpLeft:C.DiagonalUpRight:P==C.HorizontalLeft?C.DiagonalDownLeft:C.DiagonalDownRight}},{key:"calculateFingerDirection",value:function(r,a,o,s){var c=r[0]-a[0],t=r[0]-o[0],v=a[0]-o[0],h=r[1]-a[1],w=r[1]-o[1],P=a[1]-o[1],M=Math.max(Math.abs(c),Math.abs(t),Math.abs(v)),j=Math.max(Math.abs(h),Math.abs(w),Math.abs(P)),O=0,X=0,z=0,Y=j/(M+1e-5);Y>1.5?O+=this.options.DISTANCE_VOTE_POWER:Y>.66?X+=this.options.DISTANCE_VOTE_POWER:z+=this.options.DISTANCE_VOTE_POWER;var B=Math.sqrt(c*c+h*h),le=Math.sqrt(t*t+w*w),ae=Math.sqrt(v*v+P*P),Q=Math.max(B,le,ae),V=r[0],$=r[1],ue=o[0],ne=o[1];Q==B?(ue=o[0],ne=o[1]):Q==ae&&(V=a[0],$=a[1]);var oe=[V,$],De=[ue,ne],Ve=this.getSlopes(oe,De),Se=this.angleOrientationAt(Ve,this.options.TOTAL_ANGLE_VOTE_POWER);O+=Se[0],X+=Se[1],z+=Se[2];var Ge,ee=Ue(s);try{for(ee.s();!(Ge=ee.n()).done;){var Rr=Ge.value,ie=this.angleOrientationAt(Rr,this.options.SINGLE_ANGLE_VOTE_POWER);O+=ie[0],X+=ie[1],z+=ie[2]}}catch(f){ee.e(f)}finally{ee.f()}return O==Math.max(O,X,z)?this.estimateVerticalDirection(w,h,P,j):z==Math.max(X,z)?this.estimateHorizontalDirection(t,c,v,M):this.estimateDiagonalDirection(w,h,P,j,t,c,v,M)}},{key:"calculateSlope",value:function(r,a,o,s){var c=(a-s)/(r-o),t=180*Math.atan(c)/Math.PI;return t<=0?t=-t:t>0&&(t=180-t),t}}])&&yr(l.prototype,i),n}();function br(n,l){var i=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!i){if(Array.isArray(n)||(i=function(t,v){if(t){if(typeof t=="string")return xe(t,v);var h=Object.prototype.toString.call(t).slice(8,-1);if(h==="Object"&&t.constructor&&(h=t.constructor.name),h==="Map"||h==="Set")return Array.from(t);if(h==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(h))return xe(t,v)}}(n))||l){i&&(n=i);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(t){throw t},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o,s=!0,c=!1;return{s:function(){i=i.call(n)},n:function(){var t=i.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||i.return==null||i.return()}finally{if(c)throw o}}}}function xe(n,l){(l==null||l>n.length)&&(l=n.length);for(var i=0,r=new Array(l);i<l;i++)r[i]=n[i];return r}function Cr(n,l){if(!(n instanceof l))throw new TypeError("Cannot call a class as a function")}function Fr(n,l){for(var i=0;i<l.length;i++){var r=l[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}var mr=function(){function n(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Cr(this,n),this.estimator=new vr(a),this.gestures=r}var l,i;return l=n,(i=[{key:"estimate",value:function(r,a){var o,s=[],c=this.estimator.estimate(r),t=[],v=br(g.all);try{for(v.s();!(o=v.n()).done;){var h=o.value;t.push([g.getName(h),_.getName(c.curls[h]),C.getName(c.directions[h])])}}catch(O){v.e(O)}finally{v.f()}var w,P=br(this.gestures);try{for(P.s();!(w=P.n()).done;){var M=w.value,j=M.matchAgainst(c.curls,c.directions);j>=a&&s.push({name:M.name,score:j})}}catch(O){P.e(O)}finally{P.f()}return{poseData:t,gestures:s}}}])&&Fr(l.prototype,i),n}();function Me(n,l){return function(i){if(Array.isArray(i))return i}(n)||function(i,r){var a=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(a!=null){var o,s,c=[],t=!0,v=!1;try{for(a=a.call(i);!(t=(o=a.next()).done)&&(c.push(o.value),!r||c.length!==r);t=!0);}catch(h){v=!0,s=h}finally{try{t||a.return==null||a.return()}finally{if(v)throw s}}return c}}(n,l)||N(n,l)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function wr(n,l){var i=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!i){if(Array.isArray(n)||(i=N(n))||l){i&&(n=i);var r=0,a=function(){};return{s:a,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(t){throw t},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o,s=!0,c=!1;return{s:function(){i=i.call(n)},n:function(){var t=i.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||i.return==null||i.return()}finally{if(c)throw o}}}}function N(n,l){if(n){if(typeof n=="string")return Ke(n,l);var i=Object.prototype.toString.call(n).slice(8,-1);return i==="Object"&&n.constructor&&(i=n.constructor.name),i==="Map"||i==="Set"?Array.from(n):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Ke(n,l):void 0}}function Ke(n,l){(l==null||l>n.length)&&(l=n.length);for(var i=0,r=new Array(l);i<l;i++)r[i]=n[i];return r}function Sr(n,l){for(var i=0;i<l.length;i++){var r=l[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}var te=function(){function n(r){(function(a,o){if(!(a instanceof o))throw new TypeError("Cannot call a class as a function")})(this,n),this.name=r,this.curls={},this.directions={}}var l,i;return l=n,(i=[{key:"addCurl",value:function(r,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;this.curls[r]===void 0&&(this.curls[r]=[]),this.curls[r].push([a,o])}},{key:"addDirection",value:function(r,a){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;this.directions[r]===void 0&&(this.directions[r]=[]),this.directions[r].push([a,o])}},{key:"matchAgainst",value:function(r,a){var o=0,s=0;for(var c in r){var t=r[c],v=this.curls[c];if(v!==void 0){s++;var h,w=!1,P=0,M=wr(v);try{for(M.s();!(h=M.n()).done;){var j=Me(h.value,2),O=j[0],X=j[1];if(t==O){o+=X,P=Math.max(P,X),w=!0;break}}}catch(oe){M.e(oe)}finally{M.f()}w||(o-=P)}}for(var z in a){var Y=a[z],B=this.directions[z];if(B!==void 0){s++;var le,ae=!1,Q=0,V=wr(B);try{for(V.s();!(le=V.n()).done;){var $=Me(le.value,2),ue=$[0],ne=$[1];if(Y==ue){o+=ne,Q=Math.max(Q,ne),ae=!0;break}}}catch(oe){V.e(oe)}finally{V.f()}ae||(o-=Q)}}return o/s*10}}])&&Sr(l.prototype,i),n}(),E=new te("victory");E.addDirection(g.Thumb,C.VerticalUp,1),E.addDirection(g.Thumb,C.DiagonalUpLeft,1),E.addDirection(g.Thumb,C.DiagonalUpRight,1),E.addCurl(g.Index,_.NoCurl,1),E.addDirection(g.Index,C.VerticalUp,1),E.addDirection(g.Index,C.DiagonalUpLeft,1),E.addDirection(g.Index,C.DiagonalUpRight,1),E.addDirection(g.Index,C.HorizontalLeft,1),E.addDirection(g.Index,C.HorizontalRight,1),E.addCurl(g.Middle,_.NoCurl,1),E.addDirection(g.Middle,C.VerticalUp,1),E.addDirection(g.Middle,C.DiagonalUpLeft,1),E.addDirection(g.Middle,C.DiagonalUpRight,1),E.addDirection(g.Middle,C.HorizontalLeft,1),E.addDirection(g.Middle,C.HorizontalRight,1),E.addCurl(g.Ring,_.FullCurl,1),E.addCurl(g.Ring,_.HalfCurl,.9),E.addCurl(g.Pinky,_.FullCurl,1),E.addCurl(g.Pinky,_.HalfCurl,.9);var hr=E,J=new te("thumbs_up");J.addCurl(g.Thumb,_.NoCurl,1),J.addDirection(g.Thumb,C.VerticalUp,1),J.addDirection(g.Thumb,C.DiagonalUpLeft,.9),J.addDirection(g.Thumb,C.DiagonalUpRight,.9);for(var _e=0,pr=[g.Index,g.Middle,g.Ring,g.Pinky];_e<pr.length;_e++){var Je=pr[_e];J.addCurl(Je,_.FullCurl,1),J.addCurl(Je,_.HalfCurl,.9)}J.addDirection(g.Index,C.DiagonalUpLeft,1),J.addDirection(g.Index,C.HorizontalLeft,1),J.addDirection(g.Index,C.HorizontalRight,1),J.addDirection(g.Index,C.DiagonalUpRight,1);var pe=J;re.default={GestureEstimator:mr,GestureDescription:te,Finger:g,FingerCurl:_,FingerDirection:C,Gestures:D}}]).default})})(Pr);var e=Pr.exports;const Pe=new e.GestureDescription("A");Pe.addCurl(e.Finger.Thumb,e.FingerCurl.NoCurl,1);Pe.addDirection(e.Finger.Thumb,e.FingerDirection.VerticalUp,.75);Pe.addCurl(e.Finger.Index,e.FingerCurl.FullCurl,1);Pe.addCurl(e.Finger.Middle,e.FingerCurl.FullCurl,1);Pe.addCurl(e.Finger.Ring,e.FingerCurl.FullCurl,1);Pe.addCurl(e.Finger.Pinky,e.FingerCurl.FullCurl,1);const ce=new e.GestureDescription("B");Pe.addCurl(e.Finger.Index,e.FingerCurl.NoCurl,1);ce.addCurl(e.Finger.Index,e.FingerCurl.NoCurl,1);ce.addDirection(e.Finger.Index,e.FingerDirection.VerticalUp,.75);ce.addCurl(e.Finger.Middle,e.FingerCurl.NoCurl,1);ce.addDirection(e.Finger.Middle,e.FingerDirection.VerticalUp,.75);ce.addCurl(e.Finger.Ring,e.FingerCurl.NoCurl,1);ce.addDirection(e.Finger.Ring,e.FingerDirection.VerticalUp,.75);ce.addCurl(e.Finger.Pinky,e.FingerCurl.NoCurl,1);ce.addDirection(e.Finger.Pinky,e.FingerDirection.VerticalUp,.75);ce.addCurl(e.Finger.Thumb,e.FingerCurl.HalfCurl,1);const We=new e.GestureDescription("C");We.addCurl(e.Finger.Thumb,e.FingerCurl.NoCurl,1);We.addDirection(e.Finger.Thumb,e.FingerDirection.DiagonalUpRight,.75);We.addCurl(e.Finger.Index,e.FingerCurl.HalfCurl,1);We.addCurl(e.Finger.Middle,e.FingerCurl.HalfCurl,1);We.addCurl(e.Finger.Ring,e.FingerCurl.HalfCurl,1);We.addCurl(e.Finger.Pinky,e.FingerCurl.HalfCurl,1);const Xe=new e.GestureDescription("D");Xe.addCurl(e.Finger.Index,e.FingerCurl.NoCurl,1);Xe.addDirection(e.Finger.Index,e.FingerDirection.VerticalUp,.75);Xe.addCurl(e.Finger.Middle,e.FingerCurl.FullCurl,1);Xe.addCurl(e.Finger.Ring,e.FingerCurl.FullCurl,1);Xe.addCurl(e.Finger.Pinky,e.FingerCurl.FullCurl,1);Xe.addCurl(e.Finger.Thumb,e.FingerCurl.HalfCurl,.75);const ir=new e.GestureDescription("E");ir.addCurl(e.Finger.Index,e.FingerCurl.FullCurl,1);ir.addCurl(e.Finger.Middle,e.FingerCurl.FullCurl,1);ir.addCurl(e.Finger.Ring,e.FingerCurl.FullCurl,1);ir.addCurl(e.Finger.Pinky,e.FingerCurl.FullCurl,1);ir.addCurl(e.Finger.Thumb,e.FingerCurl.HalfCurl,1);const be=new e.GestureDescription("F");be.addCurl(e.Finger.Thumb,e.FingerCurl.HalfCurl,.8);be.addCurl(e.Finger.Index,e.FingerCurl.FullCurl,1);be.addCurl(e.Finger.Middle,e.FingerCurl.NoCurl,1);be.addDirection(e.Finger.Middle,e.FingerDirection.VerticalUp,.75);be.addCurl(e.Finger.Ring,e.FingerCurl.NoCurl,1);be.addDirection(e.Finger.Ring,e.FingerDirection.VerticalUp,.75);be.addCurl(e.Finger.Pinky,e.FingerCurl.NoCurl,1);be.addDirection(e.Finger.Pinky,e.FingerDirection.VerticalUp,.75);const de=new e.GestureDescription("G");de.addCurl(e.Finger.Index,e.FingerCurl.NoCurl,1);de.addDirection(e.Finger.Index,e.FingerDirection.HorizontalLeft,.75);de.addDirection(e.Finger.Index,e.FingerDirection.HorizontalRight,.75);de.addCurl(e.Finger.Thumb,e.FingerCurl.NoCurl,1);de.addDirection(e.Finger.Thumb,e.FingerDirection.HorizontalLeft,.5);de.addDirection(e.Finger.Thumb,e.FingerDirection.HorizontalRight,.5);de.addCurl(e.Finger.Middle,e.FingerCurl.FullCurl,1);de.addCurl(e.Finger.Ring,e.FingerCurl.FullCurl,1);de.addCurl(e.Finger.Pinky,e.FingerCurl.FullCurl,1);const ge=new e.GestureDescription("H");ge.addCurl(e.Finger.Index,e.FingerCurl.NoCurl,1);ge.addDirection(e.Finger.Index,e.FingerDirection.HorizontalLeft,.75);ge.addDirection(e.Finger.Index,e.FingerDirection.HorizontalRight,.75);ge.addCurl(e.Finger.Middle,e.FingerCurl.NoCurl,1);ge.addDirection(e.Finger.Middle,e.FingerDirection.HorizontalLeft,.75);ge.addDirection(e.Finger.Middle,e.FingerDirection.HorizontalRight,.75);ge.addCurl(e.Finger.Ring,e.FingerCurl.FullCurl,1);ge.addCurl(e.Finger.Pinky,e.FingerCurl.FullCurl,1);ge.addCurl(e.Finger.Thumb,e.FingerCurl.HalfCurl,.75);const qe=new e.GestureDescription("I");qe.addCurl(e.Finger.Pinky,e.FingerCurl.NoCurl,1);qe.addDirection(e.Finger.Pinky,e.FingerDirection.VerticalUp,.75);qe.addCurl(e.Finger.Index,e.FingerCurl.FullCurl,1);qe.addCurl(e.Finger.Middle,e.FingerCurl.FullCurl,1);qe.addCurl(e.Finger.Ring,e.FingerCurl.FullCurl,1);qe.addCurl(e.Finger.Thumb,e.FingerCurl.HalfCurl,.75);const Ie=new e.GestureDescription("J");Ie.addCurl(e.Finger.Pinky,e.FingerCurl.NoCurl,1);Ie.addDirection(e.Finger.Pinky,e.FingerDirection.DiagonalUpRight,.5);Ie.addDirection(e.Finger.Pinky,e.FingerDirection.DiagonalUpLeft,.5);Ie.addCurl(e.Finger.Index,e.FingerCurl.FullCurl,1);Ie.addCurl(e.Finger.Middle,e.FingerCurl.FullCurl,1);Ie.addCurl(e.Finger.Ring,e.FingerCurl.FullCurl,1);Ie.addCurl(e.Finger.Thumb,e.FingerCurl.HalfCurl,.75);const Ne=new e.GestureDescription("K");Ne.addCurl(e.Finger.Index,e.FingerCurl.NoCurl,1);Ne.addDirection(e.Finger.Index,e.FingerDirection.VerticalUp,.75);Ne.addCurl(e.Finger.Middle,e.FingerCurl.NoCurl,1);Ne.addDirection(e.Finger.Middle,e.FingerDirection.VerticalUp,.75);Ne.addCurl(e.Finger.Thumb,e.FingerCurl.NoCurl,.75);Ne.addCurl(e.Finger.Ring,e.FingerCurl.FullCurl,1);Ne.addCurl(e.Finger.Pinky,e.FingerCurl.FullCurl,1);const we=new e.GestureDescription("L");we.addCurl(e.Finger.Index,e.FingerCurl.NoCurl,1);we.addDirection(e.Finger.Index,e.FingerDirection.VerticalUp,.75);we.addCurl(e.Finger.Thumb,e.FingerCurl.NoCurl,1);we.addDirection(e.Finger.Thumb,e.FingerDirection.HorizontalLeft,.5);we.addDirection(e.Finger.Thumb,e.FingerDirection.HorizontalRight,.5);we.addCurl(e.Finger.Middle,e.FingerCurl.FullCurl,1);we.addCurl(e.Finger.Ring,e.FingerCurl.FullCurl,1);we.addCurl(e.Finger.Pinky,e.FingerCurl.FullCurl,1);const tr=new e.GestureDescription("M");tr.addCurl(e.Finger.Index,e.FingerCurl.FullCurl,1);tr.addCurl(e.Finger.Middle,e.FingerCurl.FullCurl,1);tr.addCurl(e.Finger.Ring,e.FingerCurl.FullCurl,1);tr.addCurl(e.Finger.Pinky,e.FingerCurl.FullCurl,1);tr.addCurl(e.Finger.Thumb,e.FingerCurl.FullCurl,1);const lr=new e.GestureDescription("N");lr.addCurl(e.Finger.Index,e.FingerCurl.FullCurl,1);lr.addCurl(e.Finger.Middle,e.FingerCurl.FullCurl,1);lr.addCurl(e.Finger.Ring,e.FingerCurl.FullCurl,1);lr.addCurl(e.Finger.Pinky,e.FingerCurl.FullCurl,1);lr.addCurl(e.Finger.Thumb,e.FingerCurl.HalfCurl,.75);const ar=new e.GestureDescription("O");ar.addCurl(e.Finger.Thumb,e.FingerCurl.HalfCurl,1);ar.addCurl(e.Finger.Index,e.FingerCurl.HalfCurl,1);ar.addCurl(e.Finger.Middle,e.FingerCurl.HalfCurl,1);ar.addCurl(e.Finger.Ring,e.FingerCurl.HalfCurl,1);ar.addCurl(e.Finger.Pinky,e.FingerCurl.HalfCurl,1);const Re=new e.GestureDescription("P");Re.addCurl(e.Finger.Index,e.FingerCurl.NoCurl,1);Re.addDirection(e.Finger.Index,e.FingerDirection.DiagonalDownLeft,.5);Re.addDirection(e.Finger.Index,e.FingerDirection.DiagonalDownRight,.5);Re.addCurl(e.Finger.Middle,e.FingerCurl.NoCurl,1);Re.addDirection(e.Finger.Middle,e.FingerDirection.VerticalDown,.5);Re.addCurl(e.Finger.Thumb,e.FingerCurl.NoCurl,.75);Re.addCurl(e.Finger.Ring,e.FingerCurl.FullCurl,1);Re.addCurl(e.Finger.Pinky,e.FingerCurl.FullCurl,1);const Ee=new e.GestureDescription("Q");Ee.addCurl(e.Finger.Index,e.FingerCurl.NoCurl,1);Ee.addDirection(e.Finger.Index,e.FingerDirection.VerticalDown,.75);Ee.addCurl(e.Finger.Thumb,e.FingerCurl.NoCurl,1);Ee.addDirection(e.Finger.Thumb,e.FingerDirection.VerticalDown,.5);Ee.addCurl(e.Finger.Middle,e.FingerCurl.FullCurl,1);Ee.addCurl(e.Finger.Ring,e.FingerCurl.FullCurl,1);Ee.addCurl(e.Finger.Pinky,e.FingerCurl.FullCurl,1);const ke=new e.GestureDescription("R");ke.addCurl(e.Finger.Index,e.FingerCurl.NoCurl,1);ke.addDirection(e.Finger.Index,e.FingerDirection.VerticalUp,.75);ke.addCurl(e.Finger.Middle,e.FingerCurl.NoCurl,1);ke.addDirection(e.Finger.Middle,e.FingerDirection.VerticalUp,.75);ke.addCurl(e.Finger.Ring,e.FingerCurl.FullCurl,1);ke.addCurl(e.Finger.Pinky,e.FingerCurl.FullCurl,1);ke.addCurl(e.Finger.Thumb,e.FingerCurl.HalfCurl,.75);const ur=new e.GestureDescription("S");ur.addCurl(e.Finger.Index,e.FingerCurl.FullCurl,1);ur.addCurl(e.Finger.Middle,e.FingerCurl.FullCurl,1);ur.addCurl(e.Finger.Ring,e.FingerCurl.FullCurl,1);ur.addCurl(e.Finger.Pinky,e.FingerCurl.FullCurl,1);ur.addCurl(e.Finger.Thumb,e.FingerCurl.HalfCurl,1);const or=new e.GestureDescription("T");or.addCurl(e.Finger.Index,e.FingerCurl.FullCurl,1);or.addCurl(e.Finger.Middle,e.FingerCurl.FullCurl,1);or.addCurl(e.Finger.Ring,e.FingerCurl.FullCurl,1);or.addCurl(e.Finger.Pinky,e.FingerCurl.FullCurl,1);or.addCurl(e.Finger.Thumb,e.FingerCurl.NoCurl,.75);const Le=new e.GestureDescription("U");Le.addCurl(e.Finger.Index,e.FingerCurl.NoCurl,1);Le.addDirection(e.Finger.Index,e.FingerDirection.VerticalUp,.75);Le.addCurl(e.Finger.Middle,e.FingerCurl.NoCurl,1);Le.addDirection(e.Finger.Middle,e.FingerDirection.VerticalUp,.75);Le.addCurl(e.Finger.Ring,e.FingerCurl.FullCurl,1);Le.addCurl(e.Finger.Pinky,e.FingerCurl.FullCurl,1);Le.addCurl(e.Finger.Thumb,e.FingerCurl.HalfCurl,.75);const fe=new e.GestureDescription("V");fe.addCurl(e.Finger.Index,e.FingerCurl.NoCurl,1);fe.addDirection(e.Finger.Index,e.FingerDirection.DiagonalUpLeft,.5);fe.addDirection(e.Finger.Index,e.FingerDirection.VerticalUp,.5);fe.addCurl(e.Finger.Middle,e.FingerCurl.NoCurl,1);fe.addDirection(e.Finger.Middle,e.FingerDirection.DiagonalUpRight,.5);fe.addDirection(e.Finger.Middle,e.FingerDirection.VerticalUp,.5);fe.addCurl(e.Finger.Ring,e.FingerCurl.FullCurl,1);fe.addCurl(e.Finger.Pinky,e.FingerCurl.FullCurl,1);fe.addCurl(e.Finger.Thumb,e.FingerCurl.HalfCurl,.75);const Te=new e.GestureDescription("W");Te.addCurl(e.Finger.Index,e.FingerCurl.NoCurl,1);Te.addDirection(e.Finger.Index,e.FingerDirection.VerticalUp,.75);Te.addCurl(e.Finger.Middle,e.FingerCurl.NoCurl,1);Te.addDirection(e.Finger.Middle,e.FingerDirection.VerticalUp,.75);Te.addCurl(e.Finger.Ring,e.FingerCurl.NoCurl,1);Te.addDirection(e.Finger.Ring,e.FingerDirection.VerticalUp,.75);Te.addCurl(e.Finger.Pinky,e.FingerCurl.FullCurl,1);Te.addCurl(e.Finger.Thumb,e.FingerCurl.HalfCurl,.75);const Ye=new e.GestureDescription("X");Ye.addCurl(e.Finger.Index,e.FingerCurl.HalfCurl,1);Ye.addDirection(e.Finger.Index,e.FingerDirection.VerticalUp,.5);Ye.addCurl(e.Finger.Middle,e.FingerCurl.FullCurl,1);Ye.addCurl(e.Finger.Ring,e.FingerCurl.FullCurl,1);Ye.addCurl(e.Finger.Pinky,e.FingerCurl.FullCurl,1);Ye.addCurl(e.Finger.Thumb,e.FingerCurl.HalfCurl,.75);const Ce=new e.GestureDescription("Y");Ce.addCurl(e.Finger.Thumb,e.FingerCurl.NoCurl,1);Ce.addDirection(e.Finger.Thumb,e.FingerDirection.DiagonalUpLeft,.5);Ce.addDirection(e.Finger.Thumb,e.FingerDirection.DiagonalUpRight,.5);Ce.addCurl(e.Finger.Pinky,e.FingerCurl.NoCurl,1);Ce.addDirection(e.Finger.Pinky,e.FingerDirection.VerticalUp,.5);Ce.addDirection(e.Finger.Pinky,e.FingerDirection.DiagonalUpRight,.5);Ce.addCurl(e.Finger.Index,e.FingerCurl.FullCurl,1);Ce.addCurl(e.Finger.Middle,e.FingerCurl.FullCurl,1);Ce.addCurl(e.Finger.Ring,e.FingerCurl.FullCurl,1);const Oe=new e.GestureDescription("Z");Oe.addCurl(e.Finger.Index,e.FingerCurl.NoCurl,1);Oe.addDirection(e.Finger.Index,e.FingerDirection.DiagonalUpRight,.5);Oe.addDirection(e.Finger.Index,e.FingerDirection.DiagonalUpLeft,.5);Oe.addCurl(e.Finger.Middle,e.FingerCurl.FullCurl,1);Oe.addCurl(e.Finger.Ring,e.FingerCurl.FullCurl,1);Oe.addCurl(e.Finger.Pinky,e.FingerCurl.FullCurl,1);Oe.addCurl(e.Finger.Thumb,e.FingerCurl.HalfCurl,.75);const Be=new e.GestureDescription("SEND");Be.addCurl(e.Finger.Thumb,e.FingerCurl.NoCurl,1);Be.addDirection(e.Finger.Thumb,e.FingerDirection.VerticalUp,.9);Be.addCurl(e.Finger.Index,e.FingerCurl.FullCurl,1);Be.addCurl(e.Finger.Middle,e.FingerCurl.FullCurl,1);Be.addCurl(e.Finger.Ring,e.FingerCurl.FullCurl,1);Be.addCurl(e.Finger.Pinky,e.FingerCurl.FullCurl,1);const Fe=new e.GestureDescription("CLEAR");Fe.addCurl(e.Finger.Thumb,e.FingerCurl.NoCurl,.8);Fe.addCurl(e.Finger.Index,e.FingerCurl.NoCurl,1);Fe.addDirection(e.Finger.Index,e.FingerDirection.VerticalUp,.7);Fe.addCurl(e.Finger.Middle,e.FingerCurl.NoCurl,1);Fe.addDirection(e.Finger.Middle,e.FingerDirection.VerticalUp,.7);Fe.addCurl(e.Finger.Ring,e.FingerCurl.NoCurl,1);Fe.addDirection(e.Finger.Ring,e.FingerDirection.VerticalUp,.7);Fe.addCurl(e.Finger.Pinky,e.FingerCurl.NoCurl,1);Fe.addDirection(e.Finger.Pinky,e.FingerDirection.VerticalUp,.7);const me=new e.GestureDescription("SPACE");me.addCurl(e.Finger.Thumb,e.FingerCurl.HalfCurl,.8);me.addCurl(e.Finger.Index,e.FingerCurl.NoCurl,1);me.addDirection(e.Finger.Index,e.FingerDirection.HorizontalRight,.5);me.addDirection(e.Finger.Index,e.FingerDirection.HorizontalLeft,.5);me.addCurl(e.Finger.Middle,e.FingerCurl.NoCurl,1);me.addDirection(e.Finger.Middle,e.FingerDirection.HorizontalRight,.5);me.addDirection(e.Finger.Middle,e.FingerDirection.HorizontalLeft,.5);me.addCurl(e.Finger.Ring,e.FingerCurl.NoCurl,1);me.addCurl(e.Finger.Pinky,e.FingerCurl.NoCurl,1);const sr=new e.GestureDescription("BACKSPACE");sr.addCurl(e.Finger.Thumb,e.FingerCurl.HalfCurl,1);sr.addCurl(e.Finger.Index,e.FingerCurl.HalfCurl,1);sr.addCurl(e.Finger.Middle,e.FingerCurl.FullCurl,1);sr.addCurl(e.Finger.Ring,e.FingerCurl.FullCurl,1);sr.addCurl(e.Finger.Pinky,e.FingerCurl.FullCurl,1);const Ae=new e.GestureDescription("PREV_MODE");Ae.addCurl(e.Finger.Index,e.FingerCurl.NoCurl,1);Ae.addDirection(e.Finger.Index,e.FingerDirection.VerticalUp,.75);Ae.addCurl(e.Finger.Middle,e.FingerCurl.NoCurl,1);Ae.addDirection(e.Finger.Middle,e.FingerDirection.VerticalUp,.75);Ae.addCurl(e.Finger.Ring,e.FingerCurl.FullCurl,1);Ae.addCurl(e.Finger.Pinky,e.FingerCurl.FullCurl,1);Ae.addCurl(e.Finger.Thumb,e.FingerCurl.HalfCurl,.75);const he=new e.GestureDescription("NEXT_MODE");he.addCurl(e.Finger.Thumb,e.FingerCurl.NoCurl,1);he.addDirection(e.Finger.Thumb,e.FingerDirection.DiagonalUpLeft,.5);he.addDirection(e.Finger.Thumb,e.FingerDirection.DiagonalUpRight,.5);he.addCurl(e.Finger.Index,e.FingerCurl.NoCurl,1);he.addDirection(e.Finger.Index,e.FingerDirection.VerticalUp,.75);he.addCurl(e.Finger.Middle,e.FingerCurl.FullCurl,1);he.addCurl(e.Finger.Ring,e.FingerCurl.FullCurl,1);he.addCurl(e.Finger.Pinky,e.FingerCurl.NoCurl,1);he.addDirection(e.Finger.Pinky,e.FingerDirection.VerticalUp,.75);const Ar=[Pe,ce,We,Xe,ir,be,de,ge,qe,Ie,Ne,we,tr,lr,ar,Re,Ee,ke,ur,or,Le,fe,Te,Ye,Ce,Oe],Hr=[Be,Fe,me,sr,Ae,he],Ur=[...Ar,...Hr],xr=$e=>["SEND","CLEAR","SPACE","BACKSPACE","PREV_MODE","NEXT_MODE"].includes($e),_r={twoFingerTapWindow:500,twoFingerTapCooldown:400,twoFingerMinFrames:4,minPointingTime:100,dwellTime:1200,cursorSmoothing:.5},Vr={Thumb_Up:{action:"message",message:"ðŸ‘"},Thumb_Down:{action:"message",message:"ðŸ‘Ž"},Open_Palm:{action:"message",message:"ðŸ‘‹"},Victory:{action:"message",message:"ok"},ILoveYou:{action:"message",message:"thanks"},Closed_Fist:{action:"message",message:"stop"},Pointing_Up:{action:"point"}};function qr({onStopGeneration:$e,onSendMessage:Mr,onScroll:He,onPinch:re,onHover:I,onModeChange:D,onGestureModeToggle:x,onGestureState:g,onASLResult:_,onError:C,config:Ue=_r,onDebugInfo:cr,onLandmarkData:dr,onPerformance:gr,mode:fr="navigation",appContext:yr="chat",gestureActiveArea:vr}){const br=d.useRef($e),xe=d.useRef(Mr),Cr=d.useRef(He),Fr=d.useRef(re),mr=d.useRef(I),Me=d.useRef(D),wr=d.useRef(x),N=d.useRef(g),Ke=d.useRef(_),Sr=d.useRef(cr),te=d.useRef(dr),E=d.useRef(gr),hr=d.useRef(Ue),J=d.useRef(fr),_e=d.useRef(yr),pr=d.useRef(vr);br.current=$e,xe.current=Mr,Cr.current=He,Fr.current=re,mr.current=I,Me.current=D,wr.current=x,N.current=g,Ke.current=_,Sr.current=cr,te.current=dr,E.current=gr,hr.current=Ue,J.current=fr,_e.current=yr,pr.current=vr;const Je=d.useRef(C);Je.current=C;const pe=d.useRef({frames:0,lastTime:performance.now(),fps:0}),n=d.useRef(null),l=d.useRef(null),i=d.useRef(null),r=d.useRef(null),[a,o]=d.useState(!1),s=d.useRef(),c=d.useRef(null),t=d.useRef(null),v=d.useRef(null),h=d.useRef(null),w=d.useRef(null),P=d.useRef(null),M=d.useRef({visible:!1,x:0,y:0,isClicking:!1}),j=d.useRef({x:0,y:0}),O=d.useRef(0),X=1500,z=15,Y=8,B=d.useRef(new Map),le=d.useRef(new Map),ae=d.useRef([]),Q=d.useRef(null),V=d.useRef(0),$=d.useRef(0),ue=800,ne=12,oe=d.useCallback(f=>{const m=["Victory","ILoveYou","Fist","Open_Palm"],S=["Thumb_Up","Thumb_Down","Pointing_Up"];return m.includes(f)?15:S.includes(f)?5:z},[]),De=d.useCallback((f,m)=>{if(["PREV_MODE","NEXT_MODE"].includes(f))return!0;switch(m){case"chat":return!0;case"compare":return!f.startsWith("ASL");case"analyze":case"debate":return!0;default:return!0}},[]),Ve=d.useCallback((f,m)=>{const S=pr.current;if(!S)return!0;const u=1-f;return u>=S.minX&&u<=S.maxX&&m>=S.minY&&m<=S.maxY},[]),Se=d.useCallback(f=>(le.current.has(f)||le.current.set(f,{isScrolling:!1,lastScrollY:null,scrollVelocity:0,lastOpenTime:0,waveXPositions:[],waveDirectionChanges:0,lastWaveDirection:null,waveStartTime:0,dwellStartTime:0,dwellPosition:null,wasPointingOnly:!1,pointingOnlyStartTime:0,twoFingerFrames:0,clickLocked:!1,middleFingerActive:!1}),le.current.get(f)),[]),Ge=d.useCallback(f=>(B.current.has(f)||B.current.set(f,{candidate:"NEUTRAL",frames:0}),B.current.get(f)),[]);d.useEffect(()=>{let f=null,m=null;return(async()=>{var u;try{const p=typeof chrome<"u"&&!!((u=chrome.runtime)!=null&&u.id),b=p?"/mediapipe":"https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.0/wasm",ze=p?"/mediapipe/gesture_recognizer.task":"https://storage.googleapis.com/mediapipe-models/gesture_recognizer/gesture_recognizer/float16/1/gesture_recognizer.task",T=p?"/mediapipe/hand_landmarker.task":"https://storage.googleapis.com/mediapipe-models/hand_landmarker/hand_landmarker/float16/1/hand_landmarker.task",A=await kr.forVisionTasks(b);f=await Lr.createFromOptions(A,{baseOptions:{modelAssetPath:ze,delegate:"GPU"},runningMode:"VIDEO",numHands:2,minHandDetectionConfidence:.5,minHandPresenceConfidence:.5,minTrackingConfidence:.5}),t.current=f,m=await Or.createFromOptions(A,{baseOptions:{modelAssetPath:T,delegate:"GPU"},runningMode:"VIDEO",numHands:2,minHandDetectionConfidence:.5,minHandPresenceConfidence:.5,minTrackingConfidence:.5}),c.current=m,h.current=new e.GestureEstimator(Ur);const q=document.createElement("canvas");q.width=320,q.height=240,l.current=q;const H=document.createElement("canvas");H.width=1,H.height=1;const F=H.getContext("2d");F&&(F.fillStyle="#000",F.fillRect(0,0,1,1));try{f&&f.recognizeForVideo(H,0),m&&m.detectForVideo(H,0)}catch{}o(!0)}catch(p){console.error("Error initializing gesture recognition:",p)}})(),()=>{t.current&&t.current.close(),c.current&&c.current.close()}},[]);const ee=d.useCallback((f,m,S)=>{var H;const u=Se(S),p=Ge(S),b=_e.current;if(!f.gestures||f.gestures.length===0)return u.isScrolling=!1,u.lastScrollY=null,M.current.visible&&w.current&&(w.current.style.opacity="0",M.current.visible=!1),u.middleFingerActive&&N.current&&(N.current({gesture:null,progress:0,triggered:!1}),u.middleFingerActive=!1),null;const ze=(H=f.gestures[S])==null?void 0:H[0],T=f.landmarks[S];if(!ze||!T)return null;const A=ze.categoryName;if(!De(A,b))return null;const q=Vr[A];if(A==="Pointing_Up"&&T){const F=T[8],R={x:1-F.x,y:F.y};mr.current&&mr.current(R.x,R.y);const Z=window.innerWidth,W=window.innerHeight,U=R.x*Z,se=R.y*W,K=hr.current.cursorSmoothing,G=j.current;M.current.visible?(G.x+=(U-G.x)*K,G.y+=(se-G.y)*K):(G.x=U,G.y=se),w.current&&(w.current.style.transform=`translate(${G.x}px, ${G.y}px)`,w.current.style.opacity="1",w.current.style.borderColor="rgba(148, 163, 184, 0.7)",w.current.style.boxShadow="0 0 8px rgba(148, 163, 184, 0.3)"),M.current={visible:!0,x:G.x,y:G.y,isClicking:!1};const ye=hr.current.dwellTime,Qe=.05;if(u.dwellPosition===null)u.dwellStartTime=m,u.dwellPosition=R;else if(Math.sqrt(Math.pow(R.x-u.dwellPosition.x,2)+Math.pow(R.y-u.dwellPosition.y,2))>Qe)u.dwellStartTime=m,u.dwellPosition=R;else{const Ze=m-u.dwellStartTime;if(Ze>=ye&&Fr.current)return Fr.current(R.x,R.y),O.current=m,u.dwellStartTime=0,u.dwellPosition=null,N.current&&N.current({gesture:"DWELL_CLICK",progress:1,triggered:!0}),"DWELL_CLICK";if(N.current){const k=Math.min(1,Ze/ye);N.current({gesture:"POINTING",progress:k,triggered:!1})}}return"POINTING"}else u.dwellStartTime=0,u.dwellPosition=null,M.current.visible&&w.current&&(w.current.style.opacity="0",M.current.visible=!1);if(A==="Closed_Fist"&&T){const R=T[0].y;if(!u.isScrolling)u.isScrolling=!0,u.lastScrollY=R,u.scrollVelocity=0;else if(u.lastScrollY!==null){const Z=R-u.lastScrollY,W=(u.scrollVelocity||0)*.6+Z*.4;u.scrollVelocity=W,Math.abs(W)>.006&&Cr.current?(Cr.current(W*1800),u.lastScrollY=R):Math.abs(Z)>.02&&(u.lastScrollY=R)}return"FIST"}else u.isScrolling=!1,u.lastScrollY=null,u.scrollVelocity=0;if(A==="Open_Palm"&&T){u.lastOpenTime=m;const R=T[0].x;if(u.waveStartTime===0||m-u.waveStartTime>2e3)u.waveXPositions=[R],u.waveDirectionChanges=0,u.lastWaveDirection=null,u.waveStartTime=m;else{const Z=u.waveXPositions[u.waveXPositions.length-1],W=R-Z;if(Math.abs(W)>.03){u.waveXPositions.push(R);const se=W>0?"right":"left";if(u.lastWaveDirection&&se!==u.lastWaveDirection&&u.waveDirectionChanges++,u.lastWaveDirection=se,u.waveDirectionChanges>=3&&m-O.current>X){const K=document.activeElement,G=K instanceof HTMLInputElement||K instanceof HTMLTextAreaElement,ye=T[0].y;if(xe.current&&!G&&Ve(R,ye))return xe.current("Hi"),O.current=m,u.waveDirectionChanges=0,u.waveStartTime=0,u.lastWaveDirection=null,u.waveXPositions=[],"WAVE"}}}}if(T){const F=T[0],R=T[8],Z=T[12],W=T[16],U=T[20],se=T[10],K=(k,y)=>(k.x-y.x)**2+(k.y-y.y)**2,G=K(Z,F),ye=K(R,F),Qe=K(W,F),Dr=K(U,F);if(K(Z,F)>K(se,F)&&G>ye*2&&G>Qe*2&&G>Dr*2){p.candidate==="Middle_Finger"?p.frames++:(p.candidate="Middle_Finger",p.frames=1);const k=Math.min(1,p.frames/Y),y=p.frames>=Y;if(u.middleFingerActive=y,N.current&&N.current({gesture:"Middle_Finger",progress:k,triggered:y}),y)return"Middle_Finger"}else(u.middleFingerActive||p.candidate==="Middle_Finger")&&(u.middleFingerActive=!1,p.candidate="NEUTRAL",p.frames=0,N.current&&N.current({gesture:null,progress:0,triggered:!1}))}if((q==null?void 0:q.action)==="message"&&q.message){p.candidate===A?p.frames++:(p.candidate=A,p.frames=1);const F=oe(A);if(p.frames>=F&&m-O.current>X){const R=document.activeElement,Z=R instanceof HTMLInputElement||R instanceof HTMLTextAreaElement,W=T[0];if(xe.current&&!Z&&Ve(W.x,W.y))return xe.current(q.message),O.current=m,p.frames=0,N.current&&N.current({gesture:A,progress:1,triggered:!0}),A}if(N.current){const R=Math.min(1,p.frames/F);N.current({gesture:A,progress:R,triggered:!1})}}return A},[Se,Ge,De]),Rr=d.useCallback((f,m)=>{if(!h.current||!f)return null;const S=f.map(p=>[p.x,p.y,p.z]),u=h.current.estimate(S,7.5);if(u.gestures.length>0){const p=u.gestures.sort((q,H)=>H.score-q.score),b=p[0],ze=_e.current;if(!De(b.name,ze))return N.current&&N.current({gesture:xr(b.name)?`ACTION: ${b.name}`:`ASL: ${b.name}`,progress:0,triggered:!1}),null;const T=$.current!==0&&m-$.current<ue&&!xr(b.name)&&b.name===Q.current;T||(b.name===Q.current?V.current++:(Q.current=b.name,V.current=1));const A={letter:b.name,confidence:b.score/10,allGestures:p};if(Ke.current&&Ke.current(A),N.current){const q=Math.min(1,V.current/ne),H=V.current>=ne&&!T;H&&($.current=m,V.current=0,xr(b.name)?b.name==="PREV_MODE"&&Me.current?Me.current("prev"):b.name==="NEXT_MODE"&&Me.current&&Me.current("next"):ae.current.push(b.name));const F=xr(b.name)?`ACTION: ${b.name}`:`ASL: ${b.name}`;N.current({gesture:F,progress:q,triggered:H})}return b.name}return Q.current=null,V.current=0,N.current&&N.current({gesture:null,progress:0,triggered:!1}),null},[De]),ie=d.useCallback(()=>{var se,K,G,ye,Qe,Dr,Ze;const f=n.current,m=i.current,S=J.current;if(!f||!m){s.current=requestAnimationFrame(ie);return}if(S==="navigation"&&!t.current){s.current=requestAnimationFrame(ie);return}if(S==="asl"&&!c.current){s.current=requestAnimationFrame(ie);return}if(f.videoWidth===0||f.videoHeight===0){s.current=requestAnimationFrame(ie);return}const u=window.innerWidth,p=window.innerHeight;(m.width!==u||m.height!==p)&&(m.width=u,m.height=p);const b=m.getContext("2d");if(!b){s.current=requestAnimationFrame(ie);return}const T=performance.now(),A=l.current;if(A){const k=A.getContext("2d");k&&k.drawImage(f,0,0,A.width,A.height)}const q=A||f;let H=[],F=null;if(S==="navigation"&&t.current){const k=t.current.recognizeForVideo(q,T);k.landmarks&&(H=k.landmarks.map(y=>y.map(L=>({x:L.x,y:L.y,z:L.z}))));for(let y=0;y<(((se=k.landmarks)==null?void 0:se.length)||0);y++){const L=ee(k,T,y);L&&(F=L)}if(te.current&&H[0]){const y=(ye=(G=(K=k.handednesses)==null?void 0:K[0])==null?void 0:G[0])==null?void 0:ye.categoryName;te.current({landmarks:H[0],handedness:y??null})}}else if(S==="asl"&&c.current){const k=c.current.detectForVideo(q,T);if(k.landmarks){if(H=k.landmarks.map(y=>y.map(L=>({x:L.x,y:L.y,z:L.z}))),H[0]){const y=Rr(H[0],T);y&&(F=y)}if(te.current){const y=(Ze=(Dr=(Qe=k.handednesses)==null?void 0:Qe[0])==null?void 0:Dr[0])==null?void 0:Ze.categoryName;te.current({landmarks:H[0],handedness:y??null})}}}const R=Math.round(performance.now()-T);pe.current.frames++;const Z=T-pe.current.lastTime;Z>=1e3&&(pe.current.fps=Math.round(pe.current.frames*1e3/Z),pe.current.frames=0,pe.current.lastTime=T,E.current&&E.current({fps:pe.current.fps,detectionTime:R}));const W=r.current,U=W==null?void 0:W.getContext("2d");if(b.clearRect(0,0,u,p),U&&U.clearRect(0,0,u,p),H.length>0)for(const k of H){let y=S==="asl"?"#10b981":"#3b82f6",L=S==="asl"?"#6ee7b7":"#60a5fa";F&&(S==="asl"?F.startsWith("ASL:")?(y="#10b981",L="#6ee7b7"):F.startsWith("ACTION:")?(y="#8b5cf6",L="#c4b5fd"):(y="#10b981",L="#6ee7b7"):F==="Pointing_Up"||F==="POINTING"?(y="#06b6d4",L="#67e8f9"):F==="Thumb_Up"||F==="THUMBS_UP"?(y="#22c55e",L="#86efac"):F==="Thumb_Down"||F==="THUMBS_DOWN"?(y="#f97316",L="#fdba74"):F==="Closed_Fist"||F==="FIST"?(y="#a855f7",L="#d8b4fe"):F==="Open_Palm"||F==="WAVE"?(y="#f59e0b",L="#fcd34d"):F==="Middle_Finger"?(y="#ef4444",L="#f87171"):(y="#3b82f6",L="#60a5fa"));const Ir=[[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[0,9],[9,10],[10,11],[11,12],[0,13],[13,14],[14,15],[15,16],[0,17],[17,18],[18,19],[19,20],[5,9],[9,13],[13,17]];for(const[er,Tr]of Ir){const rr=k[er],nr=k[Tr],je=b.createLinearGradient(rr.x*u,rr.y*p,nr.x*u,nr.y*p);je.addColorStop(0,y),je.addColorStop(1,L),b.beginPath(),b.moveTo(rr.x*u,rr.y*p),b.lineTo(nr.x*u,nr.y*p),b.strokeStyle=je,b.lineWidth=F?3:2,b.shadowColor=y,b.shadowBlur=F?10:8,b.stroke()}if(U){for(let er=0;er<k.length;er++){const Tr=k[er],rr=Tr.x*u,nr=Tr.y*p,je=[4,8,12,16,20].includes(er),Nr=je?F?5:4:F?3:2;U.beginPath(),U.arc(rr,nr,Nr,0,2*Math.PI),je?(U.fillStyle="#ffffff",U.shadowColor=L,U.shadowBlur=F?20:15):(U.fillStyle="#1e293b",U.strokeStyle=L,U.lineWidth=1.5,U.shadowColor=y,U.shadowBlur=F?8:5),U.fill(),je||U.stroke()}U.shadowBlur=0}}else M.current.visible&&w.current&&(w.current.style.opacity="0",M.current.visible=!1),te.current&&te.current({landmarks:null,handedness:null});s.current=requestAnimationFrame(ie)},[ee,Rr]);return d.useEffect(()=>(a&&n.current&&(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({video:!0}).then(f=>{v.current=f,n.current&&(n.current.srcObject=f,n.current.play(),n.current.addEventListener("loadeddata",()=>{const m=window.innerWidth,S=window.innerHeight;i.current&&(i.current.width=m,i.current.height=S),r.current&&(r.current.width=m,r.current.height=S),s.current&&cancelAnimationFrame(s.current),s.current=requestAnimationFrame(ie)}))}).catch(f=>{console.error("Error accessing webcam:",f);let m="Could not access camera";f.name==="NotFoundError"||f.name==="DevicesNotFoundError"?m="No camera found. Please connect a webcam to use gesture control.":f.name==="NotAllowedError"||f.name==="PermissionDeniedError"?m="Camera access denied. Please allow camera access in your browser settings.":(f.name==="NotReadableError"||f.name==="TrackStartError")&&(m="Camera is in use by another application."),Je.current&&Je.current(m)}):console.warn("navigator.mediaDevices is undefined. Camera access requires HTTPS or localhost.")),()=>{s.current&&cancelAnimationFrame(s.current)}),[a,ie]),d.useEffect(()=>()=>{s.current&&(cancelAnimationFrame(s.current),s.current=void 0),v.current&&(v.current.getTracks().forEach(f=>{f.stop()}),v.current=null),n.current&&(n.current.srcObject=null),t.current&&(t.current.close(),t.current=null),c.current&&(c.current.close(),c.current=null),r.current&&(r.current.width=0,r.current.height=0)},[]),ve.jsxs(ve.Fragment,{children:[ve.jsxs("div",{className:"fixed inset-0 z-[1] pointer-events-none overflow-hidden scale-x-[-1]",children:[ve.jsx("video",{ref:n,className:"hidden",playsInline:!0,muted:!0,autoPlay:!0}),ve.jsx("canvas",{ref:i,className:"absolute inset-0 w-full h-full opacity-50 mix-blend-screen"})]}),ve.jsx("div",{className:"fixed inset-0 z-[1] pointer-events-none overflow-hidden scale-x-[-1]",children:ve.jsx("canvas",{ref:r,className:"absolute inset-0 w-full h-full opacity-50 mix-blend-screen"})}),fr==="navigation"&&ve.jsx("div",{ref:w,className:"fixed pointer-events-none z-[9999]",style:{top:0,left:0,width:28,height:28,marginLeft:-14,marginTop:-14,borderRadius:"50%",border:"2px solid rgba(148, 163, 184, 0.7)",opacity:0,boxShadow:"0 0 8px rgba(148, 163, 184, 0.3)",willChange:"transform, opacity"},children:ve.jsx("div",{ref:P,className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 rounded-full",style:{width:6,height:6,backgroundColor:"rgba(255, 255, 255, 0.9)"}})})]})}export{qr as default};
