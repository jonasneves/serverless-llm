const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SettingsModal--4R84Uo8.js","assets/react-vendor-VqckXmoY.js","assets/markdown-rIyYVYgH.js","assets/math-render-Q06Bpsm3.js","assets/math-render-BqiDbsU2.css","assets/syntax-highlight-BzG5Erai.js","assets/syntax-highlight-BEHUn5zE.css","assets/DiscussionTranscript-C2gtcJAX.js","assets/FormattedContent-CtYzWev5.js","assets/GestureControl-BHnpJ-UJ.js","assets/HandBackground-DFMjYCtB.js","assets/mediapipe-YSlczgt6.js","assets/ChatView-DvF95tuF.js"])))=>i.map(i=>d[i]);
var Pn=Object.defineProperty;var $n=(t,n,o)=>n in t?Pn(t,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[n]=o;var Qt=(t,n,o)=>$n(t,typeof n!="symbol"?n+"":n,o);import{r as s,j as e,X as Bn,S as Hn,Z as rn,C as Jt,a as Wn,A as Fn,b as Yn,T as Xn,R as Gn,c as Un,d as qn}from"./react-vendor-VqckXmoY.js";import"./math-render-Q06Bpsm3.js";import"./syntax-highlight-BzG5Erai.js";import"./markdown-rIyYVYgH.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))d(p);new MutationObserver(p=>{for(const i of p)if(i.type==="childList")for(const y of i.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&d(y)}).observe(document,{childList:!0,subtree:!0});function o(p){const i={};return p.integrity&&(i.integrity=p.integrity),p.referrerPolicy&&(i.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?i.credentials="include":p.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function d(p){if(p.ep)return;p.ep=!0;const i=o(p);fetch(p.href,i)}})();const Kn="modulepreload",Vn=function(t){return"/static/playground/"+t},Zt={},Ue=function(n,o,d){let p=Promise.resolve();if(o&&o.length>0){document.getElementsByTagName("link");const y=document.querySelector("meta[property=csp-nonce]"),h=(y==null?void 0:y.nonce)||(y==null?void 0:y.getAttribute("nonce"));p=Promise.allSettled(o.map(m=>{if(m=Vn(m),m in Zt)return;Zt[m]=!0;const g=m.endsWith(".css"),x=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${x}`))return;const b=document.createElement("link");if(b.rel=g?"stylesheet":Kn,g||(b.as="script"),b.crossOrigin="",b.href=m,h&&b.setAttribute("nonce",h),document.head.appendChild(b),g)return new Promise((R,O)=>{b.addEventListener("load",R),b.addEventListener("error",()=>O(new Error(`Unable to preload CSS for ${m}`)))})}))}function i(y){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=y,window.dispatchEvent(h),!h.defaultPrevented)throw y}return p.then(y=>{for(const h of y||[])h.status==="rejected"&&i(h.reason);return n().catch(i)})},Qn={"self-hosted":{color:"#10b981"},github:{color:"#3b82f6"},external:{color:"#8b5cf6"}},Jn=50,Zn=100,es=150,ts=["deepseek-r1-distill-qwen-1.5b","r1qwen","smollm3","nanbeige"],ns=["gpt-oss","gptoss"],ss=t=>{const n=t.toLowerCase();return ts.some(o=>n.includes(o.toLowerCase()))},rs=t=>{const n=t.toLowerCase();return ns.some(o=>n.includes(o.toLowerCase()))};function ir(t,n,o){if(o!==void 0)return o;let d;switch(n){case"self-hosted":d=Jn;break;case"github":d=Zn;break;case"external":d=es;break}return d}const Nt=[{id:"eu-ai-act-enforcement",label:"EU AI Act Enforcement Wave",prompt:"The EU AI Act enters enforcement; high-risk systems must prove data provenance, evals, and risk controls. Outline compliance gaps for a frontier model API and tradeoffs between speed and alignment.",category:"Policy",modes:["analyze","debate"],tags:["governance","compliance"]},{id:"export-controls-blackwell",label:"Export Controls Tighten",prompt:"U.S. export rules tighten again on AI accelerators; Blackwell-class parts face new caps and cloud checks. Map the impact on training roadmaps, costs, and on-device strategies.",category:"Infra",modes:["compare","debate"],tags:["chips","supply-chain"]},{id:"weights-leak",label:"Major Weights Leak",prompt:"A commercial frontier model checkpoint leaks. Assess risks (misuse, impersonation, jailbreak diffusion), legal exposure, and whether open red-team releases mitigate or worsen safety.",category:"Security",modes:["analyze","debate"],tags:["safety","open-weights"]},{id:"on-device-llm-race",label:"On-Device LLM Race",prompt:"Phone OEMs ship 3nm NPUs and 20B-parameter on-device assistants. What actually moves the needle for UX, privacy, and cost vs. cloud? Where do hybrid (edge + cloud) designs win?",category:"Infra",modes:["compare","debate"],tags:["edge","latency"]},{id:"signed-app-prompt-injection",label:"Signed App Prompt Injection",prompt:"A popular signed desktop app shipped with hardcoded system prompts; attackers use supply chain updates to exfiltrate data. How should vendors audit, sandbox, and attest LLM apps?",category:"Security",modes:["compare","analyze"],tags:["supply-chain","prompt-injection"]},{id:"eval-standardization",label:"Safety Eval Standard",prompt:"NIST-style safety eval suites gain traction (jailbreak, autonomy, bio). How should vendors report scores, and what gaps remain for frontier vs. small models?",category:"Policy",modes:["compare","debate"],tags:["evaluation","safety"]},{id:"licensing-standoff",label:"Publisher Licensing Standoff",prompt:"Major news publishers pause AI licensing talks and sue over training. What remedies (revenue share, opt-out registries, model removal) are realistic, and how do they ripple to open models?",category:"Data",modes:["analyze","debate"],tags:["licensing","copyright"]},{id:"sbom-for-llms",label:"SBOM for LLM Pipelines",prompt:"Regulators push SBOMs and signed artifacts for AI stacks. Draft what should appear in an LLM pipeline SBOM (data, weights, evals, guardrails) and how to verify it at runtime.",category:"Security",modes:["compare","analyze"],tags:["sbom","supply-chain"]},{id:"data-poisoning-campaign",label:"Data Poisoning Campaign",prompt:"Researchers find coordinated data poisoning in popular open corpora. How should model hosts detect and mitigate poisoning post-hoc, and what retraining tradeoffs are acceptable?",category:"Security",modes:["compare","debate"],tags:["data","poisoning"]},{id:"copyright-settlement",label:"Copyright Settlement Sets Precedent",prompt:"A major copyright suit settles with dataset disclosure and per-output watermarking. Predict how this precedent affects future training sets and open-weight releases.",category:"Policy",modes:["debate"],tags:["copyright","watermarking"]}],lr={analyze:["What's the most important programming principle?","Should code comments explain 'what' or 'why'?","Is TypeScript worth the extra complexity?"],debate:["Tabs or spaces? Give your verdict.","Should AI be allowed to write its own code?","What will never be automated by AI?"],compare:[],chat:[]};Nt.filter(t=>t.category==="Policy"||t.category==="Data"),Nt.filter(t=>t.category==="Infra"),Nt.filter(t=>t.category==="Security");const os=["dots-mesh","dots","dots-fade","grid","mesh","animated-mesh","none"],it="#0f172a",en={compare:it,analyze:it,debate:it,chat:it},Ge={maxTokens:1024,temperature:.7},ae={cardWidth:256,cardHeight:200,gapX:24,gapY:24,baseRadius:160,minRadius:120,radiusPerModel:15,scrollClamp:200};function as({showDock:t,availableModels:n,allSelectedByType:o,totalModelsByType:d,handleDragStart:p,handleModelToggle:i,handleAddGroup:y,dockRef:h,mode:m,allModels:g,chatModelId:x,setChatModelId:b,chatAutoMode:R,setChatAutoMode:O,chatAutoModeScope:P,setChatAutoModeScope:B,setShowDock:Y}){const[c,H]=s.useState(""),$=s.useRef(null),U=[{type:"self-hosted",title:"Self-Hosted Models",accentColor:"emerald",chatAutoScope:"self-hosted"},{type:"github",title:"GitHub Models",accentColor:"blue",chatAutoScope:"api"},{type:"external",title:"External Models",accentColor:"purple",chatAutoScope:"external"}],A=m==="chat",S=A?g:n,Z=s.useMemo(()=>{if(!c)return S;const k=c.toLowerCase();return S.filter(J=>J.name.toLowerCase().includes(k))},[S,c]);s.useEffect(()=>{t?setTimeout(()=>{var k;return(k=$.current)==null?void 0:k.focus()},100):H("")},[t]);const W=k=>{A&&(O(!0),B(k),Y(!1))},ne=k=>{A?(O(!1),b(k),Y(!1)):i(k)},T=k=>A?!R&&x===k:!1,q=k=>A&&R&&P===k;return e.jsxs("div",{ref:h,"data-no-arena-scroll":!0,"data-no-background":!0,className:"fixed top-1/2 left-1/2 w-[min(90vw,600px)] max-h-[80vh] rounded-2xl flex flex-col z-[60] transition-all duration-300 shadow-2xl",style:{transform:t?"translate(-50%, -50%) scale(1)":"translate(-50%, -50%) scale(0.95)",opacity:t?1:0,pointerEvents:t?"auto":"none"},children:[e.jsxs("div",{className:"px-5 py-4 border-b border-slate-700/50 bg-slate-800/95 backdrop-blur-md rounded-t-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-200",children:"Model Selection"}),e.jsx("p",{className:"text-[10px] text-slate-500 mt-0.5",children:"Click to add to arena or select for chat"})]}),e.jsx("button",{onClick:()=>Y(!1),className:"text-slate-400 hover:text-slate-200 transition-colors",title:"Close",children:e.jsx(Bn,{size:18})})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Hn,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-500"}),e.jsx("input",{ref:$,type:"text",placeholder:"Search models...",value:c,onChange:k=>H(k.target.value),className:"w-full pl-9 pr-3 py-2 text-sm bg-slate-700/50 border border-slate-600/50 rounded-lg text-slate-200 placeholder-slate-500 focus:outline-none focus:border-slate-500"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-5 py-4 space-y-5 bg-slate-800/95 backdrop-blur-md",children:U.map(k=>{const J=Z.filter(se=>se.type===k.type),te=n.filter(se=>se.type===k.type),F=o[k.type],Q=d[k.type]>0,V={emerald:{button:"text-emerald-400 hover:text-emerald-300 hover:bg-emerald-500/10",auto:"text-emerald-400 hover:text-emerald-300 bg-emerald-500/10 hover:bg-emerald-500/20",dot:"bg-emerald-500",border:"hover:border-emerald-500/40"},blue:{button:"text-blue-400 hover:text-blue-300 hover:bg-blue-500/10",auto:"text-blue-400 hover:text-blue-300 bg-blue-500/10 hover:bg-blue-500/20",dot:"bg-blue-500",border:"hover:border-blue-500/40"},purple:{button:"text-purple-400 hover:text-purple-300 hover:bg-purple-500/10",auto:"text-purple-400 hover:text-purple-300 bg-purple-500/10 hover:bg-purple-500/20",dot:"bg-purple-500",border:"hover:border-purple-500/40"}}[k.accentColor];return te.length===0?null:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between px-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${V.dot}`}),e.jsx("h3",{className:"text-[11px] font-semibold text-slate-300 uppercase tracking-wide",children:k.title}),e.jsxs("span",{className:"text-[10px] text-slate-500",children:["(",te.length,")"]})]}),!A&&e.jsx("button",{onClick:()=>y(k.type),className:`text-[10px] font-medium px-2 py-1 rounded transition-all active:scale-95 ${V.button} ${Q?"":"opacity-40 cursor-not-allowed"}`,disabled:!Q,children:F?"− Remove All":"+ Add All"})]}),A&&e.jsxs("button",{onClick:()=>W(k.chatAutoScope),className:`group flex items-center justify-between gap-2 px-3 py-2 rounded-lg transition-all border border-transparent active:scale-95 ${q(k.chatAutoScope)?V.auto+" border-"+k.accentColor+"-500/40":"hover:bg-white/5 text-slate-400 hover:text-slate-200"}`,title:"Auto mode with smart fallback",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(rn,{size:14,className:q(k.chatAutoScope)?V.dot.replace("bg-","text-"):"text-slate-500"}),e.jsx("span",{className:"text-xs font-medium",children:"Auto (Smart Fallback)"})]}),q(k.chatAutoScope)&&e.jsx(Jt,{size:14,className:V.dot.replace("bg-","text-")})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[J.map(se=>{const re=T(se.id);return e.jsxs("div",{draggable:!A,onDragStart:A?void 0:pe=>p(pe,se.id),onClick:()=>ne(se.id),className:`group flex items-center justify-between gap-3 px-3 py-2 rounded-lg transition-all border border-transparent active:scale-95 ${A?`cursor-pointer ${re?V.auto+" border-"+k.accentColor+"-500/40":"hover:bg-white/5"}`:`cursor-grab active:cursor-grabbing hover:bg-white/5 ${V.border}`}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${V.dot} ${re?"opacity-100":"opacity-60 group-hover:opacity-100"} transition-opacity`}),e.jsx("span",{className:`text-xs font-medium ${re?"text-slate-200":"text-slate-400 group-hover:text-slate-200"} transition-colors`,children:se.name})]}),re&&e.jsx(Jt,{size:14,className:V.dot.replace("bg-","text-")})]},se.id)}),J.length===0&&c&&e.jsx("div",{className:"text-[10px] text-slate-600 italic px-3 py-2",children:"No models match your search"}),J.length===0&&!c&&e.jsx("div",{className:"text-[10px] text-slate-600 italic px-3 py-2",children:"All models are in the arena"})]})]},k.type)})}),e.jsx("div",{className:"px-5 py-3 border-t border-slate-700/50 bg-slate-900/50 backdrop-blur-md rounded-b-2xl",children:e.jsxs("p",{className:"text-[10px] text-slate-500 text-center",children:["Press ",e.jsx("kbd",{className:"px-1 py-0.5 rounded bg-slate-800 text-slate-400 font-mono text-[9px]",children:"M"})," or ",e.jsx("kbd",{className:"px-1 py-0.5 rounded bg-slate-800 text-slate-400 font-mono text-[9px]",children:"Esc"})," to close"]})})]})}function is({inputRef:t,inputFocused:n,setInputFocused:o,onSendMessage:d,className:p,style:i,placeholder:y,isGenerating:h,onStop:m}){return e.jsx("div",{className:p??"fixed bottom-0 right-0 left-0 z-[100] pb-6 px-3 sm:px-4 flex justify-center items-end pointer-events-none transition-all duration-300",style:i??{paddingBottom:"calc(1.5rem + env(safe-area-inset-bottom))"},children:e.jsx("div",{className:"w-full pointer-events-auto",style:{maxWidth:"600px"},children:e.jsxs("div",{className:`rounded-xl p-2.5 transition-all duration-300 flex items-center gap-2 border border-slate-700/40 header-shell ${n?"prompt-panel-focused":""}`,children:[e.jsx("input",{ref:t,type:"text",placeholder:y||"Ask a question to compare model responses...",className:"w-full bg-transparent text-slate-200 placeholder-slate-500 outline-none text-base sm:text-sm px-2.5 py-2.5",onFocus:()=>o(!0),onBlur:()=>o(!1),onKeyDown:g=>{var x;if(g.key==="Enter"&&!g.shiftKey){if(g.preventDefault(),h)return;(x=t.current)!=null&&x.value&&(d(t.current.value),t.current.value="")}},disabled:h}),e.jsx("button",{onClick:()=>{var g;h?m==null||m():(g=t.current)!=null&&g.value&&(d(t.current.value),t.current.value="")},onMouseDown:g=>g.currentTarget.blur(),className:`min-w-[44px] min-h-[44px] sm:min-w-[36px] sm:min-h-[36px] p-2 rounded-lg transition-colors active:scale-95 flex items-center justify-center focus:outline-none focus-visible:outline-none ${h?"text-red-400 hover:text-red-300 hover:bg-red-500/10":"text-slate-400 hover:text-white hover:bg-white/10"}`,"aria-label":h?"Stop generation":"Send message",children:h?e.jsx(Wn,{className:"w-5 h-5 sm:w-4 sm:h-4 fill-current"}):e.jsx(Fn,{className:"w-5 h-5 sm:w-4 sm:h-4",strokeWidth:2.5})})]})})})}const ls={chat:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),compare:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2"})}),analyze:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),debate:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})},De=[{value:"chat",label:"Chat"},{value:"compare",label:"Compare"},{value:"analyze",label:"Analyze"},{value:"debate",label:"Debate"}];function cs({mode:t,setMode:n,setHoveredCard:o,clearSelection:d,showDock:p,setShowDock:i,onOpenSettings:y,gestureButtonSlot:h}){const[m,g]=s.useState(!1),x=s.useRef(null),[b,R]=s.useState(!0),O=s.useRef(null),[P,B]=s.useState(null),[Y,c]=s.useState(0),H=De.findIndex(S=>S.value===t),$=H===-1?0:H,U=De[$].label;s.useEffect(()=>{const S=()=>{R(window.innerWidth>=1024)};return S(),window.addEventListener("resize",S),()=>window.removeEventListener("resize",S)},[]),s.useEffect(()=>{if(!O.current)return;const S=()=>{const ne=O.current;if(!ne)return;const T=ne.querySelectorAll('button[role="radio"]');if(T.length===0||$>=T.length)return;const k=T[$].getBoundingClientRect(),J=ne.getBoundingClientRect(),te=k.width,F=k.left,Q=J.left;B(te),c(F-Q)},Z=setTimeout(S,0),W=new ResizeObserver(()=>{setTimeout(S,0)});return W.observe(O.current),window.addEventListener("resize",S),()=>{clearTimeout(Z),W.disconnect(),window.removeEventListener("resize",S)}},[t,b,$]),s.useEffect(()=>{function S(Z){x.current&&!x.current.contains(Z.target)&&g(!1)}return m&&document.addEventListener("mousedown",S),()=>{document.removeEventListener("mousedown",S)}},[m]);const A=S=>{n(S),o(null),d(),g(!1)};return e.jsxs("div",{className:"fixed top-0 left-0 right-0 flex items-center justify-between mb-2 px-3 sm:px-6 pt-4 sm:pt-6 z-50 pointer-events-none transition-all duration-300",children:[e.jsx("div",{className:"absolute inset-0 pointer-events-auto",style:{height:"100%",zIndex:-1}}),e.jsx("div",{className:"flex items-center gap-2 w-auto pointer-events-auto z-20",children:h}),e.jsx("div",{className:"hidden md:block absolute left-1/2 -translate-x-1/2 pointer-events-auto z-20",children:e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex items-center p-1.5 rounded-xl border border-slate-700/40 header-shell",children:[e.jsx("button",{onClick:()=>i(!p),className:"px-2 sm:px-3 flex items-center justify-center text-slate-400 hover:text-white transition-colors",title:"Toggle Model Dock",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsx("div",{className:"w-px h-5 bg-slate-700/50 mx-0.5 sm:mx-1"}),e.jsxs("div",{ref:O,className:"relative flex p-1 rounded-lg bg-black/20 mode-track",role:"radiogroup","aria-label":"Mode selection","data-gesture-mode-track":"true",children:[e.jsx("div",{className:"absolute top-1 bottom-1 rounded-md transition-all duration-300 ease-out mode-slider",style:{width:P!==null?`${P}px`:`calc((100% - 8px) / ${De.length})`,left:P!==null?`${Y}px`:`calc(4px + (100% - 8px) * ${$} / ${De.length})`}}),De.map(S=>e.jsx("button",{tabIndex:-1,onClick:()=>A(S.value),role:"radio","aria-checked":t===S.value,"aria-label":S.label,title:S.label,className:`relative z-10 py-2 sm:py-1.5 px-3 text-[11px] sm:text-xs font-medium transition-colors duration-200 min-h-[44px] sm:min-h-0 active:scale-95 focus:outline-none focus-visible:outline-none flex-1 flex items-center justify-center text-center ${t===S.value?"text-white":"text-slate-400 hover:text-slate-200"}`,children:S.label},S.value))]})]})})}),e.jsx("div",{className:"flex md:hidden flex-1 justify-center pointer-events-auto relative z-20",children:e.jsxs("div",{className:"relative",ref:x,children:[e.jsxs("button",{onClick:()=>g(!m),className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-slate-800/90 border border-slate-700/50 text-slate-200 font-medium text-sm backdrop-blur-md shadow-lg active:scale-95 transition-all",children:[e.jsx("span",{className:"font-bold text-slate-400 hidden xs:inline",children:"Arena"}),e.jsx("span",{className:"font-bold hidden xs:inline text-slate-600",children:"/"}),e.jsx("span",{children:U}),e.jsx("svg",{className:`w-4 h-4 text-slate-400 transition-transform duration-200 ${m?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),m&&e.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 mt-2 w-48 py-1 rounded-xl bg-slate-800 border border-slate-700 shadow-2xl overflow-hidden flex flex-col animate-in fade-in zoom-in-95 duration-100 origin-top",children:De.map(S=>e.jsxs("button",{onClick:()=>A(S.value),className:`px-4 py-3 text-sm text-left w-full transition-colors flex items-center gap-3 ${t===S.value?"bg-blue-500/10 text-blue-400":"text-slate-300 hover:bg-slate-700/50"}`,children:[e.jsx("span",{className:"flex-shrink-0",children:ls[S.value]}),e.jsx("span",{className:"flex-1",children:S.label}),t===S.value&&e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]},S.value))})]})}),e.jsx("div",{className:"flex items-center gap-2 w-auto justify-end pointer-events-auto z-20",children:e.jsx("button",{onClick:y,className:"min-w-[42px] min-h-[42px] w-[42px] h-[42px] rounded-full bg-slate-800/50 flex items-center justify-center border border-slate-700/50 hover:border-slate-600 transition-colors active:scale-95 focus:outline-none focus-visible:outline-none",title:"Settings",children:e.jsxs("svg",{className:"w-4 h-4 text-slate-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),e.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})})})]})}const ds=t=>{if(typeof t=="string")return t;try{return JSON.stringify(t)}catch{return null}},us=(t,n)=>{if(t===null)return n;try{return JSON.parse(t)}catch{return n}};function Pe(t,n,o={}){const d=o.serialize??ds,p=o.deserialize??us,[i,y]=s.useState(()=>{if(typeof window>"u")return n;try{const h=window.localStorage.getItem(t);return p(h,n)}catch{return n}});return s.useEffect(()=>{if(!(typeof window>"u"))try{const h=d(i);h===null?window.localStorage.removeItem(t):window.localStorage.setItem(t,h)}catch{}},[t,d,i]),[i,y]}const ps=800,fs=3e3,hs=8;function ms(){const[t,n]=s.useState([]),[o,d]=s.useState(!0),[p,i]=s.useState(null),[y,h]=s.useState(0),[m,g]=Pe("playground_selected_models",null),x=s.useRef(m!==null),[b,R]=Pe("playground_chat_model",null),O=s.useRef(b!==null),P=s.useMemo(()=>m??[],[m]),B=s.useCallback(T=>{g(q=>typeof T=="function"?T(q??[]):T)},[g]),[Y,c]=s.useState(""),H=s.useRef(0),$=s.useRef(null),U=s.useCallback(async(T,q,k=!1)=>{$.current&&(clearTimeout($.current),$.current=null),d(!0),k&&(i("Refreshing..."),h(0));const J=te=>{var re,pe;const F=te.models.map(X=>{const de=X.type==="self-hosted"||X.type==="github"||X.type==="external"?X.type:"self-hosted",ee=Qn[de];return{id:X.id,name:ee.name||X.name||X.id,color:ee.color,type:de,response:"Ready to generate...",priority:X.priority,context_length:X.context_length,default:X.default}});if(n(F),d(!1),i(null),h(0),x.current||(g(F.filter(X=>X.type==="self-hosted"&&X.id!=="nemotron-3-nano-30b-a3b").map(X=>X.id)),x.current=!0),!O.current){const X=F.find(ee=>ee.default),de=F.find(ee=>ee.type==="github"||ee.type==="external");R((X==null?void 0:X.id)||(de==null?void 0:de.id)||((re=F[0])==null?void 0:re.id)||null),O.current=!0}const Q=F.find(X=>X.type==="github"||X.type==="external"),V=F.find(X=>X.default),se=((pe=F[0])==null?void 0:pe.id)||"";c((Q==null?void 0:Q.id)||(V==null?void 0:V.id)||se)};try{const te=await fetch("/api/models");if(T!==H.current)return;if(!te.ok)throw new Error(`HTTP ${te.status}`);const F=await te.json();if(T!==H.current)return;if(!F.models||F.models.length===0)throw new Error("No models available yet");J(F)}catch(te){if(T!==H.current)return;console.warn("Backend fetch failed:",te);try{console.log("Trying static models.json...");const Q=await fetch("/models.json");if(Q.ok){const V=await Q.json();if(V.models&&V.models.length>0){console.log(`Loaded ${V.models.length} models from static file`),J(V);return}}}catch(Q){console.warn("Static models.json not available:",Q)}const F=q+1;if(h(F),F<hs){const Q=Math.min(ps*Math.pow(1.4,q),fs);i("Connecting to backend..."),$.current=setTimeout(()=>{U(T,F)},Q)}else d(!1),i("Could not load models")}},[g,R]),A=s.useCallback(()=>{H.current+=1,U(H.current,0,!0)},[U]);s.useEffect(()=>(H.current+=1,U(H.current,0),()=>{H.current+=1,$.current&&clearTimeout($.current)}),[U]);const S=s.useMemo(()=>t.filter(T=>!P.includes(T.id)),[t,P]),{totalModelsByType:Z,allSelectedByType:W}=s.useMemo(()=>{const T={"self-hosted":t.filter(k=>k.type==="self-hosted").length,github:t.filter(k=>k.type==="github").length,external:t.filter(k=>k.type==="external").length},q={"self-hosted":t.filter(k=>k.type==="self-hosted"&&P.includes(k.id)).length,github:t.filter(k=>k.type==="github"&&P.includes(k.id)).length,external:t.filter(k=>k.type==="external"&&P.includes(k.id)).length};return{totalModelsByType:T,allSelectedByType:{"self-hosted":T["self-hosted"]>0&&q["self-hosted"]===T["self-hosted"],github:T.github>0&&q.github===T.github,external:T.external>0&&q.external===T.external}}},[t,P]),ne=s.useCallback(T=>{var q;return((q=t.find(k=>k.id===T))==null?void 0:q.name)||T},[t]);return{modelsData:t,setModelsData:n,selected:P,setSelected:B,chatModelId:b,setChatModelId:R,moderator:Y,setModerator:c,availableModels:S,totalModelsByType:Z,allSelectedByType:W,modelIdToName:ne,isLoading:o,loadError:p,retryCount:y,retryNow:A}}function xs(){var t;return typeof chrome<"u"&&((t=chrome.storage)!=null&&t.local)?window.__API_BASE__||"https://chat.neevs.io":""}async function*_t(t,n,o){var g;const p=`${xs()}${t}`,i=await fetch(p,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),signal:o});if(!i.ok){yield{event:"error",error:`HTTP ${i.status}: ${i.statusText}`};return}const y=(g=i.body)==null?void 0:g.getReader();if(!y){yield{event:"error",error:"No response body"};return}const h=new TextDecoder;let m="";try{for(;;){const{done:x,value:b}=await y.read();if(x)break;m+=h.decode(b,{stream:!0});const R=m.split(`
`);m=R.pop()||"";for(const O of R)if(O.startsWith("data: ")){const P=O.slice(6).trim();if(P)try{yield JSON.parse(P)}catch{}}}}finally{y.releaseLock()}}const gs=async(t,n)=>_t("/api/chat/stream",{models:t.models,messages:t.messages,max_tokens:t.max_tokens,temperature:t.temperature,github_token:t.github_token,openrouter_key:t.openrouter_key},n),bs=async(t,n)=>_t("/api/chat/analyze/stream",t,n),ys=async(t,n)=>_t("/api/chat/debate/stream",t,n),Tt=async(t,n)=>{try{for await(const o of t)n(o)}catch(o){throw console.error("Stream error:",o),o}};function tn(t){window.__API_BASE__=t}const vs=[{name:"Chat",path:"chat.yml",category:"core"},{name:"Build Images",path:"build-push-images.yml",category:"core"},{name:"Nanbeige4-3B Thinking",path:"nanbeige-inference.yml",category:"reasoning",serviceKey:"nanbeige"},{name:"Qwen3 4B",path:"qwen-inference.yml",category:"small",serviceKey:"qwen"},{name:"SmolLM3 3B",path:"smollm3-inference.yml",category:"small",serviceKey:"smollm3"},{name:"LFM2 2.6B",path:"lfm2-inference.yml",category:"small",serviceKey:"lfm2"},{name:"DeepSeek R1 1.5B",path:"r1qwen-inference.yml",category:"reasoning",serviceKey:"r1qwen"},{name:"Gemma 3 12B",path:"gemma-inference.yml",category:"medium",serviceKey:"gemma"},{name:"Mistral 7B v0.3",path:"mistral-inference.yml",category:"medium",serviceKey:"mistral"},{name:"Phi-3 Mini",path:"phi-inference.yml",category:"small",serviceKey:"phi"},{name:"RNJ-1 Instruct",path:"rnj-inference.yml",category:"medium",serviceKey:"rnj"},{name:"Llama 3.2-3B",path:"llama-inference.yml",category:"medium",serviceKey:"llama"},{name:"FunctionGemma 270M",path:"functiongemma-inference.yml",category:"small",serviceKey:"functiongemma"},{name:"Nemotron-3 Nano 30B",path:"nemotron-inference.yml",category:"reasoning",serviceKey:"nemotron"},{name:"GPT-OSS 20B",path:"gpt-oss-inference.yml",category:"reasoning",serviceKey:"gptoss"}],ws={workflows:vs},on=ws.workflows;new Map(on.map(t=>[t.name,t.path]));new Map(on.filter(t=>t.serviceKey).map(t=>[t.serviceKey,t.name]));const Oe={githubToken:"",profile:"local_all",chatApiBaseUrl:"http://localhost:8080",modelsBaseDomain:"",modelsUseHttps:!1};function nn(t){const n={...Oe,...t};(!n.chatApiBaseUrl||typeof n.chatApiBaseUrl!="string")&&typeof n.baseDomain=="string"&&(n.chatApiBaseUrl=n.baseDomain?`${n.useHttps===!1?"http":"https"}://chat.${n.baseDomain}`:"http://localhost:8080",n.profile="custom"),(!n.modelsBaseDomain||typeof n.modelsBaseDomain!="string")&&typeof n.baseDomain=="string"&&(n.modelsBaseDomain=n.baseDomain,n.profile="custom"),typeof n.modelsUseHttps!="boolean"&&typeof n.useHttps=="boolean"&&(n.modelsUseHttps=n.useHttps,n.profile="custom");const o=n.profile==="remote_all"||n.profile==="local_chat_remote_models"||n.profile==="local_all"||n.profile==="custom"?n.profile:Oe.profile;return{githubToken:typeof n.githubToken=="string"?n.githubToken:Oe.githubToken,profile:o,chatApiBaseUrl:At(typeof n.chatApiBaseUrl=="string"?n.chatApiBaseUrl:""),modelsBaseDomain:typeof n.modelsBaseDomain=="string"?n.modelsBaseDomain:Oe.modelsBaseDomain,modelsUseHttps:typeof n.modelsUseHttps=="boolean"?n.modelsUseHttps:Oe.modelsUseHttps}}function ks(){var t;return typeof chrome<"u"&&!!((t=chrome.storage)!=null&&t.local)}function At(t){const n=t.trim().replace(/\/+$/,"");return n||"http://localhost:8080"}function js(){const[t,n]=s.useState(Oe),[o,d]=s.useState(!1);return s.useEffect(()=>{if(ks()){chrome.storage.local.get(["envConfig"],i=>{const y=nn(i.envConfig);n(y),d(!0);const h=At(y.chatApiBaseUrl);tn(h),console.log("[Config] Extension mode, API base:",h)});const p=(i,y)=>{var h;if(y==="local"&&((h=i.envConfig)!=null&&h.newValue)){const m=nn(i.envConfig.newValue);n(m);const g=At(m.chatApiBaseUrl);tn(g),console.log("[Config] Updated API base:",g)}};return chrome.storage.onChanged.addListener(p),()=>chrome.storage.onChanged.removeListener(p)}else d(!0),console.log("[Config] Web mode, using relative URLs")},[]),{config:t,isLoaded:o}}function Ss(){const[t,n]=s.useState([]),o=s.useRef([]),d=s.useCallback(h=>{if(!h.length)return;const m=[...o.current,...h];o.current=m,n(m)},[]),p=s.useCallback(()=>{o.current=[],n([])},[]),i=s.useCallback(h=>h.map(m=>`${m.role==="user"?"User":"Assistant"}: ${m.content}`).join(`

`),[]),y=s.useCallback((h,m)=>{if(m==="compare")return h;const g=h.filter(b=>b.role==="user"),x=[...h].reverse().find(b=>b.role==="assistant"&&b.kind==="analyze_synthesis"&&b.content.trim().length>0);return x?[...g,x]:g},[]);return{history:t,historyRef:o,pushHistoryEntries:d,clearHistory:p,historyToText:i,buildCarryoverHistory:y}}function Ms(t){const n=s.useRef({}),o=s.useRef(null),d=s.useCallback(()=>{o.current=null;const m=n.current;n.current={},Object.keys(m).length&&t(x=>x.map(b=>{const R=m[b.id];return R?{...b,response:(b.response||"")+R.answer,thinking:(b.thinking||"")+R.thinking}:b}))},[t]),p=s.useCallback(()=>{o.current==null&&(o.current=requestAnimationFrame(d))},[d]),i=s.useCallback((m,g,x)=>{if(!g&&!x)return;const b=n.current[m]||{answer:"",thinking:""};b.answer+=g,b.thinking+=x,n.current[m]=b,p()},[p]),y=s.useCallback(m=>{n.current[m]&&delete n.current[m]},[]),h=s.useCallback(()=>{n.current={},o.current!=null&&(cancelAnimationFrame(o.current),o.current=null)},[]);return{pendingStreamRef:n,flushStreamRafRef:o,enqueueStreamDelta:i,clearPendingStreamForModel:y,resetPendingStream:h}}function Cs(t){const{mode:n,moderator:o,selected:d,selectedCardIds:p,githubToken:i,isGenerating:y,summarizeSessionResponses:h,setLastQuery:m,setHoveredCard:g,setPhaseLabel:x,setModeratorSynthesis:b,setDiscussionTurnsByModel:R,resetFailedModels:O,markModelFailed:P,failedModelsRef:B,currentDiscussionTurnRef:Y,sessionModelIdsRef:c,abortControllerRef:H,thinkingStateRef:$,conversationHistoryRef:U,pushHistoryEntries:A,historyToText:S,buildCarryoverHistory:Z,setModelsData:W,modelIdToName:ne,setExecutionTimes:T,setIsGenerating:q,setIsSynthesizing:k,setSpeaking:J,enqueueStreamDelta:te,clearPendingStreamForModel:F,resetPendingStream:Q}=t;return{sendMessage:async(se,re,pe,X)=>{if(!se.trim()||d.length===0&&!pe||!pe&&y)return;const de=(X==null?void 0:X.skipHistory)??!1,ee={role:"user",content:se},Ce=de?U.current:[...U.current,ee];de||A([ee]);const $e=Z(Ce,n),ve=S($e);m(se);const je=ve?`${ve}

Continue the conversation above and respond to the latest user request.`:se;let a;if(pe)a=pe;else{const L=Array.from(p).filter(j=>d.includes(j)&&(n==="compare"||j!==o));a=L.length>0?L:d.slice()}c.current=a;const ie={},le=(L,j,f)=>{if(!j)return;const u=f!=null&&f.label?`${f.label}: ${j}`:j;ie[L]=f!=null&&f.replace?u:ie[L]?`${ie[L]}

${u}`:u},fe=new AbortController;H.current=fe,q(!0),k(!1),g(null),x(null),b(""),R({}),O(),Y.current=null,Q(),W(L=>L.map(j=>a.includes(j.id)||j.id===o?re&&re[j.id]?{...j,response:re[j.id],thinking:void 0,error:void 0}:{...j,response:"",thinking:void 0,error:void 0}:j)),T(L=>{const j={...L},f=performance.now();return a.forEach(u=>{j[u]={startTime:f}}),o&&!j[o]&&(j[o]={startTime:f}),j});const ce=new Set(a);o&&ce.add(o),ce.forEach(L=>{const j=ss(L),f=rs(L);$.current[L]={inThink:j||f,carry:"",implicitThinking:j,harmonyFormat:f}});const he=new Set,me=(L,j)=>{const f=L==null?void 0:L.trim();!f||de||A([{role:"assistant",content:f,kind:j}])},Se=(L,j)=>{const f=$.current[L]||{inThink:!1,carry:"",implicitThinking:!1};let u=f.carry+j;f.carry="";const M=u.lastIndexOf("<");if(M!==-1&&u.length-M<12){const C=u.slice(M);("<think>".startsWith(C)||"</think>".startsWith(C)||"<thinking>".startsWith(C)||"</thinking>".startsWith(C))&&(f.carry=C,u=u.slice(0,M))}let v="",z="",_=0;if(f.harmonyFormat){const C="<|channel|>final<|message|>",I=u.indexOf(C);if(I!==-1)f.inThink&&(v+=u.slice(0,I)),f.inThink=!1,z+=u.slice(I+C.length);else if(f.inThink){const oe=u.replace(/<\|channel\|>analysis<\|message\|>/gi,"").replace(/<\|end\|>/gi,"").replace(/<\|start\|>/gi,"").replace(/assistant/gi,"");v+=oe}else{const oe=u.replace(/<\|end\|>/gi,"");z+=oe}$.current[L]=f,z&&le(L,z),(v||z)&&te(L,z,v);return}if(!f.inThink&&!f.implicitThinking){const C=u.indexOf("</think>"),I=u.indexOf("</thinking>"),oe=C!==-1||I!==-1,xe=u.indexOf("<think>")!==-1||u.indexOf("<thinking>")!==-1;oe&&!xe&&(f.implicitThinking=!0,f.inThink=!0)}for(;_<u.length;)if(f.inThink){const C=u.indexOf("</think>",_),I=u.indexOf("</thinking>",_);let oe=-1,xe=0;if(C!==-1&&(I===-1||C<I)?(oe=C,xe=8):I!==-1&&(oe=I,xe=11),oe===-1){v+=u.slice(_);break}v+=u.slice(_,oe),f.inThink=!1,f.implicitThinking=!1,_=oe+xe}else{const C=u.indexOf("<think>",_),I=u.indexOf("<thinking>",_);let oe=-1,xe=0;if(C!==-1&&(I===-1||C<I)?(oe=C,xe=7):I!==-1&&(oe=I,xe=10),oe===-1){z+=u.slice(_);break}z+=u.slice(_,oe),f.inThink=!0,_=oe+xe}$.current[L]=f,z&&le(L,z),(v||z)&&te(L,z,v)},Re=L=>{const j=L.toLowerCase();return j.includes("rate limit")||j.includes("waiting")?'<svg width="14" height="14" viewBox="0 0 24 24" fill="none" style="display: inline-block; vertical-align: text-bottom; margin-right: 6px;"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none"/><path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>'+L:j.includes("error")||j.includes("failed")?'<svg width="14" height="14" viewBox="0 0 24 24" fill="none" style="display: inline-block; vertical-align: text-bottom; margin-right: 6px;"><path d="M12 2L2 20h20L12 2z" stroke="currentColor" stroke-width="2" fill="none" stroke-linejoin="round"/><path d="M12 9v4M12 17h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>'+L:L};try{if(n==="compare"){J(new Set(a));const L=await gs({models:a,messages:Ce.map(j=>({role:j.role,content:j.content})),max_tokens:Ge.maxTokens,temperature:Ge.temperature,github_token:i||null},fe.signal);if(await Tt(L,j=>{if(j.event==="info"&&j.content){const f=String(j.content),u=Re(f);x(u),j.model_id&&W(M=>M.map(v=>v.id===j.model_id?{...v,statusMessage:u}:v))}if(j.event==="token"&&j.model_id){const f=j.model_id,u=performance.now();he.has(f)||(he.add(f),T(M=>({...M,[f]:{...M[f],firstTokenTime:u}})),W(M=>M.map(v=>v.id===f?{...v,statusMessage:void 0}:v))),Se(f,String(j.content??""))}if(j.event==="done"&&j.model_id){const f=performance.now(),u=j.model_id;T(M=>({...M,[u]:{...M[u],endTime:f}})),J(M=>{const v=new Set(M);return v.delete(u),v})}}),!de){const j=h(ie,a);j&&A([{role:"assistant",content:j,kind:"compare_summary"}])}return}if(n==="analyze"){const L=a;if(L.length<2){const u="Select at least 2 participants for Analyze mode.";b(u),o&&W(M=>M.map(v=>v.id===o?{...v,response:u}:v)),x("Error");return}J(new Set(L));const j=await bs({query:je,participants:L,max_tokens:Ge.maxTokens,github_token:i||null},fe.signal);let f="";if(await Tt(j,u=>{const M=u.event;if(M==="analyze_start"&&x("Collecting Responses"),M==="model_start"&&u.model_id){const v=u.model_id;J(z=>{const _=new Set(z);return _.add(v),_})}if(M==="model_chunk"&&u.model_id){const v=u.model_id,z=performance.now();he.has(v)||(he.add(v),T(_=>({..._,[v]:{..._[v],firstTokenTime:z}}))),Se(v,String(u.chunk??""))}if(M==="model_response"&&u.model_id){const v=u.model_id,z=performance.now();T(C=>({...C,[v]:{...C[v],endTime:z}})),J(C=>{const I=new Set(C);return I.delete(v),I});const _=String(u.response??"");le(v,_,{replace:!0}),re&&re[v]||(W(C=>C.map(I=>I.id===v?{...I,response:_}:I)),me(`${ne(v)}:
${_}`,"analyze_response"))}if(M==="model_error"&&u.model_id){const v=u.model_id,z=performance.now();T(C=>({...C,[v]:{...C[v],endTime:z}})),J(C=>{const I=new Set(C);return I.delete(v),I});const _=String(u.error??"Error generating response.");F(v),W(C=>C.map(I=>I.id===v?{...I,response:_,error:_}:I)),P(v),le(v,_,{replace:!0})}if(M==="analysis_complete"){x("Analysis Complete");const v=u.consensus||[],z=u.unique_contributions||{};let _=`Analysis:

`;if(v.length>0&&(_+=`Consensus:
`+v.map(C=>`• ${C}`).join(`
`)+`

`),Object.keys(z).length>0){_+=`Unique Contributions:
`;for(const[C,I]of Object.entries(z)){const oe=ne(C);_+=`
${oe}:
`+I.map(xe=>`• ${xe}`).join(`
`)+`
`}}f=_,b(_),o&&W(C=>C.map(I=>I.id===o?{...I,response:_}:I))}if(M==="analyze_complete"&&(x("Complete"),J(new Set)),M==="error"){const v=String(u.error??"Analyze error.");b(v),x("Error")}}),!de){const u=f.trim();u&&A([{role:"assistant",content:u,kind:"analyze_synthesis"}])}return}if(n==="debate"){const L=a;if(L.length<2){const f="Select at least 2 participants for Debate mode.";b(f),o&&W(u=>u.map(M=>M.id===o?{...M,response:f}:M)),x("Error");return}const j=await ys({query:je,participants:L,turns:2,max_tokens:Ge.maxTokens,temperature:Ge.temperature,github_token:i||null},fe.signal);await Tt(j,f=>{const u=f.event;if(u==="debate_start"&&x("Debate Starting"),u==="round_start"){const M=f.round_number??0;x(`Round ${M+1}`)}if(u==="turn_start"&&f.model_id){const M=f.model_id,v=f.turn_number??0,z=f.round_number??0;J(new Set([M])),x(`Round ${z+1} · Turn ${v+1}`),Y.current={modelId:M,turnNumber:v}}if(u==="turn_chunk"&&f.model_id){const M=f.model_id,v=performance.now();he.has(M)||(he.add(M),T(z=>({...z,[M]:{...z[M],firstTokenTime:v}}))),Se(M,String(f.chunk??""))}if(u==="turn_complete"&&f.model_id){const M=f.model_id,v=performance.now();T(C=>({...C,[M]:{...C[M],endTime:v}})),J(C=>{const I=new Set(C);return I.delete(M),I});const z=String(f.response??""),_=f.turn_number??0;le(M,z,{replace:!0}),W(C=>C.map(I=>I.id===M?{...I,response:z}:I)),R(C=>({...C,[M]:[...C[M]||[],{turn_number:_,response:z}]})),me(`${ne(M)}:
${z}`,"debate_turn")}if(u==="turn_error"&&f.model_id){const M=f.model_id,v=performance.now();T(_=>({..._,[M]:{..._[M],endTime:v}})),J(_=>{const C=new Set(_);return C.delete(M),C});const z=String(f.error??"Turn error.");F(M),W(_=>_.map(C=>C.id===M?{...C,response:z,error:z}:C)),P(M)}if(u==="debate_complete"&&(x("Complete"),J(new Set)),u==="error"){const M=String(f.error??"Debate error.");x("Error"),b(M)}});return}}catch(L){if(L.name==="AbortError")return;if(console.error("Chat error:",L),H.current===fe){const j=L.message||String(L);b(`Session Error: ${j}`),x("Error"),Q(),W(f=>f.map(u=>a.includes(u.id)&&!u.response?{...u,response:"Error generating response."}:u)),a.forEach(f=>P(f))}}finally{if(H.current===fe){const L=performance.now();T(j=>{const f={...j};return c.current.forEach(u=>{f[u]&&!f[u].endTime&&(f[u]={...f[u],endTime:L})}),f}),q(!1),k(!1),x(j=>j==="Error"?j:null),J(new Set)}}}}}function Lt(t,n){const o=Math.min(t.x,n.x),d=Math.min(t.y,n.y),p=Math.max(t.x,n.x),i=Math.max(t.y,n.y);return{left:o,top:d,right:p,bottom:i,width:p-o,height:i-d}}function Es({rootContainerRef:t,visualizationAreaRef:n,arenaOffsetYRef:o,arenaTargetYRef:d,wheelRafRef:p,selectedModels:i,cardRefs:y,selectedCardIds:h,setSelectedCardIds:m,suppressClickRef:g}){const[x,b]=s.useState(null),R=s.useRef(!1);s.useEffect(()=>{R.current=x!=null},[x]),s.useEffect(()=>{const B=Y=>{if(Y.button!==0||!t.current)return;const c=Y.target;if(!c)return;const H=c.closest("[data-card]"),$=c.closest('button, a, input, textarea, select, [role="button"]'),U=c.closest("[draggable]"),A=c.closest("[data-no-arena-scroll]");if(H||$||U||A||!t.current.contains(c))return;d.current=o.current,p.current!=null&&(cancelAnimationFrame(p.current),p.current=null);const S=t.current.getBoundingClientRect(),Z={x:Y.clientX-S.left,y:Y.clientY-S.top};Y.preventDefault(),R.current=!0,g.current.card=!1,g.current.background=!1,b({origin:Z,current:Z,active:!1})};return window.addEventListener("mousedown",B,!0),()=>window.removeEventListener("mousedown",B,!0)},[o,d,p,t,n,g]),s.useEffect(()=>{if(!x||!t.current)return;const B=H=>H.preventDefault();document.addEventListener("selectstart",B);const Y=H=>{const $=t.current.getBoundingClientRect(),U={x:H.clientX-$.left,y:H.clientY-$.top};b(A=>{if(!A)return A;const S=Lt(A.origin,U),Z=A.active||S.width>4||S.height>4;return{...A,current:U,active:Z}})},c=H=>{R.current=!1;const $=t.current.getBoundingClientRect(),U={x:H.clientX-$.left,y:H.clientY-$.top},A=H.target,S=!!(A&&A.closest("[data-card]"));b(Z=>{if(!Z)return null;const W=Lt(Z.origin,U);if(Z.active&&W.width>0&&W.height>0){const ne=[],T=t.current.getBoundingClientRect(),q={left:T.left+W.left,right:T.left+W.right,top:T.top+W.top,bottom:T.top+W.bottom};for(const k of i){const J=y.current.get(k.id);if(!J)continue;const te=J.getBoundingClientRect();!(te.right<q.left||te.left>q.right||te.bottom<q.top||te.top>q.bottom)&&ne.push(k.id)}m(new Set(ne)),S?g.current.card=!0:ne.length>0&&(g.current.background=!0)}return null})};return window.addEventListener("mousemove",Y),window.addEventListener("mouseup",c),()=>{window.removeEventListener("mousemove",Y),window.removeEventListener("mouseup",c),document.removeEventListener("selectstart",B)}},[x,t,n,i,y,h,m,g]);const O=s.useMemo(()=>{if(!x||!x.active)return null;const B=Lt(x.origin,x.current);return B.width<=0||B.height<=0?null:{left:B.left,top:B.top,width:B.width,height:B.height}},[x]),P=s.useCallback(()=>{b(null),R.current=!1},[]);return{selectionRect:O,isSelecting:x!=null,dragSelectionActiveRef:R,clearSelection:P}}function Ns({visualizationAreaRef:t,cardRefs:n,selected:o,setSelected:d,mode:p,gridCols:i,getCirclePosition:y}){const[h,m]=s.useState(null),g=s.useCallback((x,b)=>{if(x.button!==0||x.target.closest('button, a, input, textarea, select, [role="button"]'))return;x.preventDefault();const O=n.current.get(b);if(!O||!t.current)return;const P=O.getBoundingClientRect(),B=t.current.getBoundingClientRect(),Y=P.left+P.width/2,c=P.top+P.height/2;m({activeId:b,currX:x.clientX,currY:x.clientY,offsetX:Y-x.clientX,offsetY:c-x.clientY,containerLeft:B.left,containerTop:B.top,containerWidth:B.width,containerHeight:B.height,cardHeight:P.height}),x.target.setPointerCapture(x.pointerId)},[t]);return s.useEffect(()=>{if(!h)return;const x=R=>{if(m(c=>c?{...c,currX:R.clientX,currY:R.clientY}:null),!t.current)return;const O=t.current.getBoundingClientRect(),P=o.indexOf(h.activeId);let B=1/0,Y=-1;if(p==="compare"){const c=R.clientX-(O.left+O.width/2),H=R.clientY-O.top,$=(ae.cardWidth+ae.gapX)*i-ae.gapX;o.forEach((U,A)=>{const S=Math.floor(A/i),W=A%i*(ae.cardWidth+ae.gapX)-$/2+ae.cardWidth/2,ne=S*(ae.cardHeight+ae.gapY),T=W,q=ne+ae.cardHeight/2,k=(c-T)**2+(H-q)**2;k<B&&(B=k,Y=A)})}else{const c=R.clientX-(O.left+O.width/2),H=R.clientY-(O.top+O.height/2),$=Math.max(ae.baseRadius,ae.minRadius+o.length*ae.radiusPerModel);o.forEach((U,A)=>{const S=y(A,o.length,p,$),Z=(c-S.x)**2+(H-S.y)**2;Z<B&&(B=Z,Y=A)})}if(Y!==-1&&Y!==P){const c=[...o],[H]=c.splice(P,1);c.splice(Y,0,H),d(c)}},b=()=>m(null);return window.addEventListener("pointermove",x),window.addEventListener("pointerup",b),()=>{window.removeEventListener("pointermove",x),window.removeEventListener("pointerup",b)}},[h,t,n,o,d,p,i,y]),{dragState:h,handlePointerDown:g}}const Ts={autoMode:!0,autoModeScope:"self-hosted",selectedModelId:null};function Ls(t,n){switch(n.type){case"SET_AUTO_MODE":return{...t,autoMode:n.payload};case"SET_AUTO_MODE_SCOPE":return{...t,autoMode:!0,autoModeScope:n.payload};case"SELECT_MODEL":return{...t,selectedModelId:n.payload};default:return t}}function Rs(t){const[n,o]=s.useReducer(Ls,{...Ts,...t});return{autoMode:n.autoMode,autoModeScope:n.autoModeScope,selectedModelId:n.selectedModelId,setAutoMode:d=>o({type:"SET_AUTO_MODE",payload:d}),setAutoModeScope:d=>o({type:"SET_AUTO_MODE_SCOPE",payload:d}),selectModel:d=>o({type:"SELECT_MODEL",payload:d})}}const ke=(t,n)=>!t||!t.startsWith("#")?t:t.length===7||t.length===4?`${t}${n}`:t,As={idle:"Ready",responding:"Responding",done:"Done",waiting:"Waiting",error:"Error"};function Rt({state:t,color:n,size:o=16,label:d,className:p=""}){const i={width:`${o}px`,height:`${o}px`},y=d??As[t],h=Math.max(2,Math.round(o*.14)),m=Math.max(12,o-2),g="#fbbf24",x=ke(n,"cc"),b=()=>{switch(t){case"responding":return e.jsx("div",{className:"relative flex items-center justify-center",style:i,children:e.jsxs("svg",{width:m,height:m,viewBox:"0 0 24 24",fill:"none",className:"",style:{filter:`drop-shadow(0 0 6px ${ke(g,"55")})`,animation:"spin 0.6s linear infinite"},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"spinnerGradient",gradientUnits:"userSpaceOnUse",x1:"3",y1:"12",x2:"12",y2:"3",children:[e.jsx("stop",{offset:"0%",stopColor:g,stopOpacity:"1"}),e.jsx("stop",{offset:"60%",stopColor:g,stopOpacity:"0.5"}),e.jsx("stop",{offset:"100%",stopColor:g,stopOpacity:"0"})]})}),e.jsx("circle",{cx:"12",cy:"12",r:"9",stroke:ke(g,"15"),strokeWidth:h,fill:"none"}),e.jsx("path",{d:"M 12 3 A 9 9 0 1 1 3 12",stroke:"url(#spinnerGradient)",strokeWidth:h,strokeLinecap:"round",fill:"none"}),e.jsx("circle",{cx:"3",cy:"12",r:h*.7,fill:g})]})});case"done":return e.jsx("div",{className:"flex items-center justify-center rounded-full",style:{...i,background:ke(n,"14"),border:`1px solid ${ke(n,"99")}`},children:e.jsx("svg",{width:m,height:m,viewBox:"0 0 24 24",fill:"none",children:e.jsx("polyline",{points:"5 13 10 18 19 7",stroke:n,strokeWidth:h,strokeLinecap:"round",strokeLinejoin:"round"})})});case"error":const R="#ef4444";return e.jsx("div",{className:"flex items-center justify-center rounded-full",style:{...i,background:ke(R,"14"),border:`1px solid ${ke(R,"99")}`},children:e.jsx("svg",{width:m,height:m,viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M6 6L18 18M6 18L18 6",stroke:R,strokeWidth:h,strokeLinecap:"round",strokeLinejoin:"round"})})});case"waiting":return e.jsxs("div",{className:"relative flex items-center justify-center",style:i,children:[e.jsx("div",{className:"absolute inset-0 rounded-full",style:{border:`1px solid ${ke(x,"99")}`}}),e.jsx("svg",{width:m,height:m,viewBox:"0 0 24 24",fill:"none",style:{animation:"spin 5s linear infinite"},children:e.jsx("circle",{cx:"12",cy:"12",r:"8.5",stroke:ke(x,"44"),strokeWidth:h-1,strokeDasharray:"6 10",strokeLinecap:"round"})}),e.jsx("div",{className:"absolute w-2 h-2 rounded-full",style:{background:ke(x,"aa"),animation:"pulse 1.5s ease-in-out infinite"}})]});default:return e.jsxs("div",{className:"relative flex items-center justify-center",style:i,children:[e.jsx("div",{className:"absolute inset-0 rounded-full",style:{border:"1px solid rgba(71, 85, 105, 0.5)"}}),e.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:"rgba(148, 163, 184, 0.6)",animation:"pulse 2.4s ease-in-out infinite"}})]})}};return e.jsx("div",{className:`inline-flex items-center justify-center ${p}`,title:y,children:b()})}function sn({times:t}){const n=(t==null?void 0:t.startTime)!=null,o=(t==null?void 0:t.endTime)!=null,d=(t==null?void 0:t.firstTokenTime)!=null,p=n&&o?((t.endTime-t.startTime)/1e3).toFixed(2):null,i=n&&d?((t.firstTokenTime-t.startTime)/1e3).toFixed(2):null;return e.jsxs("div",{className:"text-[10px] text-slate-500",children:[e.jsx("span",{className:"text-slate-400",children:"TIME"})," ",p?`${p}s`:n&&!o?"...":"—",i&&e.jsxs("span",{className:"ml-2 text-slate-600",children:["TTFT ",i,"s"]})]})}const It=({text:t,speed:n=5})=>{const[o,d]=s.useState(""),p=s.useRef(0),i=s.useRef(null);return s.useEffect(()=>{!t.startsWith(o)&&o!==""&&(d(""),p.current=0)},[t]),s.useEffect(()=>{i.current!=null&&(clearTimeout(i.current),i.current=null);const y=t.length;if(p.current>=y)return;const h=()=>{const m=p.current,g=y-m;if(g<=0)return;const x=g>120?12:g>40?4:g>10?2:1,b=Math.min(y,m+x);p.current=b,d(t.slice(0,b));const O=y-b>5?0:n;i.current=window.setTimeout(h,O)};return i.current=window.setTimeout(h,n),()=>{i.current!=null&&(clearTimeout(i.current),i.current=null)}},[t,n]),e.jsx("span",{children:o})},lt=256,an=200,ze=96;function _s(t){const{mode:n,selectedModels:o,gridCols:d,speaking:p,selectedCardIds:i,setSelectedCardIds:y,executionTimes:h,failedModels:m,cardRefs:g,handlePointerDown:x,dragState:b,setContextMenu:R,suppressClickRef:O,getTailSnippet:P,hoveredCard:B,setHoveredCard:Y,layoutRadius:c,getCirclePosition:H,moderatorModel:$,moderatorId:U,orchestratorTransform:A,orchestratorStatus:S,orchestratorPhaseLabel:Z,moderatorSynthesis:W,isSynthesizing:ne,isGenerating:T,phaseLabel:q,linesTransitioning:k,lastSelectedCardRef:J,orchestratorAutoMode:te,orchestratorAutoScope:F,showOrchestratorMenu:Q,setShowOrchestratorMenu:V,setOrchestratorAutoMode:se,setOrchestratorAutoScope:re,orchestratorMenuRef:pe,availableModels:X,setModerator:de}=t,ee=n!=="compare",Ce=n==="analyze"?c-64:0,$e=S==="responding"?"Responding":S==="waiting"?"Waiting":S==="done"?"Done":"Ready",[ve,je]=s.useState(null);return s.useEffect(()=>{if(!Q)return;const a=ie=>{pe.current&&!pe.current.contains(ie.target)&&(V(!1),je(null))};return document.addEventListener("mousedown",a,!0),()=>document.removeEventListener("mousedown",a,!0)},[Q,pe,V]),e.jsxs(e.Fragment,{children:[o.map((a,ie)=>{var Je;const le=H(ie,o.length,n,c),fe=Is(ie,d),ce=p.has(a.id),he=i.has(a.id),me=m.has(a.id),Se=!ce&&!me&&!!((Je=h[a.id])!=null&&Je.endTime)&&a.response.trim().length>0,Re=!ce&&!Se&&!me&&T&&n==="debate",L=me?"error":ce?"responding":Se?"done":Re?"waiting":"idle",j=me?"Error":ce?"Responding":Se?"Done":Re?"Waiting":"Ready",f="#fbbf24",u="#ef4444",M=a.type==="self-hosted"?"#10b981":"#3b82f6",v=me?u:M,z=ce&&!me,_="rgba(30, 41, 59, 0.85)",C=me?`linear-gradient(135deg, ${u}14, ${_})`:z?`linear-gradient(135deg, ${f}14, ${_})`:_,I=me?`1px solid ${u}99`:z?`1px solid ${f}99`:he?`1px solid ${M}d0`:"1px solid rgba(71, 85, 105, 0.5)",oe=me?`0 0 24px ${u}33, inset 0 1px 1px rgba(255,255,255,0.1)`:z?`0 0 24px ${f}33, inset 0 1px 1px rgba(255,255,255,0.1)`:he?`0 0 20px ${M}30, inset 0 1px 1px rgba(255,255,255,0.1)`:"0 4px 20px rgba(0,0,0,0.3), inset 0 1px 1px rgba(255,255,255,0.05)",xe=Ds({mode:n,gridX:fe.gridX,gridY:fe.gridY,circleX:le.x,circleY:le.y,dragState:b,modelId:a.id}),qe=B===a.id,ct=ee?ze:lt,dt=ee?ze:an,Ee=Math.max(800,c*2+600),ge=Ee/2,Be=ge,Ke=ge,Ve=ge+(0-le.x),Qe=ge+(Ce-le.y);return e.jsxs("div",{ref:ue=>{ue?g.current.set(a.id,ue):g.current.delete(a.id)},onPointerDown:ue=>x(ue,a.id),className:"absolute",onContextMenu:ue=>{ue.preventDefault(),ue.stopPropagation(),R({x:ue.clientX,y:ue.clientY,modelId:a.id})},style:{transform:xe,zIndex:ee?qe?300:he?40:ce?15:5:he?20:ce?10:1,left:"50%",top:ee?"50%":"0",transition:(b==null?void 0:b.activeId)===a.id?"none":"transform 300ms cubic-bezier(0.2, 0, 0.2, 1)"},children:[ee&&ce&&!me&&!k&&e.jsxs("svg",{className:"absolute pointer-events-none",style:{width:`${Ee}px`,height:`${Ee}px`,top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:-1},viewBox:`0 0 ${Ee} ${Ee}`,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:`grad-${a.id}`,gradientUnits:"userSpaceOnUse",x1:Be,y1:Ke,x2:Ve,y2:Qe,children:[e.jsx("stop",{offset:"0%",stopColor:f,stopOpacity:"0.45"}),e.jsx("stop",{offset:"100%",stopColor:f,stopOpacity:"0.12"})]})}),e.jsx("line",{x1:Be,y1:Ke,x2:Ve,y2:Qe,stroke:`url(#grad-${a.id})`,strokeWidth:"2",strokeDasharray:"6,4",strokeLinecap:"round",className:"animate-flow arena-link"})]}),e.jsxs("div",{"data-card":!0,onClick:ue=>zs({e:ue,modelId:a.id,suppressClickRef:O,setSelectedCardIds:y,selectedModels:o,lastSelectedCardRef:J}),onMouseEnter:()=>ee&&Y(a.id),onMouseLeave:()=>ee&&Y(null),className:`relative cursor-grab active:cursor-grabbing card-hover ${ee?"rounded-full":""} ${he?"card-selected":""} ${ce?"card-speaking":""}`,style:{background:C,backdropFilter:ee?void 0:"blur(8px)",WebkitBackdropFilter:ee?void 0:"blur(8px)",border:I,boxShadow:oe,transform:he||z?"scale(1.05)":"scale(1)",width:`${ct}px`,height:`${dt}px`,borderRadius:ee?"50%":"12px",transition:"transform 180ms ease-out, box-shadow 180ms ease-out, border-color 180ms ease-out, width 0.7s cubic-bezier(0.4, 0, 0.2, 1), height 0.7s cubic-bezier(0.4, 0, 0.2, 1), border-radius 0.7s cubic-bezier(0.4, 0, 0.2, 1)"},children:[!ee&&e.jsxs("div",{style:Bs,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3 gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5 min-w-0",children:[e.jsx(Rt,{state:L,color:v,size:16,label:j}),e.jsx("span",{className:"text-xs font-semibold text-slate-200 truncate",children:a.name})]}),e.jsx("div",{className:"flex items-center gap-1.5 shrink-0",children:e.jsx("span",{className:`text-[9px] uppercase tracking-wider px-1.5 py-0.5 rounded ${a.type==="self-hosted"?"bg-emerald-500/10 text-emerald-300 border border-emerald-500/30":"bg-blue-500/10 text-blue-300 border border-blue-500/30"}`,children:a.type==="self-hosted"?"Self-hosted":"API"})})]}),e.jsx("p",{className:"text-xs text-slate-400 leading-relaxed line-clamp-3 flex-1",children:Os({model:a,isSpeaking:ce,thinkingFallback:e.jsx("span",{className:"text-slate-500 italic",children:"Thinking…"}),getTailSnippet:P})}),e.jsx("div",{className:"flex items-center gap-4 mt-3 pt-3 border-t border-slate-700/50",children:e.jsx(sn,{times:h[a.id]})})]}),ee&&e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center text-center",style:{transition:"opacity 0.3s ease-out"},children:[e.jsx("div",{className:"absolute inset-[3px] rounded-full border border-white/5",style:{boxShadow:`inset 0 0 20px ${v}15`}}),e.jsx("div",{className:"absolute inset-[-6px] rounded-full opacity-60",style:{background:`radial-gradient(circle, ${v}22 0%, transparent 65%)`,filter:"blur(10px)"}}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center gap-1.5 px-3",children:[e.jsx("div",{className:"text-[7px] tracking-[0.32em] text-slate-400 uppercase",children:j}),e.jsx("div",{className:"text-[10px] font-semibold text-slate-100 leading-tight",children:a.name}),e.jsx(Rt,{state:L,color:v,size:12})]})]})]}),n==="analyze"&&ee&&a.personaEmoji&&e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 flex items-center justify-center pointer-events-none select-none",style:{bottom:"-12px",fontSize:"20px",zIndex:100,transition:"transform 180ms ease-out",transform:ce?"scale(1.15)":"scale(1)",filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.5)) drop-shadow(0 0 8px rgba(0,0,0,0.3))"},title:a.personaName?`${a.personaName} - ${a.personaTrait}`:"Persona",children:a.personaEmoji}),ee&&ce&&a.thinking&&a.thinking.trim().length>0&&a.response.trim().length===0&&e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 flex items-center justify-center pointer-events-none select-none animate-pulse",style:{bottom:"-12px",fontSize:"18px",zIndex:100,filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.5)) drop-shadow(0 0 10px rgba(168, 85, 247, 0.4))"},title:"Thinking...",children:"💭"}),ee&&B===a.id&&e.jsxs("div",{"data-card":!0,onClick:ue=>ue.stopPropagation(),className:"absolute w-64 max-w-[calc(100vw-2rem)] p-4 rounded-xl transition-all duration-300 z-[220]",style:{top:le.y>0?"auto":"100%",bottom:le.y>0?"100%":"auto",left:"50%",transform:"translateX(-50%)",marginTop:le.y>0?0:"12px",marginBottom:le.y>0?"12px":0,background:"rgba(15, 23, 42, 0.95)",backdropFilter:"blur(16px)",border:`1px solid ${v}40`,boxShadow:`0 20px 40px rgba(0,0,0,0.5), 0 0 20px ${v}15`},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:v}}),e.jsx("span",{className:"text-xs font-semibold text-slate-300",children:a.name})]}),n==="analyze"&&a.personaEmoji&&a.personaName&&e.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-2 border-b border-slate-700/50",children:[e.jsx("span",{className:"text-base",children:a.personaEmoji}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs font-semibold text-blue-400",children:a.personaName}),a.personaTrait&&e.jsx("div",{className:"text-[10px] text-slate-500",children:a.personaTrait})]})]}),e.jsx("p",{className:"text-xs text-slate-400 leading-relaxed whitespace-pre-wrap",children:Ps({model:a,isSpeaking:ce,getTailSnippet:P})}),e.jsx("div",{className:"flex items-center gap-4 mt-3 pt-2 border-t border-slate-700/50",children:e.jsx(sn,{times:h[a.id]})})]})]},a.id)}),n!=="compare"&&$&&e.jsxs("div",{"data-card":!0,className:"absolute z-20 transition-all duration-700 ease-out cursor-pointer",style:{opacity:1,transform:A,left:"50%",top:n==="analyze"?`calc(50% + ${c}px - 64px)`:"50%"},onClick:a=>{a.stopPropagation(),U&&(y(new Set([U])),J.current=U)},onContextMenu:a=>{a.preventDefault(),a.stopPropagation(),Q?(V(!1),je(null)):(je({x:a.clientX,y:a.clientY}),V(!0))},onMouseEnter:()=>Y("moderator"),onMouseLeave:()=>Y(null),children:[e.jsx("div",{className:"relative flex items-center justify-center",style:{width:`${ze}px`,height:`${ze}px`},children:(()=>{const a=S==="responding",ie=a?"#fbbf24":$.color;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0 rounded-full animate-pulse",style:{background:`radial-gradient(circle, ${ie}20 0%, transparent 70%)`,transform:"scale(2.2)",filter:"blur(18px)"}}),e.jsxs("div",{className:"relative rounded-full flex items-center justify-center transition-all duration-300",style:{width:`${ze}px`,height:`${ze}px`,background:a?"linear-gradient(135deg, rgba(251, 191, 36, 0.08), rgba(15, 23, 42, 0.9))":"rgba(15, 23, 42, 0.9)",backdropFilter:"blur(16px)",border:`2px solid ${ie}${a?"99":"60"}`,boxShadow:`0 0 36px ${ie}${a?"40":"28"}, inset 0 1px 1px rgba(255,255,255,0.1)`},children:[e.jsx("div",{className:"absolute inset-[-4px] rounded-full",style:{background:`conic-gradient(from 0deg, transparent, ${ie}60, transparent)`,animation:"spin 4s linear infinite"}}),e.jsx("div",{className:"absolute inset-[2px] rounded-full",style:{background:"rgba(15, 23, 42, 0.96)"}}),e.jsxs("div",{className:"relative text-center z-10 flex flex-col items-center gap-1.5 px-3",children:[e.jsx("div",{className:"text-[7px] tracking-[0.32em] text-slate-400 uppercase",children:$e}),e.jsx("div",{className:"text-[10px] font-semibold text-slate-100 leading-tight",children:$.name}),e.jsx(Rt,{state:S,color:ie,size:12})]})]})]})})()}),e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 flex flex-col items-center gap-1 w-max max-w-[200px]",style:{top:"calc(100% + 12px)"},children:e.jsx("span",{className:"text-[10px] text-slate-500",children:Z})}),B==="moderator"&&!Q&&(()=>{const a=S==="responding",ie=a?"#fbbf24":$.color;return e.jsxs("div",{"data-card":!0,onClick:le=>le.stopPropagation(),className:"absolute bottom-full mb-4 left-1/2 -translate-x-1/2 w-80 max-w-[calc(100vw-2rem)] p-4 rounded-xl z-[200] transition-all duration-300",style:{background:"rgba(15, 23, 42, 0.95)",backdropFilter:"blur(16px)",border:`1px solid ${ie}40`,boxShadow:`0 20px 40px rgba(0,0,0,0.5), 0 0 30px ${ie}20`},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"Orchestrator"}),e.jsx("span",{className:"text-xs text-slate-500",children:"·"}),e.jsx("span",{className:"text-xs font-medium text-slate-300",children:$.name}),a&&e.jsx("span",{className:"text-[9px] uppercase tracking-wider px-1.5 py-0.5 rounded bg-yellow-500/20 text-yellow-300 border border-yellow-500/30",children:"Working"})]}),e.jsx("p",{className:"text-sm text-slate-300 leading-relaxed",children:$s({moderatorSynthesis:W,isSynthesizing:ne,moderatorId:U,speaking:p,phaseLabel:q,isGenerating:T,getTailSnippet:P})})]})})(),Q&&ve&&Yn.createPortal(e.jsx("div",{ref:pe,className:"w-64 bg-slate-800 border border-slate-700 rounded-lg shadow-xl overflow-hidden",style:{position:"fixed",top:`${ve.y}px`,left:`${ve.x}px`,transform:"translateY(-50%)",zIndex:9999},onClick:a=>a.stopPropagation(),children:te?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-3 py-2 text-[10px] uppercase tracking-wider text-slate-500 font-semibold border-b border-slate-700/50",children:["Auto Mode: ",F==="self-hosted"?"SELF-HOSTED":F.toUpperCase()]}),["all","self-hosted","api"].map(a=>e.jsxs("button",{onClick:()=>{re(a),V(!1)},className:`w-full px-3 py-2 text-left text-xs font-medium transition-colors ${F===a?"bg-yellow-500/20 text-yellow-300":"text-slate-300 hover:bg-slate-700/50"}`,children:[a==="all"&&"All",a==="self-hosted"&&"Self-hosted",a==="api"&&"API",e.jsxs("span",{className:"text-[10px] text-slate-500 ml-1",children:[a==="all"&&"(self-hosted → API)",a==="self-hosted"&&"(no quota)",a==="api"&&"(cloud only)"]})]},a)),e.jsx("div",{className:"border-t border-slate-700",children:e.jsx("button",{onClick:()=>{se(!1),V(!1)},className:"w-full px-3 py-2 text-left text-xs font-medium text-slate-400 hover:bg-slate-700/50 transition-colors",children:"Manual Mode"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-3 py-2 text-[10px] uppercase tracking-wider text-slate-500 font-semibold border-b border-slate-700/50",children:"Select Orchestrator"}),X.filter(a=>a.type==="github"||a.type==="external").length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-3 py-1.5 text-[9px] uppercase tracking-wider text-slate-600 font-semibold",children:"GitHub Models"}),X.filter(a=>a.type==="github"||a.type==="external").map(a=>e.jsx("button",{onClick:()=>{de(a.id),V(!1)},className:`w-full px-4 py-2 text-left text-xs font-medium transition-colors ${U===a.id?"bg-blue-500/20 text-blue-300":"text-slate-300 hover:bg-slate-700/50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:a.name}),U===a.id&&e.jsx("span",{className:"text-blue-400",children:"✓"})]})},a.id))]}),X.filter(a=>a.type==="self-hosted").length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-3 py-1.5 text-[9px] uppercase tracking-wider text-slate-600 font-semibold border-t border-slate-700/50 mt-1",children:"Self-Hosted Models"}),X.filter(a=>a.type==="self-hosted").map(a=>e.jsx("button",{onClick:()=>{de(a.id),V(!1)},className:`w-full px-4 py-2 text-left text-xs font-medium transition-colors ${U===a.id?"bg-blue-500/20 text-blue-300":"text-slate-300 hover:bg-slate-700/50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:a.name}),U===a.id&&e.jsx("span",{className:"text-blue-400",children:"✓"})]})},a.id))]}),e.jsx("div",{className:"border-t border-slate-700",children:e.jsxs("button",{onClick:()=>{se(!0),V(!1)},className:"w-full px-3 py-2 text-left text-xs font-medium text-yellow-400 hover:bg-slate-700/50 transition-colors flex items-center gap-2",children:[e.jsx(rn,{size:12}),e.jsx("span",{children:"Enable Auto Mode"})]})})]})}),document.body)]}),n!=="compare"&&e.jsxs("svg",{className:"absolute pointer-events-none transition-opacity duration-700",style:{width:"1000px",height:"1000px",opacity:.2},children:[e.jsx("circle",{cx:"500",cy:"500",r:c,fill:"none",stroke:"url(#circleGrad)",strokeWidth:"1",strokeDasharray:"8,4"}),e.jsx("defs",{children:e.jsxs("linearGradient",{id:"circleGrad",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#3b82f6"}),e.jsx("stop",{offset:"50%",stopColor:"#8b5cf6"}),e.jsx("stop",{offset:"100%",stopColor:"#3b82f6"})]})})]})]})}function Is(t,n){const o=Math.floor(t/n),d=t%n,p=(lt+ae.gapX)*n-ae.gapX,i=o*(an+ae.gapY);return{gridX:d*(lt+ae.gapX)-p/2+lt/2,gridY:i}}function Ds({mode:t,gridX:n,gridY:o,circleX:d,circleY:p,dragState:i,modelId:y}){if((i==null?void 0:i.activeId)===y){const h=i.currX+i.offsetX,m=i.currY+i.offsetY;if(t==="compare"){const b=h-(i.containerLeft+i.containerWidth/2),R=m-i.containerTop-i.cardHeight/2;return`translate(calc(-50% + ${b}px), ${R}px)`}const g=h-(i.containerLeft+i.containerWidth/2),x=m-(i.containerTop+i.containerHeight/2);return`translate(calc(-50% + ${g}px), calc(-50% + ${x}px))`}return t==="compare"?`translate(calc(-50% + ${n}px), ${o}px)`:`translate(calc(-50% + ${d}px), calc(-50% + ${p}px))`}function zs({e:t,modelId:n,suppressClickRef:o,setSelectedCardIds:d,selectedModels:p,lastSelectedCardRef:i}){if(t.stopPropagation(),o.current.card){o.current.card=!1;return}const y=t.shiftKey,h=t.metaKey||t.ctrlKey;if(y&&i.current){const m=p.findIndex(x=>x.id===i.current),g=p.findIndex(x=>x.id===n);if(m!==-1&&g!==-1){const x=Math.min(m,g),b=Math.max(m,g),R=p.slice(x,b+1).map(O=>O.id);d(O=>{const P=new Set(O);return R.forEach(B=>P.add(B)),P})}}else h?(d(m=>{const g=new Set(m);return g.has(n)?g.delete(n):g.add(n),g}),i.current=n):(d(new Set([n])),i.current=n)}function Os({model:t,isSpeaking:n,thinkingFallback:o,getTailSnippet:d}){return t.statusMessage?t.statusMessage.startsWith("<svg")?e.jsx("span",{dangerouslySetInnerHTML:{__html:t.statusMessage}}):t.statusMessage:n?t.response.trim().length>0?t.response.startsWith("<svg")?e.jsx("span",{dangerouslySetInnerHTML:{__html:t.response}}):e.jsx(It,{text:t.response,speed:20}):t.thinking&&t.thinking.trim().length>0?e.jsxs("span",{children:[e.jsx("span",{className:"text-slate-500 italic",children:"Thinking… "}),d(t.thinking.trim(),220)]}):o:t.response.startsWith("<svg")?e.jsx("span",{dangerouslySetInnerHTML:{__html:t.response}}):t.response}function Ps({model:t,isSpeaking:n,getTailSnippet:o,maxChars:d=220}){return t.statusMessage?t.statusMessage.startsWith("<svg")?e.jsx("span",{dangerouslySetInnerHTML:{__html:t.statusMessage}}):t.statusMessage:n?t.thinking&&t.thinking.trim().length>0?e.jsxs("span",{children:[e.jsx("span",{className:"text-purple-400/80 text-[10px] uppercase tracking-wider font-medium",children:"💭 Thinking "}),e.jsx("span",{className:"text-slate-400",children:o(t.thinking.trim(),260)})]}):t.response.trim().length>0?t.response.startsWith("<svg")?e.jsx("span",{dangerouslySetInnerHTML:{__html:t.response}}):e.jsx(It,{text:t.response,speed:20}):e.jsx("span",{className:"text-slate-500 italic",children:"Thinking…"}):t.thinking&&t.thinking.trim().length>0?e.jsxs("span",{children:[e.jsx("span",{className:"text-purple-400/80 text-[10px] uppercase tracking-wider font-medium",children:"💭 Reasoning "}),e.jsx("span",{className:"text-slate-400",children:o(t.thinking.trim(),260)})]}):t.response?t.response.startsWith("<svg")?e.jsx("span",{dangerouslySetInnerHTML:{__html:t.response}}):o(t.response,d):e.jsx("span",{className:"text-slate-500 italic",children:"No response yet."})}function $s({moderatorSynthesis:t,isSynthesizing:n,moderatorId:o,speaking:d,phaseLabel:p,isGenerating:i,getTailSnippet:y}){return t?n&&o&&d.has(o)?e.jsx(It,{text:t,speed:20}):y(t):n?e.jsx("span",{className:"text-slate-500 italic",children:"Synthesizing responses..."}):i?p&&p.startsWith("<svg")?e.jsx("span",{className:"text-slate-500 italic",dangerouslySetInnerHTML:{__html:p}}):e.jsx("span",{className:"text-slate-500 italic",children:p==="Stage 1 · Responses"?"Waiting for model responses...":p||"Orchestrating..."}):e.jsx("span",{className:"text-slate-500 italic",children:"Send a prompt to see the synthesis."})}const Bs={padding:"16px",height:"100%",display:"flex",flexDirection:"column",isolation:"isolate",WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",textRendering:"optimizeLegibility",opacity:1,transition:"opacity 0.3s ease-out"};function Hs({rect:t}){return t?e.jsx("div",{className:"absolute pointer-events-none z-30",style:{left:t.left,top:t.top,width:t.width,height:t.height,border:"2px solid rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)"}}):null}const Ws={twoFingerTapWindow:500,twoFingerTapCooldown:400,twoFingerMinFrames:4,minPointingTime:100,dwellTime:1200,cursorSmoothing:.5},Dt=s.createContext(null);function Fs({children:t}){const[n,o]=s.useState(!1),[d,p]=s.useState("navigation"),[i,y]=s.useState("chat"),[h,m]=s.useState(Ws),[g,x]=s.useState(!1),b=s.useRef({}),R=s.useCallback(T=>{b.current=T},[]),[O,P]=s.useState({gesture:null,progress:0,triggered:!1}),[B,Y]=s.useState(null),[c,H]=s.useState(void 0),[$,U]=s.useState(void 0),[A,S]=s.useState(void 0),[Z,W]=s.useState(null),ne={isActive:n,setIsActive:o,gestureMode:d,setGestureMode:p,appContext:i,setAppContext:y,gestureConfig:h,setGestureConfig:m,mouseSimulation:g,setMouseSimulation:x,callbacks:b,setCallbacks:R,gestureState:O,setGestureState:P,aslResult:B,setASLResult:Y,debugInfo:c,setDebugInfo:H,landmarkData:$,setLandmarkData:U,performanceMetrics:A,setPerformanceMetrics:S,cameraError:Z,setCameraError:W};return e.jsx(Dt.Provider,{value:ne,children:t})}function Ys(){const t=s.useContext(Dt);if(!t)throw new Error("useGesture must be used within a GestureProvider");return t}function cr(){return s.useContext(Dt)}class Xs extends s.Component{constructor(o){super(o);Qt(this,"handleRetry",()=>{var o,d;this.setState({hasError:!1,error:null}),(d=(o=this.props).onRetry)==null||d.call(o)});this.state={hasError:!1,error:null}}static getDerivedStateFromError(o){return{hasError:!0,error:o}}componentDidCatch(o,d){console.error("ErrorBoundary caught an error:",o,d)}render(){var o;return this.state.hasError?this.props.fallback?this.props.fallback:e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-white/70 gap-4 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-amber-400",children:[e.jsx(Xn,{size:20}),e.jsx("span",{className:"text-sm font-medium",children:"Something went wrong"})]}),e.jsx("p",{className:"text-xs text-white/40 text-center max-w-xs",children:((o=this.state.error)==null?void 0:o.message)||"Failed to load component"}),e.jsxs("button",{onClick:this.handleRetry,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white/80 bg-slate-700/50 hover:bg-slate-600/50 rounded-lg transition-all active:scale-95 border border-slate-600/50",children:[e.jsx(Gn,{size:14}),"Try Again"]})]}):this.props.children}}const Gs=s.lazy(()=>Ue(()=>import("./SettingsModal--4R84Uo8.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),Us=s.lazy(()=>Ue(()=>import("./DiscussionTranscript-C2gtcJAX.js"),__vite__mapDeps([7,1,2,3,4,5,6,8]))),qs=s.lazy(()=>Ue(()=>import("./GestureControl-BHnpJ-UJ.js"),__vite__mapDeps([9,1,2,3,4,5,6]))),Ks=s.lazy(()=>Ue(()=>import("./HandBackground-DFMjYCtB.js"),__vite__mapDeps([10,1,2,3,4,5,6,11]))),Vs=s.lazy(()=>Ue(()=>import("./ChatView-DvF95tuF.js"),__vite__mapDeps([12,1,2,3,4,5,6,8])).then(t=>({default:t.default}))),Qs='button, input, textarea, select, a, [role="button"], [data-no-background], [data-card]';function Js(){const t=Ys();js();const{modelsData:n,setModelsData:o,selected:d,setSelected:p,chatModelId:i,setChatModelId:y,moderator:h,setModerator:m,availableModels:g,totalModelsByType:x,allSelectedByType:b,modelIdToName:R,isLoading:O,loadError:P,retryCount:B,retryNow:Y}=ms(),[c,H]=Pe("playground_mode","chat",{serialize:r=>r,deserialize:(r,l)=>["chat","compare","analyze","debate"].includes(r)?r:l}),[$,U]=s.useState(!1),A=s.useRef(null),[S,Z]=s.useState(null),[W,ne]=s.useState(!1),[T,q]=s.useState(!1),[k,J]=s.useState(2),te=s.useRef(0),F=s.useRef(0),Q=s.useRef(null),[V,se]=s.useState(!1),[re,pe]=Pe("github_models_token","",{serialize:r=>r||null,deserialize:(r,l)=>r??l}),[X,de]=Pe("openrouter_api_key","",{serialize:r=>r||null,deserialize:(r,l)=>r??l}),[ee,Ce]=s.useState({}),$e=s.useRef(null),ve=s.useRef(null),[je,a]=s.useState(""),[ie,le]=s.useState(null),fe=s.useRef(null),ce=s.useCallback(r=>{fe.current&&clearTimeout(fe.current),le(r),fe.current=window.setTimeout(()=>{le(null),fe.current=null},5e3)},[]),he=s.useCallback(r=>{if(c==="chat"||re)return!0;const l=n.find(w=>w.id===r);return!l||l.type!=="github"&&l.type!=="external"},[c,re,n]),me=s.useCallback(()=>!!(c==="chat"||re),[c,re]),[Se,Re]=s.useState([]),{autoMode:L,autoModeScope:j,setAutoMode:f,setAutoModeScope:u}=Rs({autoMode:!0,autoModeScope:"self-hosted"}),[M,v]=s.useState(""),[z,_]=s.useState(!1),C=s.useRef(!1),{history:I,historyRef:oe,pushHistoryEntries:xe,clearHistory:qe,historyToText:ct,buildCarryoverHistory:dt}=Ss(),Ee=(r,l)=>{const w=new Set,E=l.filter(Boolean).filter((D,G,K)=>K.indexOf(D)===G),N=[];return E.forEach(D=>{const G=r[D];G&&G.trim()&&(N.push({id:D,text:G.trim()}),w.add(D))}),Object.entries(r).forEach(([D,G])=>{w.has(D)||!G||!G.trim()||N.push({id:D,text:G.trim()})}),N.length?N.map(({id:D,text:G})=>`${R(D)}:
${G}`).join(`

`):null};s.useEffect(()=>{const r=C.current;C.current=t.isActive,c==="chat"&&t.isActive&&!r&&u("api")},[t.isActive,c,u]);const ge=d.map(r=>n.find(l=>l.id===r)).filter(r=>!!r&&(c==="compare"||r.id!==h)),Be=(r,l,w,E)=>{if(w==="analyze"){const ot=250+r*220/(l-1)-90,at=ot*Math.PI/180;return{x:Math.cos(at)*E,y:Math.sin(at)*E,angle:ot}}const N=r*360/l-90,D=Math.cos(N*Math.PI/180)*E,G=Math.sin(N*Math.PI/180)*E;return{x:D,y:G,angle:N}},Ke=(r,l)=>{Z(l),r.dataTransfer.effectAllowed="move"},Ve=r=>{r.preventDefault(),ne(!0)},Qe=()=>{ne(!1)},Je=r=>{if(r.preventDefault(),ne(!1),S){if(c==="chat")y(S);else if(!d.includes(S)){if(!he(S)){ce("Add your GitHub token in Settings for API model access with dedicated quota"),Z(null);return}p(l=>[...l,S])}Z(null)}},ue=r=>{if(c==="chat"){y(i===r?null:r);return}if(d.includes(r))if(Le&&pt.current.includes(r)&&je){ve.current&&ve.current.abort();const w=pt.current.filter(N=>N!==r),E={};if(n.forEach(N=>{w.includes(N.id)&&N.response&&!N.error&&(E[N.id]=N.response)}),p(N=>N.filter(D=>D!==r)),Me.has(r)&&He(N=>{const D=new Set(N);return D.delete(r),D}),(c==="analyze"||c==="debate")&&w.length<2){Ye(!1),nt(!1),xt("This mode requires at least 2 participants."),vt("Error");return}jt(je,E,w,{skipHistory:!0})}else p(w=>w.filter(E=>E!==r));else{if(!he(r)){ce("Add your GitHub token in Settings for API model access with dedicated quota");return}p(l=>[...l,r])}},ln=r=>{const l=n.filter(N=>N.type===r).map(N=>N.id);if(l.length>0&&l.every(N=>d.includes(N))){p(N=>N.filter(D=>!l.includes(D)));return}if((r==="github"||r==="external")&&!me()){ce("Add your GitHub token in Settings for API model access with dedicated quota");return}const E=g.filter(N=>N.type===r).map(N=>N.id);E.length>0&&p(N=>[...N,...E])},[cn,Ae]=s.useState(null),[zt,Ot]=s.useState(new Set),[dn,un]=s.useState(!1),[Me,He]=s.useState(new Set),_e=()=>He(new Set),[Ze,pn]=s.useState(null),ut=s.useMemo(()=>{if(c==="compare")return 0;const r=Math.max(ae.baseRadius,ae.minRadius+ge.length*ae.radiusPerModel);if(!Ze)return r;const w=Math.min(Ze.width,Ze.height)/2-140;return Math.max(r,w)},[c,ge.length,Ze]);s.useEffect(()=>{const r=()=>{if(!be.current)return;const{clientWidth:w,clientHeight:E}=be.current;let N=Math.floor(w/(ae.cardWidth+ae.gapX));N=Math.max(1,N),J(N),pn({width:w,height:E})},l=new ResizeObserver(w=>{for(let E of w)E.target===be.current&&r()});return be.current&&(l.observe(be.current),r()),()=>{be.current&&l.unobserve(be.current)}},[c]);const Ie=s.useRef(null),be=s.useRef(null),Ne=s.useRef(null),Pt=s.useRef(null),et=s.useRef(new Map),fn=s.useRef(null),We=s.useRef({card:!1,background:!1}),hn=s.useRef({}),pt=s.useRef([]),{enqueueStreamDelta:mn,clearPendingStreamForModel:xn,resetPendingStream:ft}=Ms(o),{selectionRect:gn,isSelecting:ht,dragSelectionActiveRef:$t}=Es({rootContainerRef:Pt,visualizationAreaRef:be,arenaOffsetYRef:te,arenaTargetYRef:F,wheelRafRef:Q,selectedModels:ge,cardRefs:et,selectedCardIds:Me,setSelectedCardIds:He,suppressClickRef:We}),{dragState:bn,handlePointerDown:yn}=Ns({visualizationAreaRef:be,cardRefs:et,selected:d,setSelected:p,mode:c,gridCols:k,getCirclePosition:Be});s.useEffect(()=>()=>ft(),[ft]);const[we,Te]=s.useState(null);s.useEffect(()=>{const r="arena-selecting",l=document.body;return ht?l.classList.add(r):l.classList.remove(r),()=>{l.classList.remove(r)}},[ht]);const tt=s.useCallback(r=>r?!r.closest(Qs):!1,[]),vn=s.useCallback(r=>{if(tt(r.target)){if(We.current.background){We.current.background=!1;return}Ae(null),_e(),We.current.background=!1}},[tt,_e]),wn=s.useCallback(r=>{tt(r.target)&&(r.preventDefault(),Te({x:r.clientX,y:r.clientY,type:"background"}))},[tt]),Bt=s.useCallback(()=>{U(!0),A.current&&clearTimeout(A.current),A.current=window.setTimeout(()=>{U(!1),A.current=null},350)},[]),Fe=s.useCallback(r=>{r!==c&&(Bt(),Ye(!1),H(r))},[c,Bt]);s.useEffect(()=>()=>{fe.current&&clearTimeout(fe.current)},[]),s.useEffect(()=>()=>{A.current&&clearTimeout(A.current)},[]),s.useEffect(()=>{const r=()=>Te(null);return window.addEventListener("click",r),()=>window.removeEventListener("click",r)},[]);const[Le,Ye]=s.useState(!1),[Xe,nt]=s.useState(!1),[mt,xt]=s.useState(""),kn=s.useCallback(()=>{qe(),Ye(!1),nt(!1),xt(""),vt(null),Wt({}),o(r=>r.map(l=>({...l,response:"Ready to generate...",thinking:void 0,error:void 0}))),Ce({}),Ot(new Set)},[qe,o]),[jn,Sn]=s.useState(!0),[Mn,Cn]=s.useState("api"),[gt,bt]=s.useState(!1),yt=s.useRef(null);s.useEffect(()=>{const r=w=>{yt.current&&!yt.current.contains(w.target)&&bt(!1)},l=w=>{w.key==="Escape"&&bt(!1)};return gt&&(document.addEventListener("mousedown",r),document.addEventListener("keydown",l)),()=>{document.removeEventListener("mousedown",r),document.removeEventListener("keydown",l)}},[gt]);const[Ht,vt]=s.useState(null),[,Wt]=s.useState({}),[En,Ft]=s.useState(new Set),wt=s.useRef(new Set),Nn=s.useRef(null),Yt=s.useRef({}),Xt=s.useRef(c),[kt,Gt]=s.useState(null),Tn=()=>{const r=new Set;wt.current=r,Ft(r)},Ln=r=>{Ft(l=>{if(l.has(r))return l;const w=new Set(l);return w.add(r),wt.current=w,w})},{sendMessage:jt}=Cs({mode:c,moderator:h,selected:d,selectedCardIds:Me,githubToken:re,isGenerating:Le,summarizeSessionResponses:Ee,setLastQuery:a,setHoveredCard:Ae,setPhaseLabel:vt,setModeratorSynthesis:xt,setDiscussionTurnsByModel:Wt,resetFailedModels:Tn,markModelFailed:Ln,failedModelsRef:wt,currentDiscussionTurnRef:Nn,sessionModelIdsRef:pt,abortControllerRef:ve,thinkingStateRef:hn,conversationHistoryRef:oe,pushHistoryEntries:xe,historyToText:ct,buildCarryoverHistory:dt,setModelsData:o,modelIdToName:R,setExecutionTimes:Ce,setIsGenerating:Ye,setIsSynthesizing:nt,setSpeaking:Ot,enqueueStreamDelta:mn,clearPendingStreamForModel:xn,resetPendingStream:ft});s.useEffect(()=>{const r=l=>{if(l.key==="Escape"){const E=document.activeElement;if(E&&E!==document.body&&E.blur(),V){se(!1);return}if(we){Te(null);return}if(Me.size>0){_e(),Ae(null);return}if(T){q(!1);return}Ae(null);return}if((l.metaKey||l.ctrlKey)&&(l.key==="a"||l.key==="A")){const E=l.target;if(E.tagName==="INPUT"||E.tagName==="TEXTAREA"||c==="chat")return;l.preventDefault(),d.length>0&&He(new Set(d));return}const w=l.target;if(!(w.tagName==="INPUT"||w.tagName==="TEXTAREA")){if(l.key==="ArrowRight"||l.key==="ArrowLeft"){l.preventDefault();const E=["chat","compare","analyze","debate"],N=E.indexOf(c);if(N!==-1){const D=l.key==="ArrowRight"?1:-1,G=(N+D+E.length)%E.length;Fe(E[G])}return}if(l.key==="m"||l.key==="M"){l.preventDefault(),q(!T);return}if((l.key==="Delete"||l.key==="Backspace")&&Me.size>0){l.preventDefault(),p(E=>E.filter(N=>!Me.has(N))),_e();return}l.key.length===1&&!l.ctrlKey&&!l.metaKey&&!l.altKey&&Ie.current&&Ie.current.focus()}};return window.addEventListener("keydown",r),()=>{window.removeEventListener("keydown",r)}},[T,V,we,Me,c,Fe,_e]);const st=s.useRef(!1),St=s.useRef(0),Ut=r=>{const l=be.current;l&&l.style.setProperty("--arena-offset-y",`${r}px`)},Mt=r=>Math.max(-200,Math.min(ae.scrollClamp,r)),qt=()=>{const r=te.current,l=F.current,w=l-r;if(Math.abs(w)<.5){te.current=l,Ut(l),Q.current=null;return}const E=r+w*.35;te.current=E,Ut(E),Q.current=requestAnimationFrame(qt)},Ct=()=>{Q.current==null&&(Q.current=requestAnimationFrame(qt))};s.useEffect(()=>{const r=D=>{if($t.current)return;const G=D.target;if(G&&G.closest("input, textarea, [data-no-arena-scroll]"))return;D.preventDefault();const K=D.deltaY*.9,ye=F.current-K;F.current=Mt(ye),Ct()},l=D=>D?!!D.closest('input, textarea, [data-no-arena-scroll], [data-card], button, a, select, [role="button"]'):!1,w=D=>{if(D.touches.length!==1)return;const G=D.target;l(G)||(st.current=!0,St.current=D.touches[0].clientY)},E=D=>{if($t.current||!st.current||D.touches.length!==1)return;const G=D.target;if(l(G)){st.current=!1;return}const K=D.touches[0].clientY,ye=K-St.current;St.current=K,D.preventDefault(),F.current=Mt(F.current+ye),Ct()},N=()=>{st.current=!1};return window.addEventListener("touchstart",w,{passive:!0}),window.addEventListener("touchmove",E,{passive:!1}),window.addEventListener("touchend",N),window.addEventListener("touchcancel",N),window.addEventListener("wheel",r,{passive:!1}),()=>{window.removeEventListener("touchstart",w),window.removeEventListener("touchmove",E),window.removeEventListener("touchend",N),window.removeEventListener("touchcancel",N),window.removeEventListener("wheel",r),Q.current!=null&&cancelAnimationFrame(Q.current)}},[]);const[rt,Rn]=Pe("playground-bg-style","dots",{serialize:r=>r,deserialize:(r,l)=>r&&os.includes(r)?r:l}),An=n.find(r=>r.id===h),_n=Xe?"responding":Le?"waiting":mt?"done":"idle",In=Xe?"Synthesizing...":Le?"Observing":mt?"Complete":"Ready",Dn=`${kt?`translate(-50%, -50%) translate(${kt.x}px, ${kt.y}px)`:"translate(-50%, -50%)"} scale(1)`;s.useLayoutEffect(()=>{if(c!=="compare")return;const r={};ge.forEach(l=>{const w=et.current.get(l.id);w&&(r[l.id]=w.getBoundingClientRect())}),Yt.current=r},[c,ge.length,ge.map(r=>r.id).join(",")]),s.useEffect(()=>{if(Xt.current==="compare"&&c!=="compare"&&h&&be.current){const l=Yt.current[h],w=be.current.getBoundingClientRect();if(l&&w.width>0&&w.height>0){const E=w.left+w.width/2,N=c==="analyze"?ut-64:0,D=w.top+(w.height*.5+N),G=l.left+l.width/2-E,K=l.top+l.height/2-D;(Math.abs(G)>1||Math.abs(K)>1)&&(Gt({x:G,y:K}),requestAnimationFrame(()=>Gt(null)))}}Xt.current=c},[c,h,ut]);const zn=rt==="none"?"":`bg-${rt}`,On=(r,l=280)=>r?r.length<=l?r:`…${r.slice(r.length-l)}`:"",Kt=()=>{ve.current&&(ve.current.abort(),Ye(!1),nt(!1))};return e.jsxs("div",{ref:Pt,className:`fixed inset-0 overflow-hidden text-white ${zn}`,style:{backgroundColor:en[c],transition:"background-color 1s ease",...rt==="none"?{background:en[c]}:{},...ht?{userSelect:"none",WebkitUserSelect:"none"}:{}},onClick:vn,onContextMenu:wn,children:[t.isActive&&!t.mouseSimulation&&e.jsx(s.Suspense,{fallback:null,children:e.jsx(Ks,{onStopGeneration:t.callbacks.current.onStopGeneration,onSendMessage:t.callbacks.current.onSendMessage,onScroll:t.callbacks.current.onScroll,onPinch:t.callbacks.current.onPinch,onHover:t.callbacks.current.onHover,onModeChange:t.callbacks.current.onModeChange,config:t.gestureConfig,mode:t.gestureMode,appContext:t.appContext,onGestureModeToggle:()=>t.setGestureMode(t.gestureMode==="navigation"?"asl":"navigation"),gestureActiveArea:{minX:.7,maxX:1,minY:0,maxY:1},onGestureState:t.setGestureState,onASLResult:t.setASLResult,onError:t.setCameraError,onDebugInfo:t.setDebugInfo,onLandmarkData:t.setLandmarkData,onPerformance:t.setPerformanceMetrics})}),O&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-slate-900/95 backdrop-blur-sm",children:e.jsxs("div",{className:"flex flex-col items-center gap-5 text-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-12 h-12 border-2 border-slate-700 border-t-blue-500 rounded-full animate-spin"}),e.jsx("div",{className:"absolute inset-0 w-12 h-12 border-2 border-transparent border-b-emerald-500/50 rounded-full animate-spin",style:{animationDirection:"reverse",animationDuration:"1.5s"}})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"text-white/80 text-sm font-medium",children:P||"Connecting to models..."}),B>0&&e.jsxs("p",{className:"text-white/40 text-xs tabular-nums",children:["Attempt ",B," of 8"]})]}),e.jsxs("button",{onClick:Y,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white/70 hover:text-white bg-white/5 hover:bg-white/10 border border-white/10 hover:border-white/20 rounded-lg transition-all active:scale-95",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh Now"]})]})}),e.jsx(cs,{mode:c,setMode:Fe,setHoveredCard:Ae,clearSelection:_e,showDock:T,setShowDock:q,onOpenSettings:()=>se(!0),gestureButtonSlot:e.jsx(s.Suspense,{fallback:null,children:e.jsx(qs,{inHeader:!0,appContext:c,onStopGeneration:()=>{if(c==="chat"&&Ne.current){Ne.current.stopGeneration();return}Kt()},onSendMessage:r=>{if(c==="chat"&&Ne.current){Ne.current.sendMessage(r,!0);return}const l=c==="compare"||c==="analyze"||c==="debate"?d:[];l.length>0&&jt(r,{},l)},onScroll:r=>{if(c==="chat"&&Ne.current){Ne.current.scroll(r);return}F.current=Mt(F.current+r),Ct()},onHover:(r,l)=>{const w=r*window.innerWidth,E=l*window.innerHeight,N=document.elementFromPoint(w,E);if(N){const D=N.closest("[data-gesture-mode-track]");if(D){const ye=D.getBoundingClientRect(),Vt=w-ye.left,ot=ye.width,at=Math.floor(Vt/ot*5),Et=["chat","compare","analyze","debate"][Math.max(0,Math.min(4,at))];Et&&Et!==c&&Fe(Et);return}const G=document.querySelector('[data-gesture-hovered="true"]'),K=N.closest('button, a, [role="button"], [data-clickable], .cursor-pointer, [onclick]')||N;K!==G?(G&&(G.removeAttribute("data-gesture-hovered"),G.dispatchEvent(new PointerEvent("pointerleave",{bubbles:!1,cancelable:!0})),G.dispatchEvent(new MouseEvent("mouseleave",{bubbles:!1,cancelable:!0})),G.dispatchEvent(new MouseEvent("mouseout",{bubbles:!0,cancelable:!0}))),K.setAttribute("data-gesture-hovered","true"),K.dispatchEvent(new PointerEvent("pointerenter",{bubbles:!1,cancelable:!0,clientX:w,clientY:E})),K.dispatchEvent(new PointerEvent("pointermove",{bubbles:!0,cancelable:!0,clientX:w,clientY:E})),K.dispatchEvent(new MouseEvent("mouseenter",{bubbles:!1,cancelable:!0,clientX:w,clientY:E})),K.dispatchEvent(new MouseEvent("mouseover",{bubbles:!0,cancelable:!0,clientX:w,clientY:E}))):K===G&&(K.dispatchEvent(new PointerEvent("pointermove",{bubbles:!0,cancelable:!0,clientX:w,clientY:E})),K.dispatchEvent(new MouseEvent("mousemove",{bubbles:!0,cancelable:!0,clientX:w,clientY:E})))}},onPinch:(r,l)=>{const w=r*window.innerWidth,E=l*window.innerHeight,N=document.elementFromPoint(w,E);if(N){const D=ye=>{ye.dispatchEvent(new PointerEvent("pointerdown",{bubbles:!0,cancelable:!0,clientX:w,clientY:E,pointerId:1,pointerType:"touch",isPrimary:!0})),ye.dispatchEvent(new PointerEvent("pointerup",{bubbles:!0,cancelable:!0,clientX:w,clientY:E,pointerId:1,pointerType:"touch",isPrimary:!0})),ye.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0,clientX:w,clientY:E})),ye.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0,clientX:w,clientY:E})),ye.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,clientX:w,clientY:E}))},G=N.closest('button, a, [role="button"], [data-clickable], .cursor-pointer, [onclick]');D(G||N);const K=document.createElement("div");K.style.position="fixed",K.style.left=`${w}px`,K.style.top=`${E}px`,K.style.width="20px",K.style.height="20px",K.style.background="rgba(236, 72, 153, 0.5)",K.style.borderRadius="50%",K.style.transform="translate(-50%, -50%)",K.style.pointerEvents="none",K.style.zIndex="9999",document.body.appendChild(K),K.animate([{transform:"translate(-50%, -50%) scale(1)",opacity:1},{transform:"translate(-50%, -50%) scale(4)",opacity:0}],{duration:400}).onfinish=()=>K.remove()}},onModeChange:r=>{const l=["chat","compare","analyze","debate"],w=l.indexOf(c);let E;r==="next"?E=(w+1)%l.length:E=(w-1+l.length)%l.length,Fe(l[E])}})})}),e.jsxs("div",{style:{paddingLeft:"1.5rem",paddingRight:"0"},children:[T&&e.jsx("div",{className:"fixed inset-0 z-[55] bg-black/10 backdrop-blur-[1px] transition-opacity duration-300",onClick:()=>q(!1)}),e.jsx(as,{showDock:T,availableModels:g,allSelectedByType:b,totalModelsByType:x,handleDragStart:Ke,handleModelToggle:ue,handleAddGroup:ln,dockRef:$e,mode:c,allModels:n,chatModelId:i,setChatModelId:y,chatAutoMode:L,setChatAutoMode:f,chatAutoModeScope:j,setChatAutoModeScope:u,setShowDock:q}),c==="chat"&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex h-screen w-full relative z-[10]",children:e.jsx("div",{className:"flex-1 relative px-2 sm:px-6 pt-20 pb-6",children:e.jsx(Xs,{children:e.jsx(s.Suspense,{fallback:e.jsxs("div",{className:"flex items-center justify-center h-full text-white/50 gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/20 border-t-white/60 rounded-full animate-spin"}),"Loading..."]}),children:e.jsx(Vs,{ref:Ne,models:n,selectedModelId:i,onSelectModel:y,githubToken:re,openrouterKey:X,messages:Se,setMessages:Re,autoMode:L,setAutoMode:f,autoModeScope:j,setAutoModeScope:u,currentResponse:M,setCurrentResponse:v,isGenerating:z,setIsGenerating:_,onModelUsed:y,gesturesActive:t.isActive})})})})})}),c!=="chat"&&e.jsxs("div",{className:"flex h-screen w-full relative",children:[e.jsx("div",{className:"relative flex-1 transition-all duration-300 flex flex-col pt-24",children:e.jsx("div",{ref:be,onDragOver:Ve,onDragLeave:Qe,onDrop:Je,className:"relative w-full h-full z-10 transition-all duration-300",style:{position:"relative",display:"flex",alignItems:c==="compare"?"flex-start":"center",justifyContent:"center","--arena-offset-y":`${te.current}px`,transform:c==="analyze"||c==="debate"?`translateY(calc(var(--arena-offset-y) - 50px)) scale(${W?1.02:1})`:`translateY(var(--arena-offset-y)) scale(${W?1.02:1})`,willChange:"transform",border:W?"2px dashed rgba(59, 130, 246, 0.4)":"2px dashed transparent",borderRadius:W?"24px":"0px",transition:"transform 0s linear",...c==="compare"?{minHeight:"300px",paddingBottom:"120px"}:c==="analyze"||c==="debate"?{height:"100%",minHeight:"100%",overflow:"hidden"}:{height:"100%",minHeight:"100%",overflow:"hidden"},...W?{background:"rgba(59, 130, 246, 0.05)"}:{}},children:e.jsx(_s,{mode:c,selectedModels:ge,gridCols:k,speaking:zt,selectedCardIds:Me,setSelectedCardIds:He,executionTimes:ee,failedModels:En,cardRefs:et,handlePointerDown:yn,dragState:bn,handleModelToggle:ue,setContextMenu:Te,suppressClickRef:We,getTailSnippet:On,hoveredCard:cn,setHoveredCard:Ae,layoutRadius:ut,getCirclePosition:Be,moderatorModel:An,moderatorId:h,orchestratorTransform:Dn,orchestratorStatus:_n,orchestratorPhaseLabel:In,moderatorSynthesis:mt,isSynthesizing:Xe,isGenerating:Le,phaseLabel:Ht,linesTransitioning:$,lastSelectedCardRef:fn,orchestratorAutoMode:jn,orchestratorAutoScope:Mn,showOrchestratorMenu:gt,setShowOrchestratorMenu:bt,setOrchestratorAutoMode:Sn,setOrchestratorAutoScope:Cn,orchestratorMenuRef:yt,availableModels:g,setModerator:m})})}),c!=="compare"&&e.jsx("div",{className:"transcript-panel w-[400px] xl:w-[480px] flex flex-col border-l border-white/5 bg-slate-900/20 backdrop-blur-sm z-40 relative h-full",children:e.jsx(s.Suspense,{fallback:null,children:e.jsx(Us,{history:I,models:n,mode:c,onSelectPrompt:r=>{Ie.current&&(Ie.current.value=r,Ie.current.focus())},onNewSession:kn,className:"pt-24 pb-6 mask-fade-top",phaseLabel:Ht,isGenerating:Le,isSynthesizing:Xe,speakingCount:zt.size,totalParticipants:ge.length})})})]})]}),e.jsx(Hs,{rect:gn}),ie&&e.jsx("div",{className:"fixed bottom-20 left-1/2 -translate-x-1/2 z-[200] animate-in slide-in-from-bottom-4 fade-in duration-300",children:e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 rounded-xl bg-amber-500/10 border border-amber-500/30 backdrop-blur-md shadow-xl",children:[e.jsx("svg",{className:"w-5 h-5 text-amber-400 shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsx("span",{className:"text-sm text-amber-100",children:ie}),e.jsx("button",{onClick:()=>{le(null),se(!0)},className:"ml-2 px-3 py-1 text-xs font-medium text-amber-900 bg-amber-400 hover:bg-amber-300 rounded-md transition-colors",children:"Open Settings"}),e.jsx("button",{onClick:()=>le(null),className:"ml-1 p-1 text-amber-400/60 hover:text-amber-400 transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsx(s.Suspense,{fallback:null,children:e.jsx(Gs,{open:V,onClose:()=>se(!1),token:re,setToken:pe,openrouterKey:X,setOpenrouterKey:de,bgStyle:rt,setBgStyle:Rn})}),(c==="compare"||c==="analyze"||c==="debate")&&e.jsx(is,{inputRef:Ie,inputFocused:dn,setInputFocused:un,onSendMessage:jt,isGenerating:Le||Xe,onStop:Kt,placeholder:c==="compare"?void 0:"Steer the discussion...",className:`fixed bottom-0 left-0 z-[100] pb-6 px-3 sm:px-4 flex justify-center items-end pointer-events-none transition-all duration-300 ${c==="compare"?"right-0":"right-[400px] xl:right-[480px]"}`,style:{paddingBottom:"calc(1.5rem + env(safe-area-inset-bottom))"}}),we&&e.jsx("div",{className:"fixed bg-slate-800 border border-slate-700 rounded-lg shadow-xl py-1 z-[200] min-w-[160px]",style:{top:we.y,left:we.x},onClick:r=>r.stopPropagation(),children:we.type==="background"?e.jsxs("button",{className:"w-full text-left px-4 py-2 text-sm text-slate-200 hover:bg-slate-700 transition-colors flex items-center gap-2",onClick:()=>{q(!0),Te(null)},children:[e.jsx("svg",{className:"w-4 h-4 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Model"]}):we.modelId?e.jsxs(e.Fragment,{children:[c!=="compare"&&we.modelId!==h&&e.jsxs("button",{className:"w-full text-left px-4 py-2 text-sm text-slate-200 hover:bg-slate-700 transition-colors flex items-center gap-2",onClick:()=>{m(we.modelId),Te(null)},children:[e.jsx("svg",{className:"w-4 h-4 text-orange-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})}),"Set as Orchestrator"]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 text-sm text-red-400 hover:bg-slate-700 transition-colors flex items-center gap-2",onClick:()=>{const r=we.modelId===h;if(ue(we.modelId),r&&c!=="compare"){const l=d.filter(w=>w!==we.modelId);l.length>0?m(l[0]):m("")}Te(null)},children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Remove"]})]}):null})]})}function Zs(){return e.jsx(Fs,{children:e.jsx(Js,{})})}Un.createRoot(document.getElementById("root")).render(e.jsx(qn.StrictMode,{children:e.jsx(Zs,{})}));export{os as B,lr as M,is as P,Hs as S,cr as a,gs as f,ir as g,Tt as s,Ys as u};
