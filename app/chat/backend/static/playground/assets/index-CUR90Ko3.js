const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SettingsModal-CjKr8Rf-.js","assets/react-vendor-CQxWqugw.js","assets/markdown-BNX5kHMI.js","assets/math-render-D6B7xoul.js","assets/math-render-BqiDbsU2.css","assets/syntax-highlight-K7DiErAG.js","assets/syntax-highlight-BEHUn5zE.css","assets/ResponseModal-reNlrW8D.js","assets/FormattedContent-ClPh4eCb.js","assets/DiscussionTranscript-Dx7tA61F.js","assets/GestureControl-CldEI6QU.js","assets/HandBackground-F7iiHyIM.js","assets/mediapipe-BWDqrTQ6.js","assets/ChatView-DNQTqbZO.js"])))=>i.map(i=>d[i]);
var qn=Object.defineProperty;var Vn=(t,n,r)=>n in t?qn(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r;var tn=(t,n,r)=>Vn(t,typeof n!="symbol"?n+"":n,r);import{r as s,j as e,X as Qn,S as Jn,C as Zn,P as es,a as ts,A as ns,b as ss,Z as rs,T as os,R as as,c as is,d as ls}from"./react-vendor-CQxWqugw.js";import"./math-render-D6B7xoul.js";import"./syntax-highlight-K7DiErAG.js";import"./markdown-BNX5kHMI.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))l(f);new MutationObserver(f=>{for(const a of f)if(a.type==="childList")for(const h of a.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&l(h)}).observe(document,{childList:!0,subtree:!0});function r(f){const a={};return f.integrity&&(a.integrity=f.integrity),f.referrerPolicy&&(a.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?a.credentials="include":f.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(f){if(f.ep)return;f.ep=!0;const a=r(f);fetch(f.href,a)}})();const cs="modulepreload",us=function(t){return"/static/playground/"+t},nn={},Be=function(n,r,l){let f=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),u=(h==null?void 0:h.nonce)||(h==null?void 0:h.getAttribute("nonce"));f=Promise.allSettled(r.map(c=>{if(c=us(c),c in nn)return;nn[c]=!0;const p=c.endsWith(".css"),m=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${m}`))return;const d=document.createElement("link");if(d.rel=p?"stylesheet":cs,p||(d.as="script"),d.crossOrigin="",d.href=c,u&&d.setAttribute("nonce",u),document.head.appendChild(d),p)return new Promise((v,R)=>{d.addEventListener("load",v),d.addEventListener("error",()=>R(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(h){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=h,window.dispatchEvent(u),!u.defaultPrevented)throw h}return f.then(h=>{for(const u of h||[])u.status==="rejected"&&a(u.reason);return n().catch(a)})},ds={"self-hosted":{color:"#10b981"},github:{color:"#3b82f6"}},fs=["deepseek-r1-distill-qwen-1.5b","r1qwen","smollm3","nanbeige"],ps=[],hs=t=>{const n=t.toLowerCase();return fs.some(r=>n.includes(r.toLowerCase()))},ms=t=>{const n=t.toLowerCase();return ps.some(r=>n.includes(r.toLowerCase()))},Rt=[{id:"eu-ai-act-enforcement",label:"EU AI Act Enforcement Wave",prompt:"The EU AI Act enters enforcement; high-risk systems must prove data provenance, evals, and risk controls. Outline compliance gaps for a frontier model API and tradeoffs between speed and alignment.",category:"Policy",modes:["analyze","debate"],tags:["governance","compliance"]},{id:"export-controls-blackwell",label:"Export Controls Tighten",prompt:"U.S. export rules tighten again on AI accelerators; Blackwell-class parts face new caps and cloud checks. Map the impact on training roadmaps, costs, and on-device strategies.",category:"Infra",modes:["compare","debate"],tags:["chips","supply-chain"]},{id:"weights-leak",label:"Major Weights Leak",prompt:"A commercial frontier model checkpoint leaks. Assess risks (misuse, impersonation, jailbreak diffusion), legal exposure, and whether open red-team releases mitigate or worsen safety.",category:"Security",modes:["analyze","debate"],tags:["safety","open-weights"]},{id:"on-device-llm-race",label:"On-Device LLM Race",prompt:"Phone OEMs ship 3nm NPUs and 20B-parameter on-device assistants. What actually moves the needle for UX, privacy, and cost vs. cloud? Where do hybrid (edge + cloud) designs win?",category:"Infra",modes:["compare","debate"],tags:["edge","latency"]},{id:"signed-app-prompt-injection",label:"Signed App Prompt Injection",prompt:"A popular signed desktop app shipped with hardcoded system prompts; attackers use supply chain updates to exfiltrate data. How should vendors audit, sandbox, and attest LLM apps?",category:"Security",modes:["compare","analyze"],tags:["supply-chain","prompt-injection"]},{id:"eval-standardization",label:"Safety Eval Standard",prompt:"NIST-style safety eval suites gain traction (jailbreak, autonomy, bio). How should vendors report scores, and what gaps remain for frontier vs. small models?",category:"Policy",modes:["compare","debate"],tags:["evaluation","safety"]},{id:"licensing-standoff",label:"Publisher Licensing Standoff",prompt:"Major news publishers pause AI licensing talks and sue over training. What remedies (revenue share, opt-out registries, model removal) are realistic, and how do they ripple to open models?",category:"Data",modes:["analyze","debate"],tags:["licensing","copyright"]},{id:"sbom-for-llms",label:"SBOM for LLM Pipelines",prompt:"Regulators push SBOMs and signed artifacts for AI stacks. Draft what should appear in an LLM pipeline SBOM (data, weights, evals, guardrails) and how to verify it at runtime.",category:"Security",modes:["compare","analyze"],tags:["sbom","supply-chain"]},{id:"data-poisoning-campaign",label:"Data Poisoning Campaign",prompt:"Researchers find coordinated data poisoning in popular open corpora. How should model hosts detect and mitigate poisoning post-hoc, and what retraining tradeoffs are acceptable?",category:"Security",modes:["compare","debate"],tags:["data","poisoning"]},{id:"copyright-settlement",label:"Copyright Settlement Sets Precedent",prompt:"A major copyright suit settles with dataset disclosure and per-output watermarking. Predict how this precedent affects future training sets and open-weight releases.",category:"Policy",modes:["debate"],tags:["copyright","watermarking"]}],Rr={analyze:["What's the most important programming principle?","Should code comments explain 'what' or 'why'?","Is TypeScript worth the extra complexity?"],debate:["Tabs or spaces? Give your verdict.","Should AI be allowed to write its own code?","What will never be automated by AI?"],compare:[],chat:[]};Rt.filter(t=>t.category==="Policy"||t.category==="Data"),Rt.filter(t=>t.category==="Infra"),Rt.filter(t=>t.category==="Security");const xs=["dots-mesh","dots","dots-fade","grid","mesh","animated-mesh","none"],pt="#0f172a",sn={compare:pt,analyze:pt,debate:pt,chat:pt},Je={maxTokens:1024,temperature:.7},gs=`You can output interactive UI elements using JSON. When appropriate, include clickable options:

\`\`\`json
{
  "options": [
    {"id": "opt1", "label": "Option 1", "action": "message", "value": "User selected option 1"},
    {"id": "opt2", "label": "Option 2", "action": "message", "value": "User selected option 2"}
  ]
}
\`\`\`

Guidelines:
- Use for choices, confirmations, or navigation
- 2-4 options max
- Keep labels short
- Include JSON after your text response`,re={cardWidth:256,cardHeight:200,gapX:24,gapY:24,baseRadius:160,minRadius:120,radiusPerModel:15,scrollClamp:200};function bs({showDock:t,availableModels:n,allSelectedByType:r,totalModelsByType:l,handleDragStart:f,handleModelToggle:a,handleAddGroup:h,dockRef:u,mode:c,allModels:p,setShowDock:m,chatSelectedModels:d=new Set,onToggleChatModel:v,onToggleChatGroup:R}){const[A,L]=s.useState(""),[w,_]=s.useState(""),i=s.useRef(null);s.useEffect(()=>{const E=setTimeout(()=>_(A),200);return()=>clearTimeout(E)},[A]);const O=[{type:"self-hosted",title:"Self-Hosted",accentColor:"emerald"},{type:"github",title:"GitHub Models",accentColor:"blue"}],F=c==="chat",G=F?p:n,j=s.useMemo(()=>{if(!w)return G;const E=w.toLowerCase();return G.filter(V=>V.name.toLowerCase().includes(E))},[G,w]),J=s.useCallback(E=>{F&&v?v(E):a(E)},[F,v,a]);s.useEffect(()=>{t?setTimeout(()=>{var E;return(E=i.current)==null?void 0:E.focus()},100):L("")},[t]),s.useEffect(()=>{if(!t)return;const E=V=>{V.key==="Escape"&&(V.preventDefault(),m(!1))};return window.addEventListener("keydown",E),()=>window.removeEventListener("keydown",E)},[t,m]);const se=E=>({emerald:{dot:"bg-emerald-500",text:"text-emerald-400",active:"bg-emerald-500/20 border-emerald-500/30"},blue:{dot:"bg-blue-500",text:"text-blue-400",active:"bg-blue-500/20 border-blue-500/30"},purple:{dot:"bg-purple-500",text:"text-purple-400",active:"bg-purple-500/20 border-purple-500/30"}})[E];return e.jsxs("div",{ref:u,"data-no-arena-scroll":!0,"data-no-background":!0,className:"fixed top-1/2 left-1/2 w-[min(90vw,500px)] max-h-[70vh] rounded-2xl flex flex-col z-[60] transition-all duration-300 shadow-2xl bg-slate-800/95 backdrop-blur-md",style:{transform:t?"translate(-50%, -50%) scale(1)":"translate(-50%, -50%) scale(0.95)",opacity:t?1:0,pointerEvents:t?"auto":"none"},children:[e.jsxs("div",{className:"px-4 py-3 border-b border-slate-700/50 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-200",children:F?"Select Models":"Add to Arena"}),F&&e.jsx("p",{className:"text-[10px] text-slate-500 mt-0.5",children:d.size===0?"Click to select":`${d.size} selected`})]}),e.jsx("button",{onClick:()=>m(!1),className:"text-slate-400 hover:text-slate-200",children:e.jsx(Qn,{size:18})})]}),e.jsx("div",{className:"px-4 py-2 border-b border-slate-700/50",children:e.jsxs("div",{className:"relative",children:[e.jsx(Jn,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-500"}),e.jsx("input",{ref:i,type:"text",placeholder:"Search...",value:A,onChange:E=>L(E.target.value),className:"w-full pl-9 pr-3 py-2 text-sm bg-slate-700/50 border border-slate-600/50 rounded-lg text-slate-200 placeholder-slate-500 focus:outline-none focus:border-slate-500"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-3 space-y-4",children:O.map(E=>{const V=j.filter(P=>P.type===E.type),I=p.filter(P=>P.type===E.type),U=se(E.accentColor);if(I.length===0)return null;const Q=F&&I.every(P=>d.has(P.id));return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between px-1 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${U.dot}`}),e.jsxs("span",{className:"text-[10px] font-semibold text-slate-400 uppercase tracking-wide",children:[E.title," (",I.length,")"]})]}),F?R&&e.jsx("button",{onClick:()=>R(E.type),className:`text-[10px] font-medium px-2 py-1 rounded ${U.text} hover:bg-white/5`,children:Q?"− Remove All":"+ Add All"}):e.jsx("button",{onClick:()=>h(E.type),className:`text-[10px] font-medium px-2 py-1 rounded ${U.text} hover:bg-white/5`,children:r[E.type]?"− Remove All":"+ Add All"})]}),e.jsx("div",{className:"space-y-1",children:V.map(P=>{const te=F?d.has(P.id):!1,b=P.type==="self-hosted"&&P.available===!1,W=!b;return e.jsxs("div",{draggable:!F&&W,onDragStart:!F&&W?ue=>f(ue,P.id):void 0,onClick:W?()=>J(P.id):void 0,className:`flex items-center justify-between px-3 py-2 rounded-lg transition-colors border ${b?"opacity-40 cursor-not-allowed border-transparent":te?U.active:"hover:bg-white/5 border-transparent cursor-pointer"}`,title:b?"Model is offline":void 0,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[b&&e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-red-500"}),e.jsx("span",{className:`text-xs font-medium ${te?"text-slate-200":"text-slate-400"}`,children:P.name})]}),te&&!b&&e.jsx(Zn,{size:14,className:U.text})]},P.id)})})]},E.type)})}),e.jsx("div",{className:"px-4 py-2 border-t border-slate-700/50",children:e.jsxs("p",{className:"text-[10px] text-slate-500 text-center",children:["Press ",e.jsx("kbd",{className:"px-1 py-0.5 rounded bg-slate-700 text-slate-400 text-[9px]",children:"M"})," or ",e.jsx("kbd",{className:"px-1 py-0.5 rounded bg-slate-700 text-slate-400 text-[9px]",children:"Esc"})," to close"]})})]})}function ys({inputRef:t,inputFocused:n,setInputFocused:r,onSendMessage:l,className:f,style:a,placeholder:h,isGenerating:u,onStop:c,uiBuilderEnabled:p,onToggleUiBuilder:m}){return e.jsx("div",{className:f??"fixed bottom-0 right-0 left-0 z-[100] pb-6 px-3 sm:px-4 flex justify-center items-end pointer-events-none transition-all duration-300",style:a??{paddingBottom:"calc(1.5rem + env(safe-area-inset-bottom))"},children:e.jsx("div",{className:"w-full pointer-events-auto",style:{maxWidth:"600px"},children:e.jsxs("div",{className:`rounded-xl p-2.5 transition-all duration-300 flex items-center gap-2 border border-slate-700/40 header-shell ${n?"prompt-panel-focused":""}`,children:[m&&e.jsx("button",{onClick:m,className:`p-2 rounded-lg transition-colors ${p?"text-violet-400 bg-violet-500/20":"text-slate-500 hover:text-slate-300 hover:bg-slate-700/50"}`,title:"UI Builder - Enable interactive UI elements in responses",children:e.jsx(es,{size:16})}),e.jsx("input",{ref:t,type:"text",placeholder:h||"Ask a question to compare model responses...",className:"w-full bg-transparent text-slate-200 placeholder-slate-500 outline-none text-base sm:text-sm px-2.5 py-2.5",onFocus:()=>r(!0),onBlur:()=>r(!1),onKeyDown:d=>{var v;if(d.key==="Enter"&&!d.shiftKey){if(d.preventDefault(),u)return;(v=t.current)!=null&&v.value&&(l(t.current.value),t.current.value="")}},disabled:u}),e.jsx("button",{onClick:()=>{var d;u?c==null||c():(d=t.current)!=null&&d.value&&(l(t.current.value),t.current.value="")},onMouseDown:d=>d.currentTarget.blur(),className:`min-w-[44px] min-h-[44px] sm:min-w-[36px] sm:min-h-[36px] p-2 rounded-lg transition-colors active:scale-95 flex items-center justify-center focus:outline-none focus-visible:outline-none ${u?"text-red-400 hover:text-red-300 hover:bg-red-500/10":"text-slate-400 hover:text-white hover:bg-white/10"}`,"aria-label":u?"Stop generation":"Send message",children:u?e.jsx(ts,{className:"w-5 h-5 sm:w-4 sm:h-4 fill-current"}):e.jsx(ns,{className:"w-5 h-5 sm:w-4 sm:h-4",strokeWidth:2.5})})]})})})}const vs={chat:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),compare:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2"})}),analyze:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),debate:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})},Ie=[{value:"chat",label:"Chat"},{value:"compare",label:"Compare"},{value:"analyze",label:"Analyze"},{value:"debate",label:"Debate"}];function ws({mode:t,setMode:n,setHoveredCard:r,clearSelection:l,showDock:f,setShowDock:a,onOpenSettings:h,gestureButtonSlot:u}){const[c,p]=s.useState(!1),m=s.useRef(null),[d,v]=s.useState(!0),R=s.useRef(null),[A,L]=s.useState(null),[w,_]=s.useState(0),i=Ie.findIndex(j=>j.value===t),O=i===-1?0:i,F=Ie[O].label;s.useEffect(()=>{const j=()=>{v(window.innerWidth>=1024)};return j(),window.addEventListener("resize",j),()=>window.removeEventListener("resize",j)},[]),s.useEffect(()=>{if(!R.current)return;const j=()=>{const E=R.current;if(!E)return;const V=E.querySelectorAll('button[role="radio"]');if(V.length===0||O>=V.length)return;const U=V[O].getBoundingClientRect(),Q=E.getBoundingClientRect(),P=U.width,te=U.left,b=Q.left;L(P),_(te-b)},J=setTimeout(j,0),se=new ResizeObserver(()=>{setTimeout(j,0)});return se.observe(R.current),window.addEventListener("resize",j),()=>{clearTimeout(J),se.disconnect(),window.removeEventListener("resize",j)}},[t,d,O]),s.useEffect(()=>{function j(J){m.current&&!m.current.contains(J.target)&&p(!1)}return c&&document.addEventListener("mousedown",j),()=>{document.removeEventListener("mousedown",j)}},[c]);const G=j=>{n(j),r(null),l(),p(!1)};return e.jsxs("div",{className:"fixed top-0 left-0 right-0 flex items-center justify-between mb-2 px-3 sm:px-6 pt-4 sm:pt-6 z-50 pointer-events-none transition-all duration-300",children:[e.jsx("div",{className:"absolute inset-0 pointer-events-auto",style:{height:"100%",zIndex:-1}}),e.jsx("div",{className:"flex items-center gap-2 w-auto pointer-events-auto z-20",children:u}),e.jsx("div",{className:"hidden md:block absolute left-1/2 -translate-x-1/2 pointer-events-auto z-20",children:e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex items-center p-1.5 rounded-xl border border-slate-700/40 header-shell",children:[e.jsx("button",{onClick:()=>a(!f),className:"px-2 sm:px-3 flex items-center justify-center text-slate-400 hover:text-white transition-colors",title:"Toggle Model Dock",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsx("div",{className:"w-px h-5 bg-slate-700/50 mx-0.5 sm:mx-1"}),e.jsxs("div",{ref:R,className:"relative flex p-1 rounded-lg bg-black/20 mode-track",role:"radiogroup","aria-label":"Mode selection","data-gesture-mode-track":"true",children:[e.jsx("div",{className:"absolute top-1 bottom-1 rounded-md transition-all duration-300 ease-out mode-slider",style:{width:A!==null?`${A}px`:`calc((100% - 8px) / ${Ie.length})`,left:A!==null?`${w}px`:`calc(4px + (100% - 8px) * ${O} / ${Ie.length})`}}),Ie.map(j=>e.jsx("button",{tabIndex:-1,onClick:()=>G(j.value),role:"radio","aria-checked":t===j.value,"aria-label":j.label,title:j.label,className:`relative z-10 py-2 sm:py-1.5 px-3 text-[11px] sm:text-xs font-medium transition-colors duration-200 min-h-[44px] sm:min-h-0 active:scale-95 focus:outline-none focus-visible:outline-none flex-1 flex items-center justify-center text-center ${t===j.value?"text-white":"text-slate-400 hover:text-slate-200"}`,children:j.label},j.value))]})]})})}),e.jsx("div",{className:"flex md:hidden flex-1 justify-center pointer-events-auto relative z-20",children:e.jsxs("div",{className:"relative",ref:m,children:[e.jsxs("button",{onClick:()=>p(!c),className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-slate-800/90 border border-slate-700/50 text-slate-200 font-medium text-sm backdrop-blur-md shadow-lg active:scale-95 transition-all",children:[e.jsx("span",{className:"font-bold text-slate-400 hidden xs:inline",children:"Arena"}),e.jsx("span",{className:"font-bold hidden xs:inline text-slate-600",children:"/"}),e.jsx("span",{children:F}),e.jsx("svg",{className:`w-4 h-4 text-slate-400 transition-transform duration-200 ${c?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),c&&e.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 mt-2 w-48 py-1 rounded-xl bg-slate-800 border border-slate-700 shadow-2xl overflow-hidden flex flex-col animate-in fade-in zoom-in-95 duration-100 origin-top",children:Ie.map(j=>e.jsxs("button",{onClick:()=>G(j.value),className:`px-4 py-3 text-sm text-left w-full transition-colors flex items-center gap-3 ${t===j.value?"bg-blue-500/10 text-blue-400":"text-slate-300 hover:bg-slate-700/50"}`,children:[e.jsx("span",{className:"flex-shrink-0",children:vs[j.value]}),e.jsx("span",{className:"flex-1",children:j.label}),t===j.value&&e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]},j.value))})]})}),e.jsx("div",{className:"flex items-center gap-2 w-auto justify-end pointer-events-auto z-20",children:e.jsx("button",{onClick:h,className:"min-w-[42px] min-h-[42px] w-[42px] h-[42px] rounded-full bg-slate-800/50 flex items-center justify-center border border-slate-700/50 hover:border-slate-600 transition-colors active:scale-95 focus:outline-none focus-visible:outline-none",title:"Settings",children:e.jsxs("svg",{className:"w-4 h-4 text-slate-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),e.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})})})]})}const ks=t=>{if(typeof t=="string")return t;try{return JSON.stringify(t)}catch{return null}},js=(t,n)=>{if(t===null)return n;try{return JSON.parse(t)}catch{return n}};function Pe(t,n,r={}){const l=r.serialize??ks,f=r.deserialize??js,[a,h]=s.useState(()=>{if(typeof window>"u")return n;try{const u=window.localStorage.getItem(t);return f(u,n)}catch{return n}});return s.useEffect(()=>{if(!(typeof window>"u"))try{const u=l(a);u===null?window.localStorage.removeItem(t):window.localStorage.setItem(t,u)}catch{}},[t,l,a]),[a,h]}const Ss=800,Ts=3e3,Es=8;function Cs(){const[t,n]=s.useState([]),[r,l]=s.useState(!0),[f,a]=s.useState(null),[h,u]=s.useState(0),[c,p]=Pe("playground_selected_models",null),m=s.useRef(c!==null),[d,v]=Pe("playground_chat_model",null),R=s.useRef(d!==null),A=s.useMemo(()=>c??[],[c]),L=s.useCallback(I=>{p(U=>typeof I=="function"?I(U??[]):I)},[p]),[w,_]=s.useState(""),i=s.useRef(0),O=s.useRef(null),F=s.useCallback(async(I,U,Q=!1)=>{O.current&&(clearTimeout(O.current),O.current=null),l(!0),Q&&(a("Refreshing..."),u(0));const P=te=>{var pe,xe;const b=te.models.filter(q=>q.type!=="external").map(q=>{const ae=q.type==="github"?"github":"self-hosted",he=ds[ae];return{id:q.id,name:he.name||q.name||q.id,color:he.color,type:ae,response:"",priority:q.priority,context_length:q.context_length,default:q.default,available:ae==="github"?!0:void 0}});if(n(b),l(!1),a(null),u(0),m.current||(p(b.filter(q=>q.type==="self-hosted").map(q=>q.id)),m.current=!0),!R.current){const q=b.find(ee=>ee.id==="gpt-4o"),ae=b.find(ee=>ee.default),he=b.find(ee=>ee.type==="github");v((q==null?void 0:q.id)||(ae==null?void 0:ae.id)||(he==null?void 0:he.id)||((pe=b[0])==null?void 0:pe.id)||null),R.current=!0}const W=b.find(q=>q.type==="github"),ue=b.find(q=>q.default),we=((xe=b[0])==null?void 0:xe.id)||"";_((W==null?void 0:W.id)||(ue==null?void 0:ue.id)||we)};try{const te=await fetch("/api/models");if(I!==i.current)return;if(!te.ok)throw new Error(`HTTP ${te.status}`);const b=await te.json();if(I!==i.current)return;if(!b.models||b.models.length===0)throw new Error("No models available yet");P(b)}catch(te){if(I!==i.current)return;console.warn("Backend fetch failed:",te);try{console.log("Trying static models.json...");const W=await fetch("/models.json");if(W.ok){const ue=await W.json();if(ue.models&&ue.models.length>0){console.log(`Loaded ${ue.models.length} models from static file`),P(ue);return}}}catch(W){console.warn("Static models.json not available:",W)}const b=U+1;if(u(b),b<Es){const W=Math.min(Ss*Math.pow(1.4,U),Ts);a("Connecting to backend..."),O.current=setTimeout(()=>{F(I,b)},W)}else l(!1),a("Could not load models")}},[p,v]),G=s.useCallback(()=>{i.current+=1,F(i.current,0,!0)},[F]);s.useEffect(()=>(i.current+=1,F(i.current,0),()=>{i.current+=1,O.current&&clearTimeout(O.current)}),[F]);const j=s.useMemo(()=>t.filter(I=>!A.includes(I.id)),[t,A]),{totalModelsByType:J,allSelectedByType:se}=s.useMemo(()=>{const I={"self-hosted":t.filter(Q=>Q.type==="self-hosted").length,github:t.filter(Q=>Q.type==="github").length},U={"self-hosted":t.filter(Q=>Q.type==="self-hosted"&&A.includes(Q.id)).length,github:t.filter(Q=>Q.type==="github"&&A.includes(Q.id)).length};return{totalModelsByType:I,allSelectedByType:{"self-hosted":I["self-hosted"]>0&&U["self-hosted"]===I["self-hosted"],github:I.github>0&&U.github===I.github}}},[t,A]),E=s.useCallback(I=>{var U;return((U=t.find(Q=>Q.id===I))==null?void 0:U.name)||I},[t]),V=s.useCallback((I,U)=>{n(Q=>Q.map(P=>P.id===I?{...P,available:U}:P))},[]);return{modelsData:t,setModelsData:n,selected:A,setSelected:L,chatModelId:d,setChatModelId:v,moderator:w,setModerator:_,availableModels:j,totalModelsByType:J,allSelectedByType:se,modelIdToName:E,updateModelAvailability:V,isLoading:r,loadError:f,retryCount:h,retryNow:G}}const Ms=3e4,Ns=2e3;function Rs(t,n){const r=s.useRef(null),l=s.useRef(null),f=s.useCallback(async(h,u)=>{if(u!=="self-hosted"){n(h,!0);return}try{const c=await fetch(`/api/models/${h}/status`,{method:"GET",headers:{"Content-Type":"application/json"}});if(c.ok){const p=await c.json();n(h,p.status==="online")}else n(h,!1)}catch{n(h,!1)}},[n]),a=s.useCallback(async()=>{await Promise.all(t.map(h=>f(h.id,h.type||"self-hosted")))},[t,f]);return s.useEffect(()=>(l.current=setTimeout(()=>{a()},Ns),r.current=setInterval(()=>{a()},Ms),()=>{r.current&&clearInterval(r.current),l.current&&clearTimeout(l.current)}),[a]),{checkAllModels:a}}function Ls(){var t;return typeof chrome<"u"&&((t=chrome.storage)!=null&&t.local)?window.__API_BASE__||"https://chat.neevs.io":""}async function*zt(t,n,r){var p;const f=`${Ls()}${t}`,a=await fetch(f,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),signal:r});if(!a.ok){yield{event:"error",error:`HTTP ${a.status}: ${a.statusText}`};return}const h=(p=a.body)==null?void 0:p.getReader();if(!h){yield{event:"error",error:"No response body"};return}const u=new TextDecoder;let c="";try{for(;;){const{done:m,value:d}=await h.read();if(m)break;c+=u.decode(d,{stream:!0});const v=c.split(`
`);c=v.pop()||"";for(const R of v)if(R.startsWith("data: ")){const A=R.slice(6).trim();if(A)try{yield JSON.parse(A)}catch{}}}}finally{h.releaseLock()}}const As=async(t,n)=>zt("/api/chat/stream",{models:t.models,messages:t.messages,max_tokens:t.max_tokens,temperature:t.temperature,github_token:t.github_token},n),_s=async(t,n)=>zt("/api/chat/analyze/stream",t,n),Is=async(t,n)=>zt("/api/chat/debate/stream",t,n),Lt=async(t,n)=>{try{for await(const r of t)n(r)}catch(r){throw console.error("Stream error:",r),r}};function rn(t){window.__API_BASE__=t}const zs=[{name:"Chat",path:"chat.yml",category:"core"},{name:"Build Images",path:"build-push-images.yml",category:"core"},{name:"Nanbeige4-3B Thinking",path:"inference.yml",category:"reasoning",serviceKey:"nanbeige"},{name:"Qwen3 4B",path:"inference.yml",category:"small",serviceKey:"qwen"},{name:"DASD-4B Thinking",path:"inference.yml",category:"small",serviceKey:"dasd"},{name:"GLM-4.7 Flash",path:"inference.yml",category:"reasoning",serviceKey:"glm"},{name:"SmolLM3 3B",path:"inference.yml",category:"small",serviceKey:"smollm3"},{name:"AgentCPM-Explore 4B",path:"inference.yml",category:"small",serviceKey:"agentcpm"},{name:"LFM2.5 1.2B",path:"inference.yml",category:"small",serviceKey:"lfm2"},{name:"DeepSeek R1 1.5B",path:"inference.yml",category:"reasoning",serviceKey:"r1qwen"},{name:"Gemma 3 12B",path:"inference.yml",category:"medium",serviceKey:"gemma"},{name:"Mistral 7B v0.3",path:"inference.yml",category:"medium",serviceKey:"mistral"},{name:"Phi-4 Mini",path:"inference.yml",category:"small",serviceKey:"phi"},{name:"RNJ-1 Instruct",path:"inference.yml",category:"medium",serviceKey:"rnj"},{name:"Llama 3.2-3B",path:"inference.yml",category:"medium",serviceKey:"llama"},{name:"FunctionGemma 270M",path:"inference.yml",category:"small",serviceKey:"functiongemma"},{name:"GPT-OSS 20B",path:"inference.yml",category:"reasoning",serviceKey:"gptoss"}],Ps={workflows:zs},un=Ps.workflows;new Map(un.map(t=>[t.name,t.path]));new Map(un.filter(t=>t.serviceKey).map(t=>[t.serviceKey,t.name]));const ze={githubToken:"",profile:"local_all",chatApiBaseUrl:"http://localhost:8080",modelsBaseDomain:"",modelsUseHttps:!1};function on(t){const n={...ze,...t};(!n.chatApiBaseUrl||typeof n.chatApiBaseUrl!="string")&&typeof n.baseDomain=="string"&&(n.chatApiBaseUrl=n.baseDomain?`${n.useHttps===!1?"http":"https"}://chat.${n.baseDomain}`:"http://localhost:8080",n.profile="custom"),(!n.modelsBaseDomain||typeof n.modelsBaseDomain!="string")&&typeof n.baseDomain=="string"&&(n.modelsBaseDomain=n.baseDomain,n.profile="custom"),typeof n.modelsUseHttps!="boolean"&&typeof n.useHttps=="boolean"&&(n.modelsUseHttps=n.useHttps,n.profile="custom");const r=n.profile==="remote_all"||n.profile==="local_chat_remote_models"||n.profile==="local_all"||n.profile==="custom"?n.profile:ze.profile;return{githubToken:typeof n.githubToken=="string"?n.githubToken:ze.githubToken,profile:r,chatApiBaseUrl:_t(typeof n.chatApiBaseUrl=="string"?n.chatApiBaseUrl:""),modelsBaseDomain:typeof n.modelsBaseDomain=="string"?n.modelsBaseDomain:ze.modelsBaseDomain,modelsUseHttps:typeof n.modelsUseHttps=="boolean"?n.modelsUseHttps:ze.modelsUseHttps}}function $s(){var t;return typeof chrome<"u"&&!!((t=chrome.storage)!=null&&t.local)}function _t(t){const n=t.trim().replace(/\/+$/,"");return n||"http://localhost:8080"}function Bs(){const[t,n]=s.useState(ze),[r,l]=s.useState(!1);return s.useEffect(()=>{if($s()){chrome.storage.local.get(["envConfig"],a=>{const h=on(a.envConfig);n(h),l(!0);const u=_t(h.chatApiBaseUrl);rn(u),console.log("[Config] Extension mode, API base:",u)});const f=(a,h)=>{var u;if(h==="local"&&((u=a.envConfig)!=null&&u.newValue)){const c=on(a.envConfig.newValue);n(c);const p=_t(c.chatApiBaseUrl);rn(p),console.log("[Config] Updated API base:",p)}};return chrome.storage.onChanged.addListener(f),()=>chrome.storage.onChanged.removeListener(f)}else l(!0),console.log("[Config] Web mode, using relative URLs")},[]),{config:t,isLoaded:r}}function Ds(){const[t,n]=s.useState([]),r=s.useRef([]),l=s.useCallback(u=>{if(!u.length)return;const c=[...r.current,...u];r.current=c,n(c)},[]),f=s.useCallback(()=>{r.current=[],n([])},[]),a=s.useCallback(u=>u.map(c=>`${c.role==="user"?"User":"Assistant"}: ${c.content}`).join(`

`),[]),h=s.useCallback((u,c)=>{if(c==="compare")return u;const p=u.filter(d=>d.role==="user"),m=[...u].reverse().find(d=>d.role==="assistant"&&d.kind==="analyze_synthesis"&&d.content.trim().length>0);return m?[...p,m]:p},[]);return{history:t,historyRef:r,pushHistoryEntries:l,clearHistory:f,historyToText:a,buildCarryoverHistory:h}}function Os(t){const n=s.useRef({}),r=s.useRef(null),l=s.useCallback(()=>{r.current=null;const c=n.current;n.current={},Object.keys(c).length&&t(m=>m.map(d=>{const v=c[d.id];return v?{...d,response:(d.response||"")+v.answer,thinking:(d.thinking||"")+v.thinking}:d}))},[t]),f=s.useCallback(()=>{r.current==null&&(r.current=requestAnimationFrame(l))},[l]),a=s.useCallback((c,p,m)=>{if(!p&&!m)return;const d=n.current[c]||{answer:"",thinking:""};d.answer+=p,d.thinking+=m,n.current[c]=d,f()},[f]),h=s.useCallback(c=>{n.current[c]&&delete n.current[c]},[]),u=s.useCallback(()=>{n.current={},r.current!=null&&(cancelAnimationFrame(r.current),r.current=null)},[]);return{pendingStreamRef:n,flushStreamRafRef:r,enqueueStreamDelta:a,clearPendingStreamForModel:h,resetPendingStream:u}}function Hs(t,n){const r={...n};let l=r.carry+t;r.carry="";const f=l.lastIndexOf("<");if(f!==-1&&l.length-f<12){const c=l.slice(f);("<think>".startsWith(c)||"</think>".startsWith(c)||"<thinking>".startsWith(c)||"</thinking>".startsWith(c))&&(r.carry=c,l=l.slice(0,f))}let a="",h="";if(r.harmonyFormat){const c="<|channel|>final<|message|>",p=l.indexOf(c);if(p!==-1)r.inThink&&(a+=l.slice(0,p)),r.inThink=!1,h+=l.slice(p+c.length);else if(r.inThink){const m=l.replace(/<\|channel\|>analysis<\|message\|>/gi,"").replace(/<\|end\|>/gi,"").replace(/<\|start\|>/gi,"").replace(/assistant/gi,"");a+=m}else{const m=l.replace(/<\|end\|>/gi,"");h+=m}return{answerAdd:h,thinkingAdd:a,newState:r}}if(!r.inThink&&!r.implicitThinking){const c=l.indexOf("</think>"),p=l.indexOf("</thinking>"),m=c!==-1||p!==-1,d=l.indexOf("<think>")!==-1||l.indexOf("<thinking>")!==-1;m&&!d&&(r.implicitThinking=!0,r.inThink=!0)}let u=0;for(;u<l.length;)if(r.inThink){const c=l.indexOf("</think>",u),p=l.indexOf("</thinking>",u);let m=-1,d=0;if(c!==-1&&(p===-1||c<p)?(m=c,d=8):p!==-1&&(m=p,d=11),m===-1){a+=l.slice(u);break}a+=l.slice(u,m),r.inThink=!1,r.implicitThinking=!1,u=m+d}else{const c=l.indexOf("<think>",u),p=l.indexOf("<thinking>",u);let m=-1,d=0;if(c!==-1&&(p===-1||c<p)?(m=c,d=7):p!==-1&&(m=p,d=10),m===-1){h+=l.slice(u);break}h+=l.slice(u,m),r.inThink=!0,u=m+d}return{answerAdd:h,thinkingAdd:a,newState:r}}function Ws(t){const{mode:n,moderator:r,selected:l,selectedCardIds:f,githubToken:a,isGenerating:h,systemPrompt:u,summarizeSessionResponses:c,setLastQuery:p,setHoveredCard:m,setPhaseLabel:d,setModeratorSynthesis:v,setDiscussionTurnsByModel:R,resetFailedModels:A,markModelFailed:L,failedModelsRef:w,currentDiscussionTurnRef:_,sessionModelIdsRef:i,abortControllerRef:O,thinkingStateRef:F,conversationHistoryRef:G,pushHistoryEntries:j,historyToText:J,buildCarryoverHistory:se,setModelsData:E,modelIdToName:V,setExecutionTimes:I,setIsGenerating:U,setIsSynthesizing:Q,setSpeaking:P,enqueueStreamDelta:te,clearPendingStreamForModel:b,resetPendingStream:W}=t;return{sendMessage:async(we,pe,xe,q)=>{if(!we.trim()||l.length===0&&!xe||!xe&&h)return;const ae=(q==null?void 0:q.skipHistory)??!1,he={role:"user",content:we},ee=ae?G.current:[...G.current,he];ae||j([he]);const _e=se(ee,n),$=J(_e);p(we);const Ee=$?`${$}

Continue the conversation above and respond to the latest user request.`:we;let ne;if(xe)ne=xe;else{const z=Array.from(f).filter(B=>l.includes(B)&&(n==="compare"||B!==r));ne=z.length>0?z:l.slice()}i.current=ne;const fe={},oe=(z,B,C)=>{if(!B)return;const g=C!=null&&C.label?`${C.label}: ${B}`:B;fe[z]=C!=null&&C.replace?g:fe[z]?`${fe[z]}

${g}`:g},de=new AbortController;O.current=de,U(!0),Q(!1),m(null),d(null),v(""),R({}),A(),_.current=null,W(),E(z=>z.map(B=>ne.includes(B.id)||B.id===r?pe&&pe[B.id]?{...B,response:pe[B.id],thinking:void 0,error:void 0}:{...B,response:"",thinking:void 0,error:void 0}:B)),I(z=>{const B={...z},C=performance.now();return ne.forEach(g=>{B[g]={startTime:C}}),r&&!B[r]&&(B[r]={startTime:C}),B});const ge=new Set(ne);r&&ge.add(r),ge.forEach(z=>{const B=hs(z),C=ms(z);F.current[z]={inThink:B||C,carry:"",implicitThinking:B,harmonyFormat:C}});const be=new Set,De=(z,B)=>{const C=z==null?void 0:z.trim();!C||ae||j([{role:"assistant",content:C,kind:B}])},ke=(z,B)=>{const C=F.current[z]||{inThink:!1,carry:"",implicitThinking:!1},{answerAdd:g,thinkingAdd:T,newState:N}=Hs(B,C);F.current[z]=N,g&&oe(z,g),(T||g)&&te(z,g,T)},ye=z=>{const B=z.toLowerCase();return B.includes("rate limit")||B.includes("waiting")?'<svg width="14" height="14" viewBox="0 0 24 24" fill="none" style="display: inline-block; vertical-align: text-bottom; margin-right: 6px;"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none"/><path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>'+z:B.includes("error")||B.includes("failed")?'<svg width="14" height="14" viewBox="0 0 24 24" fill="none" style="display: inline-block; vertical-align: text-bottom; margin-right: 6px;"><path d="M12 2L2 20h20L12 2z" stroke="currentColor" stroke-width="2" fill="none" stroke-linejoin="round"/><path d="M12 9v4M12 17h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>'+z:z};try{if(n==="compare"){P(new Set(ne));const z=ee.map(g=>({role:g.role,content:g.content})),B=u?[{role:"system",content:u},...z]:z,C=await As({models:ne,messages:B,max_tokens:Je.maxTokens,temperature:Je.temperature,github_token:a||null},de.signal);if(await Lt(C,g=>{if(g.event==="info"&&g.content){const T=String(g.content),N=ye(T);d(N),g.model_id&&E(K=>K.map(H=>H.id===g.model_id?{...H,statusMessage:N}:H))}if(g.event==="token"&&g.model_id){const T=g.model_id,N=performance.now();be.has(T)||(be.add(T),I(K=>({...K,[T]:{...K[T],firstTokenTime:N}})),E(K=>K.map(H=>H.id===T?{...H,statusMessage:void 0}:H))),ke(T,String(g.content??""))}if(g.event==="done"&&g.model_id){const T=performance.now(),N=g.model_id;I(K=>({...K,[N]:{...K[N],endTime:T}})),P(K=>{const H=new Set(K);return H.delete(N),H})}}),!ae){const g=c(fe,ne);g&&j([{role:"assistant",content:g,kind:"compare_summary"}])}return}if(n==="analyze"){const z=ne;if(z.length<2){const g="Select at least 2 participants for Analyze mode.";v(g),r&&E(T=>T.map(N=>N.id===r?{...N,response:g}:N)),d("Error");return}P(new Set(z));const B=await _s({query:Ee,participants:z,max_tokens:Je.maxTokens,github_token:a||null,system_prompt:u||null},de.signal);let C="";if(await Lt(B,g=>{const T=g.event;if(T==="analyze_start"&&d("Collecting Responses"),T==="model_start"&&g.model_id){const N=g.model_id;P(K=>{const H=new Set(K);return H.add(N),H})}if(T==="model_chunk"&&g.model_id){const N=g.model_id,K=performance.now();be.has(N)||(be.add(N),I(H=>({...H,[N]:{...H[N],firstTokenTime:K}}))),ke(N,String(g.chunk??""))}if(T==="model_response"&&g.model_id){const N=g.model_id,K=performance.now();I(X=>({...X,[N]:{...X[N],endTime:K}})),P(X=>{const Z=new Set(X);return Z.delete(N),Z});const H=String(g.response??"");oe(N,H,{replace:!0}),pe&&pe[N]||(E(X=>X.map(Z=>Z.id===N?{...Z,response:H}:Z)),De(`${V(N)}:
${H}`,"analyze_response"))}if(T==="model_error"&&g.model_id){const N=g.model_id,K=performance.now();I(X=>({...X,[N]:{...X[N],endTime:K}})),P(X=>{const Z=new Set(X);return Z.delete(N),Z});const H=String(g.error??"Error generating response.");b(N),E(X=>X.map(Z=>Z.id===N?{...Z,response:H,error:H}:Z)),L(N),oe(N,H,{replace:!0})}if(T==="analysis_complete"){d("Analysis Complete");const N=g.consensus||[],K=g.unique_contributions||{};let H=`Analysis:

`;if(N.length>0&&(H+=`Consensus:
`+N.map(X=>`• ${X}`).join(`
`)+`

`),Object.keys(K).length>0){H+=`Unique Contributions:
`;for(const[X,Z]of Object.entries(K)){const Se=V(X);H+=`
${Se}:
`+Z.map(Ce=>`• ${Ce}`).join(`
`)+`
`}}C=H,v(H),r&&E(X=>X.map(Z=>Z.id===r?{...Z,response:H}:Z))}if(T==="analyze_complete"&&(d("Complete"),P(new Set)),T==="error"){const N=String(g.error??"Analyze error.");v(N),d("Error")}}),!ae){const g=C.trim();g&&j([{role:"assistant",content:g,kind:"analyze_synthesis"}])}return}if(n==="debate"){const z=ne;if(z.length<2){const C="Select at least 2 participants for Debate mode.";v(C),r&&E(g=>g.map(T=>T.id===r?{...T,response:C}:T)),d("Error");return}const B=await Is({query:Ee,participants:z,turns:2,max_tokens:Je.maxTokens,temperature:Je.temperature,github_token:a||null,system_prompt:u||null},de.signal);await Lt(B,C=>{const g=C.event;if(g==="debate_start"&&d("Debate Starting"),g==="round_start"){const T=C.round_number??0;d(`Round ${T+1}`)}if(g==="turn_start"&&C.model_id){const T=C.model_id,N=C.turn_number??0,K=C.round_number??0;P(new Set([T])),d(`Round ${K+1} · Turn ${N+1}`),_.current={modelId:T,turnNumber:N}}if(g==="turn_chunk"&&C.model_id){const T=C.model_id,N=performance.now();be.has(T)||(be.add(T),I(K=>({...K,[T]:{...K[T],firstTokenTime:N}}))),ke(T,String(C.chunk??""))}if(g==="turn_complete"&&C.model_id){const T=C.model_id,N=performance.now();I(X=>({...X,[T]:{...X[T],endTime:N}})),P(X=>{const Z=new Set(X);return Z.delete(T),Z});const K=String(C.response??""),H=C.turn_number??0;oe(T,K,{replace:!0}),E(X=>X.map(Z=>Z.id===T?{...Z,response:K}:Z)),R(X=>({...X,[T]:[...X[T]||[],{turn_number:H,response:K}]})),De(`${V(T)}:
${K}`,"debate_turn")}if(g==="turn_error"&&C.model_id){const T=C.model_id,N=performance.now();I(H=>({...H,[T]:{...H[T],endTime:N}})),P(H=>{const X=new Set(H);return X.delete(T),X});const K=String(C.error??"Turn error.");b(T),E(H=>H.map(X=>X.id===T?{...X,response:K,error:K}:X)),L(T)}if(g==="debate_complete"&&(d("Complete"),P(new Set)),g==="error"){const T=String(C.error??"Debate error.");d("Error"),v(T)}});return}}catch(z){if(z.name==="AbortError")return;if(console.error("Chat error:",z),O.current===de){const B=z.message||String(z);v(`Session Error: ${B}`),d("Error"),W(),E(C=>C.map(g=>ne.includes(g.id)&&!g.response?{...g,response:"Error generating response."}:g)),ne.forEach(C=>L(C))}}finally{if(O.current===de){const z=performance.now();I(B=>{const C={...B};return i.current.forEach(g=>{C[g]&&!C[g].endTime&&(C[g]={...C[g],endTime:z})}),C}),U(!1),Q(!1),d(B=>B==="Error"?B:null),P(new Set)}}}}}function At(t,n){const r=Math.min(t.x,n.x),l=Math.min(t.y,n.y),f=Math.max(t.x,n.x),a=Math.max(t.y,n.y);return{left:r,top:l,right:f,bottom:a,width:f-r,height:a-l}}function Gs({rootContainerRef:t,visualizationAreaRef:n,arenaOffsetYRef:r,arenaTargetYRef:l,wheelRafRef:f,selectedModels:a,cardRefs:h,selectedCardIds:u,setSelectedCardIds:c,suppressClickRef:p}){const[m,d]=s.useState(null),v=s.useRef(!1);s.useEffect(()=>{v.current=m!=null},[m]),s.useEffect(()=>{const L=w=>{if(w.button!==0||!t.current)return;const _=w.target;if(!_)return;const i=_.closest("[data-card]"),O=_.closest('button, a, input, textarea, select, [role="button"]'),F=_.closest("[draggable]"),G=_.closest("[data-no-arena-scroll]");if(i||O||F||G||!t.current.contains(_))return;l.current=r.current,f.current!=null&&(cancelAnimationFrame(f.current),f.current=null);const j=t.current.getBoundingClientRect(),J={x:w.clientX-j.left,y:w.clientY-j.top};w.preventDefault(),v.current=!0,p.current.card=!1,p.current.background=!1,d({origin:J,current:J,active:!1})};return window.addEventListener("mousedown",L,!0),()=>window.removeEventListener("mousedown",L,!0)},[r,l,f,t,n,p]),s.useEffect(()=>{if(!m||!t.current)return;const L=i=>i.preventDefault();document.addEventListener("selectstart",L);const w=i=>{const O=t.current.getBoundingClientRect(),F={x:i.clientX-O.left,y:i.clientY-O.top};d(G=>{if(!G)return G;const j=At(G.origin,F),J=G.active||j.width>4||j.height>4;return{...G,current:F,active:J}})},_=i=>{v.current=!1;const O=t.current.getBoundingClientRect(),F={x:i.clientX-O.left,y:i.clientY-O.top},G=i.target,j=!!(G&&G.closest("[data-card]"));d(J=>{if(!J)return null;const se=At(J.origin,F);if(J.active&&se.width>0&&se.height>0){const E=[],V=t.current.getBoundingClientRect(),I={left:V.left+se.left,right:V.left+se.right,top:V.top+se.top,bottom:V.top+se.bottom};for(const U of a){const Q=h.current.get(U.id);if(!Q)continue;const P=Q.getBoundingClientRect();!(P.right<I.left||P.left>I.right||P.bottom<I.top||P.top>I.bottom)&&E.push(U.id)}c(new Set(E)),j?p.current.card=!0:E.length>0&&(p.current.background=!0)}return null})};return window.addEventListener("mousemove",w),window.addEventListener("mouseup",_),()=>{window.removeEventListener("mousemove",w),window.removeEventListener("mouseup",_),document.removeEventListener("selectstart",L)}},[m,t,n,a,h,u,c,p]);const R=s.useMemo(()=>{if(!m||!m.active)return null;const L=At(m.origin,m.current);return L.width<=0||L.height<=0?null:{left:L.left,top:L.top,width:L.width,height:L.height}},[m]),A=s.useCallback(()=>{d(null),v.current=!1},[]);return{selectionRect:R,isSelecting:m!=null,dragSelectionActiveRef:v,clearSelection:A}}function Ys({visualizationAreaRef:t,cardRefs:n,selected:r,setSelected:l,mode:f,gridCols:a,getCirclePosition:h}){const[u,c]=s.useState(null),p=s.useCallback((m,d)=>{if(m.button!==0||m.target.closest('button, a, input, textarea, select, [role="button"]'))return;m.preventDefault();const R=n.current.get(d);if(!R||!t.current)return;const A=R.getBoundingClientRect(),L=t.current.getBoundingClientRect(),w=A.left+A.width/2,_=A.top+A.height/2;c({activeId:d,currX:m.clientX,currY:m.clientY,offsetX:w-m.clientX,offsetY:_-m.clientY,containerLeft:L.left,containerTop:L.top,containerWidth:L.width,containerHeight:L.height,cardHeight:A.height}),m.target.setPointerCapture(m.pointerId)},[t]);return s.useEffect(()=>{if(!u)return;const m=v=>{if(c(_=>_?{..._,currX:v.clientX,currY:v.clientY}:null),!t.current)return;const R=t.current.getBoundingClientRect(),A=r.indexOf(u.activeId);let L=1/0,w=-1;if(f==="compare"){const _=v.clientX-(R.left+R.width/2),i=v.clientY-R.top,O=(re.cardWidth+re.gapX)*a-re.gapX;r.forEach((F,G)=>{const j=Math.floor(G/a),se=G%a*(re.cardWidth+re.gapX)-O/2+re.cardWidth/2,E=j*(re.cardHeight+re.gapY),V=se,I=E+re.cardHeight/2,U=(_-V)**2+(i-I)**2;U<L&&(L=U,w=G)})}else{const _=v.clientX-(R.left+R.width/2),i=v.clientY-(R.top+R.height/2),O=Math.max(re.baseRadius,re.minRadius+r.length*re.radiusPerModel);r.forEach((F,G)=>{const j=h(G,r.length,f,O),J=(_-j.x)**2+(i-j.y)**2;J<L&&(L=J,w=G)})}if(w!==-1&&w!==A){const _=[...r],[i]=_.splice(A,1);_.splice(w,0,i),l(_)}},d=()=>c(null);return window.addEventListener("pointermove",m),window.addEventListener("pointerup",d),()=>{window.removeEventListener("pointermove",m),window.removeEventListener("pointerup",d)}},[u,t,n,r,l,f,a,h]),{dragState:u,handlePointerDown:p}}function Fs({mode:t,showSettings:n,showDock:r,contextMenu:l,selectedCardIds:f,selected:a,inputRef:h,setShowSettings:u,setShowDock:c,setContextMenu:p,setSelected:m,setSelectedCardIds:d,clearSelection:v,setHoveredCard:R,handleModeChange:A}){s.useEffect(()=>{const L=w=>{if(w.key==="Escape"){const i=document.activeElement;if(i&&i!==document.body&&i.blur(),n){u(!1);return}if(l){p(null);return}if(f.size>0){v(),R(null);return}if(r){c(!1);return}R(null);return}if((w.metaKey||w.ctrlKey)&&(w.key==="a"||w.key==="A")){const i=w.target;if(i.tagName==="INPUT"||i.tagName==="TEXTAREA"||t==="chat")return;w.preventDefault(),a.length>0&&d(new Set(a));return}const _=w.target;if(!(_.tagName==="INPUT"||_.tagName==="TEXTAREA")){if(w.key==="ArrowRight"||w.key==="ArrowLeft"){w.preventDefault();const i=["chat","compare","analyze","debate"],O=i.indexOf(t);if(O!==-1){const F=w.key==="ArrowRight"?1:-1,G=(O+F+i.length)%i.length;A(i[G])}return}if(w.key==="m"||w.key==="M"){w.preventDefault(),c(!r);return}if((w.key==="Delete"||w.key==="Backspace")&&f.size>0){w.preventDefault(),m(i=>i.filter(O=>!f.has(O))),v();return}w.key.length===1&&!w.ctrlKey&&!w.metaKey&&!w.altKey&&h.current&&h.current.focus()}};return window.addEventListener("keydown",L),()=>window.removeEventListener("keydown",L)},[r,n,l,f,t,a,h,u,c,p,m,d,v,R,A])}function Us({visualizationAreaRef:t,dragSelectionActiveRef:n}){const r=s.useRef(0),l=s.useRef(0),f=s.useRef(null),a=s.useRef(!1),h=s.useRef(0),u=d=>{const v=t.current;v&&v.style.setProperty("--arena-offset-y",`${d}px`)},c=d=>Math.max(-200,Math.min(re.scrollClamp,d)),p=()=>{const d=r.current,v=l.current,R=v-d;if(Math.abs(R)<.5){r.current=v,u(v),f.current=null;return}const A=d+R*.35;r.current=A,u(A),f.current=requestAnimationFrame(p)},m=()=>{f.current==null&&(f.current=requestAnimationFrame(p))};return s.useEffect(()=>{const d=w=>{if(n.current)return;const _=w.target;if(_&&_.closest("input, textarea, [data-no-arena-scroll]"))return;w.preventDefault();const i=w.deltaY*.9,O=l.current-i;l.current=c(O),m()},v=w=>w?!!w.closest('input, textarea, [data-no-arena-scroll], [data-card], button, a, select, [role="button"]'):!1,R=w=>{if(w.touches.length!==1)return;const _=w.target;v(_)||(a.current=!0,h.current=w.touches[0].clientY)},A=w=>{if(n.current||!a.current||w.touches.length!==1)return;const _=w.target;if(v(_)){a.current=!1;return}const i=w.touches[0].clientY,O=i-h.current;h.current=i,w.preventDefault(),l.current=c(l.current+O),m()},L=()=>{a.current=!1};return window.addEventListener("touchstart",R,{passive:!0}),window.addEventListener("touchmove",A,{passive:!1}),window.addEventListener("touchend",L),window.addEventListener("touchcancel",L),window.addEventListener("wheel",d,{passive:!1}),()=>{window.removeEventListener("touchstart",R),window.removeEventListener("touchmove",A),window.removeEventListener("touchend",L),window.removeEventListener("touchcancel",L),window.removeEventListener("wheel",d),f.current!=null&&cancelAnimationFrame(f.current)}},[]),{arenaOffsetYRef:r,arenaTargetYRef:l,wheelRafRef:f,applyOffset:u,clampTarget:c,ensureRaf:m}}function je(t,n){return!t||!t.startsWith("#")?t:t.length===7||t.length===4?`${t}${n}`:t}const Xs={idle:"Ready",responding:"Responding",done:"Done",waiting:"Waiting",error:"Error"};function It({state:t,color:n,size:r=16,label:l,className:f=""}){const a={width:`${r}px`,height:`${r}px`},h=l??Xs[t],u=Math.max(2,Math.round(r*.14)),c=Math.max(12,r-2),p="#fbbf24",m=je(n,"cc"),d=()=>{switch(t){case"responding":return e.jsx("div",{className:"relative flex items-center justify-center",style:a,children:e.jsxs("svg",{width:c,height:c,viewBox:"0 0 24 24",fill:"none",className:"",style:{filter:`drop-shadow(0 0 6px ${je(p,"55")})`,animation:"spin 0.6s linear infinite"},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"spinnerGradient",gradientUnits:"userSpaceOnUse",x1:"3",y1:"12",x2:"12",y2:"3",children:[e.jsx("stop",{offset:"0%",stopColor:p,stopOpacity:"1"}),e.jsx("stop",{offset:"60%",stopColor:p,stopOpacity:"0.5"}),e.jsx("stop",{offset:"100%",stopColor:p,stopOpacity:"0"})]})}),e.jsx("circle",{cx:"12",cy:"12",r:"9",stroke:je(p,"15"),strokeWidth:u,fill:"none"}),e.jsx("path",{d:"M 12 3 A 9 9 0 1 1 3 12",stroke:"url(#spinnerGradient)",strokeWidth:u,strokeLinecap:"round",fill:"none"}),e.jsx("circle",{cx:"3",cy:"12",r:u*.7,fill:p})]})});case"done":return e.jsx("div",{className:"flex items-center justify-center rounded-full",style:{...a,background:je(n,"14"),border:`1px solid ${je(n,"99")}`},children:e.jsx("svg",{width:c,height:c,viewBox:"0 0 24 24",fill:"none",children:e.jsx("polyline",{points:"5 13 10 18 19 7",stroke:n,strokeWidth:u,strokeLinecap:"round",strokeLinejoin:"round"})})});case"error":const v="#ef4444";return e.jsx("div",{className:"flex items-center justify-center rounded-full",style:{...a,background:je(v,"14"),border:`1px solid ${je(v,"99")}`},children:e.jsx("svg",{width:c,height:c,viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M6 6L18 18M6 18L18 6",stroke:v,strokeWidth:u,strokeLinecap:"round",strokeLinejoin:"round"})})});case"waiting":return e.jsxs("div",{className:"relative flex items-center justify-center",style:a,children:[e.jsx("div",{className:"absolute inset-0 rounded-full",style:{border:`1px solid ${je(m,"99")}`}}),e.jsx("svg",{width:c,height:c,viewBox:"0 0 24 24",fill:"none",style:{animation:"spin 5s linear infinite"},children:e.jsx("circle",{cx:"12",cy:"12",r:"8.5",stroke:je(m,"44"),strokeWidth:u-1,strokeDasharray:"6 10",strokeLinecap:"round"})}),e.jsx("div",{className:"absolute w-2 h-2 rounded-full",style:{background:je(m,"aa"),animation:"pulse 1.5s ease-in-out infinite"}})]});default:return e.jsxs("div",{className:"relative flex items-center justify-center",style:a,children:[e.jsx("div",{className:"absolute inset-0 rounded-full",style:{border:"1px solid rgba(71, 85, 105, 0.5)"}}),e.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:"rgba(148, 163, 184, 0.6)",animation:"pulse 2.4s ease-in-out infinite"}})]})}};return e.jsx("div",{className:`inline-flex items-center justify-center ${f}`,title:h,children:d()})}function an({times:t,isFastestTTFT:n,isFastestTotal:r}){const l=(t==null?void 0:t.startTime)!=null,f=(t==null?void 0:t.endTime)!=null,a=(t==null?void 0:t.firstTokenTime)!=null,h=l&&f?((t.endTime-t.startTime)/1e3).toFixed(2):null,u=l&&a?((t.firstTokenTime-t.startTime)/1e3).toFixed(2):null;return e.jsxs("div",{className:"text-[10px] text-slate-500 flex items-center gap-2",children:[e.jsxs("span",{className:r?"text-yellow-400/90 bg-yellow-500/10 px-1.5 py-0.5 rounded":void 0,title:r?"Fastest":void 0,children:[e.jsx("span",{className:r?void 0:"text-slate-400",children:"TIME"})," ",h?`${h}s`:l&&!f?"...":"—"]}),u&&e.jsxs("span",{className:n?"text-amber-400/90 bg-amber-500/10 px-1.5 py-0.5 rounded":"text-slate-600",title:n?"Fastest TTFT":void 0,children:["TTFT ",u,"s"]})]})}const Pt=({text:t,speed:n=5})=>{const[r,l]=s.useState(""),f=s.useRef(0),a=s.useRef(null);return s.useEffect(()=>{!t.startsWith(r)&&r!==""&&(l(""),f.current=0)},[t]),s.useEffect(()=>{a.current!=null&&(clearTimeout(a.current),a.current=null);const h=t.length;if(f.current>=h)return;const u=()=>{const c=f.current,p=h-c;if(p<=0)return;const m=p>120?12:p>40?4:p>10?2:1,d=Math.min(h,c+m);f.current=d,l(t.slice(0,d));const R=h-d>5?0:n;a.current=window.setTimeout(u,R)};return a.current=window.setTimeout(u,n),()=>{a.current!=null&&(clearTimeout(a.current),a.current=null)}},[t,n]),e.jsx("span",{children:r})},ht=96;function Ks(t){switch(t){case"error":return"Error";case"responding":return"Responding";case"done":return"Done";case"waiting":return"Waiting";default:return"Ready"}}function qs({mode:t,layoutRadius:n,moderatorModel:r,moderatorId:l,orchestratorTransform:f,orchestratorStatus:a,moderatorSynthesis:h,isSynthesizing:u,isGenerating:c,phaseLabel:p,speaking:m,hoveredCard:d,setHoveredCard:v,setSelectedCardIds:R,lastSelectedCardRef:A,orchestratorAutoMode:L,orchestratorAutoScope:w,showOrchestratorMenu:_,setShowOrchestratorMenu:i,setOrchestratorAutoMode:O,setOrchestratorAutoScope:F,orchestratorMenuRef:G,availableModels:j,setModerator:J,getTailSnippet:se}){const[E,V]=s.useState(null),I=Ks(a),U=p||"";s.useEffect(()=>{if(!_)return;const b=W=>{G.current&&!G.current.contains(W.target)&&(i(!1),V(null))};return document.addEventListener("mousedown",b,!0),()=>document.removeEventListener("mousedown",b,!0)},[_,G,i]);const Q=()=>{if(h)return u&&l&&m.has(l)?e.jsx(Pt,{text:h,speed:20}):se(h);if(u)return e.jsx("span",{className:"text-slate-500 italic",children:"Synthesizing responses..."});if(c){if(p!=null&&p.startsWith("<svg"))return e.jsx("span",{className:"text-slate-500 italic",dangerouslySetInnerHTML:{__html:p}});const b=p==="Stage 1 · Responses"?"Waiting for model responses...":p||"Orchestrating...";return e.jsx("span",{className:"text-slate-500 italic",children:b})}return e.jsx("span",{className:"text-slate-500 italic",children:"Send a prompt to see the synthesis."})},P=a==="responding",te=P?"#fbbf24":r.color;return e.jsxs("div",{"data-card":!0,className:"absolute z-20 transition-all duration-700 ease-out cursor-pointer",style:{opacity:1,transform:f,left:"50%",top:t==="analyze"?`calc(50% + ${n}px - 64px)`:"50%"},onClick:b=>{b.stopPropagation(),l&&(R(new Set([l])),A.current=l)},onContextMenu:b=>{b.preventDefault(),b.stopPropagation(),_?(i(!1),V(null)):(V({x:b.clientX,y:b.clientY}),i(!0))},onMouseEnter:()=>v("moderator"),onMouseLeave:()=>v(null),children:[e.jsxs("div",{className:"relative flex items-center justify-center",style:{width:`${ht}px`,height:`${ht}px`},children:[e.jsx("div",{className:"absolute inset-0 rounded-full animate-pulse",style:{background:`radial-gradient(circle, ${te}20 0%, transparent 70%)`,transform:"scale(2.2)",filter:"blur(18px)"}}),e.jsxs("div",{className:"relative rounded-full flex items-center justify-center transition-all duration-300",style:{width:`${ht}px`,height:`${ht}px`,background:P?"linear-gradient(135deg, rgba(251, 191, 36, 0.08), rgba(15, 23, 42, 0.9))":"rgba(15, 23, 42, 0.9)",backdropFilter:"blur(16px)",border:`2px solid ${te}${P?"99":"60"}`,boxShadow:`0 0 36px ${te}${P?"40":"28"}, inset 0 1px 1px rgba(255,255,255,0.1)`},children:[e.jsx("div",{className:"absolute inset-[-4px] rounded-full",style:{background:`conic-gradient(from 0deg, transparent, ${te}60, transparent)`,animation:"spin 4s linear infinite"}}),e.jsx("div",{className:"absolute inset-[2px] rounded-full",style:{background:"rgba(15, 23, 42, 0.96)"}}),e.jsxs("div",{className:"relative text-center z-10 flex flex-col items-center gap-1.5 px-3",children:[e.jsx("div",{className:"text-[7px] tracking-[0.32em] text-slate-400 uppercase",children:I}),e.jsx("div",{className:"text-[10px] font-semibold text-slate-100 leading-tight",children:r.name}),e.jsx(It,{state:a,color:te,size:12})]})]})]}),e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 flex flex-col items-center gap-1 w-max max-w-[200px]",style:{top:"calc(100% + 12px)"},children:e.jsx("span",{className:"text-[10px] text-slate-500",children:U})}),d==="moderator"&&!_&&e.jsxs("div",{"data-card":!0,onClick:b=>b.stopPropagation(),className:"absolute bottom-full mb-4 left-1/2 -translate-x-1/2 w-80 max-w-[calc(100vw-2rem)] p-4 rounded-xl z-[200] transition-all duration-300",style:{background:"rgba(15, 23, 42, 0.95)",backdropFilter:"blur(16px)",border:`1px solid ${te}40`,boxShadow:`0 20px 40px rgba(0,0,0,0.5), 0 0 30px ${te}20`},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"Orchestrator"}),e.jsx("span",{className:"text-xs text-slate-500",children:"·"}),e.jsx("span",{className:"text-xs font-medium text-slate-300",children:r.name}),P&&e.jsx("span",{className:"text-[9px] uppercase tracking-wider px-1.5 py-0.5 rounded bg-yellow-500/20 text-yellow-300 border border-yellow-500/30",children:"Working"})]}),e.jsx("p",{className:"text-sm text-slate-300 leading-relaxed",children:Q()})]}),_&&E&&ss.createPortal(e.jsx("div",{ref:G,className:"w-64 bg-slate-800 border border-slate-700 rounded-lg shadow-xl overflow-hidden",style:{position:"fixed",top:`${E.y}px`,left:`${E.x}px`,transform:"translateY(-50%)",zIndex:9999},onClick:b=>b.stopPropagation(),children:L?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-3 py-2 text-[10px] uppercase tracking-wider text-slate-500 font-semibold border-b border-slate-700/50",children:["Auto Mode: ",w==="self-hosted"?"SELF-HOSTED":w.toUpperCase()]}),["all","self-hosted","api"].map(b=>e.jsxs("button",{onClick:()=>{F(b),i(!1)},className:`w-full px-3 py-2 text-left text-xs font-medium transition-colors ${w===b?"bg-yellow-500/20 text-yellow-300":"text-slate-300 hover:bg-slate-700/50"}`,children:[b==="all"&&"All",b==="self-hosted"&&"Self-hosted",b==="api"&&"API",e.jsxs("span",{className:"text-[10px] text-slate-500 ml-1",children:[b==="all"&&"(self-hosted → API)",b==="self-hosted"&&"(no quota)",b==="api"&&"(cloud only)"]})]},b)),e.jsx("div",{className:"border-t border-slate-700",children:e.jsx("button",{onClick:()=>{O(!1),i(!1)},className:"w-full px-3 py-2 text-left text-xs font-medium text-slate-400 hover:bg-slate-700/50 transition-colors",children:"Manual Mode"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-3 py-2 text-[10px] uppercase tracking-wider text-slate-500 font-semibold border-b border-slate-700/50",children:"Select Orchestrator"}),j.filter(b=>b.type==="github").length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-3 py-1.5 text-[9px] uppercase tracking-wider text-slate-600 font-semibold",children:"GitHub Models"}),j.filter(b=>b.type==="github").map(b=>e.jsx("button",{onClick:()=>{J(b.id),i(!1)},className:`w-full px-4 py-2 text-left text-xs font-medium transition-colors ${l===b.id?"bg-blue-500/20 text-blue-300":"text-slate-300 hover:bg-slate-700/50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:b.name}),l===b.id&&e.jsx("span",{className:"text-blue-400",children:"✓"})]})},b.id))]}),j.filter(b=>b.type==="self-hosted").length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-3 py-1.5 text-[9px] uppercase tracking-wider text-slate-600 font-semibold border-t border-slate-700/50 mt-1",children:"Self-Hosted Models"}),j.filter(b=>b.type==="self-hosted").map(b=>e.jsx("button",{onClick:()=>{J(b.id),i(!1)},className:`w-full px-4 py-2 text-left text-xs font-medium transition-colors ${l===b.id?"bg-blue-500/20 text-blue-300":"text-slate-300 hover:bg-slate-700/50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:b.name}),l===b.id&&e.jsx("span",{className:"text-blue-400",children:"✓"})]})},b.id))]}),e.jsx("div",{className:"border-t border-slate-700",children:e.jsxs("button",{onClick:()=>{O(!0),i(!1)},className:"w-full px-3 py-2 text-left text-xs font-medium text-yellow-400 hover:bg-slate-700/50 transition-colors flex items-center gap-2",children:[e.jsx(rs,{size:12}),e.jsx("span",{children:"Enable Auto Mode"})]})})]})}),document.body)]})}const mt=256,dn=200,ln=96;function Vs(t){const{mode:n,selectedModels:r,gridCols:l,speaking:f,selectedCardIds:a,setSelectedCardIds:h,executionTimes:u,failedModels:c,cardRefs:p,handlePointerDown:m,dragState:d,setContextMenu:v,suppressClickRef:R,getTailSnippet:A,hoveredCard:L,setHoveredCard:w,setExpandedModelId:_,layoutRadius:i,getCirclePosition:O,moderatorModel:F,moderatorId:G,orchestratorTransform:j,orchestratorStatus:J,moderatorSynthesis:se,isSynthesizing:E,isGenerating:V,phaseLabel:I,linesTransitioning:U,lastSelectedCardRef:Q,orchestratorAutoMode:P,orchestratorAutoScope:te,showOrchestratorMenu:b,setShowOrchestratorMenu:W,setOrchestratorAutoMode:ue,setOrchestratorAutoScope:we,orchestratorMenuRef:pe,availableModels:xe,setModerator:q,fastestTTFT:ae,fastestTotal:he}=t,ee=n!=="compare",_e=n==="analyze"?i-64:0;return e.jsxs(e.Fragment,{children:[r.map(($,Ee)=>{var tt;const ne=O(Ee,r.length,n,i),fe=Qs(Ee,l),oe=f.has($.id),de=a.has($.id),ge=c.has($.id),be=!oe&&!ge&&!!((tt=u[$.id])!=null&&tt.endTime)&&$.response.trim().length>0,ke=rr(oe,be,ge,!oe&&!be&&!ge&&V&&n==="debate"),ye=sr(ke),z="#fbbf24",B="#ef4444",C=$.type==="self-hosted"?"#10b981":"#3b82f6",g=ge?B:C,T=oe&&!ge,N=or({hasError:ge,isProcessing:T,isSelected:de,errorColor:B,processingColor:z,typeColor:C}),K=Js({mode:n,gridX:fe.gridX,gridY:fe.gridY,circleX:ne.x,circleY:ne.y,dragState:d,modelId:$.id}),H=L===$.id,X=ee?ln:mt,Z=ee?ln:dn,Se=Math.max(800,i*2+600),Ce=Se/2,Ze=Ce,Me=Ce,ie=Ce+(0-ne.x),et=Ce+(_e-ne.y);return e.jsxs("div",{ref:le=>{le?p.current.set($.id,le):p.current.delete($.id)},onPointerDown:le=>m(le,$.id),className:"absolute",onContextMenu:le=>{le.preventDefault(),le.stopPropagation(),v({x:le.clientX,y:le.clientY,modelId:$.id})},style:{transform:K,zIndex:ee?H?300:de?40:oe?15:5:de?20:oe?10:1,left:"50%",top:ee?"50%":"0",transition:(d==null?void 0:d.activeId)===$.id?"none":"transform 300ms cubic-bezier(0.2, 0, 0.2, 1)"},children:[ee&&oe&&!ge&&!U&&e.jsxs("svg",{className:"absolute pointer-events-none",style:{width:`${Se}px`,height:`${Se}px`,top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:-1},viewBox:`0 0 ${Se} ${Se}`,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:`grad-${$.id}`,gradientUnits:"userSpaceOnUse",x1:Ze,y1:Me,x2:ie,y2:et,children:[e.jsx("stop",{offset:"0%",stopColor:z,stopOpacity:"0.45"}),e.jsx("stop",{offset:"100%",stopColor:z,stopOpacity:"0.12"})]})}),e.jsx("line",{x1:Ze,y1:Me,x2:ie,y2:et,stroke:`url(#grad-${$.id})`,strokeWidth:"2",strokeDasharray:"6,4",strokeLinecap:"round",className:"animate-flow arena-link"})]}),e.jsxs("div",{"data-card":!0,onClick:le=>Zs({e:le,modelId:$.id,suppressClickRef:R,setSelectedCardIds:h,selectedModels:r,lastSelectedCardRef:Q}),onDoubleClick:le=>{le.stopPropagation(),!ee&&_&&_($.id)},onMouseEnter:()=>ee&&w($.id),onMouseLeave:()=>ee&&w(null),className:`relative cursor-grab active:cursor-grabbing card-hover ${ee?"rounded-full":""} ${de?"card-selected":""} ${oe?"card-speaking":""}`,style:{background:N.background,backdropFilter:ee?void 0:"blur(8px)",WebkitBackdropFilter:ee?void 0:"blur(8px)",border:N.border,boxShadow:N.shadow,transform:de||T?"scale(1.05)":"scale(1)",width:`${X}px`,height:`${Z}px`,borderRadius:ee?"50%":"12px",transition:"transform 180ms ease-out, box-shadow 180ms ease-out, border-color 180ms ease-out, width 0.7s cubic-bezier(0.4, 0, 0.2, 1), height 0.7s cubic-bezier(0.4, 0, 0.2, 1), border-radius 0.7s cubic-bezier(0.4, 0, 0.2, 1)"},children:[!ee&&e.jsxs("div",{style:nr,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3 gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5 min-w-0",children:[e.jsx(It,{state:ke,color:g,size:16,label:ye}),e.jsx("span",{className:"text-xs font-semibold text-slate-200 truncate",children:$.name})]}),e.jsx("div",{className:"flex items-center gap-1.5 shrink-0",children:e.jsx("span",{className:`text-[9px] uppercase tracking-wider px-1.5 py-0.5 rounded ${$.type==="self-hosted"?"bg-emerald-500/10 text-emerald-300 border border-emerald-500/30":"bg-blue-500/10 text-blue-300 border border-blue-500/30"}`,children:$.type==="self-hosted"?"Self-hosted":"API"})})]}),e.jsx("p",{className:"text-xs text-slate-400 leading-relaxed line-clamp-3 flex-1",children:er({model:$,isSpeaking:oe,thinkingFallback:e.jsx("span",{className:"text-slate-500 italic",children:"Generating…"}),getTailSnippet:A})}),e.jsx("div",{className:"flex items-center gap-4 mt-3 pt-3 border-t border-slate-700/50",children:e.jsx(an,{times:u[$.id],isFastestTTFT:ae===$.id,isFastestTotal:he===$.id})})]}),ee&&e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center text-center",style:{transition:"opacity 0.3s ease-out"},children:[e.jsx("div",{className:"absolute inset-[3px] rounded-full border border-white/5",style:{boxShadow:`inset 0 0 20px ${g}15`}}),e.jsx("div",{className:"absolute inset-[-6px] rounded-full opacity-60",style:{background:`radial-gradient(circle, ${g}22 0%, transparent 65%)`,filter:"blur(10px)"}}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center gap-1.5 px-3",children:[e.jsx("div",{className:"text-[7px] tracking-[0.32em] text-slate-400 uppercase",children:ye}),e.jsx("div",{className:"text-[10px] font-semibold text-slate-100 leading-tight",children:$.name}),e.jsx(It,{state:ke,color:g,size:12})]})]})]}),n==="analyze"&&ee&&$.personaEmoji&&e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 flex items-center justify-center pointer-events-none select-none",style:{bottom:"-12px",fontSize:"20px",zIndex:100,transition:"transform 180ms ease-out",transform:oe?"scale(1.15)":"scale(1)",filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.5)) drop-shadow(0 0 8px rgba(0,0,0,0.3))"},title:$.personaName?`${$.personaName} - ${$.personaTrait}`:"Persona",children:$.personaEmoji}),ee&&oe&&$.thinking&&$.thinking.trim().length>0&&$.response.trim().length===0&&e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 flex items-center justify-center pointer-events-none select-none animate-pulse",style:{bottom:"-12px",fontSize:"18px",zIndex:100,filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.5)) drop-shadow(0 0 10px rgba(168, 85, 247, 0.4))"},title:"Thinking...",children:"💭"}),ee&&L===$.id&&e.jsxs("div",{"data-card":!0,onClick:le=>le.stopPropagation(),className:"absolute w-64 max-w-[calc(100vw-2rem)] p-4 rounded-xl transition-all duration-300 z-[220]",style:{top:ne.y>0?"auto":"100%",bottom:ne.y>0?"100%":"auto",left:"50%",transform:"translateX(-50%)",marginTop:ne.y>0?0:"12px",marginBottom:ne.y>0?"12px":0,background:"rgba(15, 23, 42, 0.95)",backdropFilter:"blur(16px)",border:`1px solid ${g}40`,boxShadow:`0 20px 40px rgba(0,0,0,0.5), 0 0 20px ${g}15`},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:g}}),e.jsx("span",{className:"text-xs font-semibold text-slate-300",children:$.name})]}),n==="analyze"&&$.personaEmoji&&$.personaName&&e.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-2 border-b border-slate-700/50",children:[e.jsx("span",{className:"text-base",children:$.personaEmoji}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs font-semibold text-blue-400",children:$.personaName}),$.personaTrait&&e.jsx("div",{className:"text-[10px] text-slate-500",children:$.personaTrait})]})]}),e.jsx("p",{className:"text-xs text-slate-400 leading-relaxed whitespace-pre-wrap",children:tr({model:$,isSpeaking:oe,getTailSnippet:A})}),e.jsx("div",{className:"flex items-center gap-4 mt-3 pt-2 border-t border-slate-700/50",children:e.jsx(an,{times:u[$.id]})})]})]},$.id)}),n!=="compare"&&F&&e.jsx(qs,{mode:n,layoutRadius:i,moderatorModel:F,moderatorId:G,orchestratorTransform:j,orchestratorStatus:J,moderatorSynthesis:se,isSynthesizing:E,isGenerating:V,phaseLabel:I,speaking:f,hoveredCard:L,setHoveredCard:w,setSelectedCardIds:h,lastSelectedCardRef:Q,orchestratorAutoMode:P,orchestratorAutoScope:te,showOrchestratorMenu:b,setShowOrchestratorMenu:W,setOrchestratorAutoMode:ue,setOrchestratorAutoScope:we,orchestratorMenuRef:pe,availableModels:xe,setModerator:q,getTailSnippet:A}),n!=="compare"&&e.jsxs("svg",{className:"absolute pointer-events-none transition-opacity duration-700",style:{width:"1000px",height:"1000px",opacity:.2},children:[e.jsx("circle",{cx:"500",cy:"500",r:i,fill:"none",stroke:"url(#circleGrad)",strokeWidth:"1",strokeDasharray:"8,4"}),e.jsx("defs",{children:e.jsxs("linearGradient",{id:"circleGrad",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#3b82f6"}),e.jsx("stop",{offset:"50%",stopColor:"#8b5cf6"}),e.jsx("stop",{offset:"100%",stopColor:"#3b82f6"})]})})]})]})}function Qs(t,n){const r=Math.floor(t/n),l=t%n,f=(mt+re.gapX)*n-re.gapX,a=r*(dn+re.gapY);return{gridX:l*(mt+re.gapX)-f/2+mt/2,gridY:a}}function Js({mode:t,gridX:n,gridY:r,circleX:l,circleY:f,dragState:a,modelId:h}){if((a==null?void 0:a.activeId)===h){const u=a.currX+a.offsetX,c=a.currY+a.offsetY;if(t==="compare"){const d=u-(a.containerLeft+a.containerWidth/2),v=c-a.containerTop-a.cardHeight/2;return`translate(calc(-50% + ${d}px), ${v}px)`}const p=u-(a.containerLeft+a.containerWidth/2),m=c-(a.containerTop+a.containerHeight/2);return`translate(calc(-50% + ${p}px), calc(-50% + ${m}px))`}return t==="compare"?`translate(calc(-50% + ${n}px), ${r}px)`:`translate(calc(-50% + ${l}px), calc(-50% + ${f}px))`}function Zs({e:t,modelId:n,suppressClickRef:r,setSelectedCardIds:l,selectedModels:f,lastSelectedCardRef:a}){if(t.stopPropagation(),r.current.card){r.current.card=!1;return}const h=t.shiftKey,u=t.metaKey||t.ctrlKey;if(h&&a.current){const c=f.findIndex(m=>m.id===a.current),p=f.findIndex(m=>m.id===n);if(c!==-1&&p!==-1){const m=Math.min(c,p),d=Math.max(c,p),v=f.slice(m,d+1).map(R=>R.id);l(R=>{const A=new Set(R);return v.forEach(L=>A.add(L)),A})}}else u?(l(c=>{const p=new Set(c);return p.has(n)?p.delete(n):p.add(n),p}),a.current=n):(l(new Set([n])),a.current=n)}function er({model:t,isSpeaking:n,thinkingFallback:r,getTailSnippet:l}){return t.statusMessage?$e(t.statusMessage)??t.statusMessage:n?t.response.trim().length>0?$e(t.response)??e.jsx(Pt,{text:t.response,speed:20}):t.thinking&&t.thinking.trim().length>0?e.jsxs("span",{children:[e.jsx("span",{className:"text-slate-500 italic",children:"Thinking… "}),l(t.thinking.trim(),220)]}):r:$e(t.response)??t.response}function tr({model:t,isSpeaking:n,getTailSnippet:r,maxChars:l=220}){return t.statusMessage?$e(t.statusMessage)??t.statusMessage:n?t.thinking&&t.thinking.trim().length>0?e.jsxs("span",{children:[e.jsx("span",{className:"text-purple-400/80 text-[10px] uppercase tracking-wider font-medium",children:"Thinking "}),e.jsx("span",{className:"text-slate-400",children:r(t.thinking.trim(),260)})]}):t.response.trim().length>0?$e(t.response)??e.jsx(Pt,{text:t.response,speed:20}):e.jsx("span",{className:"text-slate-500 italic",children:"Generating…"}):t.thinking&&t.thinking.trim().length>0?e.jsxs("span",{children:[e.jsx("span",{className:"text-purple-400/80 text-[10px] uppercase tracking-wider font-medium",children:"Reasoning "}),e.jsx("span",{className:"text-slate-400",children:r(t.thinking.trim(),260)})]}):t.response?$e(t.response)??r(t.response,l):e.jsx("span",{className:"text-slate-500 italic",children:"No response yet."})}const nr={padding:"16px",height:"100%",display:"flex",flexDirection:"column",isolation:"isolate",WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",textRendering:"optimizeLegibility",opacity:1,transition:"opacity 0.3s ease-out"};function sr(t){switch(t){case"error":return"Error";case"responding":return"Responding";case"done":return"Done";case"waiting":return"Waiting";default:return"Ready"}}function rr(t,n,r,l){return r?"error":t?"responding":n?"done":l?"waiting":"idle"}function $e(t){return t.startsWith("<svg")?e.jsx("span",{dangerouslySetInnerHTML:{__html:t}}):null}function or({hasError:t,isProcessing:n,isSelected:r,errorColor:l,processingColor:f,typeColor:a}){const h="rgba(30, 41, 59, 0.85)";return t?{background:`linear-gradient(135deg, ${l}14, ${h})`,border:`1px solid ${l}99`,shadow:`0 0 24px ${l}33, inset 0 1px 1px rgba(255,255,255,0.1)`}:n?{background:`linear-gradient(135deg, ${f}14, ${h})`,border:`1px solid ${f}99`,shadow:`0 0 24px ${f}33, inset 0 1px 1px rgba(255,255,255,0.1)`}:r?{background:h,border:`1px solid ${a}d0`,shadow:`0 0 20px ${a}30, inset 0 1px 1px rgba(255,255,255,0.1)`}:{background:h,border:"1px solid rgba(71, 85, 105, 0.5)",shadow:"0 4px 20px rgba(0,0,0,0.3), inset 0 1px 1px rgba(255,255,255,0.05)"}}function ar({rect:t}){return t?e.jsx("div",{className:"absolute pointer-events-none z-30",style:{left:t.left,top:t.top,width:t.width,height:t.height,border:"2px solid rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)"}}):null}const $t=s.createContext(null);function ir({children:t}){const[n,r]=s.useState(!1),[l,f]=s.useState("chat"),a=s.useRef({}),h=s.useCallback(R=>{a.current=R},[]),[u,c]=s.useState({gesture:null,progress:0,triggered:!1}),[p,m]=s.useState(void 0),[d,v]=s.useState(null);return e.jsx($t.Provider,{value:{isActive:n,setIsActive:r,appContext:l,setAppContext:f,callbacks:a,setCallbacks:h,gestureState:u,setGestureState:c,performanceMetrics:p,setPerformanceMetrics:m,cameraError:d,setCameraError:v},children:t})}function lr(){const t=s.useContext($t);if(!t)throw new Error("useGesture must be used within GestureProvider");return t}function Lr(){return s.useContext($t)}const cr="https://oauth.neevs.io",cn="Ov23lianHkw0Uog0VGxT",ur="read:user";async function dr(){return new Promise((t,n)=>{const r=`${window.location.origin}/static/playground/oauth-callback.html`,l=btoa(JSON.stringify({provider:"github",client_id:cn,redirect_url:r})),f=new URL("https://github.com/login/oauth/authorize");f.searchParams.set("client_id",cn),f.searchParams.set("scope",ur),f.searchParams.set("redirect_uri",`${cr}/callback`),f.searchParams.set("state",l);const a=500,h=600,u=window.screenX+(window.innerWidth-a)/2,c=window.screenY+(window.innerHeight-h)/2,p=window.open(f.toString(),"github-oauth",`width=${a},height=${h},left=${u},top=${c},popup=yes`);if(!p){n(new Error("Popup blocked. Please allow popups for this site."));return}const m=async v=>{if(v.origin!==window.location.origin)return;const{type:R,token:A,error:L}=v.data||{};if(R==="oauth-callback"){if(window.removeEventListener("message",m),clearInterval(d),L){n(new Error(L));return}if(!A){n(new Error("No token received"));return}try{const w=await fr(A);t({token:A,...w})}catch(w){n(w)}}};window.addEventListener("message",m);const d=setInterval(()=>{p.closed&&(clearInterval(d),window.removeEventListener("message",m),n(new Error("OAuth flow cancelled")))},500)})}async function fr(t){const n=await fetch("https://api.github.com/user",{headers:{Authorization:`Bearer ${t}`,Accept:"application/vnd.github+json"}});if(!n.ok)throw new Error("Failed to fetch GitHub user info");const r=await n.json();return{username:r.login,name:r.name||void 0}}class pr extends s.Component{constructor(r){super(r);tn(this,"handleRetry",()=>{var r,l;this.setState({hasError:!1,error:null}),(l=(r=this.props).onRetry)==null||l.call(r)});this.state={hasError:!1,error:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,l){console.error("ErrorBoundary caught an error:",r,l)}render(){var r;return this.state.hasError?this.props.fallback?this.props.fallback:e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-white/70 gap-4 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-amber-400",children:[e.jsx(os,{size:20}),e.jsx("span",{className:"text-sm font-medium",children:"Something went wrong"})]}),e.jsx("p",{className:"text-xs text-white/40 text-center max-w-xs",children:((r=this.state.error)==null?void 0:r.message)||"Failed to load component"}),e.jsxs("button",{onClick:this.handleRetry,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white/80 bg-slate-700/50 hover:bg-slate-600/50 rounded-lg transition-all active:scale-95 border border-slate-600/50",children:[e.jsx(as,{size:14}),"Try Again"]})]}):this.props.children}}const hr=s.lazy(()=>Be(()=>import("./SettingsModal-CjKr8Rf-.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),mr=s.lazy(()=>Be(()=>import("./ResponseModal-reNlrW8D.js"),__vite__mapDeps([7,1,2,3,4,5,6,8]))),xr=s.lazy(()=>Be(()=>import("./DiscussionTranscript-Dx7tA61F.js"),__vite__mapDeps([9,1,2,3,4,5,6,8]))),gr=s.lazy(()=>Be(()=>import("./GestureControl-CldEI6QU.js"),__vite__mapDeps([10,1,2,3,4,5,6]))),br=s.lazy(()=>Be(()=>import("./HandBackground-F7iiHyIM.js"),__vite__mapDeps([11,1,2,3,4,5,6,12]))),yr=s.lazy(()=>Be(()=>import("./ChatView-DNQTqbZO.js"),__vite__mapDeps([13,1,2,3,4,5,6,8])).then(t=>({default:t.default}))),vr='button, input, textarea, select, a, [role="button"], [data-no-background], [data-card]';function wr(){const t=lr();Bs();const{modelsData:n,setModelsData:r,selected:l,setSelected:f,chatModelId:a,setChatModelId:h,moderator:u,setModerator:c,availableModels:p,totalModelsByType:m,allSelectedByType:d,modelIdToName:v,updateModelAvailability:R,isLoading:A,loadError:L,retryCount:w,retryNow:_}=Cs();Rs(n,R);const[i,O]=Pe("playground_mode","chat",{serialize:o=>o,deserialize:(o,x)=>["chat","compare","analyze","debate"].includes(o)?o:x}),[F,G]=s.useState(!1),j=s.useRef(null),[J,se]=s.useState(null),[E,V]=s.useState(!1),[I,U]=s.useState(!1),[Q,P]=s.useState(2),[te,b]=s.useState(!1),[W,ue]=Pe("github_auth",null),we=s.useCallback(async()=>{try{const o=await dr();ue(o)}catch(o){console.error("GitHub OAuth failed:",o)}},[ue]),[pe,xe]=s.useState(!1),[q,ae]=s.useState({}),he=s.useRef(null),ee=s.useRef(null),[_e,$]=s.useState(""),[Ee,ne]=s.useState(null),fe=s.useRef(null),oe=s.useCallback(o=>{fe.current&&clearTimeout(fe.current),ne(o),fe.current=window.setTimeout(()=>{ne(null),fe.current=null},5e3)},[]),de=s.useCallback(o=>{if(i==="chat"||W!=null&&W.token)return!0;const x=n.find(y=>y.id===o);return!x||x.type!=="github"},[i,W,n]),ge=s.useCallback(()=>!!(i==="chat"||W!=null&&W.token),[i,W]),[be,De]=s.useState([]),[ke,ye]=Pe("playground_chat_selected_models",["gemma-3-12b-it","gpt-oss-20b","lfm2.5-1.2b-instruct"]),z=s.useMemo(()=>new Set(ke),[ke]),[B,C]=s.useState(!1),g=s.useRef(!1),T=s.useCallback(o=>{const x=n.find(y=>y.id===o);x&&ye(y=>{const S=new Set(y);if(S.has(o))S.delete(o);else{const M=x.type==="self-hosted"?"github":"self-hosted";n.filter(k=>k.type===M).forEach(k=>S.delete(k.id)),S.add(o)}return Array.from(S)})},[ye,n]),N=s.useCallback(o=>{const x=n.filter(M=>M.type===o&&!(M.type==="self-hosted"&&M.available===!1)).map(M=>M.id),y=o==="self-hosted"?"github":"self-hosted",S=n.filter(M=>M.type===y).map(M=>M.id);ye(M=>{const k=new Set(M);return x.length>0&&x.every(D=>k.has(D))?x.forEach(D=>k.delete(D)):(S.forEach(D=>k.delete(D)),x.forEach(D=>k.add(D))),Array.from(k)})},[n,ye]),{history:K,historyRef:H,pushHistoryEntries:X,clearHistory:Z,historyToText:Se,buildCarryoverHistory:Ce}=Ds(),Ze=(o,x)=>{const y=new Set,S=x.filter(Boolean).filter((k,Y,D)=>D.indexOf(k)===Y),M=[];return S.forEach(k=>{const Y=o[k];Y&&Y.trim()&&(M.push({id:k,text:Y.trim()}),y.add(k))}),Object.entries(o).forEach(([k,Y])=>{y.has(k)||!Y||!Y.trim()||M.push({id:k,text:Y.trim()})}),M.length?M.map(({id:k,text:Y})=>`${v(k)}:
${Y}`).join(`

`):null};s.useEffect(()=>{t.isActive&&!g.current&&(xe(!0),ye(["openai/gpt-4o"])),g.current=t.isActive},[t.isActive,ye]);const Me=l.map(o=>n.find(x=>x.id===o)).filter(o=>!!o&&(i==="compare"||o.id!==u)),ie=s.useMemo(()=>i!=="compare"?Me:[...Me].sort((o,x)=>{var M,k;const y=(M=q[o.id])==null?void 0:M.firstTokenTime,S=(k=q[x.id])==null?void 0:k.firstTokenTime;return y===void 0&&S===void 0?0:y===void 0?1:S===void 0?-1:y-S}),[i,Me,q]),{fastestTTFT:et,fastestTotal:tt}=s.useMemo(()=>{if(i!=="compare")return{fastestTTFT:null,fastestTotal:null};let o=null,x=1/0,y=null,S=1/0,M=0,k=0;for(const Y of Me){const D=q[Y.id];if(D){if(D.firstTokenTime!==void 0){M++;const ce=D.firstTokenTime-D.startTime;ce<x&&(x=ce,o=Y.id)}if(D.endTime!==void 0){k++;const ce=D.endTime-D.startTime;ce<S&&(S=ce,y=Y.id)}}}return{fastestTTFT:M>=2?o:null,fastestTotal:k>=2?y:null}},[i,Me,q]),le=(o,x,y,S)=>{if(y==="analyze"){const dt=250+o*220/(x-1)-90,ft=dt*Math.PI/180;return{x:Math.cos(ft)*S,y:Math.sin(ft)*S,angle:dt}}const M=o*360/x-90,k=Math.cos(M*Math.PI/180)*S,Y=Math.sin(M*Math.PI/180)*S;return{x:k,y:Y,angle:M}},fn=(o,x)=>{se(x),o.dataTransfer.effectAllowed="move"},pn=o=>{o.preventDefault(),V(!0)},hn=()=>{V(!1)},mn=o=>{if(o.preventDefault(),V(!1),J){if(i==="chat")h(J);else if(!l.includes(J)){if(!de(J)){oe("Connect GitHub in Settings to use API models"),se(null);return}f(x=>[...x,J])}se(null)}},xt=o=>{if(i==="chat"){h(a===o?null:o);return}if(l.includes(o))if(Te&&bt.current.includes(o)&&_e){ee.current&&ee.current.abort();const y=bt.current.filter(M=>M!==o),S={};if(n.forEach(M=>{y.includes(M.id)&&M.response&&!M.error&&(S[M.id]=M.response)}),f(M=>M.filter(k=>k!==o)),We.has(o)&&Ge(M=>{const k=new Set(M);return k.delete(o),k}),(i==="analyze"||i==="debate")&&y.length<2){Ae(!1),Ue(!1),Ke("This mode requires at least 2 participants."),Ve("Error");return}Mt(_e,S,y,{skipHistory:!0})}else f(y=>y.filter(S=>S!==o));else{if(!de(o)){oe("Connect GitHub in Settings to use API models");return}f(x=>[...x,o])}},xn=o=>{const y=n.filter(k=>k.type===o&&!(k.type==="self-hosted"&&k.available===!1)).map(k=>k.id);if(y.length>0&&y.every(k=>l.includes(k))){f(k=>k.filter(Y=>!y.includes(Y)));return}if(o==="github"&&!ge()){oe("Connect GitHub in Settings to use API models");return}const M=p.filter(k=>k.type===o&&!(k.type==="self-hosted"&&k.available===!1)).map(k=>k.id);M.length>0&&f(k=>[...k,...M])},[gn,Oe]=s.useState(null),[Ne,nt]=s.useState(null),[He,st]=s.useState(new Set),[bn,yn]=s.useState(!1),[We,Ge]=s.useState(new Set),rt=()=>Ge(new Set),[ot,vn]=s.useState(null),gt=s.useMemo(()=>{if(i==="compare")return 0;const o=Math.max(re.baseRadius,re.minRadius+ie.length*re.radiusPerModel);if(!ot)return o;const y=Math.min(ot.width,ot.height)/2-140;return Math.max(o,y)},[i,ie.length,ot]);s.useEffect(()=>{const o=()=>{if(!me.current)return;const{clientWidth:y,clientHeight:S}=me.current;let M=Math.floor(y/(re.cardWidth+re.gapX));M=Math.max(1,M),P(M),vn({width:y,height:S})},x=new ResizeObserver(y=>{for(let S of y)S.target===me.current&&o()});return me.current&&(x.observe(me.current),o()),()=>{me.current&&x.unobserve(me.current)}},[i]);const Ye=s.useRef(null),me=s.useRef(null),Re=s.useRef(null),Bt=s.useRef(null),at=s.useRef(new Map),wn=s.useRef(null),Fe=s.useRef({card:!1,background:!1}),kn=s.useRef({}),bt=s.useRef([]),{enqueueStreamDelta:jn,clearPendingStreamForModel:Sn,resetPendingStream:yt}=Os(r),Dt=s.useRef(!1),{arenaOffsetYRef:Ot,arenaTargetYRef:vt,wheelRafRef:Tn,clampTarget:En,ensureRaf:Cn}=Us({visualizationAreaRef:me,dragSelectionActiveRef:Dt}),{selectionRect:Mn,isSelecting:wt,dragSelectionActiveRef:Nn}=Gs({rootContainerRef:Bt,visualizationAreaRef:me,arenaOffsetYRef:Ot,arenaTargetYRef:vt,wheelRafRef:Tn,selectedModels:ie,cardRefs:at,selectedCardIds:We,setSelectedCardIds:Ge,suppressClickRef:Fe});Dt.current=Nn.current;const{dragState:Rn,handlePointerDown:Ln}=Ys({visualizationAreaRef:me,cardRefs:at,selected:l,setSelected:f,mode:i,gridCols:Q,getCirclePosition:le});s.useEffect(()=>()=>yt(),[yt]);const[ve,Le]=s.useState(null);s.useEffect(()=>{const o="arena-selecting",x=document.body;return wt?x.classList.add(o):x.classList.remove(o),()=>{x.classList.remove(o)}},[wt]);const it=s.useCallback(o=>o?!o.closest(vr):!1,[]),An=s.useCallback(o=>{if(it(o.target)){if(Fe.current.background){Fe.current.background=!1;return}Oe(null),rt(),Fe.current.background=!1}},[it,rt]),_n=s.useCallback(o=>{it(o.target)&&(o.preventDefault(),Le({x:o.clientX,y:o.clientY,type:"background"}))},[it]),Ht=s.useCallback(()=>{G(!0),j.current&&clearTimeout(j.current),j.current=window.setTimeout(()=>{G(!1),j.current=null},350)},[]),Wt=s.useRef(i),lt=s.useCallback(o=>{if(o===i)return;Ht();const x=["compare","analyze","debate"];x.includes(i)&&x.includes(o)||Ae(!1),O(o)},[i,Ht]);s.useEffect(()=>()=>{fe.current&&clearTimeout(fe.current)},[]),s.useEffect(()=>()=>{j.current&&clearTimeout(j.current)},[]),s.useEffect(()=>{const o=()=>Le(null);return window.addEventListener("click",o),()=>window.removeEventListener("click",o)},[]);const[Te,Ae]=s.useState(!1),[ct,Ue]=s.useState(!1),[Xe,Ke]=s.useState(""),In=s.useCallback(()=>{Z(),Ae(!1),Ue(!1),Ke(""),Ve(null),Tt({}),r(o=>o.map(x=>({...x,response:"",thinking:void 0,error:void 0}))),ae({}),st(new Set)},[Z,r]),[zn,Pn]=s.useState(!0),[$n,Bn]=s.useState("api"),[kt,jt]=s.useState(!1),St=s.useRef(null);s.useEffect(()=>{const o=y=>{St.current&&!St.current.contains(y.target)&&jt(!1)},x=y=>{y.key==="Escape"&&jt(!1)};return kt&&(document.addEventListener("mousedown",o),document.addEventListener("keydown",x)),()=>{document.removeEventListener("mousedown",o),document.removeEventListener("keydown",x)}},[kt]);const[qe,Ve]=s.useState(null),[,Tt]=s.useState({}),[Dn,Gt]=s.useState(new Set),Et=s.useRef(new Set),On=s.useRef(null),Yt=s.useRef({}),Ft=s.useRef(i),[Ct,Ut]=s.useState(null),Hn=()=>{const o=new Set;Et.current=o,Gt(o)},Wn=o=>{Gt(x=>{if(x.has(o))return x;const y=new Set(x);return y.add(o),Et.current=y,y})},Xt=s.useRef({compare:{responses:{},moderatorSynthesis:"",phaseLabel:null,executionTimes:{},isGenerating:!1,speaking:new Set},analyze:{responses:{},moderatorSynthesis:"",phaseLabel:null,executionTimes:{},isGenerating:!1,speaking:new Set},debate:{responses:{},moderatorSynthesis:"",phaseLabel:null,executionTimes:{},isGenerating:!1,speaking:new Set}}),Kt=s.useRef(n),qt=s.useRef(Xe),Vt=s.useRef(qe),Qt=s.useRef(q),Jt=s.useRef(Te),Zt=s.useRef(He);s.useEffect(()=>{Kt.current=n},[n]),s.useEffect(()=>{qt.current=Xe},[Xe]),s.useEffect(()=>{Vt.current=qe},[qe]),s.useEffect(()=>{Qt.current=q},[q]),s.useEffect(()=>{Jt.current=Te},[Te]),s.useEffect(()=>{Zt.current=He},[He]),s.useEffect(()=>{const o=["compare","analyze","debate"],x=Wt.current;if(o.includes(x)&&o.includes(i)&&x!==i){const y={};Kt.current.forEach(k=>{y[k.id]={response:k.response,thinking:k.thinking,error:k.error}}),Xt.current[x]={responses:y,moderatorSynthesis:qt.current,phaseLabel:Vt.current,executionTimes:Qt.current,isGenerating:Jt.current,speaking:new Set(Zt.current)};const S=Xt.current[i];Object.values(S.responses).some(k=>k.response&&k.response!=="")||S.isGenerating?(r(k=>k.map(Y=>{var D,ce,Qe;return{...Y,response:((D=S.responses[Y.id])==null?void 0:D.response)||"",thinking:(ce=S.responses[Y.id])==null?void 0:ce.thinking,error:(Qe=S.responses[Y.id])==null?void 0:Qe.error}})),Ke(S.moderatorSynthesis),Ve(S.phaseLabel),ae(S.executionTimes),Ae(S.isGenerating),st(new Set(S.speaking))):(Z(),r(k=>k.map(Y=>({...Y,response:"",thinking:void 0,error:void 0}))),Ke(""),Ve(null),ae({}),Ae(!1),st(new Set)),Ue(!1),Tt({})}Wt.current=i},[i,Z,r]);const{sendMessage:Mt}=Ws({mode:i,moderator:u,selected:l,selectedCardIds:We,githubToken:W==null?void 0:W.token,isGenerating:Te,systemPrompt:pe?gs:void 0,summarizeSessionResponses:Ze,setLastQuery:$,setHoveredCard:Oe,setPhaseLabel:Ve,setModeratorSynthesis:Ke,setDiscussionTurnsByModel:Tt,resetFailedModels:Hn,markModelFailed:Wn,failedModelsRef:Et,currentDiscussionTurnRef:On,sessionModelIdsRef:bt,abortControllerRef:ee,thinkingStateRef:kn,conversationHistoryRef:H,pushHistoryEntries:X,historyToText:Se,buildCarryoverHistory:Ce,setModelsData:r,modelIdToName:v,setExecutionTimes:ae,setIsGenerating:Ae,setIsSynthesizing:Ue,setSpeaking:st,enqueueStreamDelta:jn,clearPendingStreamForModel:Sn,resetPendingStream:yt});Fs({mode:i,showSettings:te,showDock:I,contextMenu:ve,selectedCardIds:We,selected:l,inputRef:Ye,setShowSettings:b,setShowDock:U,setContextMenu:Le,setSelected:f,setSelectedCardIds:Ge,clearSelection:rt,setHoveredCard:Oe,handleModeChange:lt});const[ut,Gn]=Pe("playground-bg-style","dots",{serialize:o=>o,deserialize:(o,x)=>o&&xs.includes(o)?o:x}),Yn=n.find(o=>o.id===u),Fn=ct?"responding":Te?"waiting":Xe?"done":"idle",Un=`${Ct?`translate(-50%, -50%) translate(${Ct.x}px, ${Ct.y}px)`:"translate(-50%, -50%)"} scale(1)`;s.useLayoutEffect(()=>{if(i!=="compare")return;const o={};ie.forEach(x=>{const y=at.current.get(x.id);y&&(o[x.id]=y.getBoundingClientRect())}),Yt.current=o},[i,ie.length,ie.map(o=>o.id).join(",")]),s.useEffect(()=>{if(Ft.current==="compare"&&i!=="compare"&&u&&me.current){const x=Yt.current[u],y=me.current.getBoundingClientRect();if(x&&y.width>0&&y.height>0){const S=y.left+y.width/2,M=i==="analyze"?gt-64:0,k=y.top+(y.height*.5+M),Y=x.left+x.width/2-S,D=x.top+x.height/2-k;(Math.abs(Y)>1||Math.abs(D)>1)&&(Ut({x:Y,y:D}),requestAnimationFrame(()=>Ut(null)))}}Ft.current=i},[i,u,gt]);const Xn=ut==="none"?"":`bg-${ut}`,Kn=(o,x=280)=>o?o.length<=x?o:`…${o.slice(o.length-x)}`:"",en=()=>{ee.current&&(ee.current.abort(),Ae(!1),Ue(!1))};return e.jsxs("div",{ref:Bt,className:`fixed inset-0 overflow-hidden text-white ${Xn}`,style:{backgroundColor:sn[i],transition:"background-color 1s ease",...ut==="none"?{background:sn[i]}:{},...wt?{userSelect:"none",WebkitUserSelect:"none"}:{}},onClick:An,onContextMenu:_n,children:[t.isActive&&e.jsx(s.Suspense,{fallback:null,children:e.jsx(br,{onSendMessage:t.callbacks.current.onSendMessage,onScroll:t.callbacks.current.onScroll,onPinch:t.callbacks.current.onPinch,onHover:t.callbacks.current.onHover,gestureActiveArea:{minX:.7,maxX:1,minY:0,maxY:1},onGestureState:t.setGestureState,onError:t.setCameraError,onPerformance:t.setPerformanceMetrics})}),A&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-slate-900/95 backdrop-blur-sm",children:e.jsxs("div",{className:"flex flex-col items-center gap-5 text-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-12 h-12 border-2 border-slate-700 border-t-blue-500 rounded-full animate-spin"}),e.jsx("div",{className:"absolute inset-0 w-12 h-12 border-2 border-transparent border-b-emerald-500/50 rounded-full animate-spin",style:{animationDirection:"reverse",animationDuration:"1.5s"}})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"text-white/80 text-sm font-medium",children:L||"Connecting to models..."}),w>0&&e.jsxs("p",{className:"text-white/40 text-xs tabular-nums",children:["Attempt ",w," of 8"]})]}),e.jsxs("button",{onClick:_,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white/70 hover:text-white bg-white/5 hover:bg-white/10 border border-white/10 hover:border-white/20 rounded-lg transition-all active:scale-95",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh Now"]})]})}),e.jsx(ws,{mode:i,setMode:lt,setHoveredCard:Oe,clearSelection:rt,showDock:I,setShowDock:U,onOpenSettings:()=>b(!0),gestureButtonSlot:e.jsx(s.Suspense,{fallback:null,children:e.jsx(gr,{inHeader:!0,appContext:i,onStopGeneration:()=>{if(i==="chat"&&Re.current){Re.current.stopGeneration();return}en()},onSendMessage:o=>{if(i==="chat"&&Re.current){Re.current.sendMessage(o,!0);return}const x=i==="compare"||i==="analyze"||i==="debate"?l:[];x.length>0&&Mt(o,{},x)},onScroll:o=>{if(i==="chat"&&Re.current){Re.current.scroll(o);return}vt.current=En(vt.current+o),Cn()},onHover:(o,x)=>{const y=o*window.innerWidth,S=x*window.innerHeight,M=document.elementFromPoint(y,S);if(M){const k=M.closest("[data-gesture-mode-track]");if(k){const ce=k.getBoundingClientRect(),Qe=y-ce.left,dt=ce.width,ft=Math.floor(Qe/dt*5),Nt=["chat","compare","analyze","debate"][Math.max(0,Math.min(4,ft))];Nt&&Nt!==i&&lt(Nt);return}const Y=document.querySelector('[data-gesture-hovered="true"]'),D=M.closest('button, a, [role="button"], [data-clickable], .cursor-pointer, [onclick]')||M;D!==Y?(Y&&(Y.removeAttribute("data-gesture-hovered"),Y.dispatchEvent(new PointerEvent("pointerleave",{bubbles:!1,cancelable:!0})),Y.dispatchEvent(new MouseEvent("mouseleave",{bubbles:!1,cancelable:!0})),Y.dispatchEvent(new MouseEvent("mouseout",{bubbles:!0,cancelable:!0}))),D.setAttribute("data-gesture-hovered","true"),D.dispatchEvent(new PointerEvent("pointerenter",{bubbles:!1,cancelable:!0,clientX:y,clientY:S})),D.dispatchEvent(new PointerEvent("pointermove",{bubbles:!0,cancelable:!0,clientX:y,clientY:S})),D.dispatchEvent(new MouseEvent("mouseenter",{bubbles:!1,cancelable:!0,clientX:y,clientY:S})),D.dispatchEvent(new MouseEvent("mouseover",{bubbles:!0,cancelable:!0,clientX:y,clientY:S}))):D===Y&&(D.dispatchEvent(new PointerEvent("pointermove",{bubbles:!0,cancelable:!0,clientX:y,clientY:S})),D.dispatchEvent(new MouseEvent("mousemove",{bubbles:!0,cancelable:!0,clientX:y,clientY:S})))}},onPinch:(o,x)=>{const y=o*window.innerWidth,S=x*window.innerHeight,M=document.elementFromPoint(y,S);if(M){const k=ce=>{ce.dispatchEvent(new PointerEvent("pointerdown",{bubbles:!0,cancelable:!0,clientX:y,clientY:S,pointerId:1,pointerType:"touch",isPrimary:!0})),ce.dispatchEvent(new PointerEvent("pointerup",{bubbles:!0,cancelable:!0,clientX:y,clientY:S,pointerId:1,pointerType:"touch",isPrimary:!0})),ce.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0,clientX:y,clientY:S})),ce.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0,clientX:y,clientY:S})),ce.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,clientX:y,clientY:S}))},Y=M.closest('button, a, [role="button"], [data-clickable], .cursor-pointer, [onclick]');k(Y||M);const D=document.createElement("div");D.style.position="fixed",D.style.left=`${y}px`,D.style.top=`${S}px`,D.style.width="20px",D.style.height="20px",D.style.background="rgba(236, 72, 153, 0.5)",D.style.borderRadius="50%",D.style.transform="translate(-50%, -50%)",D.style.pointerEvents="none",D.style.zIndex="9999",document.body.appendChild(D),D.animate([{transform:"translate(-50%, -50%) scale(1)",opacity:1},{transform:"translate(-50%, -50%) scale(4)",opacity:0}],{duration:400}).onfinish=()=>D.remove()}},onModeChange:o=>{const x=["chat","compare","analyze","debate"],y=x.indexOf(i);let S;o==="next"?S=(y+1)%x.length:S=(y-1+x.length)%x.length,lt(x[S])}})})}),e.jsxs("div",{style:{paddingLeft:"1.5rem",paddingRight:"0"},children:[I&&e.jsx("div",{className:"fixed inset-0 z-[55] bg-black/10 backdrop-blur-[1px] transition-opacity duration-300",onClick:()=>U(!1)}),e.jsx(bs,{showDock:I,availableModels:p,allSelectedByType:d,totalModelsByType:m,handleDragStart:fn,handleModelToggle:xt,handleAddGroup:xn,dockRef:he,mode:i,allModels:n,setShowDock:U,chatSelectedModels:z,onToggleChatModel:T,onToggleChatGroup:N}),i==="chat"&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex h-screen w-full relative z-[10]",children:e.jsx("div",{className:"flex-1 relative px-2 sm:px-6 pt-20 pb-6",children:e.jsx(pr,{children:e.jsx(s.Suspense,{fallback:e.jsxs("div",{className:"flex items-center justify-center h-full text-white/50 gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/20 border-t-white/60 rounded-full animate-spin"}),"Loading..."]}),children:e.jsx(yr,{ref:Re,models:n,selectedModels:z,onToggleModel:T,githubToken:W==null?void 0:W.token,githubUsername:(W==null?void 0:W.name)||(W==null?void 0:W.username),onConnectGitHub:we,messages:be,setMessages:De,isGenerating:B,setIsGenerating:C,gesturesActive:t.isActive,uiBuilderEnabled:pe,setUiBuilderEnabled:xe})})})})})}),i!=="chat"&&e.jsxs("div",{className:"flex h-screen w-full relative",children:[e.jsx("div",{className:"relative flex-1 transition-all duration-300 flex flex-col pt-24",children:e.jsx("div",{ref:me,onDragOver:pn,onDragLeave:hn,onDrop:mn,className:"relative w-full h-full z-10 transition-all duration-300",style:{position:"relative",display:"flex",alignItems:i==="compare"?"flex-start":"center",justifyContent:"center","--arena-offset-y":`${Ot.current}px`,transform:i==="analyze"||i==="debate"?`translateY(calc(var(--arena-offset-y) - 50px)) scale(${E?1.02:1})`:`translateY(var(--arena-offset-y)) scale(${E?1.02:1})`,willChange:"transform",border:E?"2px dashed rgba(59, 130, 246, 0.4)":"2px dashed transparent",borderRadius:E?"24px":"0px",transition:"transform 0s linear",...i==="compare"?{minHeight:"300px",paddingBottom:"120px"}:i==="analyze"||i==="debate"?{height:"100%",minHeight:"100%",overflow:"hidden"}:{height:"100%",minHeight:"100%",overflow:"hidden"},...E?{background:"rgba(59, 130, 246, 0.05)"}:{}},children:e.jsx(Vs,{mode:i,selectedModels:ie,gridCols:Q,speaking:He,selectedCardIds:We,setSelectedCardIds:Ge,executionTimes:q,failedModels:Dn,cardRefs:at,handlePointerDown:Ln,dragState:Rn,handleModelToggle:xt,setContextMenu:Le,suppressClickRef:Fe,getTailSnippet:Kn,hoveredCard:gn,setHoveredCard:Oe,setExpandedModelId:nt,layoutRadius:gt,getCirclePosition:le,moderatorModel:Yn,moderatorId:u,orchestratorTransform:Un,orchestratorStatus:Fn,moderatorSynthesis:Xe,isSynthesizing:ct,isGenerating:Te,phaseLabel:qe,linesTransitioning:F,lastSelectedCardRef:wn,orchestratorAutoMode:zn,orchestratorAutoScope:$n,showOrchestratorMenu:kt,setShowOrchestratorMenu:jt,setOrchestratorAutoMode:Pn,setOrchestratorAutoScope:Bn,orchestratorMenuRef:St,availableModels:p,setModerator:c,fastestTTFT:et,fastestTotal:tt})})}),i!=="compare"&&e.jsx("div",{className:"transcript-panel w-[400px] xl:w-[480px] flex flex-col border-l border-white/5 bg-slate-900/20 backdrop-blur-sm z-40 relative h-full",children:e.jsx(s.Suspense,{fallback:null,children:e.jsx(xr,{history:K,models:n,mode:i,onSelectPrompt:o=>{Ye.current&&(Ye.current.value=o,Ye.current.focus())},onNewSession:In,className:"pt-24 pb-6 mask-fade-top",phaseLabel:qe,isGenerating:Te,isSynthesizing:ct,speakingCount:He.size,totalParticipants:ie.length})})})]})]}),e.jsx(ar,{rect:Mn}),Ee&&e.jsx("div",{className:"fixed bottom-20 left-1/2 -translate-x-1/2 z-[200] animate-in slide-in-from-bottom-4 fade-in duration-300",children:e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 rounded-xl bg-amber-500/10 border border-amber-500/30 backdrop-blur-md shadow-xl",children:[e.jsx("svg",{className:"w-5 h-5 text-amber-400 shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsx("span",{className:"text-sm text-amber-100",children:Ee}),e.jsx("button",{onClick:()=>{ne(null),b(!0)},className:"ml-2 px-3 py-1 text-xs font-medium text-amber-900 bg-amber-400 hover:bg-amber-300 rounded-md transition-colors",children:"Open Settings"}),e.jsx("button",{onClick:()=>ne(null),className:"ml-1 p-1 text-amber-400/60 hover:text-amber-400 transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsx(s.Suspense,{fallback:null,children:e.jsx(hr,{open:te,onClose:()=>b(!1),githubAuth:W,setGithubAuth:ue,bgStyle:ut,setBgStyle:Gn})}),Ne&&i==="compare"&&e.jsx(s.Suspense,{fallback:null,children:e.jsx(mr,{model:ie.find(o=>o.id===Ne)||null,executionTimes:q[Ne],onClose:()=>nt(null),onPrev:()=>{const o=ie.findIndex(x=>x.id===Ne);o>0&&nt(ie[o-1].id)},onNext:()=>{const o=ie.findIndex(x=>x.id===Ne);o<ie.length-1&&nt(ie[o+1].id)},hasPrev:ie.findIndex(o=>o.id===Ne)>0,hasNext:ie.findIndex(o=>o.id===Ne)<ie.length-1})}),(i==="compare"||i==="analyze"||i==="debate")&&e.jsx(ys,{inputRef:Ye,inputFocused:bn,setInputFocused:yn,onSendMessage:Mt,isGenerating:Te||ct,onStop:en,placeholder:i==="compare"?void 0:"Steer the discussion...",className:`fixed bottom-0 left-0 z-[100] pb-6 px-3 sm:px-4 flex justify-center items-end pointer-events-none transition-all duration-300 ${i==="compare"?"right-0":"right-[400px] xl:right-[480px]"}`,style:{paddingBottom:"calc(1.5rem + env(safe-area-inset-bottom))"}}),ve&&e.jsx("div",{className:"fixed bg-slate-800 border border-slate-700 rounded-lg shadow-xl py-1 z-[200] min-w-[160px]",style:{top:ve.y,left:ve.x},onClick:o=>o.stopPropagation(),children:ve.type==="background"?e.jsxs("button",{className:"w-full text-left px-4 py-2 text-sm text-slate-200 hover:bg-slate-700 transition-colors flex items-center gap-2",onClick:()=>{U(!0),Le(null)},children:[e.jsx("svg",{className:"w-4 h-4 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Model"]}):ve.modelId?e.jsxs(e.Fragment,{children:[i!=="compare"&&ve.modelId!==u&&e.jsxs("button",{className:"w-full text-left px-4 py-2 text-sm text-slate-200 hover:bg-slate-700 transition-colors flex items-center gap-2",onClick:()=>{c(ve.modelId),Le(null)},children:[e.jsx("svg",{className:"w-4 h-4 text-orange-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})}),"Set as Orchestrator"]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 text-sm text-red-400 hover:bg-slate-700 transition-colors flex items-center gap-2",onClick:()=>{const o=ve.modelId===u;if(xt(ve.modelId),o&&i!=="compare"){const x=l.filter(y=>y!==ve.modelId);x.length>0?c(x[0]):c("")}Le(null)},children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Remove"]})]}):null})]})}function kr(){return e.jsx(ir,{children:e.jsx(wr,{})})}is.createRoot(document.getElementById("root")).render(e.jsx(ls.StrictMode,{children:e.jsx(kr,{})}));export{xs as B,an as E,Rr as M,ys as P,gs as U,Lr as a,dr as c,As as f,Lt as s,lr as u};
