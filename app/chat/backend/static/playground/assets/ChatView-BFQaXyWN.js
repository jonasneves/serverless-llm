import{r as i,j as e,Z as ne,t as we,u as ce,v as ye,T as je,U as Qe,w as Ge,x as Ze,X as Fe,y as Ve,z as Ue,p as _e,D as et}from"./react-vendor-BNniwcTg.js";import{F as ie}from"./FormattedContent-BK0z3Ywn.js";import{g as tt,a as rt,S as st,P as nt,f as Ne,s as Se}from"./index-BKO1PeF7.js";import"./markdown-C9gPvUVj.js";import"./math-render-CUINwOeU.js";import"./syntax-highlight-BxeShyTs.js";function ke(c,m){const D=Math.min(c.x,m.x),h=Math.min(c.y,m.y),R=Math.max(c.x,m.x),w=Math.max(c.y,m.y);return{left:D,top:h,right:R,bottom:w,width:R-D,height:w-h}}function lt(c,m){return!(c.right<m.left||c.left>m.right||c.bottom<m.top||c.top>m.bottom)}function at({containerRef:c,itemRefs:m,setSelectedIndices:D}){const[h,R]=i.useState(null),w=i.useRef(!1);i.useEffect(()=>{w.current=h!=null},[h]),i.useEffect(()=>{const O=d=>{if(d.button!==0||!c.current)return;const L=d.target;if(!L||L.closest('button, a, input, textarea, select, [role="button"]'))return;const u=c.current.getBoundingClientRect();if(!(d.clientX>=u.left&&d.clientX<=u.right&&d.clientY>=u.top&&d.clientY<=u.bottom))return;const E={x:d.clientX,y:d.clientY};d.preventDefault(),w.current=!0,R({origin:E,current:E,active:!1})};return window.addEventListener("mousedown",O,!0),()=>window.removeEventListener("mousedown",O,!0)},[c]),i.useEffect(()=>{if(!h||!c.current)return;const O=N=>N.preventDefault();document.addEventListener("selectstart",O);const d=N=>{const u={x:N.clientX,y:N.clientY};R(f=>{if(!f)return f;const E=ke(f.origin,u),T=f.active||E.width>2||E.height>2;return{...f,current:u,active:T}})},L=N=>{w.current=!1;const u={x:N.clientX,y:N.clientY};R(f=>{if(!f)return null;const E=ke(f.origin,u);if(f.active&&E.width>1&&E.height>1){const T=[];for(const[Q,$]of m.current.entries()){const F=$.getBoundingClientRect();lt({left:E.left,right:E.right,top:E.top,bottom:E.bottom},{left:F.left,right:F.right,top:F.top,bottom:F.bottom})&&T.push(Q)}D(new Set(T))}return null})};return window.addEventListener("mousemove",d),window.addEventListener("mouseup",L),()=>{window.removeEventListener("mousemove",d),window.removeEventListener("mouseup",L),document.removeEventListener("selectstart",O)}},[h,c,m,D]);const g=i.useMemo(()=>{if(!h||!h.active||!c.current)return null;const O=c.current.getBoundingClientRect(),d=ke(h.origin,h.current);return d.width<=0||d.height<=0?null:{left:d.left-O.left,top:d.top-O.top,width:d.width,height:d.height}},[h,c]),j=i.useCallback(()=>{R(null),w.current=!1},[]);return{selectionRect:g,isSelecting:h!=null,dragSelectionActiveRef:w,clearSelection:j}}const ot=6e4;function it(){const c=i.useRef(new Map),m=i.useRef(null),D=g=>{const j=c.current.get(g);return j?Date.now()-j<ot:!1};return{sortModels:g=>{const j=g.map(u=>({...u,priority:tt(u.id,u.type||"self-hosted",u.priority),isRateLimited:D(u.id),isLastSuccessful:u.id===m.current,isDefault:!!u.default})),O=j.filter(u=>!u.isRateLimited),d=j.filter(u=>u.isRateLimited),L=O.sort((u,f)=>u.isLastSuccessful!==f.isLastSuccessful?u.isLastSuccessful?-1:1:u.isDefault!==f.isDefault?u.isDefault?-1:1:u.priority!==f.priority?u.priority-f.priority:u.type!==f.type?u.type==="self-hosted"?-1:1:u.id.localeCompare(f.id)),N=d.sort((u,f)=>u.priority!==f.priority?u.priority-f.priority:u.id.localeCompare(f.id));return[...L,...N]},recordRateLimit:g=>{c.current.set(g,Date.now())},recordSuccess:g=>{m.current=g,c.current.delete(g)},isRecentlyRateLimited:D,getLastSuccessfulModel:()=>m.current}}function ct(c){const[m,D]=i.useState([]);return i.useEffect(()=>{const h=c.match(/```json\s*([\s\S]*?)\s*```/);if(h)try{let R=h[1];R=R.replace(/[\\']/g,'"').replace(/,\s*}/g,"}").replace(/,\s*]/g,"]").replace(/}\s*[\\]+\s*$/g,"}").replace(/"\s*"\s*$/g,"").trim();const w=JSON.parse(R);if(w.options&&Array.isArray(w.options)){const g=w.options.filter(j=>j.id&&j.label&&j.value);g.length>0?D(g):D([])}}catch(R){console.error("Failed to parse gesture options:",R),D([])}else D([])},[c]),m}function Ce(c){return c.replace(/```json[\s\S]*?```/g,"").trim()}const ut=1800;function dt({content:c,onSelect:m,isInline:D=!1}){const h=ct(c),[R,w]=i.useState(null),[g,j]=i.useState({}),O=i.useRef(0),d=i.useRef(0);i.useEffect(()=>{const $=F=>{var k;const B=(k=F.detail)==null?void 0:k.target;if(B&&B.hasAttribute("data-gesture-option")){const z=B.getAttribute("data-gesture-option");z&&z!==R&&(w(z),L(z))}else R&&(w(null),N())};return window.addEventListener("gesture-hover",$),()=>{window.removeEventListener("gesture-hover",$),N()}},[R]);const L=$=>{N(),O.current=Date.now();const F=()=>{const B=Date.now()-O.current,k=Math.min(B/ut*100,100);if(j(z=>({...z,[$]:k})),k>=100){const z=h.find(X=>X.id===$);z&&(m(z.value),N())}else d.current=requestAnimationFrame(F)};d.current=requestAnimationFrame(F)},N=()=>{d.current&&cancelAnimationFrame(d.current),j({})},u=$=>{w($),L($)},f=()=>{w(null),N()};if(h.length===0)return null;const E=D?"w-full mt-3":"w-full",T=D?"grid grid-cols-2 gap-2":"flex flex-col gap-2.5",Q=$=>D?`relative overflow-hidden rounded-lg font-medium text-xs border transition-all duration-200 text-center min-h-[40px] flex items-center justify-center px-3 py-2 ${$?"bg-blue-500/20 border-blue-500/50 text-white shadow-lg shadow-blue-500/10":"bg-slate-800/60 border-slate-700/60 text-slate-200 hover:bg-slate-800/80 hover:border-slate-700/80"}`:`relative overflow-hidden rounded-xl font-medium text-sm border transition-all duration-200 w-full text-left min-h-[52px] flex items-center px-4 py-3 ${$?"bg-blue-500/20 border-blue-500/50 text-white shadow-lg shadow-blue-500/10 scale-[1.02]":"bg-slate-800/60 border-slate-700/60 text-slate-200 hover:bg-slate-800/80 hover:border-slate-700/80"}`;return e.jsxs("div",{className:E,children:[!D&&e.jsxs("div",{className:"flex items-center gap-2 mb-3 px-1",children:[e.jsx("div",{className:"text-xs font-semibold uppercase tracking-wider text-slate-400",children:"Quick Actions"}),e.jsx("div",{className:"flex-1 h-px bg-gradient-to-r from-slate-700/50 to-transparent"})]}),e.jsx("div",{className:T,children:h.map($=>{const F=g[$.id]||0,B=R===$.id;return e.jsxs("button",{onClick:()=>m($.value),onMouseEnter:()=>u($.id),onMouseLeave:f,"data-gesture-option":$.id,className:Q(B),children:[B&&F>0&&e.jsx("div",{className:"absolute bottom-0 left-0 h-1 bg-gradient-to-r from-blue-400 to-blue-500 transition-all duration-75",style:{width:`${F}%`}}),e.jsx("span",{className:"relative z-10",children:$.label})]},$.id)})})]})}function pt({models:c,selectedModelId:m,onSelectModel:D,autoMode:h,setAutoMode:R,autoModeScope:w,setAutoModeScope:g,isGenerating:j}){const[O,d]=i.useState(null),[L,N]=i.useState(""),u=i.useRef(null),f=i.useRef(null),E=i.useMemo(()=>c.filter(n=>n.type==="self-hosted"),[c]),T=i.useMemo(()=>c.filter(n=>n.type==="github"),[c]),Q=i.useMemo(()=>c.filter(n=>n.type==="external"),[c]),$=i.useMemo(()=>E.filter(n=>!L||n.name.toLowerCase().includes(L.toLowerCase())),[E,L]),F=i.useMemo(()=>T.filter(n=>!L||n.name.toLowerCase().includes(L.toLowerCase())),[T,L]),B=i.useMemo(()=>Q.filter(n=>!L||n.name.toLowerCase().includes(L.toLowerCase())),[Q,L]),k=c.find(n=>n.id===m);i.useEffect(()=>{const n=U=>{u.current&&!u.current.contains(U.target)&&d(null)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),i.useEffect(()=>{const n=U=>{U.key==="Escape"&&d(null)};return document.addEventListener("keydown",n),()=>document.removeEventListener("keydown",n)},[]);const z=n=>{R(!0),g(n),d(null),N("")},X=(n,U)=>{U.stopPropagation(),O===n?(d(null),N("")):(d(n),N(""),setTimeout(()=>{var le;return(le=f.current)==null?void 0:le.focus()},50))},G=n=>{R(!1),D(n),d(null),N("")},M=h&&w==="local",V=h&&w==="api",W=h&&w==="external",te=!h&&(k==null?void 0:k.type)==="self-hosted",J=!h&&(k==null?void 0:k.type)==="github",K=!h&&(k==null?void 0:k.type)==="external",re=n=>n==="local"?M?"Self-Hosted Auto":te&&(k==null?void 0:k.name)||"Self-Hosted":n==="api"?V?"GitHub Auto":J&&(k==null?void 0:k.name)||"GitHub":W?"External Auto":K&&(k==null?void 0:k.name)||"External";return e.jsxs("div",{className:"relative flex items-center gap-1 bg-slate-800/50 rounded-lg p-1 border border-slate-700/50 backdrop-blur-sm",ref:u,children:[e.jsxs("div",{className:"relative flex items-center",children:[e.jsxs("button",{onClick:()=>z("local"),disabled:j,className:`h-7 pl-3 pr-1 flex items-center gap-1.5 rounded-l-md transition-all active:scale-95 text-xs font-medium whitespace-nowrap ${M||te?"bg-emerald-500/20 text-emerald-300":"text-slate-400 hover:text-slate-300 hover:bg-slate-700/30"}`,children:[M?e.jsx(ne,{size:12,className:"text-emerald-400"}):e.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500"}),e.jsx("span",{className:"max-w-[120px] truncate",children:re("local")})]}),e.jsx("button",{onClick:n=>X("local",n),disabled:j,className:`h-7 px-1 flex items-center rounded-r-md transition-all ${M||te?"bg-emerald-500/20 text-emerald-400":"text-slate-500 hover:text-slate-300 hover:bg-slate-700/30"}`,children:e.jsx(we,{size:12,className:`transition-transform ${O==="local"?"rotate-180":""}`})}),O==="local"&&E.length>0&&e.jsxs("div",{className:"absolute top-full left-0 mt-1 w-56 bg-slate-800/95 backdrop-blur-md border border-slate-700 rounded-lg shadow-2xl z-[100] overflow-hidden animate-in fade-in slide-in-from-top-1 duration-150",children:[E.length>5&&e.jsx("div",{className:"px-2 py-2 border-b border-slate-700/50",children:e.jsxs("div",{className:"relative",children:[e.jsx(ce,{size:12,className:"absolute left-2 top-1/2 -translate-y-1/2 text-slate-500"}),e.jsx("input",{ref:f,type:"text",placeholder:"Search...",value:L,onChange:n=>N(n.target.value),className:"w-full pl-7 pr-2 py-1 text-xs bg-slate-700/50 border border-slate-600/50 rounded text-slate-200 placeholder-slate-500 focus:outline-none focus:border-emerald-500/50"})]})}),e.jsxs("button",{onClick:()=>z("local"),className:`w-full px-3 py-2 text-left text-xs font-medium transition-colors flex items-center justify-between ${M?"bg-emerald-500/20 text-emerald-300":"text-slate-300 hover:bg-slate-700/50"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{size:12,className:"text-emerald-400"}),e.jsx("span",{children:"Auto (Smart Fallback)"})]}),M&&e.jsx("span",{className:"text-emerald-400",children:"âœ“"})]}),e.jsx("div",{className:"border-t border-slate-700/50"}),e.jsx("div",{className:"max-h-48 overflow-y-auto",children:$.map(n=>e.jsxs("button",{onClick:()=>G(n.id),className:`w-full px-3 py-2 text-left text-xs font-medium transition-colors flex items-center justify-between ${!h&&m===n.id?"bg-emerald-500/20 text-slate-200":"text-slate-300 hover:bg-slate-700/50"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500/50"}),e.jsx("span",{children:n.name})]}),!h&&m===n.id&&e.jsx("span",{className:"text-emerald-400",children:"âœ“"})]},n.id))})]})]}),e.jsx("div",{className:"w-px h-5 bg-slate-600/50"}),e.jsxs("div",{className:"relative flex items-center",children:[e.jsxs("button",{onClick:()=>z("api"),disabled:j,className:`h-7 pl-3 pr-1 flex items-center gap-1.5 rounded-l-md transition-all active:scale-95 text-xs font-medium whitespace-nowrap ${V||J?"bg-blue-500/20 text-blue-300":"text-slate-400 hover:text-slate-300 hover:bg-slate-700/30"}`,children:[V?e.jsx(ne,{size:12,className:"text-blue-400"}):e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),e.jsx("span",{className:"max-w-[120px] truncate",children:re("api")})]}),e.jsx("button",{onClick:n=>X("api",n),disabled:j,className:`h-7 px-1 flex items-center rounded-r-md transition-all ${V||J?"bg-blue-500/20 text-blue-400":"text-slate-500 hover:text-slate-300 hover:bg-slate-700/30"}`,children:e.jsx(we,{size:12,className:`transition-transform ${O==="api"?"rotate-180":""}`})}),O==="api"&&T.length>0&&e.jsxs("div",{className:"absolute top-full right-0 mt-1 w-64 bg-slate-800/95 backdrop-blur-md border border-slate-700 rounded-lg shadow-2xl z-[100] overflow-hidden animate-in fade-in slide-in-from-top-1 duration-150",children:[T.length>5&&e.jsx("div",{className:"px-2 py-2 border-b border-slate-700/50",children:e.jsxs("div",{className:"relative",children:[e.jsx(ce,{size:12,className:"absolute left-2 top-1/2 -translate-y-1/2 text-slate-500"}),e.jsx("input",{ref:f,type:"text",placeholder:"Search models...",value:L,onChange:n=>N(n.target.value),className:"w-full pl-7 pr-2 py-1 text-xs bg-slate-700/50 border border-slate-600/50 rounded text-slate-200 placeholder-slate-500 focus:outline-none focus:border-blue-500/50"})]})}),e.jsxs("button",{onClick:()=>z("api"),className:`w-full px-3 py-2 text-left text-xs font-medium transition-colors flex items-center justify-between ${V?"bg-blue-500/20 text-blue-300":"text-slate-300 hover:bg-slate-700/50"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{size:12,className:"text-blue-400"}),e.jsx("span",{children:"Auto (Smart Fallback)"})]}),V&&e.jsx("span",{className:"text-blue-400",children:"âœ“"})]}),e.jsx("div",{className:"border-t border-slate-700/50"}),e.jsx("div",{className:"max-h-48 overflow-y-auto",children:F.map(n=>e.jsxs("button",{onClick:()=>G(n.id),className:`w-full px-3 py-2 text-left text-xs font-medium transition-colors flex items-center justify-between ${!h&&m===n.id?"bg-blue-500/20 text-slate-200":"text-slate-300 hover:bg-slate-700/50"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500/50"}),e.jsx("span",{children:n.name})]}),!h&&m===n.id&&e.jsx("span",{className:"text-blue-400",children:"âœ“"})]},n.id))})]})]}),e.jsx("div",{className:"w-px h-5 bg-slate-600/50"}),e.jsxs("div",{className:"relative flex items-center",children:[e.jsxs("button",{onClick:()=>z("external"),disabled:j,className:`h-7 pl-3 pr-1 flex items-center gap-1.5 rounded-l-md transition-all active:scale-95 text-xs font-medium whitespace-nowrap ${W||K?"bg-purple-500/20 text-purple-300":"text-slate-400 hover:text-slate-300 hover:bg-slate-700/30"}`,children:[W?e.jsx(ne,{size:12,className:"text-purple-400"}):e.jsx("div",{className:"w-2 h-2 rounded-full bg-purple-500"}),e.jsx("span",{className:"max-w-[120px] truncate",children:re("external")})]}),e.jsx("button",{onClick:n=>X("external",n),disabled:j,className:`h-7 px-1 flex items-center rounded-r-md transition-all ${W||K?"bg-purple-500/20 text-purple-400":"text-slate-500 hover:text-slate-300 hover:bg-slate-700/30"}`,children:e.jsx(we,{size:12,className:`transition-transform ${O==="external"?"rotate-180":""}`})}),O==="external"&&Q.length>0&&e.jsxs("div",{className:"absolute top-full right-0 mt-1 w-64 bg-slate-800/95 backdrop-blur-md border border-slate-700 rounded-lg shadow-2xl z-[100] overflow-hidden animate-in fade-in slide-in-from-top-1 duration-150",children:[Q.length>5&&e.jsx("div",{className:"px-2 py-2 border-b border-slate-700/50",children:e.jsxs("div",{className:"relative",children:[e.jsx(ce,{size:12,className:"absolute left-2 top-1/2 -translate-y-1/2 text-slate-500"}),e.jsx("input",{ref:f,type:"text",placeholder:"Search models...",value:L,onChange:n=>N(n.target.value),className:"w-full pl-7 pr-2 py-1 text-xs bg-slate-700/50 border border-slate-600/50 rounded text-slate-200 placeholder-slate-500 focus:outline-none focus:border-purple-500/50"})]})}),e.jsxs("button",{onClick:()=>z("external"),className:`w-full px-3 py-2 text-left text-xs font-medium transition-colors flex items-center justify-between ${W?"bg-purple-500/20 text-purple-300":"text-slate-300 hover:bg-slate-700/50"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{size:12,className:"text-purple-400"}),e.jsx("span",{children:"Auto (Smart Fallback)"})]}),W&&e.jsx("span",{className:"text-purple-400",children:"âœ“"})]}),e.jsx("div",{className:"border-t border-slate-700/50"}),e.jsx("div",{className:"max-h-48 overflow-y-auto",children:B.map(n=>e.jsxs("button",{onClick:()=>G(n.id),className:`w-full px-3 py-2 text-left text-xs font-medium transition-colors flex items-center justify-between ${!h&&m===n.id?"bg-purple-500/20 text-slate-200":"text-slate-300 hover:bg-slate-700/50"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-purple-500/50"}),e.jsx("span",{children:n.name})]}),!h&&m===n.id&&e.jsx("span",{className:"text-purple-400",children:"âœ“"})]},n.id))})]})]})]})}const vt=i.forwardRef(({models:c,selectedModelId:m,onSelectModel:D,githubToken:h,openrouterKey:R,messages:w,setMessages:g,autoMode:j,setAutoMode:O,autoModeScope:d,setAutoModeScope:L,currentResponse:N,setCurrentResponse:u,isGenerating:f,setIsGenerating:E,onModelUsed:T,gesturesActive:Q=!1},$)=>{var Pe;const[F,B]=i.useState(!1),[k,z]=i.useState(null),[X,G]=i.useState(new Set),[M,V]=i.useState(null),[W,te]=i.useState(null),[J,K]=i.useState(new Set),[re,n]=i.useState(""),[U,le]=i.useState(null),ae=i.useRef(new Map);i.useRef(new Map);const Z=i.useRef(null),Re=i.useRef(null),I=i.useRef(null),oe=i.useRef(null),ue=i.useRef(new Map),de=i.useRef(null),Ae=i.useRef(null),pe=rt(),He=((Pe=pe==null?void 0:pe.gestureState)==null?void 0:Pe.gesture)==="Middle_Finger",{sortModels:Le,recordRateLimit:Ee,recordSuccess:fe}=it(),xe=i.useRef(!1),Be=t=>{if(!I.current)return t;const r=I.current.scrollHeight-I.current.clientHeight;return Math.max(0,Math.min(r,t))},Ie=()=>{if(!I.current)return!0;const{scrollTop:t,scrollHeight:r,clientHeight:a}=I.current;return r-t-a<100};i.useImperativeHandle($,()=>({sendMessage:(t,r)=>{he(t,r)},setInput:t=>{oe.current&&(oe.current.value=t,oe.current.focus())},stopGeneration:()=>{$e()},scroll:t=>{if(I.current){xe.current=!0;const r=I.current.scrollTop,a=Be(r-t);I.current.scrollTop=a}}}));const{selectionRect:Me}=at({containerRef:Re,itemRefs:ue,setSelectedIndices:G});i.useEffect(()=>{I.current&&!xe.current&&(I.current.scrollTop=I.current.scrollHeight)},[w,N,f]),i.useEffect(()=>{const t=I.current;if(!t)return;const r=()=>{Ie()&&(xe.current=!1)};return t.addEventListener("scroll",r,{passive:!0}),()=>t.removeEventListener("scroll",r)},[]),i.useEffect(()=>{const t=r=>{var s;if(r.ctrlKey||r.metaKey||r.altKey)return;const a=r.target;a.tagName==="INPUT"||a.tagName==="TEXTAREA"||r.key.length===1&&((s=oe.current)==null||s.focus())};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[]),i.useEffect(()=>{const t=r=>{if((r.metaKey||r.ctrlKey)&&r.key==="a"){const a=r.target;if(a.tagName==="INPUT"||a.tagName==="TEXTAREA")return;r.preventDefault();const s=new Set(w.map((o,p)=>p));G(s);return}if(r.key==="Delete"||r.key==="Backspace"){if(X.size>0){const a=r.target;if(a.tagName==="INPUT"||a.tagName==="TEXTAREA")return;r.preventDefault(),qe()}}else r.key==="Escape"&&G(new Set)};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[X,w]);const me=async(t,r)=>{var a,s,o;try{const p=await Ne({models:[t],messages:r.map(l=>({role:l.role,content:l.content})),max_tokens:2048,temperature:.7,github_token:h||null,openrouter_key:R||null},(a=Z.current)==null?void 0:a.signal);let x="";return await Se(p,l=>{var y;if((y=Z.current)!=null&&y.signal.aborted)throw new DOMException("Aborted","AbortError");if(l.event==="error"||l.error){const b=typeof l.error=="string"?l.error:l.content||"Stream failed";throw(b.includes("429")||b.toLowerCase().includes("rate limit")||b.toLowerCase().includes("too many requests"))&&(Ee(t),console.log(`[Auto Mode] Rate limit detected for ${t}, trying next model...`)),new Error(b)}else(l.event==="token"||l.content)&&l.content&&(x+=l.content,u(b=>b+l.content))}),fe(t),{success:!0,content:x}}catch(p){if(p.name==="AbortError")throw p;const x=((s=p.message)==null?void 0:s.includes("429"))||((o=p.message)==null?void 0:o.toLowerCase().includes("rate limit"));return x&&Ee(t),{success:!1,content:p.message,isRateLimit:x}}},he=async(t,r=!1)=>{var s,o;if(!t.trim()||f||!j&&!m)return;console.log(`[Chat] Sending message. autoMode=${j}, autoModeScope=${d}, selectedModelId=${m}`);const a={role:"user",content:t};g(p=>[...p,a]),E(!0),u(""),Z.current=new AbortController;try{const p=r?{role:"system",content:`User is hands-free using gesture control. Build an interactive interface to guide them.

Available gesture inputs:
- ðŸ‘ (yes/approve/like)
- ðŸ‘Ž (no/disapprove/dislike)
- ðŸ‘‹ (hi/hello/greeting)
- "ok" (okay/continue)
- "thanks" (thank you)
- "stop" (stop/wait)
- Pointing finger (select UI buttons)

Choose interaction style:
- Simple binary: "Give ðŸ‘ to continue or ðŸ‘Ž to stop" (no JSON needed)
- Complex choices: Use JSON UI buttons (3+ options, or multi-word responses needed)

For JSON UI (when appropriate):
\`\`\`json
{
  "options": [
    {"id": "opt1", "label": "Option 1", "action": "message", "value": "option 1"},
    {"id": "opt2", "label": "Option 2", "action": "message", "value": "option 2"}
  ]
}
\`\`\`

Guidelines:
- Keep response concise (2-3 sentences)
- Use simple gestures for yes/no/continue (more efficient)
- Use JSON UI for 3+ options or complex choices
- Provide 2-4 options max in JSON
- User can point at buttons with index finger`}:null,x=t==="ðŸ–•"||t.includes("middle finger")?{role:"system",content:"The user is showing you their middle finger (gesture). This is a playful interaction. Respond with humorous, over-the-top anger, indignation, or witty comeback. Don't be actually offended, but play along with the 'angry robot' persona."}:null,l=[...w,a].map(b=>({role:b.role,content:b.content})),y=[...p?[p]:[],...x?[x]:[],...l];if(j){const b=c.filter(C=>d==="local"?C.type==="self-hosted":d==="api"?C.type==="github"||C.type==="external":!0),A=c.filter(C=>d==="local"?C.type==="github"||C.type==="external":d==="api"?C.type==="self-hosted":!1),v=Le(b),S=Le(A);let P=null,_=!1,H=0;console.log(`[Auto Mode] Starting with ${v.length} primary (${d}) models, ${S.length} fallback models`);for(const C of v){console.log(`[Auto Mode] Trying primary model: ${C.id}`),z(C.id),u("");const q=await me(C.id,y);if(q.success){console.log(`[Auto Mode] Success with ${C.id}`),g(ve=>[...ve,{role:"assistant",content:q.content,modelName:C.name,modelId:C.id}]),u(""),z(null),T==null||T(C.id);return}console.log(`[Auto Mode] Failed with ${C.id}: ${(s=q.content)==null?void 0:s.substring(0,100)}`),q.isRateLimit&&H++,P=q.content}if(S.length>0){console.log(`[Auto Mode] All primary models failed, trying ${S.length} fallback models`),_=!0;for(const C of S){console.log(`[Auto Mode] Trying fallback model: ${C.id}`),z(C.id),u("");const q=await me(C.id,y);if(q.success){console.log(`[Auto Mode] Success with fallback ${C.id}`),g(ve=>[...ve,{role:"assistant",content:q.content,modelName:C.name,modelId:C.id}]),u(""),z(null),T==null||T(C.id);return}console.log(`[Auto Mode] Fallback failed with ${C.id}: ${(o=q.content)==null?void 0:o.substring(0,100)}`),q.isRateLimit&&H++,P=q.content}}else console.log("[Auto Mode] No fallback models available");console.log(`[Auto Mode] All ${v.length+S.length} models failed (${H} rate limited)`);let Y;const se=v.length+S.length;H>0&&H>=se?Y=`â±ï¸ All ${se} models are currently rate limited. GitHub Models has strict free tier limits. Try again in a minute, or add your own GitHub token in Settings for higher quota.`:H>0?Y=`All models failed (${H} rate limited). Last error: ${P}`:_?Y=`All models failed to respond. Last error: ${P}`:Y=`All ${d} models failed to respond. Last error: ${P}`,g(C=>[...C,{role:"assistant",content:Y,error:!0}]),z(null)}else{if(!m)return;const b=c.find(v=>v.id===m),A=await me(m,y);A.success?(g(v=>[...v,{role:"assistant",content:A.content,modelName:b==null?void 0:b.name,modelId:m}]),T==null||T(m)):g(v=>[...v,{role:"assistant",content:A.content,modelName:b==null?void 0:b.name,error:!0}])}u("")}catch(p){p.name!=="AbortError"&&g(x=>[...x,{role:"assistant",content:p.message,error:!0}])}finally{E(!1),z(null),Z.current=null}},$e=()=>{Z.current&&(Z.current.abort(),E(!1),N&&(g(t=>[...t,{role:"assistant",content:N}]),u("")))},ze=async(t,r)=>{if(f||w[t].role!=="assistant")return;let s=t-1;for(;s>=0&&w[s].role!=="user";)s--;if(s<0)return;const o=c.find(x=>x.id===r);if(!o)return;const p=w.slice(0,t).map(x=>({role:x.role,content:x.content}));E(!0),V(t),z(r),g(x=>x.map((l,y)=>y===t?{...l,content:"",modelName:o.name,modelId:r,error:void 0}:l)),Z.current=new AbortController;try{const x=await Ne({models:[r],messages:p,max_tokens:4096,temperature:.7,github_token:h,openrouter_key:R},Z.current.signal);let l="";await Se(x,y=>{var b;if((b=Z.current)!=null&&b.signal.aborted)throw new DOMException("Aborted","AbortError");if(y.event==="error"||y.error){const A=typeof y.error=="string"?y.error:y.content||"Stream failed";throw new Error(A)}else(y.event==="token"||y.content)&&y.content&&(l+=y.content,g(A=>A.map((v,S)=>S===t?{...v,content:l}:v)))}),fe(r),T==null||T(r)}catch(x){x.name!=="AbortError"&&g(l=>l.map((y,b)=>b===t?{...y,content:x.message,error:!0}:y))}finally{E(!1),V(null),z(null),Z.current=null}},Te=(t,r)=>{if(!t)return c[0]||null;const a=c.find(x=>x.id===t),s=(a==null?void 0:a.type)||"api",o=c.filter(x=>x.type===s),p=o.findIndex(x=>x.id===t);return p===-1?o[0]||null:r==="prev"?p>0?o[p-1]:o[o.length-1]:p<o.length-1?o[p+1]:o[0]},Xe=(t,r)=>{r.stopPropagation(),W===t?(te(null),K(new Set),n("")):(te(t),K(new Set),n(""),setTimeout(()=>{var a;return(a=Ae.current)==null?void 0:a.focus()},50))},be=i.useCallback(()=>{te(null),K(new Set),n("")},[]),We=t=>{K(r=>{const a=new Set(r);return a.has(t)?a.delete(t):a.add(t),a})},Oe=i.useCallback((t,r)=>{const a=ae.current.get(r);a&&(a.abort(),ae.current.delete(r)),g(s=>s.map((o,p)=>p===t&&o.alternateResponses?{...o,alternateResponses:o.alternateResponses.filter(x=>x.modelId!==r)}:o))},[g]),Je=i.useCallback(async(t,r=0)=>{var o;const a=w[t];if(!a)return;let s;r===0||!a.alternateResponses?s=a.content:s=((o=a.alternateResponses[r-1])==null?void 0:o.content)||a.content;try{await navigator.clipboard.writeText(s);const p=`${t}-${r}`;le(p),setTimeout(()=>le(null),2e3)}catch(p){console.error("Failed to copy:",p)}},[w]),Ke=async t=>{if(J.size===0||w[t].role!=="assistant")return;let a=t-1;for(;a>=0&&w[a].role!=="user";)a--;if(a<0)return;const s=w.slice(0,t).map(l=>({role:l.role,content:l.content})),o=Array.from(J),p=o.map(l=>{const y=c.find(b=>b.id===l);return{modelId:l,modelName:(y==null?void 0:y.name)||l,content:"",loading:!0}});g(l=>l.map((y,b)=>b===t?{...y,alternateResponses:[...y.alternateResponses||[],...p]}:y)),te(null),K(new Set);const x=async l=>{if(!c.find(A=>A.id===l))return;const b=new AbortController;ae.current.set(l,b);try{const A=await Ne({models:[l],messages:s,max_tokens:4096,temperature:.7,github_token:h,openrouter_key:R},b.signal);let v="";await Se(A,S=>{if(b.signal.aborted)throw new DOMException("Aborted","AbortError");if(S.event==="error"||S.error){const P=typeof S.error=="string"?S.error:S.content||"Stream failed";throw new Error(P)}else(S.event==="token"||S.content)&&S.content&&(v+=S.content,g(P=>P.map((_,H)=>H===t&&_.alternateResponses?{..._,alternateResponses:_.alternateResponses.map(Y=>Y.modelId===l?{...Y,content:v}:Y)}:_)))}),g(S=>S.map((P,_)=>_===t&&P.alternateResponses?{...P,alternateResponses:P.alternateResponses.map(H=>H.modelId===l?{...H,loading:!1}:H)}:P)),fe(l)}catch(A){A.name!=="AbortError"&&g(v=>v.map((S,P)=>P===t&&S.alternateResponses?{...S,alternateResponses:S.alternateResponses.map(_=>_.modelId===l?{..._,content:A.message,error:!0,loading:!1}:_)}:S))}finally{ae.current.delete(l)}};o.forEach(l=>x(l))},De=(t,r)=>{g(a=>a.map((s,o)=>o===t?{...s,activeResponseIndex:r}:s))},Ye=(t,r)=>{if(ae.current.has(r)){Oe(t,r);return}g(a=>a.map((s,o)=>{var b;if(o!==t||!s.alternateResponses)return s;const p=s.alternateResponses.filter(A=>A.modelId!==r);if(p.length===s.alternateResponses.length)return s;const x=s.activeResponseIndex??0,y=(x===0?s.modelId:(b=s.alternateResponses[x-1])==null?void 0:b.modelId)===r?0:x;return{...s,alternateResponses:p,activeResponseIndex:y}}))};i.useEffect(()=>{const t=a=>{de.current&&!de.current.contains(a.target)&&be()},r=a=>{a.key==="Escape"&&be()};return W!==null&&(document.addEventListener("mousedown",t),document.addEventListener("keydown",r)),()=>{document.removeEventListener("mousedown",t),document.removeEventListener("keydown",r)}},[W,be]);const qe=()=>{X.size!==0&&(g(t=>t.filter((r,a)=>!X.has(a))),G(new Set))},ee=c.find(t=>t.id===m),ge=j&&k?c.find(t=>t.id===k):ee;return e.jsxs("div",{ref:Re,className:"flex flex-col h-full relative isolate z-[10]",children:[e.jsx(st,{rect:Me}),e.jsx("div",{ref:I,className:"flex-1 overflow-y-auto p-4 pb-32 chat-scroll relative z-[10] [mask-image:linear-gradient(to_bottom,transparent_0%,black_2rem,black_calc(100%-4rem),transparent_100%)]","data-no-arena-scroll":!0,onClick:t=>{(t.target===t.currentTarget||!t.target.closest("[data-message]"))&&G(new Set)},children:e.jsxs("div",{className:"mx-auto w-full min-h-full flex flex-col space-y-6",style:{maxWidth:"600px"},children:[w.length===0&&e.jsxs("div",{className:"flex-1 flex flex-col items-center text-slate-500 select-none pb-20 relative pt-[30vh]",children:[He?e.jsxs("div",{className:"mb-4 relative",children:[e.jsx("div",{className:"absolute inset-0 bg-red-500 blur-xl opacity-50 rounded-full"}),e.jsx(ye,{size:72,className:"relative text-red-500"}),e.jsx("div",{className:"absolute -top-2 -right-2 text-3xl",children:"ðŸ’¢"})]}):e.jsx(ye,{size:72,className:"mb-4 opacity-50 transition-all duration-300"}),e.jsx("div",{className:"flex flex-col items-center gap-2 mb-4 sticky top-4 z-30",children:e.jsx(pt,{models:c,selectedModelId:m,onSelectModel:D,autoMode:j,setAutoMode:O,autoModeScope:d,setAutoModeScope:L,isGenerating:f})}),!h&&(!j&&(ee==null?void 0:ee.type)==="github"||(ee==null?void 0:ee.type)==="external"||j&&d==="api")&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-md bg-yellow-500/10 border border-yellow-500/20 text-yellow-200 text-xs",children:[e.jsx(je,{size:11,className:"shrink-0 text-yellow-500"}),e.jsx("span",{children:"Add GitHub token in Settings for dedicated quota"})]})]}),w.map((t,r)=>{const a=t.role==="assistant"&&Q&&t.content.includes("```json");return e.jsxs("div",{ref:s=>{s?ue.current.set(r,s):ue.current.delete(r)},className:`flex ${t.role==="user"?"justify-end":a?"flex-col sm:flex-row justify-start items-start gap-4":"justify-start"}`,"data-message":r,onClick:s=>{(s.target===s.currentTarget||s.target.closest("[data-message]")===s.currentTarget)&&G(o=>{const p=new Set(o);return p.has(r)?p.delete(r):p.add(r),p})},children:[e.jsxs("div",{className:`group relative ${a?"w-full sm:flex-1 sm:max-w-[45%]":"max-w-[85%]"} rounded-2xl px-4 pt-3 pb-2 select-none transition-all cursor-pointer ${X.has(r)?"ring-2 ring-blue-500 bg-blue-500/10":""} ${t.role==="user"?"bg-blue-600/20 border border-blue-500/30 text-white rounded-tr-sm":M===r?"rounded-tl-sm":t.error?"bg-red-500/10 border border-red-500/30 text-red-200 rounded-tl-sm":"bg-slate-800/60 border border-slate-700/60 text-slate-200 rounded-tl-sm"}`,style:M===r?{background:"rgba(30, 41, 59, 0.8)",border:"1px solid rgba(251, 191, 36, 0.4)",boxShadow:"0 0 20px rgba(251, 191, 36, 0.15), inset 0 0 30px rgba(251, 191, 36, 0.03)"}:void 0,children:[e.jsxs("div",{className:`flex items-center gap-2 mb-1 text-[10px] font-bold uppercase tracking-wider ${t.role==="user"?"text-blue-300 flex-row-reverse":M===r?"text-amber-400/80":"text-slate-400"}`,children:[t.role==="user"?e.jsx(Qe,{size:12}):M===r?e.jsx("div",{className:"relative flex items-center justify-center",style:{width:"14px",height:"14px"},children:e.jsxs("svg",{width:14,height:14,viewBox:"0 0 24 24",fill:"none",style:{filter:"drop-shadow(0 0 6px rgba(251, 191, 36, 0.55))",animation:"spin 0.6s linear infinite"},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"regenSpinnerGradient",gradientUnits:"userSpaceOnUse",x1:"3",y1:"12",x2:"12",y2:"3",children:[e.jsx("stop",{offset:"0%",stopColor:"#fbbf24",stopOpacity:"1"}),e.jsx("stop",{offset:"60%",stopColor:"#fbbf24",stopOpacity:"0.5"}),e.jsx("stop",{offset:"100%",stopColor:"#fbbf24",stopOpacity:"0"})]})}),e.jsx("circle",{cx:"12",cy:"12",r:"9",stroke:"url(#regenSpinnerGradient)",strokeWidth:"2.5",fill:"none",strokeLinecap:"round"})]})}):e.jsx(ye,{size:12}),t.role==="user"?"You":e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:s=>{s.stopPropagation();const o=Te(t.modelId,"prev");o&&!f&&ze(r,o.id)},disabled:f,className:"p-0.5 rounded hover:bg-slate-700/50 transition-colors disabled:opacity-30",title:"Try previous model",children:e.jsx(Ge,{size:10})}),e.jsx("span",{className:"px-1",children:t.modelName||"Assistant"}),(j||t.alternateResponses&&t.alternateResponses.length>0)&&e.jsx("div",{className:"ml-1 flex flex-wrap items-center gap-1",children:(()=>{const s=t.activeResponseIndex??0,o=j?c.filter(l=>d==="local"?l.type==="self-hosted":d==="api"?l.type==="github"||l.type==="external":!0):[],p=new Map((t.alternateResponses||[]).map((l,y)=>[l.modelId,{alt:l,altIdx:y}])),x=j?o.map(l=>({id:l.id,name:l.name})):[];return!j&&t.modelId&&x.push({id:t.modelId,name:t.modelName||t.modelId}),j||(t.alternateResponses||[]).forEach(l=>{x.push({id:l.modelId,name:l.modelName})}),x.map((l,y)=>{const b=t.modelId===l.id,A=p.get(l.id),v=A==null?void 0:A.alt,S=(A==null?void 0:A.altIdx)??0,P=b||!!v,_=b?s===0:v?s===S+1:!1,H=l.name||l.id,Y=v!=null&&v.loading?"bg-amber-500/20 text-amber-300 ring-1 ring-amber-500/40":v!=null&&v.error?"bg-red-500/20 text-red-300 ring-1 ring-red-500/40":P?b&&_?"bg-emerald-500/25 text-emerald-200 ring-1 ring-emerald-500/50":_?"bg-blue-500/30 text-blue-200 ring-1 ring-blue-500/50":"bg-slate-700/40 text-slate-400 hover:text-slate-200 hover:bg-slate-700/60":"bg-slate-800/50 text-slate-500 ring-1 ring-slate-700/50";return e.jsxs("span",{className:"flex items-center",children:[e.jsxs("button",{onClick:se=>{se.stopPropagation(),P&&(b?De(r,0):v&&De(r,S+1))},className:`px-2 py-0.5 text-[9px] rounded-full transition-colors flex items-center gap-1 ${Y}`,title:P?"Response":"Not in this reply",children:[(v==null?void 0:v.loading)&&e.jsx(Ze,{size:8,className:"animate-spin text-amber-400"}),(v==null?void 0:v.error)&&e.jsx(je,{size:8,className:"text-red-400"}),H]}),v?v.loading?e.jsx("button",{onClick:se=>{se.stopPropagation(),Oe(r,v.modelId)},className:"ml-0.5 p-0.5 rounded-full hover:bg-red-500/20 text-slate-500 hover:text-red-400 transition-colors",title:"Cancel",children:e.jsx(Fe,{size:8})}):e.jsx("button",{onClick:se=>{se.stopPropagation(),Ye(r,v.modelId)},className:"ml-0.5 p-0.5 rounded-full hover:bg-red-500/20 text-slate-500 hover:text-red-400 transition-colors",title:"Remove",children:e.jsx(Fe,{size:8})}):null]},`${l.id}-${y}`)})})()}),e.jsx("button",{onClick:s=>{s.stopPropagation();const o=Te(t.modelId,"next");o&&!f&&ze(r,o.id)},disabled:f,className:"p-0.5 rounded hover:bg-slate-700/50 transition-colors disabled:opacity-30",title:"Try next model",children:e.jsx(Ve,{size:10})}),e.jsxs("div",{className:"relative ml-1",children:[e.jsx("button",{onClick:s=>Xe(r,s),disabled:f,className:"p-0.5 rounded hover:bg-slate-700/50 transition-colors disabled:opacity-30",title:"Add parallel replies",children:e.jsx(Ue,{size:10})}),W===r&&e.jsxs("div",{ref:de,className:"absolute top-full left-0 mt-1 w-64 bg-slate-800/95 backdrop-blur-md border border-slate-700 rounded-lg shadow-2xl z-[100] overflow-hidden animate-in fade-in slide-in-from-top-1 duration-150",onClick:s=>s.stopPropagation(),children:[e.jsx("div",{className:"px-3 py-2 border-b border-slate-700/50",children:e.jsxs("div",{className:"relative",children:[e.jsx(ce,{size:12,className:"absolute left-2 top-1/2 -translate-y-1/2 text-slate-500"}),e.jsx("input",{ref:Ae,type:"text",placeholder:"Search models...",value:re,onChange:s=>n(s.target.value),className:"w-full pl-7 pr-2 py-1.5 text-xs bg-slate-700/50 border border-slate-600/50 rounded text-slate-200 placeholder-slate-500 focus:outline-none focus:border-blue-500/50"})]})}),e.jsxs("div",{className:"flex gap-1 p-2 border-b border-slate-700/50",children:[e.jsx("button",{onClick:()=>{const s=c.filter(o=>o.type==="self-hosted"&&o.id!==t.modelId).map(o=>o.id);K(new Set(s))},className:"flex-1 px-2 py-1 text-[10px] rounded bg-emerald-500/20 text-emerald-300 hover:bg-emerald-500/30 transition-colors",children:"All Self-Hosted"}),e.jsx("button",{onClick:()=>{const s=c.filter(o=>o.type==="github"||o.type==="external"&&o.id!==t.modelId).map(o=>o.id);K(new Set(s))},className:"flex-1 px-2 py-1 text-[10px] rounded bg-blue-500/20 text-blue-300 hover:bg-blue-500/30 transition-colors",children:"All GitHub"})]}),e.jsx("div",{className:"max-h-48 overflow-y-auto",children:c.filter(s=>s.id!==t.modelId).filter(s=>!re||s.name.toLowerCase().includes(re.toLowerCase())||s.id.toLowerCase().includes(re.toLowerCase())).map(s=>e.jsxs("button",{onClick:()=>We(s.id),className:`w-full px-3 py-1.5 text-left text-xs flex items-center justify-between transition-colors ${J.has(s.id)?"bg-slate-700/50 text-white":"text-slate-300 hover:bg-slate-700/30"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${s.type==="self-hosted"?"bg-emerald-500":"bg-blue-500"}`}),e.jsx("span",{children:s.name})]}),J.has(s.id)&&e.jsx(_e,{size:12,className:"text-emerald-400"})]},s.id))}),J.size>0&&e.jsx("div",{className:"p-2 border-t border-slate-700/50",children:e.jsxs("button",{onClick:()=>Ke(r),className:"w-full px-3 py-1.5 text-xs font-medium rounded bg-blue-500/20 text-blue-300 hover:bg-blue-500/30 transition-colors",children:["Run parallel with ",J.size," model",J.size>1?"s":""]})})]})]})]}),t.error&&e.jsx(je,{size:12,className:"text-red-400"})]}),e.jsx("div",{className:"prose prose-invert prose-sm max-w-none mt-2",children:(()=>{const s=t.activeResponseIndex??0;if(s===0||!t.alternateResponses)return e.jsx(ie,{text:t.role==="user"?t.content:Ce(t.content)});const o=t.alternateResponses[s-1];return o?e.jsx(ie,{text:Ce(o.content)}):e.jsx(ie,{text:Ce(t.content)})})()}),t.role==="assistant"&&t.content&&e.jsx("button",{onClick:s=>{s.stopPropagation(),Je(r,t.activeResponseIndex??0)},className:`absolute bottom-2 right-2 p-1.5 rounded-md transition-all z-10 ${U===`${r}-${t.activeResponseIndex??0}`?"bg-emerald-500/20 text-emerald-400":"opacity-0 group-hover:opacity-100 bg-slate-700/70 hover:bg-slate-600/70 text-slate-400"}`,title:U===`${r}-${t.activeResponseIndex??0}`?"Copied!":"Copy response",children:U===`${r}-${t.activeResponseIndex??0}`?e.jsx(_e,{size:12}):e.jsx(et,{size:12})})]}),a&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full sm:hidden h-px bg-gradient-to-r from-transparent via-blue-500/30 to-transparent my-3"}),e.jsxs("div",{className:"hidden sm:flex items-center self-stretch py-6",children:[e.jsx("div",{className:"h-full w-px bg-gradient-to-b from-transparent via-blue-500/30 to-transparent"}),e.jsx("div",{className:"w-3 h-px bg-blue-500/30"})]}),e.jsx("div",{className:"w-full sm:flex-1 sm:max-w-[40%]",children:e.jsx(dt,{content:t.content,onSelect:s=>he(s,!0),isInline:!1})})]})]},r)}),f&&M===null&&e.jsx("div",{className:"flex justify-start",children:e.jsxs("div",{className:"max-w-[85%] rounded-2xl rounded-tl-sm px-4 pt-3 pb-0 text-slate-200 relative",style:{background:"rgba(30, 41, 59, 0.8)",border:"1px solid rgba(251, 191, 36, 0.4)",boxShadow:"0 0 20px rgba(251, 191, 36, 0.15), inset 0 0 30px rgba(251, 191, 36, 0.03)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 text-[10px] font-bold uppercase tracking-wider text-amber-400/80",children:[e.jsx("div",{className:"relative flex items-center justify-center",style:{width:"14px",height:"14px"},children:e.jsxs("svg",{width:14,height:14,viewBox:"0 0 24 24",fill:"none",style:{filter:"drop-shadow(0 0 6px rgba(251, 191, 36, 0.55))",animation:"spin 0.6s linear infinite"},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"chatSpinnerGradient",gradientUnits:"userSpaceOnUse",x1:"3",y1:"12",x2:"12",y2:"3",children:[e.jsx("stop",{offset:"0%",stopColor:"#fbbf24",stopOpacity:"1"}),e.jsx("stop",{offset:"60%",stopColor:"#fbbf24",stopOpacity:"0.5"}),e.jsx("stop",{offset:"100%",stopColor:"#fbbf24",stopOpacity:"0"})]})}),e.jsx("circle",{cx:"12",cy:"12",r:"9",stroke:"rgba(251, 191, 36, 0.15)",strokeWidth:"2",fill:"none"}),e.jsx("path",{d:"M 12 3 A 9 9 0 1 1 3 12",stroke:"url(#chatSpinnerGradient)",strokeWidth:"2",strokeLinecap:"round",fill:"none"}),e.jsx("circle",{cx:"3",cy:"12",r:"1.4",fill:"#fbbf24"})]})}),(ge==null?void 0:ge.name)||"Assistant"]}),e.jsx("div",{className:"prose prose-invert prose-sm max-w-none",children:e.jsx(ie,{text:N})})]})})]})}),e.jsx(nt,{inputRef:oe,inputFocused:F,setInputFocused:B,onSendMessage:he,placeholder:j?"Message (Auto mode - will use auto-selected model)...":ee?`Message ${ee.name}...`:"Select a model from the dock to start chatting...",isGenerating:f,onStop:$e,className:"fixed bottom-0 left-0 right-0 z-[100] pb-6 px-3 sm:px-4 flex justify-center items-end pointer-events-none transition-all duration-300",style:{paddingBottom:"calc(1.5rem + env(safe-area-inset-bottom))"}})]})});export{vt as default};
