const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SettingsModal-BWYev0OT.js","assets/react-vendor-CQxWqugw.js","assets/markdown-BNX5kHMI.js","assets/math-render-D6B7xoul.js","assets/math-render-BqiDbsU2.css","assets/syntax-highlight-K7DiErAG.js","assets/syntax-highlight-BEHUn5zE.css","assets/ResponseModal-reNlrW8D.js","assets/FormattedContent-ClPh4eCb.js","assets/DiscussionTranscript-DlpfGpjw.js","assets/GestureControl-CV1hepTl.js","assets/HandBackground-F7iiHyIM.js","assets/mediapipe-BWDqrTQ6.js","assets/ChatView-ChBC1V4N.js"])))=>i.map(i=>d[i]);
var Un=Object.defineProperty;var Kn=(t,s,r)=>s in t?Un(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r;var tn=(t,s,r)=>Kn(t,typeof s!="symbol"?s+"":s,r);import{r as n,j as e,X as qn,S as Vn,C as Qn,a as Jn,A as Zn,b as es,Z as ts,T as ns,R as ss,c as rs,d as os}from"./react-vendor-CQxWqugw.js";import"./math-render-D6B7xoul.js";import"./syntax-highlight-K7DiErAG.js";import"./markdown-BNX5kHMI.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))a(f);new MutationObserver(f=>{for(const i of f)if(i.type==="childList")for(const x of i.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&a(x)}).observe(document,{childList:!0,subtree:!0});function r(f){const i={};return f.integrity&&(i.integrity=f.integrity),f.referrerPolicy&&(i.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?i.credentials="include":f.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(f){if(f.ep)return;f.ep=!0;const i=r(f);fetch(f.href,i)}})();const as="modulepreload",is=function(t){return"/static/playground/"+t},nn={},$e=function(s,r,a){let f=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const x=document.querySelector("meta[property=csp-nonce]"),c=(x==null?void 0:x.nonce)||(x==null?void 0:x.getAttribute("nonce"));f=Promise.allSettled(r.map(u=>{if(u=is(u),u in nn)return;nn[u]=!0;const d=u.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${h}`))return;const p=document.createElement("link");if(p.rel=d?"stylesheet":as,d||(p.as="script"),p.crossOrigin="",p.href=u,c&&p.setAttribute("nonce",c),document.head.appendChild(p),d)return new Promise((w,R)=>{p.addEventListener("load",w),p.addEventListener("error",()=>R(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(x){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=x,window.dispatchEvent(c),!c.defaultPrevented)throw x}return f.then(x=>{for(const c of x||[])c.status==="rejected"&&i(c.reason);return s().catch(i)})},ls={"self-hosted":{color:"#10b981"},github:{color:"#3b82f6"},external:{color:"#8b5cf6"}},cs=["deepseek-r1-distill-qwen-1.5b","r1qwen","smollm3","nanbeige"],us=["gpt-oss","gptoss"],ds=t=>{const s=t.toLowerCase();return cs.some(r=>s.includes(r.toLowerCase()))},fs=t=>{const s=t.toLowerCase();return us.some(r=>s.includes(r.toLowerCase()))},Rt=[{id:"eu-ai-act-enforcement",label:"EU AI Act Enforcement Wave",prompt:"The EU AI Act enters enforcement; high-risk systems must prove data provenance, evals, and risk controls. Outline compliance gaps for a frontier model API and tradeoffs between speed and alignment.",category:"Policy",modes:["analyze","debate"],tags:["governance","compliance"]},{id:"export-controls-blackwell",label:"Export Controls Tighten",prompt:"U.S. export rules tighten again on AI accelerators; Blackwell-class parts face new caps and cloud checks. Map the impact on training roadmaps, costs, and on-device strategies.",category:"Infra",modes:["compare","debate"],tags:["chips","supply-chain"]},{id:"weights-leak",label:"Major Weights Leak",prompt:"A commercial frontier model checkpoint leaks. Assess risks (misuse, impersonation, jailbreak diffusion), legal exposure, and whether open red-team releases mitigate or worsen safety.",category:"Security",modes:["analyze","debate"],tags:["safety","open-weights"]},{id:"on-device-llm-race",label:"On-Device LLM Race",prompt:"Phone OEMs ship 3nm NPUs and 20B-parameter on-device assistants. What actually moves the needle for UX, privacy, and cost vs. cloud? Where do hybrid (edge + cloud) designs win?",category:"Infra",modes:["compare","debate"],tags:["edge","latency"]},{id:"signed-app-prompt-injection",label:"Signed App Prompt Injection",prompt:"A popular signed desktop app shipped with hardcoded system prompts; attackers use supply chain updates to exfiltrate data. How should vendors audit, sandbox, and attest LLM apps?",category:"Security",modes:["compare","analyze"],tags:["supply-chain","prompt-injection"]},{id:"eval-standardization",label:"Safety Eval Standard",prompt:"NIST-style safety eval suites gain traction (jailbreak, autonomy, bio). How should vendors report scores, and what gaps remain for frontier vs. small models?",category:"Policy",modes:["compare","debate"],tags:["evaluation","safety"]},{id:"licensing-standoff",label:"Publisher Licensing Standoff",prompt:"Major news publishers pause AI licensing talks and sue over training. What remedies (revenue share, opt-out registries, model removal) are realistic, and how do they ripple to open models?",category:"Data",modes:["analyze","debate"],tags:["licensing","copyright"]},{id:"sbom-for-llms",label:"SBOM for LLM Pipelines",prompt:"Regulators push SBOMs and signed artifacts for AI stacks. Draft what should appear in an LLM pipeline SBOM (data, weights, evals, guardrails) and how to verify it at runtime.",category:"Security",modes:["compare","analyze"],tags:["sbom","supply-chain"]},{id:"data-poisoning-campaign",label:"Data Poisoning Campaign",prompt:"Researchers find coordinated data poisoning in popular open corpora. How should model hosts detect and mitigate poisoning post-hoc, and what retraining tradeoffs are acceptable?",category:"Security",modes:["compare","debate"],tags:["data","poisoning"]},{id:"copyright-settlement",label:"Copyright Settlement Sets Precedent",prompt:"A major copyright suit settles with dataset disclosure and per-output watermarking. Predict how this precedent affects future training sets and open-weight releases.",category:"Policy",modes:["debate"],tags:["copyright","watermarking"]}],vr={analyze:["What's the most important programming principle?","Should code comments explain 'what' or 'why'?","Is TypeScript worth the extra complexity?"],debate:["Tabs or spaces? Give your verdict.","Should AI be allowed to write its own code?","What will never be automated by AI?"],compare:[],chat:[]};Rt.filter(t=>t.category==="Policy"||t.category==="Data"),Rt.filter(t=>t.category==="Infra"),Rt.filter(t=>t.category==="Security");const ps=["dots-mesh","dots","dots-fade","grid","mesh","animated-mesh","none"],pt="#0f172a",sn={compare:pt,analyze:pt,debate:pt,chat:pt},Ze={maxTokens:1024,temperature:.7},hs=`You can output interactive UI elements using JSON. When appropriate, include clickable options:

\`\`\`json
{
  "options": [
    {"id": "opt1", "label": "Option 1", "action": "message", "value": "User selected option 1"},
    {"id": "opt2", "label": "Option 2", "action": "message", "value": "User selected option 2"}
  ]
}
\`\`\`

Guidelines:
- Use for choices, confirmations, or navigation
- 2-4 options max
- Keep labels short
- Include JSON after your text response`,se={cardWidth:256,cardHeight:200,gapX:24,gapY:24,baseRadius:160,minRadius:120,radiusPerModel:15,scrollClamp:200};function ms({showDock:t,availableModels:s,allSelectedByType:r,totalModelsByType:a,handleDragStart:f,handleModelToggle:i,handleAddGroup:x,dockRef:c,mode:u,allModels:d,setShowDock:h,chatSelectedModels:p=new Set,onToggleChatModel:w,onToggleChatGroup:R}){const[_,A]=n.useState(""),[v,l]=n.useState(""),k=n.useRef(null);n.useEffect(()=>{const C=setTimeout(()=>l(_),200);return()=>clearTimeout(C)},[_]);const D=[{type:"self-hosted",title:"Self-Hosted",accentColor:"emerald"},{type:"github",title:"GitHub Models",accentColor:"blue"},{type:"external",title:"External",accentColor:"purple"}],X=u==="chat",O=X?d:s,j=n.useMemo(()=>{if(!v)return O;const C=v.toLowerCase();return O.filter(L=>L.name.toLowerCase().includes(C))},[O,v]),Q=n.useCallback(C=>{X&&w?w(C):i(C)},[X,w,i]);n.useEffect(()=>{t?setTimeout(()=>{var C;return(C=k.current)==null?void 0:C.focus()},100):A("")},[t]),n.useEffect(()=>{if(!t)return;const C=L=>{L.key==="Escape"&&(L.preventDefault(),h(!1))};return window.addEventListener("keydown",C),()=>window.removeEventListener("keydown",C)},[t,h]);const Z=C=>({emerald:{dot:"bg-emerald-500",text:"text-emerald-400",active:"bg-emerald-500/20 border-emerald-500/30"},blue:{dot:"bg-blue-500",text:"text-blue-400",active:"bg-blue-500/20 border-blue-500/30"},purple:{dot:"bg-purple-500",text:"text-purple-400",active:"bg-purple-500/20 border-purple-500/30"}})[C];return e.jsxs("div",{ref:c,"data-no-arena-scroll":!0,"data-no-background":!0,className:"fixed top-1/2 left-1/2 w-[min(90vw,500px)] max-h-[70vh] rounded-2xl flex flex-col z-[60] transition-all duration-300 shadow-2xl bg-slate-800/95 backdrop-blur-md",style:{transform:t?"translate(-50%, -50%) scale(1)":"translate(-50%, -50%) scale(0.95)",opacity:t?1:0,pointerEvents:t?"auto":"none"},children:[e.jsxs("div",{className:"px-4 py-3 border-b border-slate-700/50 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-200",children:X?"Select Models":"Add to Arena"}),X&&e.jsx("p",{className:"text-[10px] text-slate-500 mt-0.5",children:p.size===0?"Click to select":`${p.size} selected`})]}),e.jsx("button",{onClick:()=>h(!1),className:"text-slate-400 hover:text-slate-200",children:e.jsx(qn,{size:18})})]}),e.jsx("div",{className:"px-4 py-2 border-b border-slate-700/50",children:e.jsxs("div",{className:"relative",children:[e.jsx(Vn,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-500"}),e.jsx("input",{ref:k,type:"text",placeholder:"Search...",value:_,onChange:C=>A(C.target.value),className:"w-full pl-9 pr-3 py-2 text-sm bg-slate-700/50 border border-slate-600/50 rounded-lg text-slate-200 placeholder-slate-500 focus:outline-none focus:border-slate-500"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-3 space-y-4",children:D.map(C=>{const L=j.filter(P=>P.type===C.type),H=d.filter(P=>P.type===C.type),W=Z(C.accentColor);if(H.length===0)return null;const ie=X&&H.every(P=>p.has(P.id));return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between px-1 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${W.dot}`}),e.jsxs("span",{className:"text-[10px] font-semibold text-slate-400 uppercase tracking-wide",children:[C.title," (",H.length,")"]})]}),X?R&&e.jsx("button",{onClick:()=>R(C.type),className:`text-[10px] font-medium px-2 py-1 rounded ${W.text} hover:bg-white/5`,children:ie?"− Remove All":"+ Add All"}):e.jsx("button",{onClick:()=>x(C.type),className:`text-[10px] font-medium px-2 py-1 rounded ${W.text} hover:bg-white/5`,children:r[C.type]?"− Remove All":"+ Add All"})]}),e.jsx("div",{className:"space-y-1",children:L.map(P=>{const G=X?p.has(P.id):!1;return e.jsxs("div",{draggable:!X,onDragStart:X?void 0:y=>f(y,P.id),onClick:()=>Q(P.id),className:`flex items-center justify-between px-3 py-2 rounded-lg cursor-pointer transition-colors border ${G?W.active:"hover:bg-white/5 border-transparent"}`,children:[e.jsx("span",{className:`text-xs font-medium ${G?"text-slate-200":"text-slate-400"}`,children:P.name}),G&&e.jsx(Qn,{size:14,className:W.text})]},P.id)})})]},C.type)})}),e.jsx("div",{className:"px-4 py-2 border-t border-slate-700/50",children:e.jsxs("p",{className:"text-[10px] text-slate-500 text-center",children:["Press ",e.jsx("kbd",{className:"px-1 py-0.5 rounded bg-slate-700 text-slate-400 text-[9px]",children:"M"})," or ",e.jsx("kbd",{className:"px-1 py-0.5 rounded bg-slate-700 text-slate-400 text-[9px]",children:"Esc"})," to close"]})})]})}function xs({inputRef:t,inputFocused:s,setInputFocused:r,onSendMessage:a,className:f,style:i,placeholder:x,isGenerating:c,onStop:u}){return e.jsx("div",{className:f??"fixed bottom-0 right-0 left-0 z-[100] pb-6 px-3 sm:px-4 flex justify-center items-end pointer-events-none transition-all duration-300",style:i??{paddingBottom:"calc(1.5rem + env(safe-area-inset-bottom))"},children:e.jsx("div",{className:"w-full pointer-events-auto",style:{maxWidth:"600px"},children:e.jsxs("div",{className:`rounded-xl p-2.5 transition-all duration-300 flex items-center gap-2 border border-slate-700/40 header-shell ${s?"prompt-panel-focused":""}`,children:[e.jsx("input",{ref:t,type:"text",placeholder:x||"Ask a question to compare model responses...",className:"w-full bg-transparent text-slate-200 placeholder-slate-500 outline-none text-base sm:text-sm px-2.5 py-2.5",onFocus:()=>r(!0),onBlur:()=>r(!1),onKeyDown:d=>{var h;if(d.key==="Enter"&&!d.shiftKey){if(d.preventDefault(),c)return;(h=t.current)!=null&&h.value&&(a(t.current.value),t.current.value="")}},disabled:c}),e.jsx("button",{onClick:()=>{var d;c?u==null||u():(d=t.current)!=null&&d.value&&(a(t.current.value),t.current.value="")},onMouseDown:d=>d.currentTarget.blur(),className:`min-w-[44px] min-h-[44px] sm:min-w-[36px] sm:min-h-[36px] p-2 rounded-lg transition-colors active:scale-95 flex items-center justify-center focus:outline-none focus-visible:outline-none ${c?"text-red-400 hover:text-red-300 hover:bg-red-500/10":"text-slate-400 hover:text-white hover:bg-white/10"}`,"aria-label":c?"Stop generation":"Send message",children:c?e.jsx(Jn,{className:"w-5 h-5 sm:w-4 sm:h-4 fill-current"}):e.jsx(Zn,{className:"w-5 h-5 sm:w-4 sm:h-4",strokeWidth:2.5})})]})})})}const gs={chat:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),compare:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2"})}),analyze:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),debate:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})},ze=[{value:"chat",label:"Chat"},{value:"compare",label:"Compare"},{value:"analyze",label:"Analyze"},{value:"debate",label:"Debate"}];function bs({mode:t,setMode:s,setHoveredCard:r,clearSelection:a,showDock:f,setShowDock:i,onOpenSettings:x,gestureButtonSlot:c}){const[u,d]=n.useState(!1),h=n.useRef(null),[p,w]=n.useState(!0),R=n.useRef(null),[_,A]=n.useState(null),[v,l]=n.useState(0),k=ze.findIndex(j=>j.value===t),D=k===-1?0:k,X=ze[D].label;n.useEffect(()=>{const j=()=>{w(window.innerWidth>=1024)};return j(),window.addEventListener("resize",j),()=>window.removeEventListener("resize",j)},[]),n.useEffect(()=>{if(!R.current)return;const j=()=>{const C=R.current;if(!C)return;const L=C.querySelectorAll('button[role="radio"]');if(L.length===0||D>=L.length)return;const W=L[D].getBoundingClientRect(),ie=C.getBoundingClientRect(),P=W.width,G=W.left,y=ie.left;A(P),l(G-y)},Q=setTimeout(j,0),Z=new ResizeObserver(()=>{setTimeout(j,0)});return Z.observe(R.current),window.addEventListener("resize",j),()=>{clearTimeout(Q),Z.disconnect(),window.removeEventListener("resize",j)}},[t,p,D]),n.useEffect(()=>{function j(Q){h.current&&!h.current.contains(Q.target)&&d(!1)}return u&&document.addEventListener("mousedown",j),()=>{document.removeEventListener("mousedown",j)}},[u]);const O=j=>{s(j),r(null),a(),d(!1)};return e.jsxs("div",{className:"fixed top-0 left-0 right-0 flex items-center justify-between mb-2 px-3 sm:px-6 pt-4 sm:pt-6 z-50 pointer-events-none transition-all duration-300",children:[e.jsx("div",{className:"absolute inset-0 pointer-events-auto",style:{height:"100%",zIndex:-1}}),e.jsx("div",{className:"flex items-center gap-2 w-auto pointer-events-auto z-20",children:c}),e.jsx("div",{className:"hidden md:block absolute left-1/2 -translate-x-1/2 pointer-events-auto z-20",children:e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex items-center p-1.5 rounded-xl border border-slate-700/40 header-shell",children:[e.jsx("button",{onClick:()=>i(!f),className:"px-2 sm:px-3 flex items-center justify-center text-slate-400 hover:text-white transition-colors",title:"Toggle Model Dock",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsx("div",{className:"w-px h-5 bg-slate-700/50 mx-0.5 sm:mx-1"}),e.jsxs("div",{ref:R,className:"relative flex p-1 rounded-lg bg-black/20 mode-track",role:"radiogroup","aria-label":"Mode selection","data-gesture-mode-track":"true",children:[e.jsx("div",{className:"absolute top-1 bottom-1 rounded-md transition-all duration-300 ease-out mode-slider",style:{width:_!==null?`${_}px`:`calc((100% - 8px) / ${ze.length})`,left:_!==null?`${v}px`:`calc(4px + (100% - 8px) * ${D} / ${ze.length})`}}),ze.map(j=>e.jsx("button",{tabIndex:-1,onClick:()=>O(j.value),role:"radio","aria-checked":t===j.value,"aria-label":j.label,title:j.label,className:`relative z-10 py-2 sm:py-1.5 px-3 text-[11px] sm:text-xs font-medium transition-colors duration-200 min-h-[44px] sm:min-h-0 active:scale-95 focus:outline-none focus-visible:outline-none flex-1 flex items-center justify-center text-center ${t===j.value?"text-white":"text-slate-400 hover:text-slate-200"}`,children:j.label},j.value))]})]})})}),e.jsx("div",{className:"flex md:hidden flex-1 justify-center pointer-events-auto relative z-20",children:e.jsxs("div",{className:"relative",ref:h,children:[e.jsxs("button",{onClick:()=>d(!u),className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-slate-800/90 border border-slate-700/50 text-slate-200 font-medium text-sm backdrop-blur-md shadow-lg active:scale-95 transition-all",children:[e.jsx("span",{className:"font-bold text-slate-400 hidden xs:inline",children:"Arena"}),e.jsx("span",{className:"font-bold hidden xs:inline text-slate-600",children:"/"}),e.jsx("span",{children:X}),e.jsx("svg",{className:`w-4 h-4 text-slate-400 transition-transform duration-200 ${u?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),u&&e.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 mt-2 w-48 py-1 rounded-xl bg-slate-800 border border-slate-700 shadow-2xl overflow-hidden flex flex-col animate-in fade-in zoom-in-95 duration-100 origin-top",children:ze.map(j=>e.jsxs("button",{onClick:()=>O(j.value),className:`px-4 py-3 text-sm text-left w-full transition-colors flex items-center gap-3 ${t===j.value?"bg-blue-500/10 text-blue-400":"text-slate-300 hover:bg-slate-700/50"}`,children:[e.jsx("span",{className:"flex-shrink-0",children:gs[j.value]}),e.jsx("span",{className:"flex-1",children:j.label}),t===j.value&&e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]},j.value))})]})}),e.jsx("div",{className:"flex items-center gap-2 w-auto justify-end pointer-events-auto z-20",children:e.jsx("button",{onClick:x,className:"min-w-[42px] min-h-[42px] w-[42px] h-[42px] rounded-full bg-slate-800/50 flex items-center justify-center border border-slate-700/50 hover:border-slate-600 transition-colors active:scale-95 focus:outline-none focus-visible:outline-none",title:"Settings",children:e.jsxs("svg",{className:"w-4 h-4 text-slate-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),e.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})})})]})}const ys=t=>{if(typeof t=="string")return t;try{return JSON.stringify(t)}catch{return null}},vs=(t,s)=>{if(t===null)return s;try{return JSON.parse(t)}catch{return s}};function Pe(t,s,r={}){const a=r.serialize??ys,f=r.deserialize??vs,[i,x]=n.useState(()=>{if(typeof window>"u")return s;try{const c=window.localStorage.getItem(t);return f(c,s)}catch{return s}});return n.useEffect(()=>{if(!(typeof window>"u"))try{const c=a(i);c===null?window.localStorage.removeItem(t):window.localStorage.setItem(t,c)}catch{}},[t,a,i]),[i,x]}const ws=800,ks=3e3,js=8;function Ss(){const[t,s]=n.useState([]),[r,a]=n.useState(!0),[f,i]=n.useState(null),[x,c]=n.useState(0),[u,d]=Pe("playground_selected_models",null),h=n.useRef(u!==null),[p,w]=Pe("playground_chat_model",null),R=n.useRef(p!==null),_=n.useMemo(()=>u??[],[u]),A=n.useCallback(L=>{d(H=>typeof L=="function"?L(H??[]):L)},[d]),[v,l]=n.useState(""),k=n.useRef(0),D=n.useRef(null),X=n.useCallback(async(L,H,W=!1)=>{D.current&&(clearTimeout(D.current),D.current=null),a(!0),W&&(i("Refreshing..."),c(0));const ie=P=>{var xe,pe;const G=P.models.map(V=>{const ne=V.type==="self-hosted"||V.type==="github"||V.type==="external"?V.type:"self-hosted",oe=ls[ne];return{id:V.id,name:oe.name||V.name||V.id,color:oe.color,type:ne,response:"",priority:V.priority,context_length:V.context_length,default:V.default}});if(s(G),a(!1),i(null),c(0),h.current||(d(G.filter(V=>V.type==="self-hosted"&&V.id!=="nemotron-3-nano-30b-a3b").map(V=>V.id)),h.current=!0),!R.current){const V=G.find(oe=>oe.default),ne=G.find(oe=>oe.type==="github"||oe.type==="external");w((V==null?void 0:V.id)||(ne==null?void 0:ne.id)||((xe=G[0])==null?void 0:xe.id)||null),R.current=!0}const y=G.find(V=>V.type==="github"||V.type==="external"),ce=G.find(V=>V.default),Ee=((pe=G[0])==null?void 0:pe.id)||"";l((y==null?void 0:y.id)||(ce==null?void 0:ce.id)||Ee)};try{const P=await fetch("/api/models");if(L!==k.current)return;if(!P.ok)throw new Error(`HTTP ${P.status}`);const G=await P.json();if(L!==k.current)return;if(!G.models||G.models.length===0)throw new Error("No models available yet");ie(G)}catch(P){if(L!==k.current)return;console.warn("Backend fetch failed:",P);try{console.log("Trying static models.json...");const y=await fetch("/models.json");if(y.ok){const ce=await y.json();if(ce.models&&ce.models.length>0){console.log(`Loaded ${ce.models.length} models from static file`),ie(ce);return}}}catch(y){console.warn("Static models.json not available:",y)}const G=H+1;if(c(G),G<js){const y=Math.min(ws*Math.pow(1.4,H),ks);i("Connecting to backend..."),D.current=setTimeout(()=>{X(L,G)},y)}else a(!1),i("Could not load models")}},[d,w]),O=n.useCallback(()=>{k.current+=1,X(k.current,0,!0)},[X]);n.useEffect(()=>(k.current+=1,X(k.current,0),()=>{k.current+=1,D.current&&clearTimeout(D.current)}),[X]);const j=n.useMemo(()=>t.filter(L=>!_.includes(L.id)),[t,_]),{totalModelsByType:Q,allSelectedByType:Z}=n.useMemo(()=>{const L={"self-hosted":t.filter(W=>W.type==="self-hosted").length,github:t.filter(W=>W.type==="github").length,external:t.filter(W=>W.type==="external").length},H={"self-hosted":t.filter(W=>W.type==="self-hosted"&&_.includes(W.id)).length,github:t.filter(W=>W.type==="github"&&_.includes(W.id)).length,external:t.filter(W=>W.type==="external"&&_.includes(W.id)).length};return{totalModelsByType:L,allSelectedByType:{"self-hosted":L["self-hosted"]>0&&H["self-hosted"]===L["self-hosted"],github:L.github>0&&H.github===L.github,external:L.external>0&&H.external===L.external}}},[t,_]),C=n.useCallback(L=>{var H;return((H=t.find(W=>W.id===L))==null?void 0:H.name)||L},[t]);return{modelsData:t,setModelsData:s,selected:_,setSelected:A,chatModelId:p,setChatModelId:w,moderator:v,setModerator:l,availableModels:j,totalModelsByType:Q,allSelectedByType:Z,modelIdToName:C,isLoading:r,loadError:f,retryCount:x,retryNow:O}}function Ts(){var t;return typeof chrome<"u"&&((t=chrome.storage)!=null&&t.local)?window.__API_BASE__||"https://chat.neevs.io":""}async function*It(t,s,r){var d;const f=`${Ts()}${t}`,i=await fetch(f,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s),signal:r});if(!i.ok){yield{event:"error",error:`HTTP ${i.status}: ${i.statusText}`};return}const x=(d=i.body)==null?void 0:d.getReader();if(!x){yield{event:"error",error:"No response body"};return}const c=new TextDecoder;let u="";try{for(;;){const{done:h,value:p}=await x.read();if(h)break;u+=c.decode(p,{stream:!0});const w=u.split(`
`);u=w.pop()||"";for(const R of w)if(R.startsWith("data: ")){const _=R.slice(6).trim();if(_)try{yield JSON.parse(_)}catch{}}}}finally{x.releaseLock()}}const Es=async(t,s)=>It("/api/chat/stream",{models:t.models,messages:t.messages,max_tokens:t.max_tokens,temperature:t.temperature,github_token:t.github_token,openrouter_key:t.openrouter_key},s),Ms=async(t,s)=>It("/api/chat/analyze/stream",t,s),Cs=async(t,s)=>It("/api/chat/debate/stream",t,s),Lt=async(t,s)=>{try{for await(const r of t)s(r)}catch(r){throw console.error("Stream error:",r),r}};function rn(t){window.__API_BASE__=t}const Ns=[{name:"Chat",path:"chat.yml",category:"core"},{name:"Build Images",path:"build-push-images.yml",category:"core"},{name:"Nanbeige4-3B Thinking",path:"inference.yml",category:"reasoning",serviceKey:"nanbeige"},{name:"Qwen3 4B",path:"inference.yml",category:"small",serviceKey:"qwen"},{name:"SmolLM3 3B",path:"inference.yml",category:"small",serviceKey:"smollm3"},{name:"LFM2.5 1.2B",path:"inference.yml",category:"small",serviceKey:"lfm2"},{name:"DeepSeek R1 1.5B",path:"inference.yml",category:"reasoning",serviceKey:"r1qwen"},{name:"Gemma 3 12B",path:"inference.yml",category:"medium",serviceKey:"gemma"},{name:"Mistral 7B v0.3",path:"inference.yml",category:"medium",serviceKey:"mistral"},{name:"Phi-3 Mini",path:"inference.yml",category:"small",serviceKey:"phi"},{name:"RNJ-1 Instruct",path:"inference.yml",category:"medium",serviceKey:"rnj"},{name:"Llama 3.2-3B",path:"inference.yml",category:"medium",serviceKey:"llama"},{name:"FunctionGemma 270M",path:"inference.yml",category:"small",serviceKey:"functiongemma"},{name:"Nemotron-3 Nano 30B",path:"inference.yml",category:"reasoning",serviceKey:"nemotron"},{name:"GPT-OSS 20B",path:"inference.yml",category:"reasoning",serviceKey:"gptoss"}],Rs={workflows:Ns},cn=Rs.workflows;new Map(cn.map(t=>[t.name,t.path]));new Map(cn.filter(t=>t.serviceKey).map(t=>[t.serviceKey,t.name]));const Ie={githubToken:"",profile:"local_all",chatApiBaseUrl:"http://localhost:8080",modelsBaseDomain:"",modelsUseHttps:!1};function on(t){const s={...Ie,...t};(!s.chatApiBaseUrl||typeof s.chatApiBaseUrl!="string")&&typeof s.baseDomain=="string"&&(s.chatApiBaseUrl=s.baseDomain?`${s.useHttps===!1?"http":"https"}://chat.${s.baseDomain}`:"http://localhost:8080",s.profile="custom"),(!s.modelsBaseDomain||typeof s.modelsBaseDomain!="string")&&typeof s.baseDomain=="string"&&(s.modelsBaseDomain=s.baseDomain,s.profile="custom"),typeof s.modelsUseHttps!="boolean"&&typeof s.useHttps=="boolean"&&(s.modelsUseHttps=s.useHttps,s.profile="custom");const r=s.profile==="remote_all"||s.profile==="local_chat_remote_models"||s.profile==="local_all"||s.profile==="custom"?s.profile:Ie.profile;return{githubToken:typeof s.githubToken=="string"?s.githubToken:Ie.githubToken,profile:r,chatApiBaseUrl:_t(typeof s.chatApiBaseUrl=="string"?s.chatApiBaseUrl:""),modelsBaseDomain:typeof s.modelsBaseDomain=="string"?s.modelsBaseDomain:Ie.modelsBaseDomain,modelsUseHttps:typeof s.modelsUseHttps=="boolean"?s.modelsUseHttps:Ie.modelsUseHttps}}function Ls(){var t;return typeof chrome<"u"&&!!((t=chrome.storage)!=null&&t.local)}function _t(t){const s=t.trim().replace(/\/+$/,"");return s||"http://localhost:8080"}function As(){const[t,s]=n.useState(Ie),[r,a]=n.useState(!1);return n.useEffect(()=>{if(Ls()){chrome.storage.local.get(["envConfig"],i=>{const x=on(i.envConfig);s(x),a(!0);const c=_t(x.chatApiBaseUrl);rn(c),console.log("[Config] Extension mode, API base:",c)});const f=(i,x)=>{var c;if(x==="local"&&((c=i.envConfig)!=null&&c.newValue)){const u=on(i.envConfig.newValue);s(u);const d=_t(u.chatApiBaseUrl);rn(d),console.log("[Config] Updated API base:",d)}};return chrome.storage.onChanged.addListener(f),()=>chrome.storage.onChanged.removeListener(f)}else a(!0),console.log("[Config] Web mode, using relative URLs")},[]),{config:t,isLoaded:r}}function _s(){const[t,s]=n.useState([]),r=n.useRef([]),a=n.useCallback(c=>{if(!c.length)return;const u=[...r.current,...c];r.current=u,s(u)},[]),f=n.useCallback(()=>{r.current=[],s([])},[]),i=n.useCallback(c=>c.map(u=>`${u.role==="user"?"User":"Assistant"}: ${u.content}`).join(`

`),[]),x=n.useCallback((c,u)=>{if(u==="compare")return c;const d=c.filter(p=>p.role==="user"),h=[...c].reverse().find(p=>p.role==="assistant"&&p.kind==="analyze_synthesis"&&p.content.trim().length>0);return h?[...d,h]:d},[]);return{history:t,historyRef:r,pushHistoryEntries:a,clearHistory:f,historyToText:i,buildCarryoverHistory:x}}function zs(t){const s=n.useRef({}),r=n.useRef(null),a=n.useCallback(()=>{r.current=null;const u=s.current;s.current={},Object.keys(u).length&&t(h=>h.map(p=>{const w=u[p.id];return w?{...p,response:(p.response||"")+w.answer,thinking:(p.thinking||"")+w.thinking}:p}))},[t]),f=n.useCallback(()=>{r.current==null&&(r.current=requestAnimationFrame(a))},[a]),i=n.useCallback((u,d,h)=>{if(!d&&!h)return;const p=s.current[u]||{answer:"",thinking:""};p.answer+=d,p.thinking+=h,s.current[u]=p,f()},[f]),x=n.useCallback(u=>{s.current[u]&&delete s.current[u]},[]),c=n.useCallback(()=>{s.current={},r.current!=null&&(cancelAnimationFrame(r.current),r.current=null)},[]);return{pendingStreamRef:s,flushStreamRafRef:r,enqueueStreamDelta:i,clearPendingStreamForModel:x,resetPendingStream:c}}function Is(t,s){const r={...s};let a=r.carry+t;r.carry="";const f=a.lastIndexOf("<");if(f!==-1&&a.length-f<12){const u=a.slice(f);("<think>".startsWith(u)||"</think>".startsWith(u)||"<thinking>".startsWith(u)||"</thinking>".startsWith(u))&&(r.carry=u,a=a.slice(0,f))}let i="",x="";if(r.harmonyFormat){const u="<|channel|>final<|message|>",d=a.indexOf(u);if(d!==-1)r.inThink&&(i+=a.slice(0,d)),r.inThink=!1,x+=a.slice(d+u.length);else if(r.inThink){const h=a.replace(/<\|channel\|>analysis<\|message\|>/gi,"").replace(/<\|end\|>/gi,"").replace(/<\|start\|>/gi,"").replace(/assistant/gi,"");i+=h}else{const h=a.replace(/<\|end\|>/gi,"");x+=h}return{answerAdd:x,thinkingAdd:i,newState:r}}if(!r.inThink&&!r.implicitThinking){const u=a.indexOf("</think>"),d=a.indexOf("</thinking>"),h=u!==-1||d!==-1,p=a.indexOf("<think>")!==-1||a.indexOf("<thinking>")!==-1;h&&!p&&(r.implicitThinking=!0,r.inThink=!0)}let c=0;for(;c<a.length;)if(r.inThink){const u=a.indexOf("</think>",c),d=a.indexOf("</thinking>",c);let h=-1,p=0;if(u!==-1&&(d===-1||u<d)?(h=u,p=8):d!==-1&&(h=d,p=11),h===-1){i+=a.slice(c);break}i+=a.slice(c,h),r.inThink=!1,r.implicitThinking=!1,c=h+p}else{const u=a.indexOf("<think>",c),d=a.indexOf("<thinking>",c);let h=-1,p=0;if(u!==-1&&(d===-1||u<d)?(h=u,p=7):d!==-1&&(h=d,p=10),h===-1){x+=a.slice(c);break}x+=a.slice(c,h),r.inThink=!0,c=h+p}return{answerAdd:x,thinkingAdd:i,newState:r}}function Ps(t){const{mode:s,moderator:r,selected:a,selectedCardIds:f,githubToken:i,isGenerating:x,systemPrompt:c,summarizeSessionResponses:u,setLastQuery:d,setHoveredCard:h,setPhaseLabel:p,setModeratorSynthesis:w,setDiscussionTurnsByModel:R,resetFailedModels:_,markModelFailed:A,failedModelsRef:v,currentDiscussionTurnRef:l,sessionModelIdsRef:k,abortControllerRef:D,thinkingStateRef:X,conversationHistoryRef:O,pushHistoryEntries:j,historyToText:Q,buildCarryoverHistory:Z,setModelsData:C,modelIdToName:L,setExecutionTimes:H,setIsGenerating:W,setIsSynthesizing:ie,setSpeaking:P,enqueueStreamDelta:G,clearPendingStreamForModel:y,resetPendingStream:ce}=t;return{sendMessage:async(xe,pe,V,ne)=>{if(!xe.trim()||a.length===0&&!V||!V&&x)return;const oe=(ne==null?void 0:ne.skipHistory)??!1,Ae={role:"user",content:xe},te=oe?O.current:[...O.current,Ae];oe||j([Ae]);const _e=Z(te,s),B=Q(_e);d(xe);const je=B?`${B}

Continue the conversation above and respond to the latest user request.`:xe;let ee;if(V)ee=V;else{const z=Array.from(f).filter($=>a.includes($)&&(s==="compare"||$!==r));ee=z.length>0?z:a.slice()}k.current=ee;const fe={},re=(z,$,T)=>{if(!$)return;const b=T!=null&&T.label?`${T.label}: ${$}`:$;fe[z]=T!=null&&T.replace?b:fe[z]?`${fe[z]}

${b}`:b},de=new AbortController;D.current=de,W(!0),ie(!1),h(null),p(null),w(""),R({}),_(),l.current=null,ce(),C(z=>z.map($=>ee.includes($.id)||$.id===r?pe&&pe[$.id]?{...$,response:pe[$.id],thinking:void 0,error:void 0}:{...$,response:"",thinking:void 0,error:void 0}:$)),H(z=>{const $={...z},T=performance.now();return ee.forEach(b=>{$[b]={startTime:T}}),r&&!$[r]&&($[r]={startTime:T}),$});const me=new Set(ee);r&&me.add(r),me.forEach(z=>{const $=ds(z),T=fs(z);X.current[z]={inThink:$||T,carry:"",implicitThinking:$,harmonyFormat:T}});const ge=new Set,De=(z,$)=>{const T=z==null?void 0:z.trim();!T||oe||j([{role:"assistant",content:T,kind:$}])},ye=(z,$)=>{const T=X.current[z]||{inThink:!1,carry:"",implicitThinking:!1},{answerAdd:b,thinkingAdd:S,newState:N}=Is($,T);X.current[z]=N,b&&re(z,b),(S||b)&&G(z,b,S)},Me=z=>{const $=z.toLowerCase();return $.includes("rate limit")||$.includes("waiting")?'<svg width="14" height="14" viewBox="0 0 24 24" fill="none" style="display: inline-block; vertical-align: text-bottom; margin-right: 6px;"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none"/><path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>'+z:$.includes("error")||$.includes("failed")?'<svg width="14" height="14" viewBox="0 0 24 24" fill="none" style="display: inline-block; vertical-align: text-bottom; margin-right: 6px;"><path d="M12 2L2 20h20L12 2z" stroke="currentColor" stroke-width="2" fill="none" stroke-linejoin="round"/><path d="M12 9v4M12 17h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>'+z:z};try{if(s==="compare"){P(new Set(ee));const z=te.map(b=>({role:b.role,content:b.content})),$=c?[{role:"system",content:c},...z]:z,T=await Es({models:ee,messages:$,max_tokens:Ze.maxTokens,temperature:Ze.temperature,github_token:i||null},de.signal);if(await Lt(T,b=>{if(b.event==="info"&&b.content){const S=String(b.content),N=Me(S);p(N),b.model_id&&C(K=>K.map(Y=>Y.id===b.model_id?{...Y,statusMessage:N}:Y))}if(b.event==="token"&&b.model_id){const S=b.model_id,N=performance.now();ge.has(S)||(ge.add(S),H(K=>({...K,[S]:{...K[S],firstTokenTime:N}})),C(K=>K.map(Y=>Y.id===S?{...Y,statusMessage:void 0}:Y))),ye(S,String(b.content??""))}if(b.event==="done"&&b.model_id){const S=performance.now(),N=b.model_id;H(K=>({...K,[N]:{...K[N],endTime:S}})),P(K=>{const Y=new Set(K);return Y.delete(N),Y})}}),!oe){const b=u(fe,ee);b&&j([{role:"assistant",content:b,kind:"compare_summary"}])}return}if(s==="analyze"){const z=ee;if(z.length<2){const b="Select at least 2 participants for Analyze mode.";w(b),r&&C(S=>S.map(N=>N.id===r?{...N,response:b}:N)),p("Error");return}P(new Set(z));const $=await Ms({query:je,participants:z,max_tokens:Ze.maxTokens,github_token:i||null,system_prompt:c||null},de.signal);let T="";if(await Lt($,b=>{const S=b.event;if(S==="analyze_start"&&p("Collecting Responses"),S==="model_start"&&b.model_id){const N=b.model_id;P(K=>{const Y=new Set(K);return Y.add(N),Y})}if(S==="model_chunk"&&b.model_id){const N=b.model_id,K=performance.now();ge.has(N)||(ge.add(N),H(Y=>({...Y,[N]:{...Y[N],firstTokenTime:K}}))),ye(N,String(b.chunk??""))}if(S==="model_response"&&b.model_id){const N=b.model_id,K=performance.now();H(F=>({...F,[N]:{...F[N],endTime:K}})),P(F=>{const J=new Set(F);return J.delete(N),J});const Y=String(b.response??"");re(N,Y,{replace:!0}),pe&&pe[N]||(C(F=>F.map(J=>J.id===N?{...J,response:Y}:J)),De(`${L(N)}:
${Y}`,"analyze_response"))}if(S==="model_error"&&b.model_id){const N=b.model_id,K=performance.now();H(F=>({...F,[N]:{...F[N],endTime:K}})),P(F=>{const J=new Set(F);return J.delete(N),J});const Y=String(b.error??"Error generating response.");y(N),C(F=>F.map(J=>J.id===N?{...J,response:Y,error:Y}:J)),A(N),re(N,Y,{replace:!0})}if(S==="analysis_complete"){p("Analysis Complete");const N=b.consensus||[],K=b.unique_contributions||{};let Y=`Analysis:

`;if(N.length>0&&(Y+=`Consensus:
`+N.map(F=>`• ${F}`).join(`
`)+`

`),Object.keys(K).length>0){Y+=`Unique Contributions:
`;for(const[F,J]of Object.entries(K)){const we=L(F);Y+=`
${we}:
`+J.map(Se=>`• ${Se}`).join(`
`)+`
`}}T=Y,w(Y),r&&C(F=>F.map(J=>J.id===r?{...J,response:Y}:J))}if(S==="analyze_complete"&&(p("Complete"),P(new Set)),S==="error"){const N=String(b.error??"Analyze error.");w(N),p("Error")}}),!oe){const b=T.trim();b&&j([{role:"assistant",content:b,kind:"analyze_synthesis"}])}return}if(s==="debate"){const z=ee;if(z.length<2){const T="Select at least 2 participants for Debate mode.";w(T),r&&C(b=>b.map(S=>S.id===r?{...S,response:T}:S)),p("Error");return}const $=await Cs({query:je,participants:z,turns:2,max_tokens:Ze.maxTokens,temperature:Ze.temperature,github_token:i||null,system_prompt:c||null},de.signal);await Lt($,T=>{const b=T.event;if(b==="debate_start"&&p("Debate Starting"),b==="round_start"){const S=T.round_number??0;p(`Round ${S+1}`)}if(b==="turn_start"&&T.model_id){const S=T.model_id,N=T.turn_number??0,K=T.round_number??0;P(new Set([S])),p(`Round ${K+1} · Turn ${N+1}`),l.current={modelId:S,turnNumber:N}}if(b==="turn_chunk"&&T.model_id){const S=T.model_id,N=performance.now();ge.has(S)||(ge.add(S),H(K=>({...K,[S]:{...K[S],firstTokenTime:N}}))),ye(S,String(T.chunk??""))}if(b==="turn_complete"&&T.model_id){const S=T.model_id,N=performance.now();H(F=>({...F,[S]:{...F[S],endTime:N}})),P(F=>{const J=new Set(F);return J.delete(S),J});const K=String(T.response??""),Y=T.turn_number??0;re(S,K,{replace:!0}),C(F=>F.map(J=>J.id===S?{...J,response:K}:J)),R(F=>({...F,[S]:[...F[S]||[],{turn_number:Y,response:K}]})),De(`${L(S)}:
${K}`,"debate_turn")}if(b==="turn_error"&&T.model_id){const S=T.model_id,N=performance.now();H(Y=>({...Y,[S]:{...Y[S],endTime:N}})),P(Y=>{const F=new Set(Y);return F.delete(S),F});const K=String(T.error??"Turn error.");y(S),C(Y=>Y.map(F=>F.id===S?{...F,response:K,error:K}:F)),A(S)}if(b==="debate_complete"&&(p("Complete"),P(new Set)),b==="error"){const S=String(T.error??"Debate error.");p("Error"),w(S)}});return}}catch(z){if(z.name==="AbortError")return;if(console.error("Chat error:",z),D.current===de){const $=z.message||String(z);w(`Session Error: ${$}`),p("Error"),ce(),C(T=>T.map(b=>ee.includes(b.id)&&!b.response?{...b,response:"Error generating response."}:b)),ee.forEach(T=>A(T))}}finally{if(D.current===de){const z=performance.now();H($=>{const T={...$};return k.current.forEach(b=>{T[b]&&!T[b].endTime&&(T[b]={...T[b],endTime:z})}),T}),W(!1),ie(!1),p($=>$==="Error"?$:null),P(new Set)}}}}}function At(t,s){const r=Math.min(t.x,s.x),a=Math.min(t.y,s.y),f=Math.max(t.x,s.x),i=Math.max(t.y,s.y);return{left:r,top:a,right:f,bottom:i,width:f-r,height:i-a}}function Bs({rootContainerRef:t,visualizationAreaRef:s,arenaOffsetYRef:r,arenaTargetYRef:a,wheelRafRef:f,selectedModels:i,cardRefs:x,selectedCardIds:c,setSelectedCardIds:u,suppressClickRef:d}){const[h,p]=n.useState(null),w=n.useRef(!1);n.useEffect(()=>{w.current=h!=null},[h]),n.useEffect(()=>{const A=v=>{if(v.button!==0||!t.current)return;const l=v.target;if(!l)return;const k=l.closest("[data-card]"),D=l.closest('button, a, input, textarea, select, [role="button"]'),X=l.closest("[draggable]"),O=l.closest("[data-no-arena-scroll]");if(k||D||X||O||!t.current.contains(l))return;a.current=r.current,f.current!=null&&(cancelAnimationFrame(f.current),f.current=null);const j=t.current.getBoundingClientRect(),Q={x:v.clientX-j.left,y:v.clientY-j.top};v.preventDefault(),w.current=!0,d.current.card=!1,d.current.background=!1,p({origin:Q,current:Q,active:!1})};return window.addEventListener("mousedown",A,!0),()=>window.removeEventListener("mousedown",A,!0)},[r,a,f,t,s,d]),n.useEffect(()=>{if(!h||!t.current)return;const A=k=>k.preventDefault();document.addEventListener("selectstart",A);const v=k=>{const D=t.current.getBoundingClientRect(),X={x:k.clientX-D.left,y:k.clientY-D.top};p(O=>{if(!O)return O;const j=At(O.origin,X),Q=O.active||j.width>4||j.height>4;return{...O,current:X,active:Q}})},l=k=>{w.current=!1;const D=t.current.getBoundingClientRect(),X={x:k.clientX-D.left,y:k.clientY-D.top},O=k.target,j=!!(O&&O.closest("[data-card]"));p(Q=>{if(!Q)return null;const Z=At(Q.origin,X);if(Q.active&&Z.width>0&&Z.height>0){const C=[],L=t.current.getBoundingClientRect(),H={left:L.left+Z.left,right:L.left+Z.right,top:L.top+Z.top,bottom:L.top+Z.bottom};for(const W of i){const ie=x.current.get(W.id);if(!ie)continue;const P=ie.getBoundingClientRect();!(P.right<H.left||P.left>H.right||P.bottom<H.top||P.top>H.bottom)&&C.push(W.id)}u(new Set(C)),j?d.current.card=!0:C.length>0&&(d.current.background=!0)}return null})};return window.addEventListener("mousemove",v),window.addEventListener("mouseup",l),()=>{window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",l),document.removeEventListener("selectstart",A)}},[h,t,s,i,x,c,u,d]);const R=n.useMemo(()=>{if(!h||!h.active)return null;const A=At(h.origin,h.current);return A.width<=0||A.height<=0?null:{left:A.left,top:A.top,width:A.width,height:A.height}},[h]),_=n.useCallback(()=>{p(null),w.current=!1},[]);return{selectionRect:R,isSelecting:h!=null,dragSelectionActiveRef:w,clearSelection:_}}function $s({visualizationAreaRef:t,cardRefs:s,selected:r,setSelected:a,mode:f,gridCols:i,getCirclePosition:x}){const[c,u]=n.useState(null),d=n.useCallback((h,p)=>{if(h.button!==0||h.target.closest('button, a, input, textarea, select, [role="button"]'))return;h.preventDefault();const R=s.current.get(p);if(!R||!t.current)return;const _=R.getBoundingClientRect(),A=t.current.getBoundingClientRect(),v=_.left+_.width/2,l=_.top+_.height/2;u({activeId:p,currX:h.clientX,currY:h.clientY,offsetX:v-h.clientX,offsetY:l-h.clientY,containerLeft:A.left,containerTop:A.top,containerWidth:A.width,containerHeight:A.height,cardHeight:_.height}),h.target.setPointerCapture(h.pointerId)},[t]);return n.useEffect(()=>{if(!c)return;const h=w=>{if(u(l=>l?{...l,currX:w.clientX,currY:w.clientY}:null),!t.current)return;const R=t.current.getBoundingClientRect(),_=r.indexOf(c.activeId);let A=1/0,v=-1;if(f==="compare"){const l=w.clientX-(R.left+R.width/2),k=w.clientY-R.top,D=(se.cardWidth+se.gapX)*i-se.gapX;r.forEach((X,O)=>{const j=Math.floor(O/i),Z=O%i*(se.cardWidth+se.gapX)-D/2+se.cardWidth/2,C=j*(se.cardHeight+se.gapY),L=Z,H=C+se.cardHeight/2,W=(l-L)**2+(k-H)**2;W<A&&(A=W,v=O)})}else{const l=w.clientX-(R.left+R.width/2),k=w.clientY-(R.top+R.height/2),D=Math.max(se.baseRadius,se.minRadius+r.length*se.radiusPerModel);r.forEach((X,O)=>{const j=x(O,r.length,f,D),Q=(l-j.x)**2+(k-j.y)**2;Q<A&&(A=Q,v=O)})}if(v!==-1&&v!==_){const l=[...r],[k]=l.splice(_,1);l.splice(v,0,k),a(l)}},p=()=>u(null);return window.addEventListener("pointermove",h),window.addEventListener("pointerup",p),()=>{window.removeEventListener("pointermove",h),window.removeEventListener("pointerup",p)}},[c,t,s,r,a,f,i,x]),{dragState:c,handlePointerDown:d}}function Ds({mode:t,showSettings:s,showDock:r,contextMenu:a,selectedCardIds:f,selected:i,inputRef:x,setShowSettings:c,setShowDock:u,setContextMenu:d,setSelected:h,setSelectedCardIds:p,clearSelection:w,setHoveredCard:R,handleModeChange:_}){n.useEffect(()=>{const A=v=>{if(v.key==="Escape"){const k=document.activeElement;if(k&&k!==document.body&&k.blur(),s){c(!1);return}if(a){d(null);return}if(f.size>0){w(),R(null);return}if(r){u(!1);return}R(null);return}if((v.metaKey||v.ctrlKey)&&(v.key==="a"||v.key==="A")){const k=v.target;if(k.tagName==="INPUT"||k.tagName==="TEXTAREA"||t==="chat")return;v.preventDefault(),i.length>0&&p(new Set(i));return}const l=v.target;if(!(l.tagName==="INPUT"||l.tagName==="TEXTAREA")){if(v.key==="ArrowRight"||v.key==="ArrowLeft"){v.preventDefault();const k=["chat","compare","analyze","debate"],D=k.indexOf(t);if(D!==-1){const X=v.key==="ArrowRight"?1:-1,O=(D+X+k.length)%k.length;_(k[O])}return}if(v.key==="m"||v.key==="M"){v.preventDefault(),u(!r);return}if((v.key==="Delete"||v.key==="Backspace")&&f.size>0){v.preventDefault(),h(k=>k.filter(D=>!f.has(D))),w();return}v.key.length===1&&!v.ctrlKey&&!v.metaKey&&!v.altKey&&x.current&&x.current.focus()}};return window.addEventListener("keydown",A),()=>window.removeEventListener("keydown",A)},[r,s,a,f,t,i,x,c,u,d,h,p,w,R,_])}function Os({visualizationAreaRef:t,dragSelectionActiveRef:s}){const r=n.useRef(0),a=n.useRef(0),f=n.useRef(null),i=n.useRef(!1),x=n.useRef(0),c=p=>{const w=t.current;w&&w.style.setProperty("--arena-offset-y",`${p}px`)},u=p=>Math.max(-200,Math.min(se.scrollClamp,p)),d=()=>{const p=r.current,w=a.current,R=w-p;if(Math.abs(R)<.5){r.current=w,c(w),f.current=null;return}const _=p+R*.35;r.current=_,c(_),f.current=requestAnimationFrame(d)},h=()=>{f.current==null&&(f.current=requestAnimationFrame(d))};return n.useEffect(()=>{const p=v=>{if(s.current)return;const l=v.target;if(l&&l.closest("input, textarea, [data-no-arena-scroll]"))return;v.preventDefault();const k=v.deltaY*.9,D=a.current-k;a.current=u(D),h()},w=v=>v?!!v.closest('input, textarea, [data-no-arena-scroll], [data-card], button, a, select, [role="button"]'):!1,R=v=>{if(v.touches.length!==1)return;const l=v.target;w(l)||(i.current=!0,x.current=v.touches[0].clientY)},_=v=>{if(s.current||!i.current||v.touches.length!==1)return;const l=v.target;if(w(l)){i.current=!1;return}const k=v.touches[0].clientY,D=k-x.current;x.current=k,v.preventDefault(),a.current=u(a.current+D),h()},A=()=>{i.current=!1};return window.addEventListener("touchstart",R,{passive:!0}),window.addEventListener("touchmove",_,{passive:!1}),window.addEventListener("touchend",A),window.addEventListener("touchcancel",A),window.addEventListener("wheel",p,{passive:!1}),()=>{window.removeEventListener("touchstart",R),window.removeEventListener("touchmove",_),window.removeEventListener("touchend",A),window.removeEventListener("touchcancel",A),window.removeEventListener("wheel",p),f.current!=null&&cancelAnimationFrame(f.current)}},[]),{arenaOffsetYRef:r,arenaTargetYRef:a,wheelRafRef:f,applyOffset:c,clampTarget:u,ensureRaf:h}}function ve(t,s){return!t||!t.startsWith("#")?t:t.length===7||t.length===4?`${t}${s}`:t}const Hs={idle:"Ready",responding:"Responding",done:"Done",waiting:"Waiting",error:"Error"};function zt({state:t,color:s,size:r=16,label:a,className:f=""}){const i={width:`${r}px`,height:`${r}px`},x=a??Hs[t],c=Math.max(2,Math.round(r*.14)),u=Math.max(12,r-2),d="#fbbf24",h=ve(s,"cc"),p=()=>{switch(t){case"responding":return e.jsx("div",{className:"relative flex items-center justify-center",style:i,children:e.jsxs("svg",{width:u,height:u,viewBox:"0 0 24 24",fill:"none",className:"",style:{filter:`drop-shadow(0 0 6px ${ve(d,"55")})`,animation:"spin 0.6s linear infinite"},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"spinnerGradient",gradientUnits:"userSpaceOnUse",x1:"3",y1:"12",x2:"12",y2:"3",children:[e.jsx("stop",{offset:"0%",stopColor:d,stopOpacity:"1"}),e.jsx("stop",{offset:"60%",stopColor:d,stopOpacity:"0.5"}),e.jsx("stop",{offset:"100%",stopColor:d,stopOpacity:"0"})]})}),e.jsx("circle",{cx:"12",cy:"12",r:"9",stroke:ve(d,"15"),strokeWidth:c,fill:"none"}),e.jsx("path",{d:"M 12 3 A 9 9 0 1 1 3 12",stroke:"url(#spinnerGradient)",strokeWidth:c,strokeLinecap:"round",fill:"none"}),e.jsx("circle",{cx:"3",cy:"12",r:c*.7,fill:d})]})});case"done":return e.jsx("div",{className:"flex items-center justify-center rounded-full",style:{...i,background:ve(s,"14"),border:`1px solid ${ve(s,"99")}`},children:e.jsx("svg",{width:u,height:u,viewBox:"0 0 24 24",fill:"none",children:e.jsx("polyline",{points:"5 13 10 18 19 7",stroke:s,strokeWidth:c,strokeLinecap:"round",strokeLinejoin:"round"})})});case"error":const w="#ef4444";return e.jsx("div",{className:"flex items-center justify-center rounded-full",style:{...i,background:ve(w,"14"),border:`1px solid ${ve(w,"99")}`},children:e.jsx("svg",{width:u,height:u,viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M6 6L18 18M6 18L18 6",stroke:w,strokeWidth:c,strokeLinecap:"round",strokeLinejoin:"round"})})});case"waiting":return e.jsxs("div",{className:"relative flex items-center justify-center",style:i,children:[e.jsx("div",{className:"absolute inset-0 rounded-full",style:{border:`1px solid ${ve(h,"99")}`}}),e.jsx("svg",{width:u,height:u,viewBox:"0 0 24 24",fill:"none",style:{animation:"spin 5s linear infinite"},children:e.jsx("circle",{cx:"12",cy:"12",r:"8.5",stroke:ve(h,"44"),strokeWidth:c-1,strokeDasharray:"6 10",strokeLinecap:"round"})}),e.jsx("div",{className:"absolute w-2 h-2 rounded-full",style:{background:ve(h,"aa"),animation:"pulse 1.5s ease-in-out infinite"}})]});default:return e.jsxs("div",{className:"relative flex items-center justify-center",style:i,children:[e.jsx("div",{className:"absolute inset-0 rounded-full",style:{border:"1px solid rgba(71, 85, 105, 0.5)"}}),e.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:"rgba(148, 163, 184, 0.6)",animation:"pulse 2.4s ease-in-out infinite"}})]})}};return e.jsx("div",{className:`inline-flex items-center justify-center ${f}`,title:x,children:p()})}function an({times:t,isFastestTTFT:s,isFastestTotal:r}){const a=(t==null?void 0:t.startTime)!=null,f=(t==null?void 0:t.endTime)!=null,i=(t==null?void 0:t.firstTokenTime)!=null,x=a&&f?((t.endTime-t.startTime)/1e3).toFixed(2):null,c=a&&i?((t.firstTokenTime-t.startTime)/1e3).toFixed(2):null;return e.jsxs("div",{className:"text-[10px] text-slate-500 flex items-center gap-2",children:[e.jsxs("span",{className:r?"text-yellow-400/90 bg-yellow-500/10 px-1.5 py-0.5 rounded":void 0,title:r?"Fastest":void 0,children:[e.jsx("span",{className:r?void 0:"text-slate-400",children:"TIME"})," ",x?`${x}s`:a&&!f?"...":"—"]}),c&&e.jsxs("span",{className:s?"text-amber-400/90 bg-amber-500/10 px-1.5 py-0.5 rounded":"text-slate-600",title:s?"Fastest TTFT":void 0,children:["TTFT ",c,"s"]})]})}const Pt=({text:t,speed:s=5})=>{const[r,a]=n.useState(""),f=n.useRef(0),i=n.useRef(null);return n.useEffect(()=>{!t.startsWith(r)&&r!==""&&(a(""),f.current=0)},[t]),n.useEffect(()=>{i.current!=null&&(clearTimeout(i.current),i.current=null);const x=t.length;if(f.current>=x)return;const c=()=>{const u=f.current,d=x-u;if(d<=0)return;const h=d>120?12:d>40?4:d>10?2:1,p=Math.min(x,u+h);f.current=p,a(t.slice(0,p));const R=x-p>5?0:s;i.current=window.setTimeout(c,R)};return i.current=window.setTimeout(c,s),()=>{i.current!=null&&(clearTimeout(i.current),i.current=null)}},[t,s]),e.jsx("span",{children:r})},ht=96;function Ws(t){switch(t){case"error":return"Error";case"responding":return"Responding";case"done":return"Done";case"waiting":return"Waiting";default:return"Ready"}}function Ys({mode:t,layoutRadius:s,moderatorModel:r,moderatorId:a,orchestratorTransform:f,orchestratorStatus:i,moderatorSynthesis:x,isSynthesizing:c,isGenerating:u,phaseLabel:d,speaking:h,hoveredCard:p,setHoveredCard:w,setSelectedCardIds:R,lastSelectedCardRef:_,orchestratorAutoMode:A,orchestratorAutoScope:v,showOrchestratorMenu:l,setShowOrchestratorMenu:k,setOrchestratorAutoMode:D,setOrchestratorAutoScope:X,orchestratorMenuRef:O,availableModels:j,setModerator:Q,getTailSnippet:Z}){const[C,L]=n.useState(null),H=Ws(i),W=d||"";n.useEffect(()=>{if(!l)return;const y=ce=>{O.current&&!O.current.contains(ce.target)&&(k(!1),L(null))};return document.addEventListener("mousedown",y,!0),()=>document.removeEventListener("mousedown",y,!0)},[l,O,k]);const ie=()=>{if(x)return c&&a&&h.has(a)?e.jsx(Pt,{text:x,speed:20}):Z(x);if(c)return e.jsx("span",{className:"text-slate-500 italic",children:"Synthesizing responses..."});if(u){if(d!=null&&d.startsWith("<svg"))return e.jsx("span",{className:"text-slate-500 italic",dangerouslySetInnerHTML:{__html:d}});const y=d==="Stage 1 · Responses"?"Waiting for model responses...":d||"Orchestrating...";return e.jsx("span",{className:"text-slate-500 italic",children:y})}return e.jsx("span",{className:"text-slate-500 italic",children:"Send a prompt to see the synthesis."})},P=i==="responding",G=P?"#fbbf24":r.color;return e.jsxs("div",{"data-card":!0,className:"absolute z-20 transition-all duration-700 ease-out cursor-pointer",style:{opacity:1,transform:f,left:"50%",top:t==="analyze"?`calc(50% + ${s}px - 64px)`:"50%"},onClick:y=>{y.stopPropagation(),a&&(R(new Set([a])),_.current=a)},onContextMenu:y=>{y.preventDefault(),y.stopPropagation(),l?(k(!1),L(null)):(L({x:y.clientX,y:y.clientY}),k(!0))},onMouseEnter:()=>w("moderator"),onMouseLeave:()=>w(null),children:[e.jsxs("div",{className:"relative flex items-center justify-center",style:{width:`${ht}px`,height:`${ht}px`},children:[e.jsx("div",{className:"absolute inset-0 rounded-full animate-pulse",style:{background:`radial-gradient(circle, ${G}20 0%, transparent 70%)`,transform:"scale(2.2)",filter:"blur(18px)"}}),e.jsxs("div",{className:"relative rounded-full flex items-center justify-center transition-all duration-300",style:{width:`${ht}px`,height:`${ht}px`,background:P?"linear-gradient(135deg, rgba(251, 191, 36, 0.08), rgba(15, 23, 42, 0.9))":"rgba(15, 23, 42, 0.9)",backdropFilter:"blur(16px)",border:`2px solid ${G}${P?"99":"60"}`,boxShadow:`0 0 36px ${G}${P?"40":"28"}, inset 0 1px 1px rgba(255,255,255,0.1)`},children:[e.jsx("div",{className:"absolute inset-[-4px] rounded-full",style:{background:`conic-gradient(from 0deg, transparent, ${G}60, transparent)`,animation:"spin 4s linear infinite"}}),e.jsx("div",{className:"absolute inset-[2px] rounded-full",style:{background:"rgba(15, 23, 42, 0.96)"}}),e.jsxs("div",{className:"relative text-center z-10 flex flex-col items-center gap-1.5 px-3",children:[e.jsx("div",{className:"text-[7px] tracking-[0.32em] text-slate-400 uppercase",children:H}),e.jsx("div",{className:"text-[10px] font-semibold text-slate-100 leading-tight",children:r.name}),e.jsx(zt,{state:i,color:G,size:12})]})]})]}),e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 flex flex-col items-center gap-1 w-max max-w-[200px]",style:{top:"calc(100% + 12px)"},children:e.jsx("span",{className:"text-[10px] text-slate-500",children:W})}),p==="moderator"&&!l&&e.jsxs("div",{"data-card":!0,onClick:y=>y.stopPropagation(),className:"absolute bottom-full mb-4 left-1/2 -translate-x-1/2 w-80 max-w-[calc(100vw-2rem)] p-4 rounded-xl z-[200] transition-all duration-300",style:{background:"rgba(15, 23, 42, 0.95)",backdropFilter:"blur(16px)",border:`1px solid ${G}40`,boxShadow:`0 20px 40px rgba(0,0,0,0.5), 0 0 30px ${G}20`},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"Orchestrator"}),e.jsx("span",{className:"text-xs text-slate-500",children:"·"}),e.jsx("span",{className:"text-xs font-medium text-slate-300",children:r.name}),P&&e.jsx("span",{className:"text-[9px] uppercase tracking-wider px-1.5 py-0.5 rounded bg-yellow-500/20 text-yellow-300 border border-yellow-500/30",children:"Working"})]}),e.jsx("p",{className:"text-sm text-slate-300 leading-relaxed",children:ie()})]}),l&&C&&es.createPortal(e.jsx("div",{ref:O,className:"w-64 bg-slate-800 border border-slate-700 rounded-lg shadow-xl overflow-hidden",style:{position:"fixed",top:`${C.y}px`,left:`${C.x}px`,transform:"translateY(-50%)",zIndex:9999},onClick:y=>y.stopPropagation(),children:A?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-3 py-2 text-[10px] uppercase tracking-wider text-slate-500 font-semibold border-b border-slate-700/50",children:["Auto Mode: ",v==="self-hosted"?"SELF-HOSTED":v.toUpperCase()]}),["all","self-hosted","api"].map(y=>e.jsxs("button",{onClick:()=>{X(y),k(!1)},className:`w-full px-3 py-2 text-left text-xs font-medium transition-colors ${v===y?"bg-yellow-500/20 text-yellow-300":"text-slate-300 hover:bg-slate-700/50"}`,children:[y==="all"&&"All",y==="self-hosted"&&"Self-hosted",y==="api"&&"API",e.jsxs("span",{className:"text-[10px] text-slate-500 ml-1",children:[y==="all"&&"(self-hosted → API)",y==="self-hosted"&&"(no quota)",y==="api"&&"(cloud only)"]})]},y)),e.jsx("div",{className:"border-t border-slate-700",children:e.jsx("button",{onClick:()=>{D(!1),k(!1)},className:"w-full px-3 py-2 text-left text-xs font-medium text-slate-400 hover:bg-slate-700/50 transition-colors",children:"Manual Mode"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-3 py-2 text-[10px] uppercase tracking-wider text-slate-500 font-semibold border-b border-slate-700/50",children:"Select Orchestrator"}),j.filter(y=>y.type==="github"||y.type==="external").length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-3 py-1.5 text-[9px] uppercase tracking-wider text-slate-600 font-semibold",children:"GitHub Models"}),j.filter(y=>y.type==="github"||y.type==="external").map(y=>e.jsx("button",{onClick:()=>{Q(y.id),k(!1)},className:`w-full px-4 py-2 text-left text-xs font-medium transition-colors ${a===y.id?"bg-blue-500/20 text-blue-300":"text-slate-300 hover:bg-slate-700/50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:y.name}),a===y.id&&e.jsx("span",{className:"text-blue-400",children:"✓"})]})},y.id))]}),j.filter(y=>y.type==="self-hosted").length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-3 py-1.5 text-[9px] uppercase tracking-wider text-slate-600 font-semibold border-t border-slate-700/50 mt-1",children:"Self-Hosted Models"}),j.filter(y=>y.type==="self-hosted").map(y=>e.jsx("button",{onClick:()=>{Q(y.id),k(!1)},className:`w-full px-4 py-2 text-left text-xs font-medium transition-colors ${a===y.id?"bg-blue-500/20 text-blue-300":"text-slate-300 hover:bg-slate-700/50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:y.name}),a===y.id&&e.jsx("span",{className:"text-blue-400",children:"✓"})]})},y.id))]}),e.jsx("div",{className:"border-t border-slate-700",children:e.jsxs("button",{onClick:()=>{D(!0),k(!1)},className:"w-full px-3 py-2 text-left text-xs font-medium text-yellow-400 hover:bg-slate-700/50 transition-colors flex items-center gap-2",children:[e.jsx(ts,{size:12}),e.jsx("span",{children:"Enable Auto Mode"})]})})]})}),document.body)]})}const mt=256,un=200,ln=96;function Fs(t){const{mode:s,selectedModels:r,gridCols:a,speaking:f,selectedCardIds:i,setSelectedCardIds:x,executionTimes:c,failedModels:u,cardRefs:d,handlePointerDown:h,dragState:p,setContextMenu:w,suppressClickRef:R,getTailSnippet:_,hoveredCard:A,setHoveredCard:v,setExpandedModelId:l,layoutRadius:k,getCirclePosition:D,moderatorModel:X,moderatorId:O,orchestratorTransform:j,orchestratorStatus:Q,moderatorSynthesis:Z,isSynthesizing:C,isGenerating:L,phaseLabel:H,linesTransitioning:W,lastSelectedCardRef:ie,orchestratorAutoMode:P,orchestratorAutoScope:G,showOrchestratorMenu:y,setShowOrchestratorMenu:ce,setOrchestratorAutoMode:Ee,setOrchestratorAutoScope:xe,orchestratorMenuRef:pe,availableModels:V,setModerator:ne,fastestTTFT:oe,fastestTotal:Ae}=t,te=s!=="compare",_e=s==="analyze"?k-64:0;return e.jsxs(e.Fragment,{children:[r.map((B,je)=>{var Oe;const ee=D(je,r.length,s,k),fe=Xs(je,a),re=f.has(B.id),de=i.has(B.id),me=u.has(B.id),ge=!re&&!me&&!!((Oe=c[B.id])!=null&&Oe.endTime)&&B.response.trim().length>0,ye=Js(re,ge,me,!re&&!ge&&!me&&L&&s==="debate"),Me=Qs(ye),z="#fbbf24",$="#ef4444",T=B.type==="self-hosted"?"#10b981":"#3b82f6",b=me?$:T,S=re&&!me,N=Zs({hasError:me,isProcessing:S,isSelected:de,errorColor:$,processingColor:z,typeColor:T}),K=Gs({mode:s,gridX:fe.gridX,gridY:fe.gridY,circleX:ee.x,circleY:ee.y,dragState:p,modelId:B.id}),Y=A===B.id,F=te?ln:mt,J=te?ln:un,we=Math.max(800,k*2+600),Se=we/2,Te=Se,ae=Se,et=Se+(0-ee.x),tt=Se+(_e-ee.y);return e.jsxs("div",{ref:ue=>{ue?d.current.set(B.id,ue):d.current.delete(B.id)},onPointerDown:ue=>h(ue,B.id),className:"absolute",onContextMenu:ue=>{ue.preventDefault(),ue.stopPropagation(),w({x:ue.clientX,y:ue.clientY,modelId:B.id})},style:{transform:K,zIndex:te?Y?300:de?40:re?15:5:de?20:re?10:1,left:"50%",top:te?"50%":"0",transition:(p==null?void 0:p.activeId)===B.id?"none":"transform 300ms cubic-bezier(0.2, 0, 0.2, 1)"},children:[te&&re&&!me&&!W&&e.jsxs("svg",{className:"absolute pointer-events-none",style:{width:`${we}px`,height:`${we}px`,top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:-1},viewBox:`0 0 ${we} ${we}`,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:`grad-${B.id}`,gradientUnits:"userSpaceOnUse",x1:Te,y1:ae,x2:et,y2:tt,children:[e.jsx("stop",{offset:"0%",stopColor:z,stopOpacity:"0.45"}),e.jsx("stop",{offset:"100%",stopColor:z,stopOpacity:"0.12"})]})}),e.jsx("line",{x1:Te,y1:ae,x2:et,y2:tt,stroke:`url(#grad-${B.id})`,strokeWidth:"2",strokeDasharray:"6,4",strokeLinecap:"round",className:"animate-flow arena-link"})]}),e.jsxs("div",{"data-card":!0,onClick:ue=>Us({e:ue,modelId:B.id,suppressClickRef:R,setSelectedCardIds:x,selectedModels:r,lastSelectedCardRef:ie}),onDoubleClick:ue=>{ue.stopPropagation(),!te&&l&&l(B.id)},onMouseEnter:()=>te&&v(B.id),onMouseLeave:()=>te&&v(null),className:`relative cursor-grab active:cursor-grabbing card-hover ${te?"rounded-full":""} ${de?"card-selected":""} ${re?"card-speaking":""}`,style:{background:N.background,backdropFilter:te?void 0:"blur(8px)",WebkitBackdropFilter:te?void 0:"blur(8px)",border:N.border,boxShadow:N.shadow,transform:de||S?"scale(1.05)":"scale(1)",width:`${F}px`,height:`${J}px`,borderRadius:te?"50%":"12px",transition:"transform 180ms ease-out, box-shadow 180ms ease-out, border-color 180ms ease-out, width 0.7s cubic-bezier(0.4, 0, 0.2, 1), height 0.7s cubic-bezier(0.4, 0, 0.2, 1), border-radius 0.7s cubic-bezier(0.4, 0, 0.2, 1)"},children:[!te&&e.jsxs("div",{style:Vs,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3 gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5 min-w-0",children:[e.jsx(zt,{state:ye,color:b,size:16,label:Me}),e.jsx("span",{className:"text-xs font-semibold text-slate-200 truncate",children:B.name})]}),e.jsx("div",{className:"flex items-center gap-1.5 shrink-0",children:e.jsx("span",{className:`text-[9px] uppercase tracking-wider px-1.5 py-0.5 rounded ${B.type==="self-hosted"?"bg-emerald-500/10 text-emerald-300 border border-emerald-500/30":"bg-blue-500/10 text-blue-300 border border-blue-500/30"}`,children:B.type==="self-hosted"?"Self-hosted":"API"})})]}),e.jsx("p",{className:"text-xs text-slate-400 leading-relaxed line-clamp-3 flex-1",children:Ks({model:B,isSpeaking:re,thinkingFallback:e.jsx("span",{className:"text-slate-500 italic",children:"Generating…"}),getTailSnippet:_})}),e.jsx("div",{className:"flex items-center gap-4 mt-3 pt-3 border-t border-slate-700/50",children:e.jsx(an,{times:c[B.id],isFastestTTFT:oe===B.id,isFastestTotal:Ae===B.id})})]}),te&&e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center text-center",style:{transition:"opacity 0.3s ease-out"},children:[e.jsx("div",{className:"absolute inset-[3px] rounded-full border border-white/5",style:{boxShadow:`inset 0 0 20px ${b}15`}}),e.jsx("div",{className:"absolute inset-[-6px] rounded-full opacity-60",style:{background:`radial-gradient(circle, ${b}22 0%, transparent 65%)`,filter:"blur(10px)"}}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center gap-1.5 px-3",children:[e.jsx("div",{className:"text-[7px] tracking-[0.32em] text-slate-400 uppercase",children:Me}),e.jsx("div",{className:"text-[10px] font-semibold text-slate-100 leading-tight",children:B.name}),e.jsx(zt,{state:ye,color:b,size:12})]})]})]}),s==="analyze"&&te&&B.personaEmoji&&e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 flex items-center justify-center pointer-events-none select-none",style:{bottom:"-12px",fontSize:"20px",zIndex:100,transition:"transform 180ms ease-out",transform:re?"scale(1.15)":"scale(1)",filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.5)) drop-shadow(0 0 8px rgba(0,0,0,0.3))"},title:B.personaName?`${B.personaName} - ${B.personaTrait}`:"Persona",children:B.personaEmoji}),te&&re&&B.thinking&&B.thinking.trim().length>0&&B.response.trim().length===0&&e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 flex items-center justify-center pointer-events-none select-none animate-pulse",style:{bottom:"-12px",fontSize:"18px",zIndex:100,filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.5)) drop-shadow(0 0 10px rgba(168, 85, 247, 0.4))"},title:"Thinking...",children:"💭"}),te&&A===B.id&&e.jsxs("div",{"data-card":!0,onClick:ue=>ue.stopPropagation(),className:"absolute w-64 max-w-[calc(100vw-2rem)] p-4 rounded-xl transition-all duration-300 z-[220]",style:{top:ee.y>0?"auto":"100%",bottom:ee.y>0?"100%":"auto",left:"50%",transform:"translateX(-50%)",marginTop:ee.y>0?0:"12px",marginBottom:ee.y>0?"12px":0,background:"rgba(15, 23, 42, 0.95)",backdropFilter:"blur(16px)",border:`1px solid ${b}40`,boxShadow:`0 20px 40px rgba(0,0,0,0.5), 0 0 20px ${b}15`},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:b}}),e.jsx("span",{className:"text-xs font-semibold text-slate-300",children:B.name})]}),s==="analyze"&&B.personaEmoji&&B.personaName&&e.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-2 border-b border-slate-700/50",children:[e.jsx("span",{className:"text-base",children:B.personaEmoji}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs font-semibold text-blue-400",children:B.personaName}),B.personaTrait&&e.jsx("div",{className:"text-[10px] text-slate-500",children:B.personaTrait})]})]}),e.jsx("p",{className:"text-xs text-slate-400 leading-relaxed whitespace-pre-wrap",children:qs({model:B,isSpeaking:re,getTailSnippet:_})}),e.jsx("div",{className:"flex items-center gap-4 mt-3 pt-2 border-t border-slate-700/50",children:e.jsx(an,{times:c[B.id]})})]})]},B.id)}),s!=="compare"&&X&&e.jsx(Ys,{mode:s,layoutRadius:k,moderatorModel:X,moderatorId:O,orchestratorTransform:j,orchestratorStatus:Q,moderatorSynthesis:Z,isSynthesizing:C,isGenerating:L,phaseLabel:H,speaking:f,hoveredCard:A,setHoveredCard:v,setSelectedCardIds:x,lastSelectedCardRef:ie,orchestratorAutoMode:P,orchestratorAutoScope:G,showOrchestratorMenu:y,setShowOrchestratorMenu:ce,setOrchestratorAutoMode:Ee,setOrchestratorAutoScope:xe,orchestratorMenuRef:pe,availableModels:V,setModerator:ne,getTailSnippet:_}),s!=="compare"&&e.jsxs("svg",{className:"absolute pointer-events-none transition-opacity duration-700",style:{width:"1000px",height:"1000px",opacity:.2},children:[e.jsx("circle",{cx:"500",cy:"500",r:k,fill:"none",stroke:"url(#circleGrad)",strokeWidth:"1",strokeDasharray:"8,4"}),e.jsx("defs",{children:e.jsxs("linearGradient",{id:"circleGrad",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#3b82f6"}),e.jsx("stop",{offset:"50%",stopColor:"#8b5cf6"}),e.jsx("stop",{offset:"100%",stopColor:"#3b82f6"})]})})]})]})}function Xs(t,s){const r=Math.floor(t/s),a=t%s,f=(mt+se.gapX)*s-se.gapX,i=r*(un+se.gapY);return{gridX:a*(mt+se.gapX)-f/2+mt/2,gridY:i}}function Gs({mode:t,gridX:s,gridY:r,circleX:a,circleY:f,dragState:i,modelId:x}){if((i==null?void 0:i.activeId)===x){const c=i.currX+i.offsetX,u=i.currY+i.offsetY;if(t==="compare"){const p=c-(i.containerLeft+i.containerWidth/2),w=u-i.containerTop-i.cardHeight/2;return`translate(calc(-50% + ${p}px), ${w}px)`}const d=c-(i.containerLeft+i.containerWidth/2),h=u-(i.containerTop+i.containerHeight/2);return`translate(calc(-50% + ${d}px), calc(-50% + ${h}px))`}return t==="compare"?`translate(calc(-50% + ${s}px), ${r}px)`:`translate(calc(-50% + ${a}px), calc(-50% + ${f}px))`}function Us({e:t,modelId:s,suppressClickRef:r,setSelectedCardIds:a,selectedModels:f,lastSelectedCardRef:i}){if(t.stopPropagation(),r.current.card){r.current.card=!1;return}const x=t.shiftKey,c=t.metaKey||t.ctrlKey;if(x&&i.current){const u=f.findIndex(h=>h.id===i.current),d=f.findIndex(h=>h.id===s);if(u!==-1&&d!==-1){const h=Math.min(u,d),p=Math.max(u,d),w=f.slice(h,p+1).map(R=>R.id);a(R=>{const _=new Set(R);return w.forEach(A=>_.add(A)),_})}}else c?(a(u=>{const d=new Set(u);return d.has(s)?d.delete(s):d.add(s),d}),i.current=s):(a(new Set([s])),i.current=s)}function Ks({model:t,isSpeaking:s,thinkingFallback:r,getTailSnippet:a}){return t.statusMessage?Be(t.statusMessage)??t.statusMessage:s?t.response.trim().length>0?Be(t.response)??e.jsx(Pt,{text:t.response,speed:20}):t.thinking&&t.thinking.trim().length>0?e.jsxs("span",{children:[e.jsx("span",{className:"text-slate-500 italic",children:"Thinking… "}),a(t.thinking.trim(),220)]}):r:Be(t.response)??t.response}function qs({model:t,isSpeaking:s,getTailSnippet:r,maxChars:a=220}){return t.statusMessage?Be(t.statusMessage)??t.statusMessage:s?t.thinking&&t.thinking.trim().length>0?e.jsxs("span",{children:[e.jsx("span",{className:"text-purple-400/80 text-[10px] uppercase tracking-wider font-medium",children:"Thinking "}),e.jsx("span",{className:"text-slate-400",children:r(t.thinking.trim(),260)})]}):t.response.trim().length>0?Be(t.response)??e.jsx(Pt,{text:t.response,speed:20}):e.jsx("span",{className:"text-slate-500 italic",children:"Generating…"}):t.thinking&&t.thinking.trim().length>0?e.jsxs("span",{children:[e.jsx("span",{className:"text-purple-400/80 text-[10px] uppercase tracking-wider font-medium",children:"Reasoning "}),e.jsx("span",{className:"text-slate-400",children:r(t.thinking.trim(),260)})]}):t.response?Be(t.response)??r(t.response,a):e.jsx("span",{className:"text-slate-500 italic",children:"No response yet."})}const Vs={padding:"16px",height:"100%",display:"flex",flexDirection:"column",isolation:"isolate",WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",textRendering:"optimizeLegibility",opacity:1,transition:"opacity 0.3s ease-out"};function Qs(t){switch(t){case"error":return"Error";case"responding":return"Responding";case"done":return"Done";case"waiting":return"Waiting";default:return"Ready"}}function Js(t,s,r,a){return r?"error":t?"responding":s?"done":a?"waiting":"idle"}function Be(t){return t.startsWith("<svg")?e.jsx("span",{dangerouslySetInnerHTML:{__html:t}}):null}function Zs({hasError:t,isProcessing:s,isSelected:r,errorColor:a,processingColor:f,typeColor:i}){const x="rgba(30, 41, 59, 0.85)";return t?{background:`linear-gradient(135deg, ${a}14, ${x})`,border:`1px solid ${a}99`,shadow:`0 0 24px ${a}33, inset 0 1px 1px rgba(255,255,255,0.1)`}:s?{background:`linear-gradient(135deg, ${f}14, ${x})`,border:`1px solid ${f}99`,shadow:`0 0 24px ${f}33, inset 0 1px 1px rgba(255,255,255,0.1)`}:r?{background:x,border:`1px solid ${i}d0`,shadow:`0 0 20px ${i}30, inset 0 1px 1px rgba(255,255,255,0.1)`}:{background:x,border:"1px solid rgba(71, 85, 105, 0.5)",shadow:"0 4px 20px rgba(0,0,0,0.3), inset 0 1px 1px rgba(255,255,255,0.05)"}}function er({rect:t}){return t?e.jsx("div",{className:"absolute pointer-events-none z-30",style:{left:t.left,top:t.top,width:t.width,height:t.height,border:"2px solid rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)"}}):null}const Bt=n.createContext(null);function tr({children:t}){const[s,r]=n.useState(!1),[a,f]=n.useState("chat"),i=n.useRef({}),x=n.useCallback(R=>{i.current=R},[]),[c,u]=n.useState({gesture:null,progress:0,triggered:!1}),[d,h]=n.useState(void 0),[p,w]=n.useState(null);return e.jsx(Bt.Provider,{value:{isActive:s,setIsActive:r,appContext:a,setAppContext:f,callbacks:i,setCallbacks:x,gestureState:c,setGestureState:u,performanceMetrics:d,setPerformanceMetrics:h,cameraError:p,setCameraError:w},children:t})}function nr(){const t=n.useContext(Bt);if(!t)throw new Error("useGesture must be used within GestureProvider");return t}function wr(){return n.useContext(Bt)}class sr extends n.Component{constructor(r){super(r);tn(this,"handleRetry",()=>{var r,a;this.setState({hasError:!1,error:null}),(a=(r=this.props).onRetry)==null||a.call(r)});this.state={hasError:!1,error:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,a){console.error("ErrorBoundary caught an error:",r,a)}render(){var r;return this.state.hasError?this.props.fallback?this.props.fallback:e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-white/70 gap-4 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-amber-400",children:[e.jsx(ns,{size:20}),e.jsx("span",{className:"text-sm font-medium",children:"Something went wrong"})]}),e.jsx("p",{className:"text-xs text-white/40 text-center max-w-xs",children:((r=this.state.error)==null?void 0:r.message)||"Failed to load component"}),e.jsxs("button",{onClick:this.handleRetry,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white/80 bg-slate-700/50 hover:bg-slate-600/50 rounded-lg transition-all active:scale-95 border border-slate-600/50",children:[e.jsx(ss,{size:14}),"Try Again"]})]}):this.props.children}}const rr=n.lazy(()=>$e(()=>import("./SettingsModal-BWYev0OT.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),or=n.lazy(()=>$e(()=>import("./ResponseModal-reNlrW8D.js"),__vite__mapDeps([7,1,2,3,4,5,6,8]))),ar=n.lazy(()=>$e(()=>import("./DiscussionTranscript-DlpfGpjw.js"),__vite__mapDeps([9,1,2,3,4,5,6,8]))),ir=n.lazy(()=>$e(()=>import("./GestureControl-CV1hepTl.js"),__vite__mapDeps([10,1,2,3,4,5,6]))),lr=n.lazy(()=>$e(()=>import("./HandBackground-F7iiHyIM.js"),__vite__mapDeps([11,1,2,3,4,5,6,12]))),cr=n.lazy(()=>$e(()=>import("./ChatView-ChBC1V4N.js"),__vite__mapDeps([13,1,2,3,4,5,6,8])).then(t=>({default:t.default}))),ur='button, input, textarea, select, a, [role="button"], [data-no-background], [data-card]';function dr(){const t=nr();As();const{modelsData:s,setModelsData:r,selected:a,setSelected:f,chatModelId:i,setChatModelId:x,moderator:c,setModerator:u,availableModels:d,totalModelsByType:h,allSelectedByType:p,modelIdToName:w,isLoading:R,loadError:_,retryCount:A,retryNow:v}=Ss(),[l,k]=Pe("playground_mode","chat",{serialize:o=>o,deserialize:(o,m)=>["chat","compare","analyze","debate"].includes(o)?o:m}),[D,X]=n.useState(!1),O=n.useRef(null),[j,Q]=n.useState(null),[Z,C]=n.useState(!1),[L,H]=n.useState(!1),[W,ie]=n.useState(2),[P,G]=n.useState(!1),[y,ce]=Pe("github_models_token","",{serialize:o=>o||null,deserialize:(o,m)=>o??m}),[Ee,xe]=Pe("openrouter_api_key","",{serialize:o=>o||null,deserialize:(o,m)=>o??m}),[pe,V]=n.useState(!1),[ne,oe]=n.useState({}),Ae=n.useRef(null),te=n.useRef(null),[_e,B]=n.useState(""),[je,ee]=n.useState(null),fe=n.useRef(null),re=n.useCallback(o=>{fe.current&&clearTimeout(fe.current),ee(o),fe.current=window.setTimeout(()=>{ee(null),fe.current=null},5e3)},[]),de=n.useCallback(o=>{if(l==="chat"||y)return!0;const m=s.find(g=>g.id===o);return!m||m.type!=="github"&&m.type!=="external"},[l,y,s]),me=n.useCallback(()=>!!(l==="chat"||y),[l,y]),[ge,De]=n.useState([]),[ye,Me]=n.useState(()=>new Set(["lfm2.5-1.2b-instruct"])),[z,$]=n.useState(!1),T=n.useRef(!1),b=n.useCallback(o=>{Me(m=>{const g=new Set(m);return g.has(o)?g.delete(o):g.add(o),g})},[]),S=n.useCallback(o=>{const m=s.filter(g=>g.type===o).map(g=>g.id);Me(g=>{const E=m.every(I=>g.has(I)),M=new Set(g);return E?m.forEach(I=>M.delete(I)):m.forEach(I=>M.add(I)),M})},[s]),{history:N,historyRef:K,pushHistoryEntries:Y,clearHistory:F,historyToText:J,buildCarryoverHistory:we}=_s(),Se=(o,m)=>{const g=new Set,E=m.filter(Boolean).filter((I,q,U)=>U.indexOf(I)===q),M=[];return E.forEach(I=>{const q=o[I];q&&q.trim()&&(M.push({id:I,text:q.trim()}),g.add(I))}),Object.entries(o).forEach(([I,q])=>{g.has(I)||!q||!q.trim()||M.push({id:I,text:q.trim()})}),M.length?M.map(({id:I,text:q})=>`${w(I)}:
${q}`).join(`

`):null};n.useEffect(()=>{T.current=t.isActive},[t.isActive]);const Te=a.map(o=>s.find(m=>m.id===o)).filter(o=>!!o&&(l==="compare"||o.id!==c)),ae=n.useMemo(()=>l!=="compare"?Te:[...Te].sort((o,m)=>{var M,I;const g=(M=ne[o.id])==null?void 0:M.firstTokenTime,E=(I=ne[m.id])==null?void 0:I.firstTokenTime;return g===void 0&&E===void 0?0:g===void 0?1:E===void 0?-1:g-E}),[l,Te,ne]),{fastestTTFT:et,fastestTotal:tt}=n.useMemo(()=>{if(l!=="compare")return{fastestTTFT:null,fastestTotal:null};let o=null,m=1/0,g=null,E=1/0,M=0,I=0;for(const q of Te){const U=ne[q.id];if(U){if(U.firstTokenTime!==void 0){M++;const le=U.firstTokenTime-U.startTime;le<m&&(m=le,o=q.id)}if(U.endTime!==void 0){I++;const le=U.endTime-U.startTime;le<E&&(E=le,g=q.id)}}}return{fastestTTFT:M>=2?o:null,fastestTotal:I>=2?g:null}},[l,Te,ne]),Oe=(o,m,g,E)=>{if(g==="analyze"){const dt=250+o*220/(m-1)-90,ft=dt*Math.PI/180;return{x:Math.cos(ft)*E,y:Math.sin(ft)*E,angle:dt}}const M=o*360/m-90,I=Math.cos(M*Math.PI/180)*E,q=Math.sin(M*Math.PI/180)*E;return{x:I,y:q,angle:M}},ue=(o,m)=>{Q(m),o.dataTransfer.effectAllowed="move"},dn=o=>{o.preventDefault(),C(!0)},fn=()=>{C(!1)},pn=o=>{if(o.preventDefault(),C(!1),j){if(l==="chat")x(j);else if(!a.includes(j)){if(!de(j)){re("Add your GitHub token in Settings for API model access with dedicated quota"),Q(null);return}f(m=>[...m,j])}Q(null)}},xt=o=>{if(l==="chat"){x(i===o?null:o);return}if(a.includes(o))if(ke&&bt.current.includes(o)&&_e){te.current&&te.current.abort();const g=bt.current.filter(M=>M!==o),E={};if(s.forEach(M=>{g.includes(M.id)&&M.response&&!M.error&&(E[M.id]=M.response)}),f(M=>M.filter(I=>I!==o)),Ye.has(o)&&Fe(M=>{const I=new Set(M);return I.delete(o),I}),(l==="analyze"||l==="debate")&&g.length<2){Le(!1),Ue(!1),qe("This mode requires at least 2 participants."),Qe("Error");return}Ct(_e,E,g,{skipHistory:!0})}else f(g=>g.filter(E=>E!==o));else{if(!de(o)){re("Add your GitHub token in Settings for API model access with dedicated quota");return}f(m=>[...m,o])}},hn=o=>{const m=s.filter(M=>M.type===o).map(M=>M.id);if(m.length>0&&m.every(M=>a.includes(M))){f(M=>M.filter(I=>!m.includes(I)));return}if((o==="github"||o==="external")&&!me()){re("Add your GitHub token in Settings for API model access with dedicated quota");return}const E=d.filter(M=>M.type===o).map(M=>M.id);E.length>0&&f(M=>[...M,...E])},[mn,He]=n.useState(null),[Ce,nt]=n.useState(null),[We,st]=n.useState(new Set),[xn,gn]=n.useState(!1),[Ye,Fe]=n.useState(new Set),rt=()=>Fe(new Set),[ot,bn]=n.useState(null),gt=n.useMemo(()=>{if(l==="compare")return 0;const o=Math.max(se.baseRadius,se.minRadius+ae.length*se.radiusPerModel);if(!ot)return o;const g=Math.min(ot.width,ot.height)/2-140;return Math.max(o,g)},[l,ae.length,ot]);n.useEffect(()=>{const o=()=>{if(!he.current)return;const{clientWidth:g,clientHeight:E}=he.current;let M=Math.floor(g/(se.cardWidth+se.gapX));M=Math.max(1,M),ie(M),bn({width:g,height:E})},m=new ResizeObserver(g=>{for(let E of g)E.target===he.current&&o()});return he.current&&(m.observe(he.current),o()),()=>{he.current&&m.unobserve(he.current)}},[l]);const Xe=n.useRef(null),he=n.useRef(null),Ne=n.useRef(null),$t=n.useRef(null),at=n.useRef(new Map),yn=n.useRef(null),Ge=n.useRef({card:!1,background:!1}),vn=n.useRef({}),bt=n.useRef([]),{enqueueStreamDelta:wn,clearPendingStreamForModel:kn,resetPendingStream:yt}=zs(r),Dt=n.useRef(!1),{arenaOffsetYRef:Ot,arenaTargetYRef:vt,wheelRafRef:jn,clampTarget:Sn,ensureRaf:Tn}=Os({visualizationAreaRef:he,dragSelectionActiveRef:Dt}),{selectionRect:En,isSelecting:wt,dragSelectionActiveRef:Mn}=Bs({rootContainerRef:$t,visualizationAreaRef:he,arenaOffsetYRef:Ot,arenaTargetYRef:vt,wheelRafRef:jn,selectedModels:ae,cardRefs:at,selectedCardIds:Ye,setSelectedCardIds:Fe,suppressClickRef:Ge});Dt.current=Mn.current;const{dragState:Cn,handlePointerDown:Nn}=$s({visualizationAreaRef:he,cardRefs:at,selected:a,setSelected:f,mode:l,gridCols:W,getCirclePosition:Oe});n.useEffect(()=>()=>yt(),[yt]);const[be,Re]=n.useState(null);n.useEffect(()=>{const o="arena-selecting",m=document.body;return wt?m.classList.add(o):m.classList.remove(o),()=>{m.classList.remove(o)}},[wt]);const it=n.useCallback(o=>o?!o.closest(ur):!1,[]),Rn=n.useCallback(o=>{if(it(o.target)){if(Ge.current.background){Ge.current.background=!1;return}He(null),rt(),Ge.current.background=!1}},[it,rt]),Ln=n.useCallback(o=>{it(o.target)&&(o.preventDefault(),Re({x:o.clientX,y:o.clientY,type:"background"}))},[it]),Ht=n.useCallback(()=>{X(!0),O.current&&clearTimeout(O.current),O.current=window.setTimeout(()=>{X(!1),O.current=null},350)},[]),Wt=n.useRef(l),lt=n.useCallback(o=>{if(o===l)return;Ht();const m=["compare","analyze","debate"];m.includes(l)&&m.includes(o)||Le(!1),k(o)},[l,Ht]);n.useEffect(()=>()=>{fe.current&&clearTimeout(fe.current)},[]),n.useEffect(()=>()=>{O.current&&clearTimeout(O.current)},[]),n.useEffect(()=>{const o=()=>Re(null);return window.addEventListener("click",o),()=>window.removeEventListener("click",o)},[]);const[ke,Le]=n.useState(!1),[ct,Ue]=n.useState(!1),[Ke,qe]=n.useState(""),An=n.useCallback(()=>{F(),Le(!1),Ue(!1),qe(""),Qe(null),Tt({}),r(o=>o.map(m=>({...m,response:"",thinking:void 0,error:void 0}))),oe({}),st(new Set)},[F,r]),[_n,zn]=n.useState(!0),[In,Pn]=n.useState("api"),[kt,jt]=n.useState(!1),St=n.useRef(null);n.useEffect(()=>{const o=g=>{St.current&&!St.current.contains(g.target)&&jt(!1)},m=g=>{g.key==="Escape"&&jt(!1)};return kt&&(document.addEventListener("mousedown",o),document.addEventListener("keydown",m)),()=>{document.removeEventListener("mousedown",o),document.removeEventListener("keydown",m)}},[kt]);const[Ve,Qe]=n.useState(null),[,Tt]=n.useState({}),[Bn,Yt]=n.useState(new Set),Et=n.useRef(new Set),$n=n.useRef(null),Ft=n.useRef({}),Xt=n.useRef(l),[Mt,Gt]=n.useState(null),Dn=()=>{const o=new Set;Et.current=o,Yt(o)},On=o=>{Yt(m=>{if(m.has(o))return m;const g=new Set(m);return g.add(o),Et.current=g,g})},Ut=n.useRef({compare:{responses:{},moderatorSynthesis:"",phaseLabel:null,executionTimes:{},isGenerating:!1,speaking:new Set},analyze:{responses:{},moderatorSynthesis:"",phaseLabel:null,executionTimes:{},isGenerating:!1,speaking:new Set},debate:{responses:{},moderatorSynthesis:"",phaseLabel:null,executionTimes:{},isGenerating:!1,speaking:new Set}}),Kt=n.useRef(s),qt=n.useRef(Ke),Vt=n.useRef(Ve),Qt=n.useRef(ne),Jt=n.useRef(ke),Zt=n.useRef(We);n.useEffect(()=>{Kt.current=s},[s]),n.useEffect(()=>{qt.current=Ke},[Ke]),n.useEffect(()=>{Vt.current=Ve},[Ve]),n.useEffect(()=>{Qt.current=ne},[ne]),n.useEffect(()=>{Jt.current=ke},[ke]),n.useEffect(()=>{Zt.current=We},[We]),n.useEffect(()=>{const o=["compare","analyze","debate"],m=Wt.current;if(o.includes(m)&&o.includes(l)&&m!==l){const g={};Kt.current.forEach(I=>{g[I.id]={response:I.response,thinking:I.thinking,error:I.error}}),Ut.current[m]={responses:g,moderatorSynthesis:qt.current,phaseLabel:Vt.current,executionTimes:Qt.current,isGenerating:Jt.current,speaking:new Set(Zt.current)};const E=Ut.current[l];Object.values(E.responses).some(I=>I.response&&I.response!=="")||E.isGenerating?(r(I=>I.map(q=>{var U,le,Je;return{...q,response:((U=E.responses[q.id])==null?void 0:U.response)||"",thinking:(le=E.responses[q.id])==null?void 0:le.thinking,error:(Je=E.responses[q.id])==null?void 0:Je.error}})),qe(E.moderatorSynthesis),Qe(E.phaseLabel),oe(E.executionTimes),Le(E.isGenerating),st(new Set(E.speaking))):(F(),r(I=>I.map(q=>({...q,response:"",thinking:void 0,error:void 0}))),qe(""),Qe(null),oe({}),Le(!1),st(new Set)),Ue(!1),Tt({})}Wt.current=l},[l,F,r]);const{sendMessage:Ct}=Ps({mode:l,moderator:c,selected:a,selectedCardIds:Ye,githubToken:y,isGenerating:ke,systemPrompt:pe?hs:void 0,summarizeSessionResponses:Se,setLastQuery:B,setHoveredCard:He,setPhaseLabel:Qe,setModeratorSynthesis:qe,setDiscussionTurnsByModel:Tt,resetFailedModels:Dn,markModelFailed:On,failedModelsRef:Et,currentDiscussionTurnRef:$n,sessionModelIdsRef:bt,abortControllerRef:te,thinkingStateRef:vn,conversationHistoryRef:K,pushHistoryEntries:Y,historyToText:J,buildCarryoverHistory:we,setModelsData:r,modelIdToName:w,setExecutionTimes:oe,setIsGenerating:Le,setIsSynthesizing:Ue,setSpeaking:st,enqueueStreamDelta:wn,clearPendingStreamForModel:kn,resetPendingStream:yt});Ds({mode:l,showSettings:P,showDock:L,contextMenu:be,selectedCardIds:Ye,selected:a,inputRef:Xe,setShowSettings:G,setShowDock:H,setContextMenu:Re,setSelected:f,setSelectedCardIds:Fe,clearSelection:rt,setHoveredCard:He,handleModeChange:lt});const[ut,Hn]=Pe("playground-bg-style","dots",{serialize:o=>o,deserialize:(o,m)=>o&&ps.includes(o)?o:m}),Wn=s.find(o=>o.id===c),Yn=ct?"responding":ke?"waiting":Ke?"done":"idle",Fn=`${Mt?`translate(-50%, -50%) translate(${Mt.x}px, ${Mt.y}px)`:"translate(-50%, -50%)"} scale(1)`;n.useLayoutEffect(()=>{if(l!=="compare")return;const o={};ae.forEach(m=>{const g=at.current.get(m.id);g&&(o[m.id]=g.getBoundingClientRect())}),Ft.current=o},[l,ae.length,ae.map(o=>o.id).join(",")]),n.useEffect(()=>{if(Xt.current==="compare"&&l!=="compare"&&c&&he.current){const m=Ft.current[c],g=he.current.getBoundingClientRect();if(m&&g.width>0&&g.height>0){const E=g.left+g.width/2,M=l==="analyze"?gt-64:0,I=g.top+(g.height*.5+M),q=m.left+m.width/2-E,U=m.top+m.height/2-I;(Math.abs(q)>1||Math.abs(U)>1)&&(Gt({x:q,y:U}),requestAnimationFrame(()=>Gt(null)))}}Xt.current=l},[l,c,gt]);const Xn=ut==="none"?"":`bg-${ut}`,Gn=(o,m=280)=>o?o.length<=m?o:`…${o.slice(o.length-m)}`:"",en=()=>{te.current&&(te.current.abort(),Le(!1),Ue(!1))};return e.jsxs("div",{ref:$t,className:`fixed inset-0 overflow-hidden text-white ${Xn}`,style:{backgroundColor:sn[l],transition:"background-color 1s ease",...ut==="none"?{background:sn[l]}:{},...wt?{userSelect:"none",WebkitUserSelect:"none"}:{}},onClick:Rn,onContextMenu:Ln,children:[t.isActive&&e.jsx(n.Suspense,{fallback:null,children:e.jsx(lr,{onSendMessage:t.callbacks.current.onSendMessage,onScroll:t.callbacks.current.onScroll,onPinch:t.callbacks.current.onPinch,onHover:t.callbacks.current.onHover,gestureActiveArea:{minX:.7,maxX:1,minY:0,maxY:1},onGestureState:t.setGestureState,onError:t.setCameraError,onPerformance:t.setPerformanceMetrics})}),R&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-slate-900/95 backdrop-blur-sm",children:e.jsxs("div",{className:"flex flex-col items-center gap-5 text-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-12 h-12 border-2 border-slate-700 border-t-blue-500 rounded-full animate-spin"}),e.jsx("div",{className:"absolute inset-0 w-12 h-12 border-2 border-transparent border-b-emerald-500/50 rounded-full animate-spin",style:{animationDirection:"reverse",animationDuration:"1.5s"}})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"text-white/80 text-sm font-medium",children:_||"Connecting to models..."}),A>0&&e.jsxs("p",{className:"text-white/40 text-xs tabular-nums",children:["Attempt ",A," of 8"]})]}),e.jsxs("button",{onClick:v,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white/70 hover:text-white bg-white/5 hover:bg-white/10 border border-white/10 hover:border-white/20 rounded-lg transition-all active:scale-95",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh Now"]})]})}),e.jsx(bs,{mode:l,setMode:lt,setHoveredCard:He,clearSelection:rt,showDock:L,setShowDock:H,onOpenSettings:()=>G(!0),gestureButtonSlot:e.jsx(n.Suspense,{fallback:null,children:e.jsx(ir,{inHeader:!0,appContext:l,onStopGeneration:()=>{if(l==="chat"&&Ne.current){Ne.current.stopGeneration();return}en()},onSendMessage:o=>{if(l==="chat"&&Ne.current){Ne.current.sendMessage(o,!0);return}const m=l==="compare"||l==="analyze"||l==="debate"?a:[];m.length>0&&Ct(o,{},m)},onScroll:o=>{if(l==="chat"&&Ne.current){Ne.current.scroll(o);return}vt.current=Sn(vt.current+o),Tn()},onHover:(o,m)=>{const g=o*window.innerWidth,E=m*window.innerHeight,M=document.elementFromPoint(g,E);if(M){const I=M.closest("[data-gesture-mode-track]");if(I){const le=I.getBoundingClientRect(),Je=g-le.left,dt=le.width,ft=Math.floor(Je/dt*5),Nt=["chat","compare","analyze","debate"][Math.max(0,Math.min(4,ft))];Nt&&Nt!==l&&lt(Nt);return}const q=document.querySelector('[data-gesture-hovered="true"]'),U=M.closest('button, a, [role="button"], [data-clickable], .cursor-pointer, [onclick]')||M;U!==q?(q&&(q.removeAttribute("data-gesture-hovered"),q.dispatchEvent(new PointerEvent("pointerleave",{bubbles:!1,cancelable:!0})),q.dispatchEvent(new MouseEvent("mouseleave",{bubbles:!1,cancelable:!0})),q.dispatchEvent(new MouseEvent("mouseout",{bubbles:!0,cancelable:!0}))),U.setAttribute("data-gesture-hovered","true"),U.dispatchEvent(new PointerEvent("pointerenter",{bubbles:!1,cancelable:!0,clientX:g,clientY:E})),U.dispatchEvent(new PointerEvent("pointermove",{bubbles:!0,cancelable:!0,clientX:g,clientY:E})),U.dispatchEvent(new MouseEvent("mouseenter",{bubbles:!1,cancelable:!0,clientX:g,clientY:E})),U.dispatchEvent(new MouseEvent("mouseover",{bubbles:!0,cancelable:!0,clientX:g,clientY:E}))):U===q&&(U.dispatchEvent(new PointerEvent("pointermove",{bubbles:!0,cancelable:!0,clientX:g,clientY:E})),U.dispatchEvent(new MouseEvent("mousemove",{bubbles:!0,cancelable:!0,clientX:g,clientY:E})))}},onPinch:(o,m)=>{const g=o*window.innerWidth,E=m*window.innerHeight,M=document.elementFromPoint(g,E);if(M){const I=le=>{le.dispatchEvent(new PointerEvent("pointerdown",{bubbles:!0,cancelable:!0,clientX:g,clientY:E,pointerId:1,pointerType:"touch",isPrimary:!0})),le.dispatchEvent(new PointerEvent("pointerup",{bubbles:!0,cancelable:!0,clientX:g,clientY:E,pointerId:1,pointerType:"touch",isPrimary:!0})),le.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0,clientX:g,clientY:E})),le.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0,clientX:g,clientY:E})),le.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,clientX:g,clientY:E}))},q=M.closest('button, a, [role="button"], [data-clickable], .cursor-pointer, [onclick]');I(q||M);const U=document.createElement("div");U.style.position="fixed",U.style.left=`${g}px`,U.style.top=`${E}px`,U.style.width="20px",U.style.height="20px",U.style.background="rgba(236, 72, 153, 0.5)",U.style.borderRadius="50%",U.style.transform="translate(-50%, -50%)",U.style.pointerEvents="none",U.style.zIndex="9999",document.body.appendChild(U),U.animate([{transform:"translate(-50%, -50%) scale(1)",opacity:1},{transform:"translate(-50%, -50%) scale(4)",opacity:0}],{duration:400}).onfinish=()=>U.remove()}},onModeChange:o=>{const m=["chat","compare","analyze","debate"],g=m.indexOf(l);let E;o==="next"?E=(g+1)%m.length:E=(g-1+m.length)%m.length,lt(m[E])}})})}),e.jsxs("div",{style:{paddingLeft:"1.5rem",paddingRight:"0"},children:[L&&e.jsx("div",{className:"fixed inset-0 z-[55] bg-black/10 backdrop-blur-[1px] transition-opacity duration-300",onClick:()=>H(!1)}),e.jsx(ms,{showDock:L,availableModels:d,allSelectedByType:p,totalModelsByType:h,handleDragStart:ue,handleModelToggle:xt,handleAddGroup:hn,dockRef:Ae,mode:l,allModels:s,setShowDock:H,chatSelectedModels:ye,onToggleChatModel:b,onToggleChatGroup:S}),l==="chat"&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex h-screen w-full relative z-[10]",children:e.jsx("div",{className:"flex-1 relative px-2 sm:px-6 pt-20 pb-6",children:e.jsx(sr,{children:e.jsx(n.Suspense,{fallback:e.jsxs("div",{className:"flex items-center justify-center h-full text-white/50 gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/20 border-t-white/60 rounded-full animate-spin"}),"Loading..."]}),children:e.jsx(cr,{ref:Ne,models:s,selectedModels:ye,onToggleModel:b,githubToken:y,openrouterKey:Ee,messages:ge,setMessages:De,isGenerating:z,setIsGenerating:$,gesturesActive:t.isActive,uiBuilderEnabled:pe,setUiBuilderEnabled:V})})})})})}),l!=="chat"&&e.jsxs("div",{className:"flex h-screen w-full relative",children:[e.jsx("div",{className:"relative flex-1 transition-all duration-300 flex flex-col pt-24",children:e.jsx("div",{ref:he,onDragOver:dn,onDragLeave:fn,onDrop:pn,className:"relative w-full h-full z-10 transition-all duration-300",style:{position:"relative",display:"flex",alignItems:l==="compare"?"flex-start":"center",justifyContent:"center","--arena-offset-y":`${Ot.current}px`,transform:l==="analyze"||l==="debate"?`translateY(calc(var(--arena-offset-y) - 50px)) scale(${Z?1.02:1})`:`translateY(var(--arena-offset-y)) scale(${Z?1.02:1})`,willChange:"transform",border:Z?"2px dashed rgba(59, 130, 246, 0.4)":"2px dashed transparent",borderRadius:Z?"24px":"0px",transition:"transform 0s linear",...l==="compare"?{minHeight:"300px",paddingBottom:"120px"}:l==="analyze"||l==="debate"?{height:"100%",minHeight:"100%",overflow:"hidden"}:{height:"100%",minHeight:"100%",overflow:"hidden"},...Z?{background:"rgba(59, 130, 246, 0.05)"}:{}},children:e.jsx(Fs,{mode:l,selectedModels:ae,gridCols:W,speaking:We,selectedCardIds:Ye,setSelectedCardIds:Fe,executionTimes:ne,failedModels:Bn,cardRefs:at,handlePointerDown:Nn,dragState:Cn,handleModelToggle:xt,setContextMenu:Re,suppressClickRef:Ge,getTailSnippet:Gn,hoveredCard:mn,setHoveredCard:He,setExpandedModelId:nt,layoutRadius:gt,getCirclePosition:Oe,moderatorModel:Wn,moderatorId:c,orchestratorTransform:Fn,orchestratorStatus:Yn,moderatorSynthesis:Ke,isSynthesizing:ct,isGenerating:ke,phaseLabel:Ve,linesTransitioning:D,lastSelectedCardRef:yn,orchestratorAutoMode:_n,orchestratorAutoScope:In,showOrchestratorMenu:kt,setShowOrchestratorMenu:jt,setOrchestratorAutoMode:zn,setOrchestratorAutoScope:Pn,orchestratorMenuRef:St,availableModels:d,setModerator:u,fastestTTFT:et,fastestTotal:tt})})}),l!=="compare"&&e.jsx("div",{className:"transcript-panel w-[400px] xl:w-[480px] flex flex-col border-l border-white/5 bg-slate-900/20 backdrop-blur-sm z-40 relative h-full",children:e.jsx(n.Suspense,{fallback:null,children:e.jsx(ar,{history:N,models:s,mode:l,onSelectPrompt:o=>{Xe.current&&(Xe.current.value=o,Xe.current.focus())},onNewSession:An,className:"pt-24 pb-6 mask-fade-top",phaseLabel:Ve,isGenerating:ke,isSynthesizing:ct,speakingCount:We.size,totalParticipants:ae.length})})})]})]}),e.jsx(er,{rect:En}),je&&e.jsx("div",{className:"fixed bottom-20 left-1/2 -translate-x-1/2 z-[200] animate-in slide-in-from-bottom-4 fade-in duration-300",children:e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 rounded-xl bg-amber-500/10 border border-amber-500/30 backdrop-blur-md shadow-xl",children:[e.jsx("svg",{className:"w-5 h-5 text-amber-400 shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsx("span",{className:"text-sm text-amber-100",children:je}),e.jsx("button",{onClick:()=>{ee(null),G(!0)},className:"ml-2 px-3 py-1 text-xs font-medium text-amber-900 bg-amber-400 hover:bg-amber-300 rounded-md transition-colors",children:"Open Settings"}),e.jsx("button",{onClick:()=>ee(null),className:"ml-1 p-1 text-amber-400/60 hover:text-amber-400 transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsx(n.Suspense,{fallback:null,children:e.jsx(rr,{open:P,onClose:()=>G(!1),token:y,setToken:ce,openrouterKey:Ee,setOpenrouterKey:xe,bgStyle:ut,setBgStyle:Hn})}),Ce&&l==="compare"&&e.jsx(n.Suspense,{fallback:null,children:e.jsx(or,{model:ae.find(o=>o.id===Ce)||null,executionTimes:ne[Ce],onClose:()=>nt(null),onPrev:()=>{const o=ae.findIndex(m=>m.id===Ce);o>0&&nt(ae[o-1].id)},onNext:()=>{const o=ae.findIndex(m=>m.id===Ce);o<ae.length-1&&nt(ae[o+1].id)},hasPrev:ae.findIndex(o=>o.id===Ce)>0,hasNext:ae.findIndex(o=>o.id===Ce)<ae.length-1})}),(l==="compare"||l==="analyze"||l==="debate")&&e.jsx(xs,{inputRef:Xe,inputFocused:xn,setInputFocused:gn,onSendMessage:Ct,isGenerating:ke||ct,onStop:en,placeholder:l==="compare"?void 0:"Steer the discussion...",className:`fixed bottom-0 left-0 z-[100] pb-6 px-3 sm:px-4 flex justify-center items-end pointer-events-none transition-all duration-300 ${l==="compare"?"right-0":"right-[400px] xl:right-[480px]"}`,style:{paddingBottom:"calc(1.5rem + env(safe-area-inset-bottom))"}}),be&&e.jsx("div",{className:"fixed bg-slate-800 border border-slate-700 rounded-lg shadow-xl py-1 z-[200] min-w-[160px]",style:{top:be.y,left:be.x},onClick:o=>o.stopPropagation(),children:be.type==="background"?e.jsxs("button",{className:"w-full text-left px-4 py-2 text-sm text-slate-200 hover:bg-slate-700 transition-colors flex items-center gap-2",onClick:()=>{H(!0),Re(null)},children:[e.jsx("svg",{className:"w-4 h-4 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Model"]}):be.modelId?e.jsxs(e.Fragment,{children:[l!=="compare"&&be.modelId!==c&&e.jsxs("button",{className:"w-full text-left px-4 py-2 text-sm text-slate-200 hover:bg-slate-700 transition-colors flex items-center gap-2",onClick:()=>{u(be.modelId),Re(null)},children:[e.jsx("svg",{className:"w-4 h-4 text-orange-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})}),"Set as Orchestrator"]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 text-sm text-red-400 hover:bg-slate-700 transition-colors flex items-center gap-2",onClick:()=>{const o=be.modelId===c;if(xt(be.modelId),o&&l!=="compare"){const m=a.filter(g=>g!==be.modelId);m.length>0?u(m[0]):u("")}Re(null)},children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Remove"]})]}):null})]})}function fr(){return e.jsx(tr,{children:e.jsx(dr,{})})}rs.createRoot(document.getElementById("root")).render(e.jsx(os.StrictMode,{children:e.jsx(fr,{})}));export{ps as B,an as E,vr as M,xs as P,hs as U,wr as a,Es as f,Lt as s,nr as u};
