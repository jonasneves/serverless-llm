const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SettingsModal-BCbQxjpE.js","assets/react-vendor-CQxWqugw.js","assets/markdown-BNX5kHMI.js","assets/math-render-D6B7xoul.js","assets/math-render-BqiDbsU2.css","assets/syntax-highlight-K7DiErAG.js","assets/syntax-highlight-BEHUn5zE.css","assets/DiscussionTranscript-CASXh_32.js","assets/FormattedContent-ClPh4eCb.js","assets/GestureControl-C1_yFZrh.js","assets/HandBackground-F7iiHyIM.js","assets/mediapipe-BWDqrTQ6.js","assets/ChatView-uSdCs5Jp.js"])))=>i.map(i=>d[i]);
var Yn=Object.defineProperty;var Fn=(t,n,r)=>n in t?Yn(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r;var Jt=(t,n,r)=>Fn(t,typeof n!="symbol"?n+"":n,r);import{r as s,j as e,X as Xn,S as Gn,C as Un,a as Kn,A as qn,b as Vn,Z as Qn,T as Jn,R as Zn,c as es,d as ts}from"./react-vendor-CQxWqugw.js";import"./math-render-D6B7xoul.js";import"./syntax-highlight-K7DiErAG.js";import"./markdown-BNX5kHMI.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))a(p);new MutationObserver(p=>{for(const i of p)if(i.type==="childList")for(const m of i.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&a(m)}).observe(document,{childList:!0,subtree:!0});function r(p){const i={};return p.integrity&&(i.integrity=p.integrity),p.referrerPolicy&&(i.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?i.credentials="include":p.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(p){if(p.ep)return;p.ep=!0;const i=r(p);fetch(p.href,i)}})();const ns="modulepreload",ss=function(t){return"/static/playground/"+t},Zt={},Ve=function(n,r,a){let p=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const m=document.querySelector("meta[property=csp-nonce]"),u=(m==null?void 0:m.nonce)||(m==null?void 0:m.getAttribute("nonce"));p=Promise.allSettled(r.map(c=>{if(c=ss(c),c in Zt)return;Zt[c]=!0;const f=c.endsWith(".css"),d=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const h=document.createElement("link");if(h.rel=f?"stylesheet":ns,f||(h.as="script"),h.crossOrigin="",h.href=c,u&&h.setAttribute("nonce",u),document.head.appendChild(h),f)return new Promise((k,L)=>{h.addEventListener("load",k),h.addEventListener("error",()=>L(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(m){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=m,window.dispatchEvent(u),!u.defaultPrevented)throw m}return p.then(m=>{for(const u of m||[])u.status==="rejected"&&i(u.reason);return n().catch(i)})},rs={"self-hosted":{color:"#10b981"},github:{color:"#3b82f6"},external:{color:"#8b5cf6"}},os=["deepseek-r1-distill-qwen-1.5b","r1qwen","smollm3","nanbeige"],as=["gpt-oss","gptoss"],is=t=>{const n=t.toLowerCase();return os.some(r=>n.includes(r.toLowerCase()))},ls=t=>{const n=t.toLowerCase();return as.some(r=>n.includes(r.toLowerCase()))},Mt=[{id:"eu-ai-act-enforcement",label:"EU AI Act Enforcement Wave",prompt:"The EU AI Act enters enforcement; high-risk systems must prove data provenance, evals, and risk controls. Outline compliance gaps for a frontier model API and tradeoffs between speed and alignment.",category:"Policy",modes:["analyze","debate"],tags:["governance","compliance"]},{id:"export-controls-blackwell",label:"Export Controls Tighten",prompt:"U.S. export rules tighten again on AI accelerators; Blackwell-class parts face new caps and cloud checks. Map the impact on training roadmaps, costs, and on-device strategies.",category:"Infra",modes:["compare","debate"],tags:["chips","supply-chain"]},{id:"weights-leak",label:"Major Weights Leak",prompt:"A commercial frontier model checkpoint leaks. Assess risks (misuse, impersonation, jailbreak diffusion), legal exposure, and whether open red-team releases mitigate or worsen safety.",category:"Security",modes:["analyze","debate"],tags:["safety","open-weights"]},{id:"on-device-llm-race",label:"On-Device LLM Race",prompt:"Phone OEMs ship 3nm NPUs and 20B-parameter on-device assistants. What actually moves the needle for UX, privacy, and cost vs. cloud? Where do hybrid (edge + cloud) designs win?",category:"Infra",modes:["compare","debate"],tags:["edge","latency"]},{id:"signed-app-prompt-injection",label:"Signed App Prompt Injection",prompt:"A popular signed desktop app shipped with hardcoded system prompts; attackers use supply chain updates to exfiltrate data. How should vendors audit, sandbox, and attest LLM apps?",category:"Security",modes:["compare","analyze"],tags:["supply-chain","prompt-injection"]},{id:"eval-standardization",label:"Safety Eval Standard",prompt:"NIST-style safety eval suites gain traction (jailbreak, autonomy, bio). How should vendors report scores, and what gaps remain for frontier vs. small models?",category:"Policy",modes:["compare","debate"],tags:["evaluation","safety"]},{id:"licensing-standoff",label:"Publisher Licensing Standoff",prompt:"Major news publishers pause AI licensing talks and sue over training. What remedies (revenue share, opt-out registries, model removal) are realistic, and how do they ripple to open models?",category:"Data",modes:["analyze","debate"],tags:["licensing","copyright"]},{id:"sbom-for-llms",label:"SBOM for LLM Pipelines",prompt:"Regulators push SBOMs and signed artifacts for AI stacks. Draft what should appear in an LLM pipeline SBOM (data, weights, evals, guardrails) and how to verify it at runtime.",category:"Security",modes:["compare","analyze"],tags:["sbom","supply-chain"]},{id:"data-poisoning-campaign",label:"Data Poisoning Campaign",prompt:"Researchers find coordinated data poisoning in popular open corpora. How should model hosts detect and mitigate poisoning post-hoc, and what retraining tradeoffs are acceptable?",category:"Security",modes:["compare","debate"],tags:["data","poisoning"]},{id:"copyright-settlement",label:"Copyright Settlement Sets Precedent",prompt:"A major copyright suit settles with dataset disclosure and per-output watermarking. Predict how this precedent affects future training sets and open-weight releases.",category:"Policy",modes:["debate"],tags:["copyright","watermarking"]}],hr={analyze:["What's the most important programming principle?","Should code comments explain 'what' or 'why'?","Is TypeScript worth the extra complexity?"],debate:["Tabs or spaces? Give your verdict.","Should AI be allowed to write its own code?","What will never be automated by AI?"],compare:[],chat:[]};Mt.filter(t=>t.category==="Policy"||t.category==="Data"),Mt.filter(t=>t.category==="Infra"),Mt.filter(t=>t.category==="Security");const cs=["dots-mesh","dots","dots-fade","grid","mesh","animated-mesh","none"],ut="#0f172a",en={compare:ut,analyze:ut,debate:ut,chat:ut},qe={maxTokens:1024,temperature:.7},se={cardWidth:256,cardHeight:200,gapX:24,gapY:24,baseRadius:160,minRadius:120,radiusPerModel:15,scrollClamp:200};function us({showDock:t,availableModels:n,allSelectedByType:r,totalModelsByType:a,handleDragStart:p,handleModelToggle:i,handleAddGroup:m,dockRef:u,mode:c,allModels:f,setShowDock:d,chatSelectedModels:h=new Set,onToggleChatModel:k,onToggleChatGroup:L}){const[A,I]=s.useState(""),[b,l]=s.useState(""),j=s.useRef(null);s.useEffect(()=>{const _=setTimeout(()=>l(A),200);return()=>clearTimeout(_)},[A]);const D=[{type:"self-hosted",title:"Self-Hosted",accentColor:"emerald"},{type:"github",title:"GitHub Models",accentColor:"blue"},{type:"external",title:"External",accentColor:"purple"}],F=c==="chat",P=F?f:n,E=s.useMemo(()=>{if(!b)return P;const _=b.toLowerCase();return P.filter(M=>M.name.toLowerCase().includes(_))},[P,b]),Q=s.useCallback(_=>{F&&k?k(_):i(_)},[F,k,i]);s.useEffect(()=>{t?setTimeout(()=>{var _;return(_=j.current)==null?void 0:_.focus()},100):I("")},[t]),s.useEffect(()=>{if(!t)return;const _=M=>{M.key==="Escape"&&(M.preventDefault(),d(!1))};return window.addEventListener("keydown",_),()=>window.removeEventListener("keydown",_)},[t,d]);const U=_=>({emerald:{dot:"bg-emerald-500",text:"text-emerald-400",active:"bg-emerald-500/20 border-emerald-500/30"},blue:{dot:"bg-blue-500",text:"text-blue-400",active:"bg-blue-500/20 border-blue-500/30"},purple:{dot:"bg-purple-500",text:"text-purple-400",active:"bg-purple-500/20 border-purple-500/30"}})[_];return e.jsxs("div",{ref:u,"data-no-arena-scroll":!0,"data-no-background":!0,className:"fixed top-1/2 left-1/2 w-[min(90vw,500px)] max-h-[70vh] rounded-2xl flex flex-col z-[60] transition-all duration-300 shadow-2xl bg-slate-800/95 backdrop-blur-md",style:{transform:t?"translate(-50%, -50%) scale(1)":"translate(-50%, -50%) scale(0.95)",opacity:t?1:0,pointerEvents:t?"auto":"none"},children:[e.jsxs("div",{className:"px-4 py-3 border-b border-slate-700/50 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-200",children:F?"Select Models":"Add to Arena"}),F&&e.jsx("p",{className:"text-[10px] text-slate-500 mt-0.5",children:h.size===0?"Click to select":`${h.size} selected`})]}),e.jsx("button",{onClick:()=>d(!1),className:"text-slate-400 hover:text-slate-200",children:e.jsx(Xn,{size:18})})]}),e.jsx("div",{className:"px-4 py-2 border-b border-slate-700/50",children:e.jsxs("div",{className:"relative",children:[e.jsx(Gn,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-500"}),e.jsx("input",{ref:j,type:"text",placeholder:"Search...",value:A,onChange:_=>I(_.target.value),className:"w-full pl-9 pr-3 py-2 text-sm bg-slate-700/50 border border-slate-600/50 rounded-lg text-slate-200 placeholder-slate-500 focus:outline-none focus:border-slate-500"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-3 space-y-4",children:D.map(_=>{const M=E.filter(X=>X.type===_.type),K=f.filter(X=>X.type===_.type),O=U(_.accentColor);if(K.length===0)return null;const ee=F&&K.every(X=>h.has(X.id));return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between px-1 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${O.dot}`}),e.jsxs("span",{className:"text-[10px] font-semibold text-slate-400 uppercase tracking-wide",children:[_.title," (",K.length,")"]})]}),F?L&&e.jsx("button",{onClick:()=>L(_.type),className:`text-[10px] font-medium px-2 py-1 rounded ${O.text} hover:bg-white/5`,children:ee?"− Remove All":"+ Add All"}):e.jsx("button",{onClick:()=>m(_.type),className:`text-[10px] font-medium px-2 py-1 rounded ${O.text} hover:bg-white/5`,children:r[_.type]?"− Remove All":"+ Add All"})]}),e.jsx("div",{className:"space-y-1",children:M.map(X=>{const H=F?h.has(X.id):!1;return e.jsxs("div",{draggable:!F,onDragStart:F?void 0:y=>p(y,X.id),onClick:()=>Q(X.id),className:`flex items-center justify-between px-3 py-2 rounded-lg cursor-pointer transition-colors border ${H?O.active:"hover:bg-white/5 border-transparent"}`,children:[e.jsx("span",{className:`text-xs font-medium ${H?"text-slate-200":"text-slate-400"}`,children:X.name}),H&&e.jsx(Un,{size:14,className:O.text})]},X.id)})})]},_.type)})}),e.jsx("div",{className:"px-4 py-2 border-t border-slate-700/50",children:e.jsxs("p",{className:"text-[10px] text-slate-500 text-center",children:["Press ",e.jsx("kbd",{className:"px-1 py-0.5 rounded bg-slate-700 text-slate-400 text-[9px]",children:"M"})," or ",e.jsx("kbd",{className:"px-1 py-0.5 rounded bg-slate-700 text-slate-400 text-[9px]",children:"Esc"})," to close"]})})]})}function ds({inputRef:t,inputFocused:n,setInputFocused:r,onSendMessage:a,className:p,style:i,placeholder:m,isGenerating:u,onStop:c}){return e.jsx("div",{className:p??"fixed bottom-0 right-0 left-0 z-[100] pb-6 px-3 sm:px-4 flex justify-center items-end pointer-events-none transition-all duration-300",style:i??{paddingBottom:"calc(1.5rem + env(safe-area-inset-bottom))"},children:e.jsx("div",{className:"w-full pointer-events-auto",style:{maxWidth:"600px"},children:e.jsxs("div",{className:`rounded-xl p-2.5 transition-all duration-300 flex items-center gap-2 border border-slate-700/40 header-shell ${n?"prompt-panel-focused":""}`,children:[e.jsx("input",{ref:t,type:"text",placeholder:m||"Ask a question to compare model responses...",className:"w-full bg-transparent text-slate-200 placeholder-slate-500 outline-none text-base sm:text-sm px-2.5 py-2.5",onFocus:()=>r(!0),onBlur:()=>r(!1),onKeyDown:f=>{var d;if(f.key==="Enter"&&!f.shiftKey){if(f.preventDefault(),u)return;(d=t.current)!=null&&d.value&&(a(t.current.value),t.current.value="")}},disabled:u}),e.jsx("button",{onClick:()=>{var f;u?c==null||c():(f=t.current)!=null&&f.value&&(a(t.current.value),t.current.value="")},onMouseDown:f=>f.currentTarget.blur(),className:`min-w-[44px] min-h-[44px] sm:min-w-[36px] sm:min-h-[36px] p-2 rounded-lg transition-colors active:scale-95 flex items-center justify-center focus:outline-none focus-visible:outline-none ${u?"text-red-400 hover:text-red-300 hover:bg-red-500/10":"text-slate-400 hover:text-white hover:bg-white/10"}`,"aria-label":u?"Stop generation":"Send message",children:u?e.jsx(Kn,{className:"w-5 h-5 sm:w-4 sm:h-4 fill-current"}):e.jsx(qn,{className:"w-5 h-5 sm:w-4 sm:h-4",strokeWidth:2.5})})]})})})}const fs={chat:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),compare:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2"})}),analyze:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),debate:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})},Le=[{value:"chat",label:"Chat"},{value:"compare",label:"Compare"},{value:"analyze",label:"Analyze"},{value:"debate",label:"Debate"}];function ps({mode:t,setMode:n,setHoveredCard:r,clearSelection:a,showDock:p,setShowDock:i,onOpenSettings:m,gestureButtonSlot:u}){const[c,f]=s.useState(!1),d=s.useRef(null),[h,k]=s.useState(!0),L=s.useRef(null),[A,I]=s.useState(null),[b,l]=s.useState(0),j=Le.findIndex(E=>E.value===t),D=j===-1?0:j,F=Le[D].label;s.useEffect(()=>{const E=()=>{k(window.innerWidth>=1024)};return E(),window.addEventListener("resize",E),()=>window.removeEventListener("resize",E)},[]),s.useEffect(()=>{if(!L.current)return;const E=()=>{const _=L.current;if(!_)return;const M=_.querySelectorAll('button[role="radio"]');if(M.length===0||D>=M.length)return;const O=M[D].getBoundingClientRect(),ee=_.getBoundingClientRect(),X=O.width,H=O.left,y=ee.left;I(X),l(H-y)},Q=setTimeout(E,0),U=new ResizeObserver(()=>{setTimeout(E,0)});return U.observe(L.current),window.addEventListener("resize",E),()=>{clearTimeout(Q),U.disconnect(),window.removeEventListener("resize",E)}},[t,h,D]),s.useEffect(()=>{function E(Q){d.current&&!d.current.contains(Q.target)&&f(!1)}return c&&document.addEventListener("mousedown",E),()=>{document.removeEventListener("mousedown",E)}},[c]);const P=E=>{n(E),r(null),a(),f(!1)};return e.jsxs("div",{className:"fixed top-0 left-0 right-0 flex items-center justify-between mb-2 px-3 sm:px-6 pt-4 sm:pt-6 z-50 pointer-events-none transition-all duration-300",children:[e.jsx("div",{className:"absolute inset-0 pointer-events-auto",style:{height:"100%",zIndex:-1}}),e.jsx("div",{className:"flex items-center gap-2 w-auto pointer-events-auto z-20",children:u}),e.jsx("div",{className:"hidden md:block absolute left-1/2 -translate-x-1/2 pointer-events-auto z-20",children:e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex items-center p-1.5 rounded-xl border border-slate-700/40 header-shell",children:[e.jsx("button",{onClick:()=>i(!p),className:"px-2 sm:px-3 flex items-center justify-center text-slate-400 hover:text-white transition-colors",title:"Toggle Model Dock",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsx("div",{className:"w-px h-5 bg-slate-700/50 mx-0.5 sm:mx-1"}),e.jsxs("div",{ref:L,className:"relative flex p-1 rounded-lg bg-black/20 mode-track",role:"radiogroup","aria-label":"Mode selection","data-gesture-mode-track":"true",children:[e.jsx("div",{className:"absolute top-1 bottom-1 rounded-md transition-all duration-300 ease-out mode-slider",style:{width:A!==null?`${A}px`:`calc((100% - 8px) / ${Le.length})`,left:A!==null?`${b}px`:`calc(4px + (100% - 8px) * ${D} / ${Le.length})`}}),Le.map(E=>e.jsx("button",{tabIndex:-1,onClick:()=>P(E.value),role:"radio","aria-checked":t===E.value,"aria-label":E.label,title:E.label,className:`relative z-10 py-2 sm:py-1.5 px-3 text-[11px] sm:text-xs font-medium transition-colors duration-200 min-h-[44px] sm:min-h-0 active:scale-95 focus:outline-none focus-visible:outline-none flex-1 flex items-center justify-center text-center ${t===E.value?"text-white":"text-slate-400 hover:text-slate-200"}`,children:E.label},E.value))]})]})})}),e.jsx("div",{className:"flex md:hidden flex-1 justify-center pointer-events-auto relative z-20",children:e.jsxs("div",{className:"relative",ref:d,children:[e.jsxs("button",{onClick:()=>f(!c),className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-slate-800/90 border border-slate-700/50 text-slate-200 font-medium text-sm backdrop-blur-md shadow-lg active:scale-95 transition-all",children:[e.jsx("span",{className:"font-bold text-slate-400 hidden xs:inline",children:"Arena"}),e.jsx("span",{className:"font-bold hidden xs:inline text-slate-600",children:"/"}),e.jsx("span",{children:F}),e.jsx("svg",{className:`w-4 h-4 text-slate-400 transition-transform duration-200 ${c?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),c&&e.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 mt-2 w-48 py-1 rounded-xl bg-slate-800 border border-slate-700 shadow-2xl overflow-hidden flex flex-col animate-in fade-in zoom-in-95 duration-100 origin-top",children:Le.map(E=>e.jsxs("button",{onClick:()=>P(E.value),className:`px-4 py-3 text-sm text-left w-full transition-colors flex items-center gap-3 ${t===E.value?"bg-blue-500/10 text-blue-400":"text-slate-300 hover:bg-slate-700/50"}`,children:[e.jsx("span",{className:"flex-shrink-0",children:fs[E.value]}),e.jsx("span",{className:"flex-1",children:E.label}),t===E.value&&e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]},E.value))})]})}),e.jsx("div",{className:"flex items-center gap-2 w-auto justify-end pointer-events-auto z-20",children:e.jsx("button",{onClick:m,className:"min-w-[42px] min-h-[42px] w-[42px] h-[42px] rounded-full bg-slate-800/50 flex items-center justify-center border border-slate-700/50 hover:border-slate-600 transition-colors active:scale-95 focus:outline-none focus-visible:outline-none",title:"Settings",children:e.jsxs("svg",{className:"w-4 h-4 text-slate-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),e.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})})})]})}const hs=t=>{if(typeof t=="string")return t;try{return JSON.stringify(t)}catch{return null}},ms=(t,n)=>{if(t===null)return n;try{return JSON.parse(t)}catch{return n}};function _e(t,n,r={}){const a=r.serialize??hs,p=r.deserialize??ms,[i,m]=s.useState(()=>{if(typeof window>"u")return n;try{const u=window.localStorage.getItem(t);return p(u,n)}catch{return n}});return s.useEffect(()=>{if(!(typeof window>"u"))try{const u=a(i);u===null?window.localStorage.removeItem(t):window.localStorage.setItem(t,u)}catch{}},[t,a,i]),[i,m]}const xs=800,gs=3e3,bs=8;function ys(){const[t,n]=s.useState([]),[r,a]=s.useState(!0),[p,i]=s.useState(null),[m,u]=s.useState(0),[c,f]=_e("playground_selected_models",null),d=s.useRef(c!==null),[h,k]=_e("playground_chat_model",null),L=s.useRef(h!==null),A=s.useMemo(()=>c??[],[c]),I=s.useCallback(M=>{f(K=>typeof M=="function"?M(K??[]):M)},[f]),[b,l]=s.useState(""),j=s.useRef(0),D=s.useRef(null),F=s.useCallback(async(M,K,O=!1)=>{D.current&&(clearTimeout(D.current),D.current=null),a(!0),O&&(i("Refreshing..."),u(0));const ee=X=>{var pe,oe;const H=X.models.map(V=>{const le=V.type==="self-hosted"||V.type==="github"||V.type==="external"?V.type:"self-hosted",ae=rs[le];return{id:V.id,name:ae.name||V.name||V.id,color:ae.color,type:le,response:"",priority:V.priority,context_length:V.context_length,default:V.default}});if(n(H),a(!1),i(null),u(0),d.current||(f(H.filter(V=>V.type==="self-hosted"&&V.id!=="nemotron-3-nano-30b-a3b").map(V=>V.id)),d.current=!0),!L.current){const V=H.find(ae=>ae.default),le=H.find(ae=>ae.type==="github"||ae.type==="external");k((V==null?void 0:V.id)||(le==null?void 0:le.id)||((pe=H[0])==null?void 0:pe.id)||null),L.current=!0}const y=H.find(V=>V.type==="github"||V.type==="external"),ce=H.find(V=>V.default),xe=((oe=H[0])==null?void 0:oe.id)||"";l((y==null?void 0:y.id)||(ce==null?void 0:ce.id)||xe)};try{const X=await fetch("/api/models");if(M!==j.current)return;if(!X.ok)throw new Error(`HTTP ${X.status}`);const H=await X.json();if(M!==j.current)return;if(!H.models||H.models.length===0)throw new Error("No models available yet");ee(H)}catch(X){if(M!==j.current)return;console.warn("Backend fetch failed:",X);try{console.log("Trying static models.json...");const y=await fetch("/models.json");if(y.ok){const ce=await y.json();if(ce.models&&ce.models.length>0){console.log(`Loaded ${ce.models.length} models from static file`),ee(ce);return}}}catch(y){console.warn("Static models.json not available:",y)}const H=K+1;if(u(H),H<bs){const y=Math.min(xs*Math.pow(1.4,K),gs);i("Connecting to backend..."),D.current=setTimeout(()=>{F(M,H)},y)}else a(!1),i("Could not load models")}},[f,k]),P=s.useCallback(()=>{j.current+=1,F(j.current,0,!0)},[F]);s.useEffect(()=>(j.current+=1,F(j.current,0),()=>{j.current+=1,D.current&&clearTimeout(D.current)}),[F]);const E=s.useMemo(()=>t.filter(M=>!A.includes(M.id)),[t,A]),{totalModelsByType:Q,allSelectedByType:U}=s.useMemo(()=>{const M={"self-hosted":t.filter(O=>O.type==="self-hosted").length,github:t.filter(O=>O.type==="github").length,external:t.filter(O=>O.type==="external").length},K={"self-hosted":t.filter(O=>O.type==="self-hosted"&&A.includes(O.id)).length,github:t.filter(O=>O.type==="github"&&A.includes(O.id)).length,external:t.filter(O=>O.type==="external"&&A.includes(O.id)).length};return{totalModelsByType:M,allSelectedByType:{"self-hosted":M["self-hosted"]>0&&K["self-hosted"]===M["self-hosted"],github:M.github>0&&K.github===M.github,external:M.external>0&&K.external===M.external}}},[t,A]),_=s.useCallback(M=>{var K;return((K=t.find(O=>O.id===M))==null?void 0:K.name)||M},[t]);return{modelsData:t,setModelsData:n,selected:A,setSelected:I,chatModelId:h,setChatModelId:k,moderator:b,setModerator:l,availableModels:E,totalModelsByType:Q,allSelectedByType:U,modelIdToName:_,isLoading:r,loadError:p,retryCount:m,retryNow:P}}function vs(){var t;return typeof chrome<"u"&&((t=chrome.storage)!=null&&t.local)?window.__API_BASE__||"https://chat.neevs.io":""}async function*At(t,n,r){var f;const p=`${vs()}${t}`,i=await fetch(p,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),signal:r});if(!i.ok){yield{event:"error",error:`HTTP ${i.status}: ${i.statusText}`};return}const m=(f=i.body)==null?void 0:f.getReader();if(!m){yield{event:"error",error:"No response body"};return}const u=new TextDecoder;let c="";try{for(;;){const{done:d,value:h}=await m.read();if(d)break;c+=u.decode(h,{stream:!0});const k=c.split(`
`);c=k.pop()||"";for(const L of k)if(L.startsWith("data: ")){const A=L.slice(6).trim();if(A)try{yield JSON.parse(A)}catch{}}}}finally{m.releaseLock()}}const ws=async(t,n)=>At("/api/chat/stream",{models:t.models,messages:t.messages,max_tokens:t.max_tokens,temperature:t.temperature,github_token:t.github_token,openrouter_key:t.openrouter_key},n),ks=async(t,n)=>At("/api/chat/analyze/stream",t,n),js=async(t,n)=>At("/api/chat/debate/stream",t,n),Ct=async(t,n)=>{try{for await(const r of t)n(r)}catch(r){throw console.error("Stream error:",r),r}};function tn(t){window.__API_BASE__=t}const Ss=[{name:"Chat",path:"chat.yml",category:"core"},{name:"Build Images",path:"build-push-images.yml",category:"core"},{name:"Nanbeige4-3B Thinking",path:"inference.yml",category:"reasoning",serviceKey:"nanbeige"},{name:"Qwen3 4B",path:"inference.yml",category:"small",serviceKey:"qwen"},{name:"SmolLM3 3B",path:"inference.yml",category:"small",serviceKey:"smollm3"},{name:"LFM2.5 1.2B",path:"inference.yml",category:"small",serviceKey:"lfm2"},{name:"DeepSeek R1 1.5B",path:"inference.yml",category:"reasoning",serviceKey:"r1qwen"},{name:"Gemma 3 12B",path:"inference.yml",category:"medium",serviceKey:"gemma"},{name:"Mistral 7B v0.3",path:"inference.yml",category:"medium",serviceKey:"mistral"},{name:"Phi-3 Mini",path:"inference.yml",category:"small",serviceKey:"phi"},{name:"RNJ-1 Instruct",path:"inference.yml",category:"medium",serviceKey:"rnj"},{name:"Llama 3.2-3B",path:"inference.yml",category:"medium",serviceKey:"llama"},{name:"FunctionGemma 270M",path:"inference.yml",category:"small",serviceKey:"functiongemma"},{name:"Nemotron-3 Nano 30B",path:"inference.yml",category:"reasoning",serviceKey:"nemotron"},{name:"GPT-OSS 20B",path:"inference.yml",category:"reasoning",serviceKey:"gptoss"}],Ts={workflows:Ss},on=Ts.workflows;new Map(on.map(t=>[t.name,t.path]));new Map(on.filter(t=>t.serviceKey).map(t=>[t.serviceKey,t.name]));const Ae={githubToken:"",profile:"local_all",chatApiBaseUrl:"http://localhost:8080",modelsBaseDomain:"",modelsUseHttps:!1};function nn(t){const n={...Ae,...t};(!n.chatApiBaseUrl||typeof n.chatApiBaseUrl!="string")&&typeof n.baseDomain=="string"&&(n.chatApiBaseUrl=n.baseDomain?`${n.useHttps===!1?"http":"https"}://chat.${n.baseDomain}`:"http://localhost:8080",n.profile="custom"),(!n.modelsBaseDomain||typeof n.modelsBaseDomain!="string")&&typeof n.baseDomain=="string"&&(n.modelsBaseDomain=n.baseDomain,n.profile="custom"),typeof n.modelsUseHttps!="boolean"&&typeof n.useHttps=="boolean"&&(n.modelsUseHttps=n.useHttps,n.profile="custom");const r=n.profile==="remote_all"||n.profile==="local_chat_remote_models"||n.profile==="local_all"||n.profile==="custom"?n.profile:Ae.profile;return{githubToken:typeof n.githubToken=="string"?n.githubToken:Ae.githubToken,profile:r,chatApiBaseUrl:Rt(typeof n.chatApiBaseUrl=="string"?n.chatApiBaseUrl:""),modelsBaseDomain:typeof n.modelsBaseDomain=="string"?n.modelsBaseDomain:Ae.modelsBaseDomain,modelsUseHttps:typeof n.modelsUseHttps=="boolean"?n.modelsUseHttps:Ae.modelsUseHttps}}function Es(){var t;return typeof chrome<"u"&&!!((t=chrome.storage)!=null&&t.local)}function Rt(t){const n=t.trim().replace(/\/+$/,"");return n||"http://localhost:8080"}function Ms(){const[t,n]=s.useState(Ae),[r,a]=s.useState(!1);return s.useEffect(()=>{if(Es()){chrome.storage.local.get(["envConfig"],i=>{const m=nn(i.envConfig);n(m),a(!0);const u=Rt(m.chatApiBaseUrl);tn(u),console.log("[Config] Extension mode, API base:",u)});const p=(i,m)=>{var u;if(m==="local"&&((u=i.envConfig)!=null&&u.newValue)){const c=nn(i.envConfig.newValue);n(c);const f=Rt(c.chatApiBaseUrl);tn(f),console.log("[Config] Updated API base:",f)}};return chrome.storage.onChanged.addListener(p),()=>chrome.storage.onChanged.removeListener(p)}else a(!0),console.log("[Config] Web mode, using relative URLs")},[]),{config:t,isLoaded:r}}function Cs(){const[t,n]=s.useState([]),r=s.useRef([]),a=s.useCallback(u=>{if(!u.length)return;const c=[...r.current,...u];r.current=c,n(c)},[]),p=s.useCallback(()=>{r.current=[],n([])},[]),i=s.useCallback(u=>u.map(c=>`${c.role==="user"?"User":"Assistant"}: ${c.content}`).join(`

`),[]),m=s.useCallback((u,c)=>{if(c==="compare")return u;const f=u.filter(h=>h.role==="user"),d=[...u].reverse().find(h=>h.role==="assistant"&&h.kind==="analyze_synthesis"&&h.content.trim().length>0);return d?[...f,d]:f},[]);return{history:t,historyRef:r,pushHistoryEntries:a,clearHistory:p,historyToText:i,buildCarryoverHistory:m}}function Ns(t){const n=s.useRef({}),r=s.useRef(null),a=s.useCallback(()=>{r.current=null;const c=n.current;n.current={},Object.keys(c).length&&t(d=>d.map(h=>{const k=c[h.id];return k?{...h,response:(h.response||"")+k.answer,thinking:(h.thinking||"")+k.thinking}:h}))},[t]),p=s.useCallback(()=>{r.current==null&&(r.current=requestAnimationFrame(a))},[a]),i=s.useCallback((c,f,d)=>{if(!f&&!d)return;const h=n.current[c]||{answer:"",thinking:""};h.answer+=f,h.thinking+=d,n.current[c]=h,p()},[p]),m=s.useCallback(c=>{n.current[c]&&delete n.current[c]},[]),u=s.useCallback(()=>{n.current={},r.current!=null&&(cancelAnimationFrame(r.current),r.current=null)},[]);return{pendingStreamRef:n,flushStreamRafRef:r,enqueueStreamDelta:i,clearPendingStreamForModel:m,resetPendingStream:u}}function Rs(t,n){const r={...n};let a=r.carry+t;r.carry="";const p=a.lastIndexOf("<");if(p!==-1&&a.length-p<12){const c=a.slice(p);("<think>".startsWith(c)||"</think>".startsWith(c)||"<thinking>".startsWith(c)||"</thinking>".startsWith(c))&&(r.carry=c,a=a.slice(0,p))}let i="",m="";if(r.harmonyFormat){const c="<|channel|>final<|message|>",f=a.indexOf(c);if(f!==-1)r.inThink&&(i+=a.slice(0,f)),r.inThink=!1,m+=a.slice(f+c.length);else if(r.inThink){const d=a.replace(/<\|channel\|>analysis<\|message\|>/gi,"").replace(/<\|end\|>/gi,"").replace(/<\|start\|>/gi,"").replace(/assistant/gi,"");i+=d}else{const d=a.replace(/<\|end\|>/gi,"");m+=d}return{answerAdd:m,thinkingAdd:i,newState:r}}if(!r.inThink&&!r.implicitThinking){const c=a.indexOf("</think>"),f=a.indexOf("</thinking>"),d=c!==-1||f!==-1,h=a.indexOf("<think>")!==-1||a.indexOf("<thinking>")!==-1;d&&!h&&(r.implicitThinking=!0,r.inThink=!0)}let u=0;for(;u<a.length;)if(r.inThink){const c=a.indexOf("</think>",u),f=a.indexOf("</thinking>",u);let d=-1,h=0;if(c!==-1&&(f===-1||c<f)?(d=c,h=8):f!==-1&&(d=f,h=11),d===-1){i+=a.slice(u);break}i+=a.slice(u,d),r.inThink=!1,r.implicitThinking=!1,u=d+h}else{const c=a.indexOf("<think>",u),f=a.indexOf("<thinking>",u);let d=-1,h=0;if(c!==-1&&(f===-1||c<f)?(d=c,h=7):f!==-1&&(d=f,h=10),d===-1){m+=a.slice(u);break}m+=a.slice(u,d),r.inThink=!0,u=d+h}return{answerAdd:m,thinkingAdd:i,newState:r}}function Ls(t){const{mode:n,moderator:r,selected:a,selectedCardIds:p,githubToken:i,isGenerating:m,summarizeSessionResponses:u,setLastQuery:c,setHoveredCard:f,setPhaseLabel:d,setModeratorSynthesis:h,setDiscussionTurnsByModel:k,resetFailedModels:L,markModelFailed:A,failedModelsRef:I,currentDiscussionTurnRef:b,sessionModelIdsRef:l,abortControllerRef:j,thinkingStateRef:D,conversationHistoryRef:F,pushHistoryEntries:P,historyToText:E,buildCarryoverHistory:Q,setModelsData:U,modelIdToName:_,setExecutionTimes:M,setIsGenerating:K,setIsSynthesizing:O,setSpeaking:ee,enqueueStreamDelta:X,clearPendingStreamForModel:H,resetPendingStream:y}=t;return{sendMessage:async(xe,pe,oe,V)=>{if(!xe.trim()||a.length===0&&!oe||!oe&&m)return;const le=(V==null?void 0:V.skipHistory)??!1,ae={role:"user",content:xe},ne=le?F.current:[...F.current,ae];le||P([ae]);const Ie=Q(ne,n),$=E(Ie);c(xe);const we=$?`${$}

Continue the conversation above and respond to the latest user request.`:xe;let Z;if(oe)Z=oe;else{const B=Array.from(p).filter(S=>a.includes(S)&&(n==="compare"||S!==r));Z=B.length>0?B:a.slice()}l.current=Z;const ge={},re=(B,S,w)=>{if(!S)return;const v=w!=null&&w.label?`${w.label}: ${S}`:S;ge[B]=w!=null&&w.replace?v:ge[B]?`${ge[B]}

${v}`:v},de=new AbortController;j.current=de,K(!0),O(!1),f(null),d(null),h(""),k({}),L(),b.current=null,y(),U(B=>B.map(S=>Z.includes(S.id)||S.id===r?pe&&pe[S.id]?{...S,response:pe[S.id],thinking:void 0,error:void 0}:{...S,response:"",thinking:void 0,error:void 0}:S)),M(B=>{const S={...B},w=performance.now();return Z.forEach(v=>{S[v]={startTime:w}}),r&&!S[r]&&(S[r]={startTime:w}),S});const he=new Set(Z);r&&he.add(r),he.forEach(B=>{const S=is(B),w=ls(B);D.current[B]={inThink:S||w,carry:"",implicitThinking:S,harmonyFormat:w}});const be=new Set,Ne=(B,S)=>{const w=B==null?void 0:B.trim();!w||le||P([{role:"assistant",content:w,kind:S}])},ke=(B,S)=>{const w=D.current[B]||{inThink:!1,carry:"",implicitThinking:!1},{answerAdd:v,thinkingAdd:T,newState:C}=Rs(S,w);D.current[B]=C,v&&re(B,v),(T||v)&&X(B,v,T)},Re=B=>{const S=B.toLowerCase();return S.includes("rate limit")||S.includes("waiting")?'<svg width="14" height="14" viewBox="0 0 24 24" fill="none" style="display: inline-block; vertical-align: text-bottom; margin-right: 6px;"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none"/><path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>'+B:S.includes("error")||S.includes("failed")?'<svg width="14" height="14" viewBox="0 0 24 24" fill="none" style="display: inline-block; vertical-align: text-bottom; margin-right: 6px;"><path d="M12 2L2 20h20L12 2z" stroke="currentColor" stroke-width="2" fill="none" stroke-linejoin="round"/><path d="M12 9v4M12 17h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>'+B:B};try{if(n==="compare"){ee(new Set(Z));const B=await ws({models:Z,messages:ne.map(S=>({role:S.role,content:S.content})),max_tokens:qe.maxTokens,temperature:qe.temperature,github_token:i||null},de.signal);if(await Ct(B,S=>{if(S.event==="info"&&S.content){const w=String(S.content),v=Re(w);d(v),S.model_id&&U(T=>T.map(C=>C.id===S.model_id?{...C,statusMessage:v}:C))}if(S.event==="token"&&S.model_id){const w=S.model_id,v=performance.now();be.has(w)||(be.add(w),M(T=>({...T,[w]:{...T[w],firstTokenTime:v}})),U(T=>T.map(C=>C.id===w?{...C,statusMessage:void 0}:C))),ke(w,String(S.content??""))}if(S.event==="done"&&S.model_id){const w=performance.now(),v=S.model_id;M(T=>({...T,[v]:{...T[v],endTime:w}})),ee(T=>{const C=new Set(T);return C.delete(v),C})}}),!le){const S=u(ge,Z);S&&P([{role:"assistant",content:S,kind:"compare_summary"}])}return}if(n==="analyze"){const B=Z;if(B.length<2){const v="Select at least 2 participants for Analyze mode.";h(v),r&&U(T=>T.map(C=>C.id===r?{...C,response:v}:C)),d("Error");return}ee(new Set(B));const S=await ks({query:we,participants:B,max_tokens:qe.maxTokens,github_token:i||null},de.signal);let w="";if(await Ct(S,v=>{const T=v.event;if(T==="analyze_start"&&d("Collecting Responses"),T==="model_start"&&v.model_id){const C=v.model_id;ee(te=>{const q=new Set(te);return q.add(C),q})}if(T==="model_chunk"&&v.model_id){const C=v.model_id,te=performance.now();be.has(C)||(be.add(C),M(q=>({...q,[C]:{...q[C],firstTokenTime:te}}))),ke(C,String(v.chunk??""))}if(T==="model_response"&&v.model_id){const C=v.model_id,te=performance.now();M(W=>({...W,[C]:{...W[C],endTime:te}})),ee(W=>{const J=new Set(W);return J.delete(C),J});const q=String(v.response??"");re(C,q,{replace:!0}),pe&&pe[C]||(U(W=>W.map(J=>J.id===C?{...J,response:q}:J)),Ne(`${_(C)}:
${q}`,"analyze_response"))}if(T==="model_error"&&v.model_id){const C=v.model_id,te=performance.now();M(W=>({...W,[C]:{...W[C],endTime:te}})),ee(W=>{const J=new Set(W);return J.delete(C),J});const q=String(v.error??"Error generating response.");H(C),U(W=>W.map(J=>J.id===C?{...J,response:q,error:q}:J)),A(C),re(C,q,{replace:!0})}if(T==="analysis_complete"){d("Analysis Complete");const C=v.consensus||[],te=v.unique_contributions||{};let q=`Analysis:

`;if(C.length>0&&(q+=`Consensus:
`+C.map(W=>`• ${W}`).join(`
`)+`

`),Object.keys(te).length>0){q+=`Unique Contributions:
`;for(const[W,J]of Object.entries(te)){const Se=_(W);q+=`
${Se}:
`+J.map(me=>`• ${me}`).join(`
`)+`
`}}w=q,h(q),r&&U(W=>W.map(J=>J.id===r?{...J,response:q}:J))}if(T==="analyze_complete"&&(d("Complete"),ee(new Set)),T==="error"){const C=String(v.error??"Analyze error.");h(C),d("Error")}}),!le){const v=w.trim();v&&P([{role:"assistant",content:v,kind:"analyze_synthesis"}])}return}if(n==="debate"){const B=Z;if(B.length<2){const w="Select at least 2 participants for Debate mode.";h(w),r&&U(v=>v.map(T=>T.id===r?{...T,response:w}:T)),d("Error");return}const S=await js({query:we,participants:B,turns:2,max_tokens:qe.maxTokens,temperature:qe.temperature,github_token:i||null},de.signal);await Ct(S,w=>{const v=w.event;if(v==="debate_start"&&d("Debate Starting"),v==="round_start"){const T=w.round_number??0;d(`Round ${T+1}`)}if(v==="turn_start"&&w.model_id){const T=w.model_id,C=w.turn_number??0,te=w.round_number??0;ee(new Set([T])),d(`Round ${te+1} · Turn ${C+1}`),b.current={modelId:T,turnNumber:C}}if(v==="turn_chunk"&&w.model_id){const T=w.model_id,C=performance.now();be.has(T)||(be.add(T),M(te=>({...te,[T]:{...te[T],firstTokenTime:C}}))),ke(T,String(w.chunk??""))}if(v==="turn_complete"&&w.model_id){const T=w.model_id,C=performance.now();M(W=>({...W,[T]:{...W[T],endTime:C}})),ee(W=>{const J=new Set(W);return J.delete(T),J});const te=String(w.response??""),q=w.turn_number??0;re(T,te,{replace:!0}),U(W=>W.map(J=>J.id===T?{...J,response:te}:J)),k(W=>({...W,[T]:[...W[T]||[],{turn_number:q,response:te}]})),Ne(`${_(T)}:
${te}`,"debate_turn")}if(v==="turn_error"&&w.model_id){const T=w.model_id,C=performance.now();M(q=>({...q,[T]:{...q[T],endTime:C}})),ee(q=>{const W=new Set(q);return W.delete(T),W});const te=String(w.error??"Turn error.");H(T),U(q=>q.map(W=>W.id===T?{...W,response:te,error:te}:W)),A(T)}if(v==="debate_complete"&&(d("Complete"),ee(new Set)),v==="error"){const T=String(w.error??"Debate error.");d("Error"),h(T)}});return}}catch(B){if(B.name==="AbortError")return;if(console.error("Chat error:",B),j.current===de){const S=B.message||String(B);h(`Session Error: ${S}`),d("Error"),y(),U(w=>w.map(v=>Z.includes(v.id)&&!v.response?{...v,response:"Error generating response."}:v)),Z.forEach(w=>A(w))}}finally{if(j.current===de){const B=performance.now();M(S=>{const w={...S};return l.current.forEach(v=>{w[v]&&!w[v].endTime&&(w[v]={...w[v],endTime:B})}),w}),K(!1),O(!1),d(S=>S==="Error"?S:null),ee(new Set)}}}}}function Nt(t,n){const r=Math.min(t.x,n.x),a=Math.min(t.y,n.y),p=Math.max(t.x,n.x),i=Math.max(t.y,n.y);return{left:r,top:a,right:p,bottom:i,width:p-r,height:i-a}}function As({rootContainerRef:t,visualizationAreaRef:n,arenaOffsetYRef:r,arenaTargetYRef:a,wheelRafRef:p,selectedModels:i,cardRefs:m,selectedCardIds:u,setSelectedCardIds:c,suppressClickRef:f}){const[d,h]=s.useState(null),k=s.useRef(!1);s.useEffect(()=>{k.current=d!=null},[d]),s.useEffect(()=>{const I=b=>{if(b.button!==0||!t.current)return;const l=b.target;if(!l)return;const j=l.closest("[data-card]"),D=l.closest('button, a, input, textarea, select, [role="button"]'),F=l.closest("[draggable]"),P=l.closest("[data-no-arena-scroll]");if(j||D||F||P||!t.current.contains(l))return;a.current=r.current,p.current!=null&&(cancelAnimationFrame(p.current),p.current=null);const E=t.current.getBoundingClientRect(),Q={x:b.clientX-E.left,y:b.clientY-E.top};b.preventDefault(),k.current=!0,f.current.card=!1,f.current.background=!1,h({origin:Q,current:Q,active:!1})};return window.addEventListener("mousedown",I,!0),()=>window.removeEventListener("mousedown",I,!0)},[r,a,p,t,n,f]),s.useEffect(()=>{if(!d||!t.current)return;const I=j=>j.preventDefault();document.addEventListener("selectstart",I);const b=j=>{const D=t.current.getBoundingClientRect(),F={x:j.clientX-D.left,y:j.clientY-D.top};h(P=>{if(!P)return P;const E=Nt(P.origin,F),Q=P.active||E.width>4||E.height>4;return{...P,current:F,active:Q}})},l=j=>{k.current=!1;const D=t.current.getBoundingClientRect(),F={x:j.clientX-D.left,y:j.clientY-D.top},P=j.target,E=!!(P&&P.closest("[data-card]"));h(Q=>{if(!Q)return null;const U=Nt(Q.origin,F);if(Q.active&&U.width>0&&U.height>0){const _=[],M=t.current.getBoundingClientRect(),K={left:M.left+U.left,right:M.left+U.right,top:M.top+U.top,bottom:M.top+U.bottom};for(const O of i){const ee=m.current.get(O.id);if(!ee)continue;const X=ee.getBoundingClientRect();!(X.right<K.left||X.left>K.right||X.bottom<K.top||X.top>K.bottom)&&_.push(O.id)}c(new Set(_)),E?f.current.card=!0:_.length>0&&(f.current.background=!0)}return null})};return window.addEventListener("mousemove",b),window.addEventListener("mouseup",l),()=>{window.removeEventListener("mousemove",b),window.removeEventListener("mouseup",l),document.removeEventListener("selectstart",I)}},[d,t,n,i,m,u,c,f]);const L=s.useMemo(()=>{if(!d||!d.active)return null;const I=Nt(d.origin,d.current);return I.width<=0||I.height<=0?null:{left:I.left,top:I.top,width:I.width,height:I.height}},[d]),A=s.useCallback(()=>{h(null),k.current=!1},[]);return{selectionRect:L,isSelecting:d!=null,dragSelectionActiveRef:k,clearSelection:A}}function _s({visualizationAreaRef:t,cardRefs:n,selected:r,setSelected:a,mode:p,gridCols:i,getCirclePosition:m}){const[u,c]=s.useState(null),f=s.useCallback((d,h)=>{if(d.button!==0||d.target.closest('button, a, input, textarea, select, [role="button"]'))return;d.preventDefault();const L=n.current.get(h);if(!L||!t.current)return;const A=L.getBoundingClientRect(),I=t.current.getBoundingClientRect(),b=A.left+A.width/2,l=A.top+A.height/2;c({activeId:h,currX:d.clientX,currY:d.clientY,offsetX:b-d.clientX,offsetY:l-d.clientY,containerLeft:I.left,containerTop:I.top,containerWidth:I.width,containerHeight:I.height,cardHeight:A.height}),d.target.setPointerCapture(d.pointerId)},[t]);return s.useEffect(()=>{if(!u)return;const d=k=>{if(c(l=>l?{...l,currX:k.clientX,currY:k.clientY}:null),!t.current)return;const L=t.current.getBoundingClientRect(),A=r.indexOf(u.activeId);let I=1/0,b=-1;if(p==="compare"){const l=k.clientX-(L.left+L.width/2),j=k.clientY-L.top,D=(se.cardWidth+se.gapX)*i-se.gapX;r.forEach((F,P)=>{const E=Math.floor(P/i),U=P%i*(se.cardWidth+se.gapX)-D/2+se.cardWidth/2,_=E*(se.cardHeight+se.gapY),M=U,K=_+se.cardHeight/2,O=(l-M)**2+(j-K)**2;O<I&&(I=O,b=P)})}else{const l=k.clientX-(L.left+L.width/2),j=k.clientY-(L.top+L.height/2),D=Math.max(se.baseRadius,se.minRadius+r.length*se.radiusPerModel);r.forEach((F,P)=>{const E=m(P,r.length,p,D),Q=(l-E.x)**2+(j-E.y)**2;Q<I&&(I=Q,b=P)})}if(b!==-1&&b!==A){const l=[...r],[j]=l.splice(A,1);l.splice(b,0,j),a(l)}},h=()=>c(null);return window.addEventListener("pointermove",d),window.addEventListener("pointerup",h),()=>{window.removeEventListener("pointermove",d),window.removeEventListener("pointerup",h)}},[u,t,n,r,a,p,i,m]),{dragState:u,handlePointerDown:f}}function zs({mode:t,showSettings:n,showDock:r,contextMenu:a,selectedCardIds:p,selected:i,inputRef:m,setShowSettings:u,setShowDock:c,setContextMenu:f,setSelected:d,setSelectedCardIds:h,clearSelection:k,setHoveredCard:L,handleModeChange:A}){s.useEffect(()=>{const I=b=>{if(b.key==="Escape"){const j=document.activeElement;if(j&&j!==document.body&&j.blur(),n){u(!1);return}if(a){f(null);return}if(p.size>0){k(),L(null);return}if(r){c(!1);return}L(null);return}if((b.metaKey||b.ctrlKey)&&(b.key==="a"||b.key==="A")){const j=b.target;if(j.tagName==="INPUT"||j.tagName==="TEXTAREA"||t==="chat")return;b.preventDefault(),i.length>0&&h(new Set(i));return}const l=b.target;if(!(l.tagName==="INPUT"||l.tagName==="TEXTAREA")){if(b.key==="ArrowRight"||b.key==="ArrowLeft"){b.preventDefault();const j=["chat","compare","analyze","debate"],D=j.indexOf(t);if(D!==-1){const F=b.key==="ArrowRight"?1:-1,P=(D+F+j.length)%j.length;A(j[P])}return}if(b.key==="m"||b.key==="M"){b.preventDefault(),c(!r);return}if((b.key==="Delete"||b.key==="Backspace")&&p.size>0){b.preventDefault(),d(j=>j.filter(D=>!p.has(D))),k();return}b.key.length===1&&!b.ctrlKey&&!b.metaKey&&!b.altKey&&m.current&&m.current.focus()}};return window.addEventListener("keydown",I),()=>window.removeEventListener("keydown",I)},[r,n,a,p,t,i,m,u,c,f,d,h,k,L,A])}function Is({visualizationAreaRef:t,dragSelectionActiveRef:n}){const r=s.useRef(0),a=s.useRef(0),p=s.useRef(null),i=s.useRef(!1),m=s.useRef(0),u=h=>{const k=t.current;k&&k.style.setProperty("--arena-offset-y",`${h}px`)},c=h=>Math.max(-200,Math.min(se.scrollClamp,h)),f=()=>{const h=r.current,k=a.current,L=k-h;if(Math.abs(L)<.5){r.current=k,u(k),p.current=null;return}const A=h+L*.35;r.current=A,u(A),p.current=requestAnimationFrame(f)},d=()=>{p.current==null&&(p.current=requestAnimationFrame(f))};return s.useEffect(()=>{const h=b=>{if(n.current)return;const l=b.target;if(l&&l.closest("input, textarea, [data-no-arena-scroll]"))return;b.preventDefault();const j=b.deltaY*.9,D=a.current-j;a.current=c(D),d()},k=b=>b?!!b.closest('input, textarea, [data-no-arena-scroll], [data-card], button, a, select, [role="button"]'):!1,L=b=>{if(b.touches.length!==1)return;const l=b.target;k(l)||(i.current=!0,m.current=b.touches[0].clientY)},A=b=>{if(n.current||!i.current||b.touches.length!==1)return;const l=b.target;if(k(l)){i.current=!1;return}const j=b.touches[0].clientY,D=j-m.current;m.current=j,b.preventDefault(),a.current=c(a.current+D),d()},I=()=>{i.current=!1};return window.addEventListener("touchstart",L,{passive:!0}),window.addEventListener("touchmove",A,{passive:!1}),window.addEventListener("touchend",I),window.addEventListener("touchcancel",I),window.addEventListener("wheel",h,{passive:!1}),()=>{window.removeEventListener("touchstart",L),window.removeEventListener("touchmove",A),window.removeEventListener("touchend",I),window.removeEventListener("touchcancel",I),window.removeEventListener("wheel",h),p.current!=null&&cancelAnimationFrame(p.current)}},[]),{arenaOffsetYRef:r,arenaTargetYRef:a,wheelRafRef:p,applyOffset:u,clampTarget:c,ensureRaf:d}}function je(t,n){return!t||!t.startsWith("#")?t:t.length===7||t.length===4?`${t}${n}`:t}const $s={idle:"Ready",responding:"Responding",done:"Done",waiting:"Waiting",error:"Error"};function Lt({state:t,color:n,size:r=16,label:a,className:p=""}){const i={width:`${r}px`,height:`${r}px`},m=a??$s[t],u=Math.max(2,Math.round(r*.14)),c=Math.max(12,r-2),f="#fbbf24",d=je(n,"cc"),h=()=>{switch(t){case"responding":return e.jsx("div",{className:"relative flex items-center justify-center",style:i,children:e.jsxs("svg",{width:c,height:c,viewBox:"0 0 24 24",fill:"none",className:"",style:{filter:`drop-shadow(0 0 6px ${je(f,"55")})`,animation:"spin 0.6s linear infinite"},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"spinnerGradient",gradientUnits:"userSpaceOnUse",x1:"3",y1:"12",x2:"12",y2:"3",children:[e.jsx("stop",{offset:"0%",stopColor:f,stopOpacity:"1"}),e.jsx("stop",{offset:"60%",stopColor:f,stopOpacity:"0.5"}),e.jsx("stop",{offset:"100%",stopColor:f,stopOpacity:"0"})]})}),e.jsx("circle",{cx:"12",cy:"12",r:"9",stroke:je(f,"15"),strokeWidth:u,fill:"none"}),e.jsx("path",{d:"M 12 3 A 9 9 0 1 1 3 12",stroke:"url(#spinnerGradient)",strokeWidth:u,strokeLinecap:"round",fill:"none"}),e.jsx("circle",{cx:"3",cy:"12",r:u*.7,fill:f})]})});case"done":return e.jsx("div",{className:"flex items-center justify-center rounded-full",style:{...i,background:je(n,"14"),border:`1px solid ${je(n,"99")}`},children:e.jsx("svg",{width:c,height:c,viewBox:"0 0 24 24",fill:"none",children:e.jsx("polyline",{points:"5 13 10 18 19 7",stroke:n,strokeWidth:u,strokeLinecap:"round",strokeLinejoin:"round"})})});case"error":const k="#ef4444";return e.jsx("div",{className:"flex items-center justify-center rounded-full",style:{...i,background:je(k,"14"),border:`1px solid ${je(k,"99")}`},children:e.jsx("svg",{width:c,height:c,viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M6 6L18 18M6 18L18 6",stroke:k,strokeWidth:u,strokeLinecap:"round",strokeLinejoin:"round"})})});case"waiting":return e.jsxs("div",{className:"relative flex items-center justify-center",style:i,children:[e.jsx("div",{className:"absolute inset-0 rounded-full",style:{border:`1px solid ${je(d,"99")}`}}),e.jsx("svg",{width:c,height:c,viewBox:"0 0 24 24",fill:"none",style:{animation:"spin 5s linear infinite"},children:e.jsx("circle",{cx:"12",cy:"12",r:"8.5",stroke:je(d,"44"),strokeWidth:u-1,strokeDasharray:"6 10",strokeLinecap:"round"})}),e.jsx("div",{className:"absolute w-2 h-2 rounded-full",style:{background:je(d,"aa"),animation:"pulse 1.5s ease-in-out infinite"}})]});default:return e.jsxs("div",{className:"relative flex items-center justify-center",style:i,children:[e.jsx("div",{className:"absolute inset-0 rounded-full",style:{border:"1px solid rgba(71, 85, 105, 0.5)"}}),e.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:"rgba(148, 163, 184, 0.6)",animation:"pulse 2.4s ease-in-out infinite"}})]})}};return e.jsx("div",{className:`inline-flex items-center justify-center ${p}`,title:m,children:h()})}function sn({times:t,isFastestTTFT:n,isFastestTotal:r}){const a=(t==null?void 0:t.startTime)!=null,p=(t==null?void 0:t.endTime)!=null,i=(t==null?void 0:t.firstTokenTime)!=null,m=a&&p?((t.endTime-t.startTime)/1e3).toFixed(2):null,u=a&&i?((t.firstTokenTime-t.startTime)/1e3).toFixed(2):null;return e.jsxs("div",{className:"text-[10px] text-slate-500 flex items-center gap-2",children:[e.jsxs("span",{className:r?"text-yellow-400/90 bg-yellow-500/10 px-1.5 py-0.5 rounded":void 0,title:r?"Fastest":void 0,children:[e.jsx("span",{className:r?void 0:"text-slate-400",children:"TIME"})," ",m?`${m}s`:a&&!p?"...":"—"]}),u&&e.jsxs("span",{className:n?"text-amber-400/90 bg-amber-500/10 px-1.5 py-0.5 rounded":"text-slate-600",title:n?"Fastest TTFT":void 0,children:["TTFT ",u,"s"]})]})}const _t=({text:t,speed:n=5})=>{const[r,a]=s.useState(""),p=s.useRef(0),i=s.useRef(null);return s.useEffect(()=>{!t.startsWith(r)&&r!==""&&(a(""),p.current=0)},[t]),s.useEffect(()=>{i.current!=null&&(clearTimeout(i.current),i.current=null);const m=t.length;if(p.current>=m)return;const u=()=>{const c=p.current,f=m-c;if(f<=0)return;const d=f>120?12:f>40?4:f>10?2:1,h=Math.min(m,c+d);p.current=h,a(t.slice(0,h));const L=m-h>5?0:n;i.current=window.setTimeout(u,L)};return i.current=window.setTimeout(u,n),()=>{i.current!=null&&(clearTimeout(i.current),i.current=null)}},[t,n]),e.jsx("span",{children:r})},dt=96;function Bs(t){switch(t){case"error":return"Error";case"responding":return"Responding";case"done":return"Done";case"waiting":return"Waiting";default:return"Ready"}}function Ds({mode:t,layoutRadius:n,moderatorModel:r,moderatorId:a,orchestratorTransform:p,orchestratorStatus:i,moderatorSynthesis:m,isSynthesizing:u,isGenerating:c,phaseLabel:f,speaking:d,hoveredCard:h,setHoveredCard:k,setSelectedCardIds:L,lastSelectedCardRef:A,orchestratorAutoMode:I,orchestratorAutoScope:b,showOrchestratorMenu:l,setShowOrchestratorMenu:j,setOrchestratorAutoMode:D,setOrchestratorAutoScope:F,orchestratorMenuRef:P,availableModels:E,setModerator:Q,getTailSnippet:U}){const[_,M]=s.useState(null),K=Bs(i),O=f||"";s.useEffect(()=>{if(!l)return;const y=ce=>{P.current&&!P.current.contains(ce.target)&&(j(!1),M(null))};return document.addEventListener("mousedown",y,!0),()=>document.removeEventListener("mousedown",y,!0)},[l,P,j]);const ee=()=>{if(m)return u&&a&&d.has(a)?e.jsx(_t,{text:m,speed:20}):U(m);if(u)return e.jsx("span",{className:"text-slate-500 italic",children:"Synthesizing responses..."});if(c){if(f!=null&&f.startsWith("<svg"))return e.jsx("span",{className:"text-slate-500 italic",dangerouslySetInnerHTML:{__html:f}});const y=f==="Stage 1 · Responses"?"Waiting for model responses...":f||"Orchestrating...";return e.jsx("span",{className:"text-slate-500 italic",children:y})}return e.jsx("span",{className:"text-slate-500 italic",children:"Send a prompt to see the synthesis."})},X=i==="responding",H=X?"#fbbf24":r.color;return e.jsxs("div",{"data-card":!0,className:"absolute z-20 transition-all duration-700 ease-out cursor-pointer",style:{opacity:1,transform:p,left:"50%",top:t==="analyze"?`calc(50% + ${n}px - 64px)`:"50%"},onClick:y=>{y.stopPropagation(),a&&(L(new Set([a])),A.current=a)},onContextMenu:y=>{y.preventDefault(),y.stopPropagation(),l?(j(!1),M(null)):(M({x:y.clientX,y:y.clientY}),j(!0))},onMouseEnter:()=>k("moderator"),onMouseLeave:()=>k(null),children:[e.jsxs("div",{className:"relative flex items-center justify-center",style:{width:`${dt}px`,height:`${dt}px`},children:[e.jsx("div",{className:"absolute inset-0 rounded-full animate-pulse",style:{background:`radial-gradient(circle, ${H}20 0%, transparent 70%)`,transform:"scale(2.2)",filter:"blur(18px)"}}),e.jsxs("div",{className:"relative rounded-full flex items-center justify-center transition-all duration-300",style:{width:`${dt}px`,height:`${dt}px`,background:X?"linear-gradient(135deg, rgba(251, 191, 36, 0.08), rgba(15, 23, 42, 0.9))":"rgba(15, 23, 42, 0.9)",backdropFilter:"blur(16px)",border:`2px solid ${H}${X?"99":"60"}`,boxShadow:`0 0 36px ${H}${X?"40":"28"}, inset 0 1px 1px rgba(255,255,255,0.1)`},children:[e.jsx("div",{className:"absolute inset-[-4px] rounded-full",style:{background:`conic-gradient(from 0deg, transparent, ${H}60, transparent)`,animation:"spin 4s linear infinite"}}),e.jsx("div",{className:"absolute inset-[2px] rounded-full",style:{background:"rgba(15, 23, 42, 0.96)"}}),e.jsxs("div",{className:"relative text-center z-10 flex flex-col items-center gap-1.5 px-3",children:[e.jsx("div",{className:"text-[7px] tracking-[0.32em] text-slate-400 uppercase",children:K}),e.jsx("div",{className:"text-[10px] font-semibold text-slate-100 leading-tight",children:r.name}),e.jsx(Lt,{state:i,color:H,size:12})]})]})]}),e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 flex flex-col items-center gap-1 w-max max-w-[200px]",style:{top:"calc(100% + 12px)"},children:e.jsx("span",{className:"text-[10px] text-slate-500",children:O})}),h==="moderator"&&!l&&e.jsxs("div",{"data-card":!0,onClick:y=>y.stopPropagation(),className:"absolute bottom-full mb-4 left-1/2 -translate-x-1/2 w-80 max-w-[calc(100vw-2rem)] p-4 rounded-xl z-[200] transition-all duration-300",style:{background:"rgba(15, 23, 42, 0.95)",backdropFilter:"blur(16px)",border:`1px solid ${H}40`,boxShadow:`0 20px 40px rgba(0,0,0,0.5), 0 0 30px ${H}20`},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"Orchestrator"}),e.jsx("span",{className:"text-xs text-slate-500",children:"·"}),e.jsx("span",{className:"text-xs font-medium text-slate-300",children:r.name}),X&&e.jsx("span",{className:"text-[9px] uppercase tracking-wider px-1.5 py-0.5 rounded bg-yellow-500/20 text-yellow-300 border border-yellow-500/30",children:"Working"})]}),e.jsx("p",{className:"text-sm text-slate-300 leading-relaxed",children:ee()})]}),l&&_&&Vn.createPortal(e.jsx("div",{ref:P,className:"w-64 bg-slate-800 border border-slate-700 rounded-lg shadow-xl overflow-hidden",style:{position:"fixed",top:`${_.y}px`,left:`${_.x}px`,transform:"translateY(-50%)",zIndex:9999},onClick:y=>y.stopPropagation(),children:I?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-3 py-2 text-[10px] uppercase tracking-wider text-slate-500 font-semibold border-b border-slate-700/50",children:["Auto Mode: ",b==="self-hosted"?"SELF-HOSTED":b.toUpperCase()]}),["all","self-hosted","api"].map(y=>e.jsxs("button",{onClick:()=>{F(y),j(!1)},className:`w-full px-3 py-2 text-left text-xs font-medium transition-colors ${b===y?"bg-yellow-500/20 text-yellow-300":"text-slate-300 hover:bg-slate-700/50"}`,children:[y==="all"&&"All",y==="self-hosted"&&"Self-hosted",y==="api"&&"API",e.jsxs("span",{className:"text-[10px] text-slate-500 ml-1",children:[y==="all"&&"(self-hosted → API)",y==="self-hosted"&&"(no quota)",y==="api"&&"(cloud only)"]})]},y)),e.jsx("div",{className:"border-t border-slate-700",children:e.jsx("button",{onClick:()=>{D(!1),j(!1)},className:"w-full px-3 py-2 text-left text-xs font-medium text-slate-400 hover:bg-slate-700/50 transition-colors",children:"Manual Mode"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-3 py-2 text-[10px] uppercase tracking-wider text-slate-500 font-semibold border-b border-slate-700/50",children:"Select Orchestrator"}),E.filter(y=>y.type==="github"||y.type==="external").length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-3 py-1.5 text-[9px] uppercase tracking-wider text-slate-600 font-semibold",children:"GitHub Models"}),E.filter(y=>y.type==="github"||y.type==="external").map(y=>e.jsx("button",{onClick:()=>{Q(y.id),j(!1)},className:`w-full px-4 py-2 text-left text-xs font-medium transition-colors ${a===y.id?"bg-blue-500/20 text-blue-300":"text-slate-300 hover:bg-slate-700/50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:y.name}),a===y.id&&e.jsx("span",{className:"text-blue-400",children:"✓"})]})},y.id))]}),E.filter(y=>y.type==="self-hosted").length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-3 py-1.5 text-[9px] uppercase tracking-wider text-slate-600 font-semibold border-t border-slate-700/50 mt-1",children:"Self-Hosted Models"}),E.filter(y=>y.type==="self-hosted").map(y=>e.jsx("button",{onClick:()=>{Q(y.id),j(!1)},className:`w-full px-4 py-2 text-left text-xs font-medium transition-colors ${a===y.id?"bg-blue-500/20 text-blue-300":"text-slate-300 hover:bg-slate-700/50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:y.name}),a===y.id&&e.jsx("span",{className:"text-blue-400",children:"✓"})]})},y.id))]}),e.jsx("div",{className:"border-t border-slate-700",children:e.jsxs("button",{onClick:()=>{D(!0),j(!1)},className:"w-full px-3 py-2 text-left text-xs font-medium text-yellow-400 hover:bg-slate-700/50 transition-colors flex items-center gap-2",children:[e.jsx(Qn,{size:12}),e.jsx("span",{children:"Enable Auto Mode"})]})})]})}),document.body)]})}const ft=256,an=200,rn=96;function Ps(t){const{mode:n,selectedModels:r,gridCols:a,speaking:p,selectedCardIds:i,setSelectedCardIds:m,executionTimes:u,failedModels:c,cardRefs:f,handlePointerDown:d,dragState:h,setContextMenu:k,suppressClickRef:L,getTailSnippet:A,hoveredCard:I,setHoveredCard:b,layoutRadius:l,getCirclePosition:j,moderatorModel:D,moderatorId:F,orchestratorTransform:P,orchestratorStatus:E,moderatorSynthesis:Q,isSynthesizing:U,isGenerating:_,phaseLabel:M,linesTransitioning:K,lastSelectedCardRef:O,orchestratorAutoMode:ee,orchestratorAutoScope:X,showOrchestratorMenu:H,setShowOrchestratorMenu:y,setOrchestratorAutoMode:ce,setOrchestratorAutoScope:xe,orchestratorMenuRef:pe,availableModels:oe,setModerator:V,fastestTTFT:le,fastestTotal:ae}=t,ne=n!=="compare",Ie=n==="analyze"?l-64:0;return e.jsxs(e.Fragment,{children:[r.map(($,we)=>{var Ze;const Z=j(we,r.length,n,l),ge=Os(we,a),re=p.has($.id),de=i.has($.id),he=c.has($.id),be=!re&&!he&&!!((Ze=u[$.id])!=null&&Ze.endTime)&&$.response.trim().length>0,ke=Us(re,be,he,!re&&!be&&!he&&_&&n==="debate"),Re=Gs(ke),B="#fbbf24",S="#ef4444",w=$.type==="self-hosted"?"#10b981":"#3b82f6",v=he?S:w,T=re&&!he,C=Ks({hasError:he,isProcessing:T,isSelected:de,errorColor:S,processingColor:B,typeColor:w}),te=Hs({mode:n,gridX:ge.gridX,gridY:ge.gridY,circleX:Z.x,circleY:Z.y,dragState:h,modelId:$.id}),q=I===$.id,W=ne?rn:ft,J=ne?rn:an,Se=Math.max(800,l*2+600),me=Se/2,ye=me,Qe=me,Je=me+(0-Z.x),$e=me+(Ie-Z.y);return e.jsxs("div",{ref:ue=>{ue?f.current.set($.id,ue):f.current.delete($.id)},onPointerDown:ue=>d(ue,$.id),className:"absolute",onContextMenu:ue=>{ue.preventDefault(),ue.stopPropagation(),k({x:ue.clientX,y:ue.clientY,modelId:$.id})},style:{transform:te,zIndex:ne?q?300:de?40:re?15:5:de?20:re?10:1,left:"50%",top:ne?"50%":"0",transition:(h==null?void 0:h.activeId)===$.id?"none":"transform 300ms cubic-bezier(0.2, 0, 0.2, 1)"},children:[ne&&re&&!he&&!K&&e.jsxs("svg",{className:"absolute pointer-events-none",style:{width:`${Se}px`,height:`${Se}px`,top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:-1},viewBox:`0 0 ${Se} ${Se}`,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:`grad-${$.id}`,gradientUnits:"userSpaceOnUse",x1:ye,y1:Qe,x2:Je,y2:$e,children:[e.jsx("stop",{offset:"0%",stopColor:B,stopOpacity:"0.45"}),e.jsx("stop",{offset:"100%",stopColor:B,stopOpacity:"0.12"})]})}),e.jsx("line",{x1:ye,y1:Qe,x2:Je,y2:$e,stroke:`url(#grad-${$.id})`,strokeWidth:"2",strokeDasharray:"6,4",strokeLinecap:"round",className:"animate-flow arena-link"})]}),e.jsxs("div",{"data-card":!0,onClick:ue=>Ws({e:ue,modelId:$.id,suppressClickRef:L,setSelectedCardIds:m,selectedModels:r,lastSelectedCardRef:O}),onMouseEnter:()=>ne&&b($.id),onMouseLeave:()=>ne&&b(null),className:`relative cursor-grab active:cursor-grabbing card-hover ${ne?"rounded-full":""} ${de?"card-selected":""} ${re?"card-speaking":""}`,style:{background:C.background,backdropFilter:ne?void 0:"blur(8px)",WebkitBackdropFilter:ne?void 0:"blur(8px)",border:C.border,boxShadow:C.shadow,transform:de||T?"scale(1.05)":"scale(1)",width:`${W}px`,height:`${J}px`,borderRadius:ne?"50%":"12px",transition:"transform 180ms ease-out, box-shadow 180ms ease-out, border-color 180ms ease-out, width 0.7s cubic-bezier(0.4, 0, 0.2, 1), height 0.7s cubic-bezier(0.4, 0, 0.2, 1), border-radius 0.7s cubic-bezier(0.4, 0, 0.2, 1)"},children:[!ne&&e.jsxs("div",{style:Xs,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3 gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5 min-w-0",children:[e.jsx(Lt,{state:ke,color:v,size:16,label:Re}),e.jsx("span",{className:"text-xs font-semibold text-slate-200 truncate",children:$.name})]}),e.jsx("div",{className:"flex items-center gap-1.5 shrink-0",children:e.jsx("span",{className:`text-[9px] uppercase tracking-wider px-1.5 py-0.5 rounded ${$.type==="self-hosted"?"bg-emerald-500/10 text-emerald-300 border border-emerald-500/30":"bg-blue-500/10 text-blue-300 border border-blue-500/30"}`,children:$.type==="self-hosted"?"Self-hosted":"API"})})]}),e.jsx("p",{className:"text-xs text-slate-400 leading-relaxed line-clamp-3 flex-1",children:Ys({model:$,isSpeaking:re,thinkingFallback:e.jsx("span",{className:"text-slate-500 italic",children:"Thinking…"}),getTailSnippet:A})}),e.jsx("div",{className:"flex items-center gap-4 mt-3 pt-3 border-t border-slate-700/50",children:e.jsx(sn,{times:u[$.id],isFastestTTFT:le===$.id,isFastestTotal:ae===$.id})})]}),ne&&e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center text-center",style:{transition:"opacity 0.3s ease-out"},children:[e.jsx("div",{className:"absolute inset-[3px] rounded-full border border-white/5",style:{boxShadow:`inset 0 0 20px ${v}15`}}),e.jsx("div",{className:"absolute inset-[-6px] rounded-full opacity-60",style:{background:`radial-gradient(circle, ${v}22 0%, transparent 65%)`,filter:"blur(10px)"}}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center gap-1.5 px-3",children:[e.jsx("div",{className:"text-[7px] tracking-[0.32em] text-slate-400 uppercase",children:Re}),e.jsx("div",{className:"text-[10px] font-semibold text-slate-100 leading-tight",children:$.name}),e.jsx(Lt,{state:ke,color:v,size:12})]})]})]}),n==="analyze"&&ne&&$.personaEmoji&&e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 flex items-center justify-center pointer-events-none select-none",style:{bottom:"-12px",fontSize:"20px",zIndex:100,transition:"transform 180ms ease-out",transform:re?"scale(1.15)":"scale(1)",filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.5)) drop-shadow(0 0 8px rgba(0,0,0,0.3))"},title:$.personaName?`${$.personaName} - ${$.personaTrait}`:"Persona",children:$.personaEmoji}),ne&&re&&$.thinking&&$.thinking.trim().length>0&&$.response.trim().length===0&&e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 flex items-center justify-center pointer-events-none select-none animate-pulse",style:{bottom:"-12px",fontSize:"18px",zIndex:100,filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.5)) drop-shadow(0 0 10px rgba(168, 85, 247, 0.4))"},title:"Thinking...",children:"💭"}),ne&&I===$.id&&e.jsxs("div",{"data-card":!0,onClick:ue=>ue.stopPropagation(),className:"absolute w-64 max-w-[calc(100vw-2rem)] p-4 rounded-xl transition-all duration-300 z-[220]",style:{top:Z.y>0?"auto":"100%",bottom:Z.y>0?"100%":"auto",left:"50%",transform:"translateX(-50%)",marginTop:Z.y>0?0:"12px",marginBottom:Z.y>0?"12px":0,background:"rgba(15, 23, 42, 0.95)",backdropFilter:"blur(16px)",border:`1px solid ${v}40`,boxShadow:`0 20px 40px rgba(0,0,0,0.5), 0 0 20px ${v}15`},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:v}}),e.jsx("span",{className:"text-xs font-semibold text-slate-300",children:$.name})]}),n==="analyze"&&$.personaEmoji&&$.personaName&&e.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-2 border-b border-slate-700/50",children:[e.jsx("span",{className:"text-base",children:$.personaEmoji}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs font-semibold text-blue-400",children:$.personaName}),$.personaTrait&&e.jsx("div",{className:"text-[10px] text-slate-500",children:$.personaTrait})]})]}),e.jsx("p",{className:"text-xs text-slate-400 leading-relaxed whitespace-pre-wrap",children:Fs({model:$,isSpeaking:re,getTailSnippet:A})}),e.jsx("div",{className:"flex items-center gap-4 mt-3 pt-2 border-t border-slate-700/50",children:e.jsx(sn,{times:u[$.id]})})]})]},$.id)}),n!=="compare"&&D&&e.jsx(Ds,{mode:n,layoutRadius:l,moderatorModel:D,moderatorId:F,orchestratorTransform:P,orchestratorStatus:E,moderatorSynthesis:Q,isSynthesizing:U,isGenerating:_,phaseLabel:M,speaking:p,hoveredCard:I,setHoveredCard:b,setSelectedCardIds:m,lastSelectedCardRef:O,orchestratorAutoMode:ee,orchestratorAutoScope:X,showOrchestratorMenu:H,setShowOrchestratorMenu:y,setOrchestratorAutoMode:ce,setOrchestratorAutoScope:xe,orchestratorMenuRef:pe,availableModels:oe,setModerator:V,getTailSnippet:A}),n!=="compare"&&e.jsxs("svg",{className:"absolute pointer-events-none transition-opacity duration-700",style:{width:"1000px",height:"1000px",opacity:.2},children:[e.jsx("circle",{cx:"500",cy:"500",r:l,fill:"none",stroke:"url(#circleGrad)",strokeWidth:"1",strokeDasharray:"8,4"}),e.jsx("defs",{children:e.jsxs("linearGradient",{id:"circleGrad",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#3b82f6"}),e.jsx("stop",{offset:"50%",stopColor:"#8b5cf6"}),e.jsx("stop",{offset:"100%",stopColor:"#3b82f6"})]})})]})]})}function Os(t,n){const r=Math.floor(t/n),a=t%n,p=(ft+se.gapX)*n-se.gapX,i=r*(an+se.gapY);return{gridX:a*(ft+se.gapX)-p/2+ft/2,gridY:i}}function Hs({mode:t,gridX:n,gridY:r,circleX:a,circleY:p,dragState:i,modelId:m}){if((i==null?void 0:i.activeId)===m){const u=i.currX+i.offsetX,c=i.currY+i.offsetY;if(t==="compare"){const h=u-(i.containerLeft+i.containerWidth/2),k=c-i.containerTop-i.cardHeight/2;return`translate(calc(-50% + ${h}px), ${k}px)`}const f=u-(i.containerLeft+i.containerWidth/2),d=c-(i.containerTop+i.containerHeight/2);return`translate(calc(-50% + ${f}px), calc(-50% + ${d}px))`}return t==="compare"?`translate(calc(-50% + ${n}px), ${r}px)`:`translate(calc(-50% + ${a}px), calc(-50% + ${p}px))`}function Ws({e:t,modelId:n,suppressClickRef:r,setSelectedCardIds:a,selectedModels:p,lastSelectedCardRef:i}){if(t.stopPropagation(),r.current.card){r.current.card=!1;return}const m=t.shiftKey,u=t.metaKey||t.ctrlKey;if(m&&i.current){const c=p.findIndex(d=>d.id===i.current),f=p.findIndex(d=>d.id===n);if(c!==-1&&f!==-1){const d=Math.min(c,f),h=Math.max(c,f),k=p.slice(d,h+1).map(L=>L.id);a(L=>{const A=new Set(L);return k.forEach(I=>A.add(I)),A})}}else u?(a(c=>{const f=new Set(c);return f.has(n)?f.delete(n):f.add(n),f}),i.current=n):(a(new Set([n])),i.current=n)}function Ys({model:t,isSpeaking:n,thinkingFallback:r,getTailSnippet:a}){return t.statusMessage?ze(t.statusMessage)??t.statusMessage:n?t.response.trim().length>0?ze(t.response)??e.jsx(_t,{text:t.response,speed:20}):t.thinking&&t.thinking.trim().length>0?e.jsxs("span",{children:[e.jsx("span",{className:"text-slate-500 italic",children:"Thinking… "}),a(t.thinking.trim(),220)]}):r:ze(t.response)??t.response}function Fs({model:t,isSpeaking:n,getTailSnippet:r,maxChars:a=220}){return t.statusMessage?ze(t.statusMessage)??t.statusMessage:n?t.thinking&&t.thinking.trim().length>0?e.jsxs("span",{children:[e.jsx("span",{className:"text-purple-400/80 text-[10px] uppercase tracking-wider font-medium",children:"Thinking "}),e.jsx("span",{className:"text-slate-400",children:r(t.thinking.trim(),260)})]}):t.response.trim().length>0?ze(t.response)??e.jsx(_t,{text:t.response,speed:20}):e.jsx("span",{className:"text-slate-500 italic",children:"Thinking…"}):t.thinking&&t.thinking.trim().length>0?e.jsxs("span",{children:[e.jsx("span",{className:"text-purple-400/80 text-[10px] uppercase tracking-wider font-medium",children:"Reasoning "}),e.jsx("span",{className:"text-slate-400",children:r(t.thinking.trim(),260)})]}):t.response?ze(t.response)??r(t.response,a):e.jsx("span",{className:"text-slate-500 italic",children:"No response yet."})}const Xs={padding:"16px",height:"100%",display:"flex",flexDirection:"column",isolation:"isolate",WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",textRendering:"optimizeLegibility",opacity:1,transition:"opacity 0.3s ease-out"};function Gs(t){switch(t){case"error":return"Error";case"responding":return"Responding";case"done":return"Done";case"waiting":return"Waiting";default:return"Ready"}}function Us(t,n,r,a){return r?"error":t?"responding":n?"done":a?"waiting":"idle"}function ze(t){return t.startsWith("<svg")?e.jsx("span",{dangerouslySetInnerHTML:{__html:t}}):null}function Ks({hasError:t,isProcessing:n,isSelected:r,errorColor:a,processingColor:p,typeColor:i}){const m="rgba(30, 41, 59, 0.85)";return t?{background:`linear-gradient(135deg, ${a}14, ${m})`,border:`1px solid ${a}99`,shadow:`0 0 24px ${a}33, inset 0 1px 1px rgba(255,255,255,0.1)`}:n?{background:`linear-gradient(135deg, ${p}14, ${m})`,border:`1px solid ${p}99`,shadow:`0 0 24px ${p}33, inset 0 1px 1px rgba(255,255,255,0.1)`}:r?{background:m,border:`1px solid ${i}d0`,shadow:`0 0 20px ${i}30, inset 0 1px 1px rgba(255,255,255,0.1)`}:{background:m,border:"1px solid rgba(71, 85, 105, 0.5)",shadow:"0 4px 20px rgba(0,0,0,0.3), inset 0 1px 1px rgba(255,255,255,0.05)"}}function qs({rect:t}){return t?e.jsx("div",{className:"absolute pointer-events-none z-30",style:{left:t.left,top:t.top,width:t.width,height:t.height,border:"2px solid rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)"}}):null}const zt=s.createContext(null);function Vs({children:t}){const[n,r]=s.useState(!1),[a,p]=s.useState("chat"),i=s.useRef({}),m=s.useCallback(L=>{i.current=L},[]),[u,c]=s.useState({gesture:null,progress:0,triggered:!1}),[f,d]=s.useState(void 0),[h,k]=s.useState(null);return e.jsx(zt.Provider,{value:{isActive:n,setIsActive:r,appContext:a,setAppContext:p,callbacks:i,setCallbacks:m,gestureState:u,setGestureState:c,performanceMetrics:f,setPerformanceMetrics:d,cameraError:h,setCameraError:k},children:t})}function Qs(){const t=s.useContext(zt);if(!t)throw new Error("useGesture must be used within GestureProvider");return t}function mr(){return s.useContext(zt)}class Js extends s.Component{constructor(r){super(r);Jt(this,"handleRetry",()=>{var r,a;this.setState({hasError:!1,error:null}),(a=(r=this.props).onRetry)==null||a.call(r)});this.state={hasError:!1,error:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,a){console.error("ErrorBoundary caught an error:",r,a)}render(){var r;return this.state.hasError?this.props.fallback?this.props.fallback:e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-white/70 gap-4 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-amber-400",children:[e.jsx(Jn,{size:20}),e.jsx("span",{className:"text-sm font-medium",children:"Something went wrong"})]}),e.jsx("p",{className:"text-xs text-white/40 text-center max-w-xs",children:((r=this.state.error)==null?void 0:r.message)||"Failed to load component"}),e.jsxs("button",{onClick:this.handleRetry,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white/80 bg-slate-700/50 hover:bg-slate-600/50 rounded-lg transition-all active:scale-95 border border-slate-600/50",children:[e.jsx(Zn,{size:14}),"Try Again"]})]}):this.props.children}}const Zs=s.lazy(()=>Ve(()=>import("./SettingsModal-BCbQxjpE.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),er=s.lazy(()=>Ve(()=>import("./DiscussionTranscript-CASXh_32.js"),__vite__mapDeps([7,1,2,3,4,5,6,8]))),tr=s.lazy(()=>Ve(()=>import("./GestureControl-C1_yFZrh.js"),__vite__mapDeps([9,1,2,3,4,5,6]))),nr=s.lazy(()=>Ve(()=>import("./HandBackground-F7iiHyIM.js"),__vite__mapDeps([10,1,2,3,4,5,6,11]))),sr=s.lazy(()=>Ve(()=>import("./ChatView-uSdCs5Jp.js"),__vite__mapDeps([12,1,2,3,4,5,6,8])).then(t=>({default:t.default}))),rr='button, input, textarea, select, a, [role="button"], [data-no-background], [data-card]';function or(){const t=Qs();Ms();const{modelsData:n,setModelsData:r,selected:a,setSelected:p,chatModelId:i,setChatModelId:m,moderator:u,setModerator:c,availableModels:f,totalModelsByType:d,allSelectedByType:h,modelIdToName:k,isLoading:L,loadError:A,retryCount:I,retryNow:b}=ys(),[l,j]=_e("playground_mode","chat",{serialize:o=>o,deserialize:(o,x)=>["chat","compare","analyze","debate"].includes(o)?o:x}),[D,F]=s.useState(!1),P=s.useRef(null),[E,Q]=s.useState(null),[U,_]=s.useState(!1),[M,K]=s.useState(!1),[O,ee]=s.useState(2),[X,H]=s.useState(!1),[y,ce]=_e("github_models_token","",{serialize:o=>o||null,deserialize:(o,x)=>o??x}),[xe,pe]=_e("openrouter_api_key","",{serialize:o=>o||null,deserialize:(o,x)=>o??x}),[oe,V]=s.useState({}),le=s.useRef(null),ae=s.useRef(null),[ne,Ie]=s.useState(""),[$,we]=s.useState(null),Z=s.useRef(null),ge=s.useCallback(o=>{Z.current&&clearTimeout(Z.current),we(o),Z.current=window.setTimeout(()=>{we(null),Z.current=null},5e3)},[]),re=s.useCallback(o=>{if(l==="chat"||y)return!0;const x=n.find(g=>g.id===o);return!x||x.type!=="github"&&x.type!=="external"},[l,y,n]),de=s.useCallback(()=>!!(l==="chat"||y),[l,y]),[he,be]=s.useState([]),[Ne,ke]=s.useState(()=>new Set(["lfm2.5-1.2b-instruct"])),[Re,B]=s.useState(!1),S=s.useRef(!1),w=s.useCallback(o=>{ke(x=>{const g=new Set(x);return g.has(o)?g.delete(o):g.add(o),g})},[]),v=s.useCallback(o=>{const x=n.filter(g=>g.type===o).map(g=>g.id);ke(g=>{const N=x.every(z=>g.has(z)),R=new Set(g);return N?x.forEach(z=>R.delete(z)):x.forEach(z=>R.add(z)),R})},[n]),{history:T,historyRef:C,pushHistoryEntries:te,clearHistory:q,historyToText:W,buildCarryoverHistory:J}=Cs(),Se=(o,x)=>{const g=new Set,N=x.filter(Boolean).filter((z,G,Y)=>Y.indexOf(z)===G),R=[];return N.forEach(z=>{const G=o[z];G&&G.trim()&&(R.push({id:z,text:G.trim()}),g.add(z))}),Object.entries(o).forEach(([z,G])=>{g.has(z)||!G||!G.trim()||R.push({id:z,text:G.trim()})}),R.length?R.map(({id:z,text:G})=>`${k(z)}:
${G}`).join(`

`):null};s.useEffect(()=>{S.current=t.isActive},[t.isActive]);const me=a.map(o=>n.find(x=>x.id===o)).filter(o=>!!o&&(l==="compare"||o.id!==u)),ye=s.useMemo(()=>l!=="compare"?me:[...me].sort((o,x)=>{var R,z;const g=(R=oe[o.id])==null?void 0:R.firstTokenTime,N=(z=oe[x.id])==null?void 0:z.firstTokenTime;return g===void 0&&N===void 0?0:g===void 0?1:N===void 0?-1:g-N}),[l,me,oe]),{fastestTTFT:Qe,fastestTotal:Je}=s.useMemo(()=>{if(l!=="compare")return{fastestTTFT:null,fastestTotal:null};let o=null,x=1/0,g=null,N=1/0,R=0,z=0;for(const G of me){const Y=oe[G.id];if(Y){if(Y.firstTokenTime!==void 0){R++;const ie=Y.firstTokenTime-Y.startTime;ie<x&&(x=ie,o=G.id)}if(Y.endTime!==void 0){z++;const ie=Y.endTime-Y.startTime;ie<N&&(N=ie,g=G.id)}}}return{fastestTTFT:R>=2?o:null,fastestTotal:z>=2?g:null}},[l,me,oe]),$e=(o,x,g,N)=>{if(g==="analyze"){const lt=250+o*220/(x-1)-90,ct=lt*Math.PI/180;return{x:Math.cos(ct)*N,y:Math.sin(ct)*N,angle:lt}}const R=o*360/x-90,z=Math.cos(R*Math.PI/180)*N,G=Math.sin(R*Math.PI/180)*N;return{x:z,y:G,angle:R}},Ze=(o,x)=>{Q(x),o.dataTransfer.effectAllowed="move"},ue=o=>{o.preventDefault(),_(!0)},ln=()=>{_(!1)},cn=o=>{if(o.preventDefault(),_(!1),E){if(l==="chat")m(E);else if(!a.includes(E)){if(!re(E)){ge("Add your GitHub token in Settings for API model access with dedicated quota"),Q(null);return}p(x=>[...x,E])}Q(null)}},pt=o=>{if(l==="chat"){m(i===o?null:o);return}if(a.includes(o))if(Te&&mt.current.includes(o)&&ne){ae.current&&ae.current.abort();const g=mt.current.filter(R=>R!==o),N={};if(n.forEach(R=>{g.includes(R.id)&&R.response&&!R.error&&(N[R.id]=R.response)}),p(R=>R.filter(z=>z!==o)),Pe.has(o)&&Oe(R=>{const z=new Set(R);return z.delete(o),z}),(l==="analyze"||l==="debate")&&g.length<2){Ce(!1),Ye(!1),Xe("This mode requires at least 2 participants."),Ue("Error");return}Tt(ne,N,g,{skipHistory:!0})}else p(g=>g.filter(N=>N!==o));else{if(!re(o)){ge("Add your GitHub token in Settings for API model access with dedicated quota");return}p(x=>[...x,o])}},un=o=>{const x=n.filter(R=>R.type===o).map(R=>R.id);if(x.length>0&&x.every(R=>a.includes(R))){p(R=>R.filter(z=>!x.includes(z)));return}if((o==="github"||o==="external")&&!de()){ge("Add your GitHub token in Settings for API model access with dedicated quota");return}const N=f.filter(R=>R.type===o).map(R=>R.id);N.length>0&&p(R=>[...R,...N])},[dn,Be]=s.useState(null),[De,et]=s.useState(new Set),[fn,pn]=s.useState(!1),[Pe,Oe]=s.useState(new Set),tt=()=>Oe(new Set),[nt,hn]=s.useState(null),ht=s.useMemo(()=>{if(l==="compare")return 0;const o=Math.max(se.baseRadius,se.minRadius+ye.length*se.radiusPerModel);if(!nt)return o;const g=Math.min(nt.width,nt.height)/2-140;return Math.max(o,g)},[l,ye.length,nt]);s.useEffect(()=>{const o=()=>{if(!fe.current)return;const{clientWidth:g,clientHeight:N}=fe.current;let R=Math.floor(g/(se.cardWidth+se.gapX));R=Math.max(1,R),ee(R),hn({width:g,height:N})},x=new ResizeObserver(g=>{for(let N of g)N.target===fe.current&&o()});return fe.current&&(x.observe(fe.current),o()),()=>{fe.current&&x.unobserve(fe.current)}},[l]);const He=s.useRef(null),fe=s.useRef(null),Ee=s.useRef(null),It=s.useRef(null),st=s.useRef(new Map),mn=s.useRef(null),We=s.useRef({card:!1,background:!1}),xn=s.useRef({}),mt=s.useRef([]),{enqueueStreamDelta:gn,clearPendingStreamForModel:bn,resetPendingStream:xt}=Ns(r),$t=s.useRef(!1),{arenaOffsetYRef:Bt,arenaTargetYRef:gt,wheelRafRef:yn,clampTarget:vn,ensureRaf:wn}=Is({visualizationAreaRef:fe,dragSelectionActiveRef:$t}),{selectionRect:kn,isSelecting:bt,dragSelectionActiveRef:jn}=As({rootContainerRef:It,visualizationAreaRef:fe,arenaOffsetYRef:Bt,arenaTargetYRef:gt,wheelRafRef:yn,selectedModels:ye,cardRefs:st,selectedCardIds:Pe,setSelectedCardIds:Oe,suppressClickRef:We});$t.current=jn.current;const{dragState:Sn,handlePointerDown:Tn}=_s({visualizationAreaRef:fe,cardRefs:st,selected:a,setSelected:p,mode:l,gridCols:O,getCirclePosition:$e});s.useEffect(()=>()=>xt(),[xt]);const[ve,Me]=s.useState(null);s.useEffect(()=>{const o="arena-selecting",x=document.body;return bt?x.classList.add(o):x.classList.remove(o),()=>{x.classList.remove(o)}},[bt]);const rt=s.useCallback(o=>o?!o.closest(rr):!1,[]),En=s.useCallback(o=>{if(rt(o.target)){if(We.current.background){We.current.background=!1;return}Be(null),tt(),We.current.background=!1}},[rt,tt]),Mn=s.useCallback(o=>{rt(o.target)&&(o.preventDefault(),Me({x:o.clientX,y:o.clientY,type:"background"}))},[rt]),Dt=s.useCallback(()=>{F(!0),P.current&&clearTimeout(P.current),P.current=window.setTimeout(()=>{F(!1),P.current=null},350)},[]),Pt=s.useRef(l),ot=s.useCallback(o=>{if(o===l)return;Dt();const x=["compare","analyze","debate"];x.includes(l)&&x.includes(o)||Ce(!1),j(o)},[l,Dt]);s.useEffect(()=>()=>{Z.current&&clearTimeout(Z.current)},[]),s.useEffect(()=>()=>{P.current&&clearTimeout(P.current)},[]),s.useEffect(()=>{const o=()=>Me(null);return window.addEventListener("click",o),()=>window.removeEventListener("click",o)},[]);const[Te,Ce]=s.useState(!1),[at,Ye]=s.useState(!1),[Fe,Xe]=s.useState(""),Cn=s.useCallback(()=>{q(),Ce(!1),Ye(!1),Xe(""),Ue(null),kt({}),r(o=>o.map(x=>({...x,response:"",thinking:void 0,error:void 0}))),V({}),et(new Set)},[q,r]),[Nn,Rn]=s.useState(!0),[Ln,An]=s.useState("api"),[yt,vt]=s.useState(!1),wt=s.useRef(null);s.useEffect(()=>{const o=g=>{wt.current&&!wt.current.contains(g.target)&&vt(!1)},x=g=>{g.key==="Escape"&&vt(!1)};return yt&&(document.addEventListener("mousedown",o),document.addEventListener("keydown",x)),()=>{document.removeEventListener("mousedown",o),document.removeEventListener("keydown",x)}},[yt]);const[Ge,Ue]=s.useState(null),[,kt]=s.useState({}),[_n,Ot]=s.useState(new Set),jt=s.useRef(new Set),zn=s.useRef(null),Ht=s.useRef({}),Wt=s.useRef(l),[St,Yt]=s.useState(null),In=()=>{const o=new Set;jt.current=o,Ot(o)},$n=o=>{Ot(x=>{if(x.has(o))return x;const g=new Set(x);return g.add(o),jt.current=g,g})},Ft=s.useRef({compare:{responses:{},moderatorSynthesis:"",phaseLabel:null,executionTimes:{},isGenerating:!1,speaking:new Set},analyze:{responses:{},moderatorSynthesis:"",phaseLabel:null,executionTimes:{},isGenerating:!1,speaking:new Set},debate:{responses:{},moderatorSynthesis:"",phaseLabel:null,executionTimes:{},isGenerating:!1,speaking:new Set}}),Xt=s.useRef(n),Gt=s.useRef(Fe),Ut=s.useRef(Ge),Kt=s.useRef(oe),qt=s.useRef(Te),Vt=s.useRef(De);s.useEffect(()=>{Xt.current=n},[n]),s.useEffect(()=>{Gt.current=Fe},[Fe]),s.useEffect(()=>{Ut.current=Ge},[Ge]),s.useEffect(()=>{Kt.current=oe},[oe]),s.useEffect(()=>{qt.current=Te},[Te]),s.useEffect(()=>{Vt.current=De},[De]),s.useEffect(()=>{const o=["compare","analyze","debate"],x=Pt.current;if(o.includes(x)&&o.includes(l)&&x!==l){const g={};Xt.current.forEach(z=>{g[z.id]={response:z.response,thinking:z.thinking,error:z.error}}),Ft.current[x]={responses:g,moderatorSynthesis:Gt.current,phaseLabel:Ut.current,executionTimes:Kt.current,isGenerating:qt.current,speaking:new Set(Vt.current)};const N=Ft.current[l];Object.values(N.responses).some(z=>z.response&&z.response!=="")||N.isGenerating?(r(z=>z.map(G=>{var Y,ie,Ke;return{...G,response:((Y=N.responses[G.id])==null?void 0:Y.response)||"",thinking:(ie=N.responses[G.id])==null?void 0:ie.thinking,error:(Ke=N.responses[G.id])==null?void 0:Ke.error}})),Xe(N.moderatorSynthesis),Ue(N.phaseLabel),V(N.executionTimes),Ce(N.isGenerating),et(new Set(N.speaking))):(q(),r(z=>z.map(G=>({...G,response:"",thinking:void 0,error:void 0}))),Xe(""),Ue(null),V({}),Ce(!1),et(new Set)),Ye(!1),kt({})}Pt.current=l},[l,q,r]);const{sendMessage:Tt}=Ls({mode:l,moderator:u,selected:a,selectedCardIds:Pe,githubToken:y,isGenerating:Te,summarizeSessionResponses:Se,setLastQuery:Ie,setHoveredCard:Be,setPhaseLabel:Ue,setModeratorSynthesis:Xe,setDiscussionTurnsByModel:kt,resetFailedModels:In,markModelFailed:$n,failedModelsRef:jt,currentDiscussionTurnRef:zn,sessionModelIdsRef:mt,abortControllerRef:ae,thinkingStateRef:xn,conversationHistoryRef:C,pushHistoryEntries:te,historyToText:W,buildCarryoverHistory:J,setModelsData:r,modelIdToName:k,setExecutionTimes:V,setIsGenerating:Ce,setIsSynthesizing:Ye,setSpeaking:et,enqueueStreamDelta:gn,clearPendingStreamForModel:bn,resetPendingStream:xt});zs({mode:l,showSettings:X,showDock:M,contextMenu:ve,selectedCardIds:Pe,selected:a,inputRef:He,setShowSettings:H,setShowDock:K,setContextMenu:Me,setSelected:p,setSelectedCardIds:Oe,clearSelection:tt,setHoveredCard:Be,handleModeChange:ot});const[it,Bn]=_e("playground-bg-style","dots",{serialize:o=>o,deserialize:(o,x)=>o&&cs.includes(o)?o:x}),Dn=n.find(o=>o.id===u),Pn=at?"responding":Te?"waiting":Fe?"done":"idle",On=`${St?`translate(-50%, -50%) translate(${St.x}px, ${St.y}px)`:"translate(-50%, -50%)"} scale(1)`;s.useLayoutEffect(()=>{if(l!=="compare")return;const o={};ye.forEach(x=>{const g=st.current.get(x.id);g&&(o[x.id]=g.getBoundingClientRect())}),Ht.current=o},[l,ye.length,ye.map(o=>o.id).join(",")]),s.useEffect(()=>{if(Wt.current==="compare"&&l!=="compare"&&u&&fe.current){const x=Ht.current[u],g=fe.current.getBoundingClientRect();if(x&&g.width>0&&g.height>0){const N=g.left+g.width/2,R=l==="analyze"?ht-64:0,z=g.top+(g.height*.5+R),G=x.left+x.width/2-N,Y=x.top+x.height/2-z;(Math.abs(G)>1||Math.abs(Y)>1)&&(Yt({x:G,y:Y}),requestAnimationFrame(()=>Yt(null)))}}Wt.current=l},[l,u,ht]);const Hn=it==="none"?"":`bg-${it}`,Wn=(o,x=280)=>o?o.length<=x?o:`…${o.slice(o.length-x)}`:"",Qt=()=>{ae.current&&(ae.current.abort(),Ce(!1),Ye(!1))};return e.jsxs("div",{ref:It,className:`fixed inset-0 overflow-hidden text-white ${Hn}`,style:{backgroundColor:en[l],transition:"background-color 1s ease",...it==="none"?{background:en[l]}:{},...bt?{userSelect:"none",WebkitUserSelect:"none"}:{}},onClick:En,onContextMenu:Mn,children:[t.isActive&&e.jsx(s.Suspense,{fallback:null,children:e.jsx(nr,{onSendMessage:t.callbacks.current.onSendMessage,onScroll:t.callbacks.current.onScroll,onPinch:t.callbacks.current.onPinch,onHover:t.callbacks.current.onHover,gestureActiveArea:{minX:.7,maxX:1,minY:0,maxY:1},onGestureState:t.setGestureState,onError:t.setCameraError,onPerformance:t.setPerformanceMetrics})}),L&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-slate-900/95 backdrop-blur-sm",children:e.jsxs("div",{className:"flex flex-col items-center gap-5 text-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-12 h-12 border-2 border-slate-700 border-t-blue-500 rounded-full animate-spin"}),e.jsx("div",{className:"absolute inset-0 w-12 h-12 border-2 border-transparent border-b-emerald-500/50 rounded-full animate-spin",style:{animationDirection:"reverse",animationDuration:"1.5s"}})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"text-white/80 text-sm font-medium",children:A||"Connecting to models..."}),I>0&&e.jsxs("p",{className:"text-white/40 text-xs tabular-nums",children:["Attempt ",I," of 8"]})]}),e.jsxs("button",{onClick:b,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white/70 hover:text-white bg-white/5 hover:bg-white/10 border border-white/10 hover:border-white/20 rounded-lg transition-all active:scale-95",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh Now"]})]})}),e.jsx(ps,{mode:l,setMode:ot,setHoveredCard:Be,clearSelection:tt,showDock:M,setShowDock:K,onOpenSettings:()=>H(!0),gestureButtonSlot:e.jsx(s.Suspense,{fallback:null,children:e.jsx(tr,{inHeader:!0,appContext:l,onStopGeneration:()=>{if(l==="chat"&&Ee.current){Ee.current.stopGeneration();return}Qt()},onSendMessage:o=>{if(l==="chat"&&Ee.current){Ee.current.sendMessage(o,!0);return}const x=l==="compare"||l==="analyze"||l==="debate"?a:[];x.length>0&&Tt(o,{},x)},onScroll:o=>{if(l==="chat"&&Ee.current){Ee.current.scroll(o);return}gt.current=vn(gt.current+o),wn()},onHover:(o,x)=>{const g=o*window.innerWidth,N=x*window.innerHeight,R=document.elementFromPoint(g,N);if(R){const z=R.closest("[data-gesture-mode-track]");if(z){const ie=z.getBoundingClientRect(),Ke=g-ie.left,lt=ie.width,ct=Math.floor(Ke/lt*5),Et=["chat","compare","analyze","debate"][Math.max(0,Math.min(4,ct))];Et&&Et!==l&&ot(Et);return}const G=document.querySelector('[data-gesture-hovered="true"]'),Y=R.closest('button, a, [role="button"], [data-clickable], .cursor-pointer, [onclick]')||R;Y!==G?(G&&(G.removeAttribute("data-gesture-hovered"),G.dispatchEvent(new PointerEvent("pointerleave",{bubbles:!1,cancelable:!0})),G.dispatchEvent(new MouseEvent("mouseleave",{bubbles:!1,cancelable:!0})),G.dispatchEvent(new MouseEvent("mouseout",{bubbles:!0,cancelable:!0}))),Y.setAttribute("data-gesture-hovered","true"),Y.dispatchEvent(new PointerEvent("pointerenter",{bubbles:!1,cancelable:!0,clientX:g,clientY:N})),Y.dispatchEvent(new PointerEvent("pointermove",{bubbles:!0,cancelable:!0,clientX:g,clientY:N})),Y.dispatchEvent(new MouseEvent("mouseenter",{bubbles:!1,cancelable:!0,clientX:g,clientY:N})),Y.dispatchEvent(new MouseEvent("mouseover",{bubbles:!0,cancelable:!0,clientX:g,clientY:N}))):Y===G&&(Y.dispatchEvent(new PointerEvent("pointermove",{bubbles:!0,cancelable:!0,clientX:g,clientY:N})),Y.dispatchEvent(new MouseEvent("mousemove",{bubbles:!0,cancelable:!0,clientX:g,clientY:N})))}},onPinch:(o,x)=>{const g=o*window.innerWidth,N=x*window.innerHeight,R=document.elementFromPoint(g,N);if(R){const z=ie=>{ie.dispatchEvent(new PointerEvent("pointerdown",{bubbles:!0,cancelable:!0,clientX:g,clientY:N,pointerId:1,pointerType:"touch",isPrimary:!0})),ie.dispatchEvent(new PointerEvent("pointerup",{bubbles:!0,cancelable:!0,clientX:g,clientY:N,pointerId:1,pointerType:"touch",isPrimary:!0})),ie.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0,clientX:g,clientY:N})),ie.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0,clientX:g,clientY:N})),ie.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,clientX:g,clientY:N}))},G=R.closest('button, a, [role="button"], [data-clickable], .cursor-pointer, [onclick]');z(G||R);const Y=document.createElement("div");Y.style.position="fixed",Y.style.left=`${g}px`,Y.style.top=`${N}px`,Y.style.width="20px",Y.style.height="20px",Y.style.background="rgba(236, 72, 153, 0.5)",Y.style.borderRadius="50%",Y.style.transform="translate(-50%, -50%)",Y.style.pointerEvents="none",Y.style.zIndex="9999",document.body.appendChild(Y),Y.animate([{transform:"translate(-50%, -50%) scale(1)",opacity:1},{transform:"translate(-50%, -50%) scale(4)",opacity:0}],{duration:400}).onfinish=()=>Y.remove()}},onModeChange:o=>{const x=["chat","compare","analyze","debate"],g=x.indexOf(l);let N;o==="next"?N=(g+1)%x.length:N=(g-1+x.length)%x.length,ot(x[N])}})})}),e.jsxs("div",{style:{paddingLeft:"1.5rem",paddingRight:"0"},children:[M&&e.jsx("div",{className:"fixed inset-0 z-[55] bg-black/10 backdrop-blur-[1px] transition-opacity duration-300",onClick:()=>K(!1)}),e.jsx(us,{showDock:M,availableModels:f,allSelectedByType:h,totalModelsByType:d,handleDragStart:Ze,handleModelToggle:pt,handleAddGroup:un,dockRef:le,mode:l,allModels:n,setShowDock:K,chatSelectedModels:Ne,onToggleChatModel:w,onToggleChatGroup:v}),l==="chat"&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex h-screen w-full relative z-[10]",children:e.jsx("div",{className:"flex-1 relative px-2 sm:px-6 pt-20 pb-6",children:e.jsx(Js,{children:e.jsx(s.Suspense,{fallback:e.jsxs("div",{className:"flex items-center justify-center h-full text-white/50 gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/20 border-t-white/60 rounded-full animate-spin"}),"Loading..."]}),children:e.jsx(sr,{ref:Ee,models:n,selectedModels:Ne,onToggleModel:w,githubToken:y,openrouterKey:xe,messages:he,setMessages:be,isGenerating:Re,setIsGenerating:B,gesturesActive:t.isActive})})})})})}),l!=="chat"&&e.jsxs("div",{className:"flex h-screen w-full relative",children:[e.jsx("div",{className:"relative flex-1 transition-all duration-300 flex flex-col pt-24",children:e.jsx("div",{ref:fe,onDragOver:ue,onDragLeave:ln,onDrop:cn,className:"relative w-full h-full z-10 transition-all duration-300",style:{position:"relative",display:"flex",alignItems:l==="compare"?"flex-start":"center",justifyContent:"center","--arena-offset-y":`${Bt.current}px`,transform:l==="analyze"||l==="debate"?`translateY(calc(var(--arena-offset-y) - 50px)) scale(${U?1.02:1})`:`translateY(var(--arena-offset-y)) scale(${U?1.02:1})`,willChange:"transform",border:U?"2px dashed rgba(59, 130, 246, 0.4)":"2px dashed transparent",borderRadius:U?"24px":"0px",transition:"transform 0s linear",...l==="compare"?{minHeight:"300px",paddingBottom:"120px"}:l==="analyze"||l==="debate"?{height:"100%",minHeight:"100%",overflow:"hidden"}:{height:"100%",minHeight:"100%",overflow:"hidden"},...U?{background:"rgba(59, 130, 246, 0.05)"}:{}},children:e.jsx(Ps,{mode:l,selectedModels:ye,gridCols:O,speaking:De,selectedCardIds:Pe,setSelectedCardIds:Oe,executionTimes:oe,failedModels:_n,cardRefs:st,handlePointerDown:Tn,dragState:Sn,handleModelToggle:pt,setContextMenu:Me,suppressClickRef:We,getTailSnippet:Wn,hoveredCard:dn,setHoveredCard:Be,layoutRadius:ht,getCirclePosition:$e,moderatorModel:Dn,moderatorId:u,orchestratorTransform:On,orchestratorStatus:Pn,moderatorSynthesis:Fe,isSynthesizing:at,isGenerating:Te,phaseLabel:Ge,linesTransitioning:D,lastSelectedCardRef:mn,orchestratorAutoMode:Nn,orchestratorAutoScope:Ln,showOrchestratorMenu:yt,setShowOrchestratorMenu:vt,setOrchestratorAutoMode:Rn,setOrchestratorAutoScope:An,orchestratorMenuRef:wt,availableModels:f,setModerator:c,fastestTTFT:Qe,fastestTotal:Je})})}),l!=="compare"&&e.jsx("div",{className:"transcript-panel w-[400px] xl:w-[480px] flex flex-col border-l border-white/5 bg-slate-900/20 backdrop-blur-sm z-40 relative h-full",children:e.jsx(s.Suspense,{fallback:null,children:e.jsx(er,{history:T,models:n,mode:l,onSelectPrompt:o=>{He.current&&(He.current.value=o,He.current.focus())},onNewSession:Cn,className:"pt-24 pb-6 mask-fade-top",phaseLabel:Ge,isGenerating:Te,isSynthesizing:at,speakingCount:De.size,totalParticipants:ye.length})})})]})]}),e.jsx(qs,{rect:kn}),$&&e.jsx("div",{className:"fixed bottom-20 left-1/2 -translate-x-1/2 z-[200] animate-in slide-in-from-bottom-4 fade-in duration-300",children:e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 rounded-xl bg-amber-500/10 border border-amber-500/30 backdrop-blur-md shadow-xl",children:[e.jsx("svg",{className:"w-5 h-5 text-amber-400 shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsx("span",{className:"text-sm text-amber-100",children:$}),e.jsx("button",{onClick:()=>{we(null),H(!0)},className:"ml-2 px-3 py-1 text-xs font-medium text-amber-900 bg-amber-400 hover:bg-amber-300 rounded-md transition-colors",children:"Open Settings"}),e.jsx("button",{onClick:()=>we(null),className:"ml-1 p-1 text-amber-400/60 hover:text-amber-400 transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsx(s.Suspense,{fallback:null,children:e.jsx(Zs,{open:X,onClose:()=>H(!1),token:y,setToken:ce,openrouterKey:xe,setOpenrouterKey:pe,bgStyle:it,setBgStyle:Bn})}),(l==="compare"||l==="analyze"||l==="debate")&&e.jsx(ds,{inputRef:He,inputFocused:fn,setInputFocused:pn,onSendMessage:Tt,isGenerating:Te||at,onStop:Qt,placeholder:l==="compare"?void 0:"Steer the discussion...",className:`fixed bottom-0 left-0 z-[100] pb-6 px-3 sm:px-4 flex justify-center items-end pointer-events-none transition-all duration-300 ${l==="compare"?"right-0":"right-[400px] xl:right-[480px]"}`,style:{paddingBottom:"calc(1.5rem + env(safe-area-inset-bottom))"}}),ve&&e.jsx("div",{className:"fixed bg-slate-800 border border-slate-700 rounded-lg shadow-xl py-1 z-[200] min-w-[160px]",style:{top:ve.y,left:ve.x},onClick:o=>o.stopPropagation(),children:ve.type==="background"?e.jsxs("button",{className:"w-full text-left px-4 py-2 text-sm text-slate-200 hover:bg-slate-700 transition-colors flex items-center gap-2",onClick:()=>{K(!0),Me(null)},children:[e.jsx("svg",{className:"w-4 h-4 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Model"]}):ve.modelId?e.jsxs(e.Fragment,{children:[l!=="compare"&&ve.modelId!==u&&e.jsxs("button",{className:"w-full text-left px-4 py-2 text-sm text-slate-200 hover:bg-slate-700 transition-colors flex items-center gap-2",onClick:()=>{c(ve.modelId),Me(null)},children:[e.jsx("svg",{className:"w-4 h-4 text-orange-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})}),"Set as Orchestrator"]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 text-sm text-red-400 hover:bg-slate-700 transition-colors flex items-center gap-2",onClick:()=>{const o=ve.modelId===u;if(pt(ve.modelId),o&&l!=="compare"){const x=a.filter(g=>g!==ve.modelId);x.length>0?c(x[0]):c("")}Me(null)},children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Remove"]})]}):null})]})}function ar(){return e.jsx(Vs,{children:e.jsx(or,{})})}es.createRoot(document.getElementById("root")).render(e.jsx(ts.StrictMode,{children:e.jsx(ar,{})}));export{cs as B,sn as E,hr as M,ds as P,_e as a,mr as b,ws as f,Ct as s,Qs as u};
