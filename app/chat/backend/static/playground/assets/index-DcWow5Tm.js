const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SettingsModal-0eA7tsRN.js","assets/react-vendor-Cr2kZ6Hw.js","assets/markdown-BhL5aFst.js","assets/math-render-BeslBgx1.js","assets/math-render-BqiDbsU2.css","assets/syntax-highlight-xu6YVAlF.js","assets/syntax-highlight-BEHUn5zE.css","assets/DiscussionTranscript-BR5VYoJZ.js","assets/FormattedContent-C59IBQBw.js","assets/GestureControl-DOanUbF5.js","assets/HandBackground-bqIFA56D.js","assets/mediapipe-YSlczgt6.js","assets/ChatView-DGFRcO4R.js"])))=>i.map(i=>d[i]);
var Hn=Object.defineProperty;var Wn=(t,n,r)=>n in t?Hn(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r;var rn=(t,n,r)=>Wn(t,typeof n!="symbol"?n+"":n,r);import{j as e,S as Yn,A as Xn,r as s,a as Fn,Z as Gn,T as Un,R as qn,c as Kn,b as Vn}from"./react-vendor-Cr2kZ6Hw.js";import"./math-render-BeslBgx1.js";import"./syntax-highlight-xu6YVAlF.js";import"./markdown-BhL5aFst.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))p(d);new MutationObserver(d=>{for(const i of d)if(i.type==="childList")for(const v of i.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&p(v)}).observe(document,{childList:!0,subtree:!0});function r(d){const i={};return d.integrity&&(i.integrity=d.integrity),d.referrerPolicy&&(i.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?i.credentials="include":d.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function p(d){if(d.ep)return;d.ep=!0;const i=r(d);fetch(d.href,i)}})();const Qn="modulepreload",Jn=function(t){return"/static/playground/"+t},on={},rt=function(n,r,p){let d=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const v=document.querySelector("meta[property=csp-nonce]"),m=(v==null?void 0:v.nonce)||(v==null?void 0:v.getAttribute("nonce"));d=Promise.allSettled(r.map(g=>{if(g=Jn(g),g in on)return;on[g]=!0;const x=g.endsWith(".css"),f=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${f}`))return;const b=document.createElement("link");if(b.rel=x?"stylesheet":Qn,x||(b.as="script"),b.crossOrigin="",b.href=g,m&&b.setAttribute("nonce",m),document.head.appendChild(b),x)return new Promise((R,P)=>{b.addEventListener("load",R),b.addEventListener("error",()=>P(new Error(`Unable to preload CSS for ${g}`)))})}))}function i(v){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=v,window.dispatchEvent(m),!m.defaultPrevented)throw v}return d.then(v=>{for(const m of v||[])m.status==="rejected"&&i(m.reason);return n().catch(i)})},Zn={"self-hosted":{color:"#10b981"},github:{color:"#3b82f6"},external:{color:"#8b5cf6"}},es={nanbeige:1,qwen:2,r1qwen:3,deepseek:3,gemma:4,mistral:5,phi:6,rnj:7,llama:8,functiongemma:9,nemotron:10,gptoss:11,"gpt-oss":11},ts={"gpt-4o":1,"gpt-4.1":2,"gpt-5":3,"gpt-5-mini":4,"gpt-5-nano":5,"llama-3.3-70b":6,"llama-4-scout-17b-16e-instruct":7,"mistral-large":8},ns={"deepseek-v3-0324":1,"glm-4.6":2,"command-r-plus":3},ss=50,rs=100,os=150;function cr(t,n,r){if(r!==void 0)return r;let p,d;switch(n){case"self-hosted":p=es,d=ss;break;case"github":p=ts,d=rs;break;case"external":p=ns,d=os;break}for(const[i,v]of Object.entries(p))if(t.toLowerCase().includes(i.toLowerCase()))return v;return d}const It=[{id:"eu-ai-act-enforcement",label:"EU AI Act Enforcement Wave",prompt:"The EU AI Act enters enforcement; high-risk systems must prove data provenance, evals, and risk controls. Outline compliance gaps for a frontier model API and tradeoffs between speed and alignment.",category:"Policy",modes:["council","roundtable"],tags:["governance","compliance"]},{id:"export-controls-blackwell",label:"Export Controls Tighten",prompt:"U.S. export rules tighten again on AI accelerators; Blackwell-class parts face new caps and cloud checks. Map the impact on training roadmaps, costs, and on-device strategies.",category:"Infra",modes:["compare","roundtable"],tags:["chips","supply-chain"]},{id:"weights-leak",label:"Major Weights Leak",prompt:"A commercial frontier model checkpoint leaks. Assess risks (misuse, impersonation, jailbreak diffusion), legal exposure, and whether open red-team releases mitigate or worsen safety.",category:"Security",modes:["council","roundtable"],tags:["safety","open-weights"]},{id:"on-device-llm-race",label:"On-Device LLM Race",prompt:"Phone OEMs ship 3nm NPUs and 20B-parameter on-device assistants. What actually moves the needle for UX, privacy, and cost vs. cloud? Where do hybrid (edge + cloud) designs win?",category:"Infra",modes:["compare","roundtable"],tags:["edge","latency"]},{id:"signed-app-prompt-injection",label:"Signed App Prompt Injection",prompt:"A popular signed desktop app shipped with hardcoded system prompts; attackers use supply chain updates to exfiltrate data. How should vendors audit, sandbox, and attest LLM apps?",category:"Security",modes:["compare","council"],tags:["supply-chain","prompt-injection"]},{id:"eval-standardization",label:"Safety Eval Standard",prompt:"NIST-style safety eval suites gain traction (jailbreak, autonomy, bio). How should vendors report scores, and what gaps remain for frontier vs. small models?",category:"Policy",modes:["compare","roundtable"],tags:["evaluation","safety"]},{id:"licensing-standoff",label:"Publisher Licensing Standoff",prompt:"Major news publishers pause AI licensing talks and sue over training. What remedies (revenue share, opt-out registries, model removal) are realistic, and how do they ripple to open models?",category:"Data",modes:["council","roundtable"],tags:["licensing","copyright"]},{id:"sbom-for-llms",label:"SBOM for LLM Pipelines",prompt:"Regulators push SBOMs and signed artifacts for AI stacks. Draft what should appear in an LLM pipeline SBOM (data, weights, evals, guardrails) and how to verify it at runtime.",category:"Security",modes:["compare","council"],tags:["sbom","supply-chain"]},{id:"data-poisoning-campaign",label:"Data Poisoning Campaign",prompt:"Researchers find coordinated data poisoning in popular open corpora. How should model hosts detect and mitigate poisoning post-hoc, and what retraining tradeoffs are acceptable?",category:"Security",modes:["compare","roundtable"],tags:["data","poisoning"]},{id:"copyright-settlement",label:"Copyright Settlement Sets Precedent",prompt:"A major copyright suit settles with dataset disclosure and per-output watermarking. Predict how this precedent affects future training sets and open-weight releases.",category:"Policy",modes:["roundtable"],tags:["copyright","watermarking"]}],ur={council:["Tabs or spaces? Give your verdict in under 50 words.","Rock, paper, scissorsâ€”which is objectively the best opening move?","In one sentence: should AI be allowed to write its own code?"],roundtable:["Write a two-sentence horror story where the second sentence recontextualizes the first.","Complete this thought: 'AI will never be able to...'","Pitch a startup in one sentence. No buzzwords allowed."],personality:["Coffee or tea? Defend your choice.","Hot take: pineapple on pizza.","What's the most overrated thing everyone pretends to like?"],compare:[],chat:[]};It.filter(t=>t.category==="Policy"||t.category==="Data"),It.filter(t=>t.category==="Infra"),It.filter(t=>t.category==="Security");const is=["dots-mesh","dots","dots-fade","grid","mesh","animated-mesh","none"],nt="#0f172a",an={compare:nt,council:nt,roundtable:nt,chat:nt,personality:nt},st={maxTokens:1024,temperature:.7},pe={cardWidth:256,cardHeight:200,gapX:24,gapY:24,baseRadius:160,minRadius:120,radiusPerModel:15,scrollClamp:200};function as({showDock:t,availableModels:n,allSelectedByType:r,totalModelsByType:p,handleDragStart:d,handleModelToggle:i,handleAddGroup:v,dockRef:m}){const g=[{type:"self-hosted",title:"Self-Hosted Models",accentColor:"emerald"},{type:"github",title:"GitHub Models",accentColor:"blue"}];return e.jsxs("div",{ref:m,"data-no-arena-scroll":!0,"data-no-background":!0,className:"dock-scroll model-dock-panel fixed left-3 top-20 bottom-20 w-[min(75vw,320px)] sm:left-6 sm:top-24 sm:bottom-24 sm:w-72 rounded-2xl flex flex-col z-[60] transition-all duration-300 overflow-hidden",style:{transform:t?"translateX(0)":"translateX(-150%)",opacity:t?1:0,pointerEvents:t?"auto":"none"},children:[e.jsxs("div",{className:"px-5 py-4 border-b border-slate-700/50",children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-200",children:"Available Models"}),e.jsx("p",{className:"text-[10px] text-slate-500 mt-0.5",children:"Click to add to arena"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-4 space-y-5",children:g.map(x=>{const f=n.filter(B=>B.type===x.type),b=r[x.type],R=p[x.type]>0,P={emerald:{button:"text-emerald-400 hover:text-emerald-300 hover:bg-emerald-500/10",dot:"bg-emerald-500",border:"hover:border-emerald-500/40"},blue:{button:"text-blue-400 hover:text-blue-300 hover:bg-blue-500/10",dot:"bg-blue-500",border:"hover:border-blue-500/40"}}[x.accentColor];return e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between px-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${P.dot} ${x.type==="self-hosted"?"glow-dot-emerald":"glow-dot-blue"}`}),e.jsx("h3",{className:"text-[11px] font-semibold text-slate-300 uppercase tracking-wide",children:x.title}),e.jsxs("span",{className:"text-[10px] text-slate-500",children:["(",f.length,")"]})]}),e.jsx("button",{onClick:()=>v(x.type),className:`text-[10px] font-medium px-2 py-1.5 sm:py-0.5 rounded transition-all active:scale-95 ${P.button} ${R?"":"opacity-40 cursor-not-allowed"}`,disabled:!R,children:b?"âˆ’ Remove All":"+ Add All"})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[f.map(B=>e.jsxs("div",{draggable:!0,onDragStart:H=>d(H,B.id),onClick:()=>i(B.id),className:`group flex items-center gap-3 px-3 py-3 sm:py-2 rounded-lg cursor-grab active:cursor-grabbing hover:bg-white/5 transition-all border border-transparent active:scale-95 ${P.border}`,children:[e.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${P.dot} opacity-60 group-hover:opacity-100 transition-opacity`}),e.jsx("span",{className:"text-xs font-medium text-slate-400 group-hover:text-slate-200 transition-colors",children:B.name})]},B.id)),f.length===0&&e.jsx("div",{className:"text-[10px] text-slate-600 italic px-3 py-2",children:"All models are in the arena"})]})]},x.type)})}),e.jsx("div",{className:"px-5 py-3 border-t border-slate-700/50 bg-slate-900/30",children:e.jsxs("p",{className:"text-[10px] text-slate-500 text-center",children:["Press ",e.jsx("kbd",{className:"px-1 py-0.5 rounded bg-slate-800 text-slate-400 font-mono text-[9px]",children:"M"})," to toggle this panel"]})})]})}function ls({inputRef:t,inputFocused:n,setInputFocused:r,onSendMessage:p,className:d,style:i,placeholder:v,isGenerating:m,onStop:g}){return e.jsx("div",{className:d??"fixed bottom-0 right-0 left-0 z-[100] pb-6 px-3 sm:px-4 flex justify-center items-end pointer-events-none transition-all duration-300",style:i??{paddingBottom:"calc(1.5rem + env(safe-area-inset-bottom))"},children:e.jsx("div",{className:"w-full pointer-events-auto",style:{maxWidth:"600px"},children:e.jsxs("div",{className:`rounded-xl p-2.5 transition-all duration-300 flex items-center gap-2 border border-slate-700/40 header-shell ${n?"prompt-panel-focused":""}`,children:[e.jsx("input",{ref:t,type:"text",placeholder:v||"Ask a question to compare model responses...",className:"w-full bg-transparent text-slate-200 placeholder-slate-500 outline-none text-base sm:text-sm px-2.5 py-2.5",onFocus:()=>r(!0),onBlur:()=>r(!1),onKeyDown:x=>{var f;if(x.key==="Enter"&&!x.shiftKey){if(x.preventDefault(),m)return;(f=t.current)!=null&&f.value&&(p(t.current.value),t.current.value="")}},disabled:m}),e.jsx("button",{onClick:()=>{var x;m?g==null||g():(x=t.current)!=null&&x.value&&(p(t.current.value),t.current.value="")},onMouseDown:x=>x.currentTarget.blur(),className:`min-w-[44px] min-h-[44px] sm:min-w-[36px] sm:min-h-[36px] p-2 rounded-lg transition-colors active:scale-95 flex items-center justify-center focus:outline-none focus-visible:outline-none ${m?"text-red-400 hover:text-red-300 hover:bg-red-500/10":"text-slate-400 hover:text-white hover:bg-white/10"}`,"aria-label":m?"Stop generation":"Send message",children:m?e.jsx(Yn,{className:"w-5 h-5 sm:w-4 sm:h-4 fill-current"}):e.jsx(Xn,{className:"w-5 h-5 sm:w-4 sm:h-4",strokeWidth:2.5})})]})})})}const cs={chat:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),compare:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2"})}),council:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),roundtable:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),personality:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})},qe=[{value:"chat",label:"Chat"},{value:"compare",label:"Compare"},{value:"council",label:"Council"},{value:"roundtable",label:"Roundtable"},{value:"personality",label:"Personalities"}];function us({mode:t,setMode:n,setHoveredCard:r,clearSelection:p,showDock:d,setShowDock:i,onOpenSettings:v,gestureButtonSlot:m}){const[g,x]=s.useState(!1),f=s.useRef(null),[b,R]=s.useState(!0),P=s.useRef(null),[B,H]=s.useState(null),[V,c]=s.useState(0),F=qe.findIndex(j=>j.value===t),G=F===-1?0:F,Q=qe[G].label;s.useEffect(()=>{const j=()=>{R(window.innerWidth>=1024)};return j(),window.addEventListener("resize",j),()=>window.removeEventListener("resize",j)},[]),s.useEffect(()=>{if(!P.current)return;const j=()=>{const ce=P.current;if(!ce)return;const S=ce.querySelectorAll('button[role="radio"]');if(S.length===0||G>=S.length)return;const O=S[G].getBoundingClientRect(),xe=ce.getBoundingClientRect(),se=O.width,N=O.left,re=xe.left;H(se),c(N-re)},ee=setTimeout(j,0),ae=new ResizeObserver(()=>{setTimeout(j,0)});return ae.observe(P.current),window.addEventListener("resize",j),()=>{clearTimeout(ee),ae.disconnect(),window.removeEventListener("resize",j)}},[t,b,G]),s.useEffect(()=>{function j(ee){f.current&&!f.current.contains(ee.target)&&x(!1)}return g&&document.addEventListener("mousedown",j),()=>{document.removeEventListener("mousedown",j)}},[g]);const U=j=>{n(j),r(null),p(),x(!1)};return e.jsxs("div",{className:"fixed top-0 left-0 right-0 flex items-center justify-between mb-2 px-3 sm:px-6 pt-4 sm:pt-6 z-50 pointer-events-none transition-all duration-300",children:[e.jsx("div",{className:"absolute inset-0 pointer-events-auto",style:{height:"100%",zIndex:-1}}),e.jsx("div",{className:"flex items-center gap-2 w-auto pointer-events-auto z-20",children:m}),e.jsx("div",{className:"hidden md:block absolute left-1/2 -translate-x-1/2 pointer-events-auto z-20",children:e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex items-center p-1.5 rounded-xl border border-slate-700/40 header-shell",children:[e.jsx("button",{onClick:()=>i(!d),className:"px-2 sm:px-3 flex items-center justify-center text-slate-400 hover:text-white transition-colors",title:"Toggle Model Dock",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsx("div",{className:"w-px h-5 bg-slate-700/50 mx-0.5 sm:mx-1"}),e.jsxs("div",{ref:P,className:"relative flex p-1 rounded-lg bg-black/20 mode-track",role:"radiogroup","aria-label":"Mode selection","data-gesture-mode-track":"true",children:[e.jsx("div",{className:"absolute top-1 bottom-1 rounded-md transition-all duration-300 ease-out mode-slider",style:{width:B!==null?`${B}px`:`calc((100% - 8px) / ${qe.length})`,left:B!==null?`${V}px`:`calc(4px + (100% - 8px) * ${G} / ${qe.length})`}}),qe.map(j=>e.jsx("button",{tabIndex:-1,onClick:()=>U(j.value),role:"radio","aria-checked":t===j.value,"aria-label":j.label,title:j.label,className:`relative z-10 py-2 sm:py-1.5 px-3 text-[11px] sm:text-xs font-medium transition-colors duration-200 min-h-[44px] sm:min-h-0 active:scale-95 focus:outline-none focus-visible:outline-none flex-1 flex items-center justify-center text-center ${t===j.value?"text-white":"text-slate-400 hover:text-slate-200"}`,children:j.label},j.value))]})]})})}),e.jsx("div",{className:"flex md:hidden flex-1 justify-center pointer-events-auto relative z-20",children:e.jsxs("div",{className:"relative",ref:f,children:[e.jsxs("button",{onClick:()=>x(!g),className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-slate-800/90 border border-slate-700/50 text-slate-200 font-medium text-sm backdrop-blur-md shadow-lg active:scale-95 transition-all",children:[e.jsx("span",{className:"font-bold text-slate-400 hidden xs:inline",children:"Arena"}),e.jsx("span",{className:"font-bold hidden xs:inline text-slate-600",children:"/"}),e.jsx("span",{children:Q}),e.jsx("svg",{className:`w-4 h-4 text-slate-400 transition-transform duration-200 ${g?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),g&&e.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 mt-2 w-48 py-1 rounded-xl bg-slate-800 border border-slate-700 shadow-2xl overflow-hidden flex flex-col animate-in fade-in zoom-in-95 duration-100 origin-top",children:qe.map(j=>e.jsxs("button",{onClick:()=>U(j.value),className:`px-4 py-3 text-sm text-left w-full transition-colors flex items-center gap-3 ${t===j.value?"bg-blue-500/10 text-blue-400":"text-slate-300 hover:bg-slate-700/50"}`,children:[e.jsx("span",{className:"flex-shrink-0",children:cs[j.value]}),e.jsx("span",{className:"flex-1",children:j.label}),t===j.value&&e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]},j.value))})]})}),e.jsx("div",{className:"flex items-center gap-2 w-auto justify-end pointer-events-auto z-20",children:e.jsx("button",{onClick:v,className:"min-w-[42px] min-h-[42px] w-[42px] h-[42px] rounded-full bg-slate-800/50 flex items-center justify-center border border-slate-700/50 hover:border-slate-600 transition-colors active:scale-95 focus:outline-none focus-visible:outline-none",title:"Settings",children:e.jsxs("svg",{className:"w-4 h-4 text-slate-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),e.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})})})]})}const ds=t=>{if(typeof t=="string")return t;try{return JSON.stringify(t)}catch{return null}},ps=(t,n)=>{if(t===null)return n;try{return JSON.parse(t)}catch{return n}};function He(t,n,r={}){const p=r.serialize??ds,d=r.deserialize??ps,[i,v]=s.useState(()=>{if(typeof window>"u")return n;try{const m=window.localStorage.getItem(t);return d(m,n)}catch{return n}});return s.useEffect(()=>{if(!(typeof window>"u"))try{const m=p(i);m===null?window.localStorage.removeItem(t):window.localStorage.setItem(t,m)}catch{}},[t,p,i]),[i,v]}const fs=800,hs=3e3,ms=8;function gs(){const[t,n]=s.useState([]),[r,p]=s.useState(!0),[d,i]=s.useState(null),[v,m]=s.useState(0),[g,x]=He("playground_selected_models",null),f=s.useRef(g!==null),[b,R]=He("playground_chat_model",null),P=s.useRef(b!==null),B=s.useMemo(()=>g??[],[g]),H=s.useCallback(S=>{x(q=>typeof S=="function"?S(q??[]):S)},[x]),[V,c]=s.useState(""),F=s.useRef(0),G=s.useRef(null),Q=s.useCallback(async(S,q,O=!1)=>{G.current&&(clearTimeout(G.current),G.current=null),p(!0),O&&(i("Refreshing..."),m(0));const xe=se=>{var be,ye;const N=se.models.map(te=>{const fe=te.type==="self-hosted"||te.type==="github"||te.type==="external"?te.type:"self-hosted",ve=Zn[fe];return{id:te.id,name:ve.name||te.name||te.id,color:ve.color,type:fe,response:"Ready to generate...",priority:te.priority,context_length:te.context_length}});if(n(N),p(!1),i(null),m(0),f.current||(x(N.filter(te=>te.type==="self-hosted").map(te=>te.id)),f.current=!0),!P.current){const te=N.find(fe=>fe.type==="github"||fe.type==="external");R((te==null?void 0:te.id)||((be=N[0])==null?void 0:be.id)||null),P.current=!0}const re=N.find(te=>te.type==="github"||te.type==="external"),oe=((ye=N[0])==null?void 0:ye.id)||"";c((re==null?void 0:re.id)||oe)};try{const se=await fetch("/api/models");if(S!==F.current)return;if(!se.ok)throw new Error(`HTTP ${se.status}`);const N=await se.json();if(S!==F.current)return;if(!N.models||N.models.length===0)throw new Error("No models available yet");xe(N)}catch(se){if(S!==F.current)return;console.warn("Backend fetch failed:",se);try{console.log("Trying static models.json...");const re=await fetch("/models.json");if(re.ok){const oe=await re.json();if(oe.models&&oe.models.length>0){console.log(`Loaded ${oe.models.length} models from static file`),xe(oe);return}}}catch(re){console.warn("Static models.json not available:",re)}const N=q+1;if(m(N),N<ms){const re=Math.min(fs*Math.pow(1.4,q),hs);i("Connecting to backend..."),G.current=setTimeout(()=>{Q(S,N)},re)}else p(!1),i("Could not load models")}},[x,R]),U=s.useCallback(()=>{F.current+=1,Q(F.current,0,!0)},[Q]);s.useEffect(()=>(F.current+=1,Q(F.current,0),()=>{F.current+=1,G.current&&clearTimeout(G.current)}),[Q]);const j=s.useMemo(()=>t.filter(S=>!B.includes(S.id)),[t,B]),{totalModelsByType:ee,allSelectedByType:ae}=s.useMemo(()=>{const S={"self-hosted":t.filter(O=>O.type==="self-hosted").length,github:t.filter(O=>O.type==="github").length,external:t.filter(O=>O.type==="external").length},q={"self-hosted":t.filter(O=>O.type==="self-hosted"&&B.includes(O.id)).length,github:t.filter(O=>O.type==="github"&&B.includes(O.id)).length,external:t.filter(O=>O.type==="external"&&B.includes(O.id)).length};return{totalModelsByType:S,allSelectedByType:{"self-hosted":S["self-hosted"]>0&&q["self-hosted"]===S["self-hosted"],github:S.github>0&&q.github===S.github,external:S.external>0&&q.external===S.external}}},[t,B]),ce=s.useCallback(S=>{var q;return((q=t.find(O=>O.id===S))==null?void 0:q.name)||S},[t]);return{modelsData:t,setModelsData:n,selected:B,setSelected:H,chatModelId:b,setChatModelId:R,moderator:V,setModerator:c,availableModels:j,totalModelsByType:ee,allSelectedByType:ae,modelIdToName:ce,isLoading:r,loadError:d,retryCount:v,retryNow:U}}function xs(){var t;return typeof chrome<"u"&&((t=chrome.storage)!=null&&t.local)?window.__API_BASE__||"https://chat.neevs.io":""}async function*mt(t,n,r){var x;const d=`${xs()}${t}`,i=await fetch(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),signal:r});if(!i.ok){yield{event:"error",error:`HTTP ${i.status}: ${i.statusText}`};return}const v=(x=i.body)==null?void 0:x.getReader();if(!v){yield{event:"error",error:"No response body"};return}const m=new TextDecoder;let g="";try{for(;;){const{done:f,value:b}=await v.read();if(f)break;g+=m.decode(b,{stream:!0});const R=g.split(`
`);g=R.pop()||"";for(const P of R)if(P.startsWith("data: ")){const B=P.slice(6).trim();if(B)try{yield JSON.parse(B)}catch{}}}}finally{v.releaseLock()}}const bs=async(t,n)=>mt("/api/chat/stream",{models:t.models,messages:t.messages,max_tokens:t.max_tokens,temperature:t.temperature,github_token:t.github_token,openrouter_key:t.openrouter_key},n),ys=async(t,n)=>mt("/api/chat/council/stream",t,n),vs=async(t,n)=>mt("/api/chat/discussion/stream",t,n),ws=async(t,n)=>mt("/api/chat/personality/stream",t,n),ft=async(t,n)=>{try{for await(const r of t)n(r)}catch(r){throw console.error("Stream error:",r),r}};function ln(t){window.__API_BASE__=t}const ks=[{name:"Chat",path:"chat.yml",category:"core"},{name:"Build Images",path:"build-push-images.yml",category:"core"},{name:"Nanbeige4-3B Thinking",path:"nanbeige-inference.yml",category:"reasoning",serviceKey:"nanbeige"},{name:"Qwen3 4B",path:"qwen-inference.yml",category:"small",serviceKey:"qwen"},{name:"DeepSeek R1 1.5B",path:"r1qwen-inference.yml",category:"reasoning",serviceKey:"r1qwen"},{name:"Gemma 3 12B",path:"gemma-inference.yml",category:"medium",serviceKey:"gemma"},{name:"Mistral 7B v0.3",path:"mistral-inference.yml",category:"medium",serviceKey:"mistral"},{name:"Phi-3 Mini",path:"phi-inference.yml",category:"small",serviceKey:"phi"},{name:"RNJ-1 Instruct",path:"rnj-inference.yml",category:"medium",serviceKey:"rnj"},{name:"Llama 3.2-3B",path:"llama-inference.yml",category:"medium",serviceKey:"llama"},{name:"FunctionGemma 270M",path:"functiongemma-inference.yml",category:"small",serviceKey:"functiongemma"},{name:"Nemotron-3 Nano 30B",path:"nemotron-inference.yml",category:"reasoning",serviceKey:"nemotron"},{name:"GPT-OSS 20B",path:"gptoss-inference.yml",category:"reasoning",serviceKey:"gptoss"}],Ss={workflows:ks},dn=Ss.workflows;new Map(dn.map(t=>[t.name,t.path]));new Map(dn.filter(t=>t.serviceKey).map(t=>[t.serviceKey,t.name]));const Ve={githubToken:"",profile:"local_all",chatApiBaseUrl:"http://localhost:8080",modelsBaseDomain:"",modelsUseHttps:!1};function cn(t){const n={...Ve,...t};(!n.chatApiBaseUrl||typeof n.chatApiBaseUrl!="string")&&typeof n.baseDomain=="string"&&(n.chatApiBaseUrl=n.baseDomain?`${n.useHttps===!1?"http":"https"}://chat.${n.baseDomain}`:"http://localhost:8080",n.profile="custom"),(!n.modelsBaseDomain||typeof n.modelsBaseDomain!="string")&&typeof n.baseDomain=="string"&&(n.modelsBaseDomain=n.baseDomain,n.profile="custom"),typeof n.modelsUseHttps!="boolean"&&typeof n.useHttps=="boolean"&&(n.modelsUseHttps=n.useHttps,n.profile="custom");const r=n.profile==="remote_all"||n.profile==="local_chat_remote_models"||n.profile==="local_all"||n.profile==="custom"?n.profile:Ve.profile;return{githubToken:typeof n.githubToken=="string"?n.githubToken:Ve.githubToken,profile:r,chatApiBaseUrl:Pt(typeof n.chatApiBaseUrl=="string"?n.chatApiBaseUrl:""),modelsBaseDomain:typeof n.modelsBaseDomain=="string"?n.modelsBaseDomain:Ve.modelsBaseDomain,modelsUseHttps:typeof n.modelsUseHttps=="boolean"?n.modelsUseHttps:Ve.modelsUseHttps}}function js(){var t;return typeof chrome<"u"&&!!((t=chrome.storage)!=null&&t.local)}function Pt(t){const n=t.trim().replace(/\/+$/,"");return n||"http://localhost:8080"}function Ms(){const[t,n]=s.useState(Ve),[r,p]=s.useState(!1);return s.useEffect(()=>{if(js()){chrome.storage.local.get(["envConfig"],i=>{const v=cn(i.envConfig);n(v),p(!0);const m=Pt(v.chatApiBaseUrl);ln(m),console.log("[Config] Extension mode, API base:",m)});const d=(i,v)=>{var m;if(v==="local"&&((m=i.envConfig)!=null&&m.newValue)){const g=cn(i.envConfig.newValue);n(g);const x=Pt(g.chatApiBaseUrl);ln(x),console.log("[Config] Updated API base:",x)}};return chrome.storage.onChanged.addListener(d),()=>chrome.storage.onChanged.removeListener(d)}else p(!0),console.log("[Config] Web mode, using relative URLs")},[]),{config:t,isLoaded:r}}function Es(){const[t,n]=s.useState([]),r=s.useRef([]),p=s.useCallback(m=>{if(!m.length)return;const g=[...r.current,...m];r.current=g,n(g)},[]),d=s.useCallback(()=>{r.current=[],n([])},[]),i=s.useCallback(m=>m.map(g=>`${g.role==="user"?"User":"Assistant"}: ${g.content}`).join(`

`),[]),v=s.useCallback((m,g)=>{if(g==="compare")return m;const x=m.filter(b=>b.role==="user"),f=[...m].reverse().find(b=>b.role==="assistant"&&(b.kind==="council_synthesis"||b.kind==="roundtable_synthesis")&&b.content.trim().length>0);return f?[...x,f]:x},[]);return{history:t,historyRef:r,pushHistoryEntries:p,clearHistory:d,historyToText:i,buildCarryoverHistory:v}}function Cs(t){const n=s.useRef({}),r=s.useRef(null),p=s.useCallback(()=>{r.current=null;const g=n.current;n.current={},Object.keys(g).length&&t(f=>f.map(b=>{const R=g[b.id];return R?{...b,response:(b.response||"")+R.answer,thinking:(b.thinking||"")+R.thinking}:b}))},[t]),d=s.useCallback(()=>{r.current==null&&(r.current=requestAnimationFrame(p))},[p]),i=s.useCallback((g,x,f)=>{if(!x&&!f)return;const b=n.current[g]||{answer:"",thinking:""};b.answer+=x,b.thinking+=f,n.current[g]=b,d()},[d]),v=s.useCallback(g=>{n.current[g]&&delete n.current[g]},[]),m=s.useCallback(()=>{n.current={},r.current!=null&&(cancelAnimationFrame(r.current),r.current=null)},[]);return{pendingStreamRef:n,flushStreamRafRef:r,enqueueStreamDelta:i,clearPendingStreamForModel:v,resetPendingStream:m}}function Ts(t){const{mode:n,moderator:r,selected:p,selectedCardIds:d,githubToken:i,isGenerating:v,summarizeSessionResponses:m,setLastQuery:g,setHoveredCard:x,setPhaseLabel:f,setModeratorSynthesis:b,setCouncilAggregateRankings:R,setCouncilAnonymousReviews:P,setDiscussionTurnsByModel:B,resetFailedModels:H,markModelFailed:V,failedModelsRef:c,currentDiscussionTurnRef:F,sessionModelIdsRef:G,abortControllerRef:Q,thinkingStateRef:U,conversationHistoryRef:j,pushHistoryEntries:ee,historyToText:ae,buildCarryoverHistory:ce,setModelsData:S,modelIdToName:q,setExecutionTimes:O,setIsGenerating:xe,setIsSynthesizing:se,setSpeaking:N,enqueueStreamDelta:re,clearPendingStreamForModel:oe,resetPendingStream:be}=t;return{sendMessage:async(te,fe,ve,Ae)=>{if(!te.trim()||p.length===0&&!ve||!ve&&v)return;const le=(Ae==null?void 0:Ae.skipHistory)??!1,We={role:"user",content:te},Ie=le?j.current:[...j.current,We];le||ee([We]);const $e=ce(Ie,n),je=ae($e);g(te);const l=je?`${je}

Continue the conversation above and respond to the latest user request.`:te;let ne;if(ve)ne=ve;else{const T=Array.from(d).filter(L=>p.includes(L)&&(n==="compare"||L!==r));ne=T.length>0?T:p.slice()}G.current=ne;const me={},ge=(T,L,A)=>{if(!L)return;const W=A!=null&&A.label?`${A.label}: ${L}`:L;me[T]=A!=null&&A.replace?W:me[T]?`${me[T]}

${W}`:W},ie=new AbortController;Q.current=ie,xe(!0),se(!1),x(null),f(null),b(""),R(null),P([]),B({}),H(),F.current=null,be(),S(T=>T.map(L=>ne.includes(L.id)||L.id===r?fe&&fe[L.id]?{...L,response:fe[L.id],thinking:void 0,error:void 0}:{...L,response:"",thinking:void 0,error:void 0}:L)),O(T=>{const L={...T},A=performance.now();return ne.forEach(W=>{L[W]={startTime:A}}),r&&!L[r]&&(L[r]={startTime:A}),L});const we=new Set(ne);r&&we.add(r),we.forEach(T=>{U.current[T]={inThink:!1,carry:""}});const ue=new Set,De=T=>T?T.replace(/_/g," ").replace(/\b\w/g,L=>L.toUpperCase()):"",Pe=T=>typeof T=="number"&&Number.isFinite(T)?`${Math.round(T*100)}%`:"â€”",Ye=T=>{if(!T)return"";const L=T.domain_weights||{},A=T.model_expertise_scores||{},W=Object.entries(L).sort((w,_)=>(_[1]??0)-(w[1]??0)).map(([w,_])=>`${De(w)} ${Pe(_)}`).join(", "),D=(ne.length>0?ne:Object.keys(A)).filter(Boolean).map(w=>`${q(w)} ${Pe(A[w])}`).join(", "),I=T.discussion_lead?q(T.discussion_lead):"â€”",y=T.expected_turns??2,h=(T.reasoning||"").trim(),M=[`ORCHESTRATOR â€¢ ${r?q(r):"Roundtable"}`];return W&&M.push(`Domains: ${W}`),M.push(`Lead: ${I}`),D&&M.push(`Participants: ${D}`),M.push(`Planned rounds: ${y}`),h&&(M.push(""),M.push(h)),M.join(`
`).trim()},Me=(T,L)=>{const A=T==null?void 0:T.trim();!A||le||ee([{role:"assistant",content:A,kind:L}])},Ee=(T,L)=>{const A=U.current[T]||{inThink:!1,carry:""};let W=A.carry+L;A.carry="";const $=W.lastIndexOf("<");if($!==-1&&W.length-$<8){const h=W.slice($);("<think>".startsWith(h)||"</think>".startsWith(h))&&(A.carry=h,W=W.slice(0,$))}let D="",I="",y=0;for(;y<W.length;)if(A.inThink){const h=W.indexOf("</think>",y);if(h===-1){D+=W.slice(y);break}D+=W.slice(y,h),A.inThink=!1,y=h+8}else{const h=W.indexOf("<think>",y);if(h===-1){I+=W.slice(y);break}I+=W.slice(y,h),A.inThink=!0,y=h+7}U.current[T]=A,I&&ge(T,I),(D||I)&&re(T,I,D)},Ne=T=>{const L=T.toLowerCase();return L.includes("rate limit")||L.includes("waiting")?'<svg width="14" height="14" viewBox="0 0 24 24" fill="none" style="display: inline-block; vertical-align: text-bottom; margin-right: 6px;"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none"/><path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>'+T:L.includes("error")||L.includes("failed")?'<svg width="14" height="14" viewBox="0 0 24 24" fill="none" style="display: inline-block; vertical-align: text-bottom; margin-right: 6px;"><path d="M12 2L2 20h20L12 2z" stroke="currentColor" stroke-width="2" fill="none" stroke-linejoin="round"/><path d="M12 9v4M12 17h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>'+T:T};try{if(n==="compare"){N(new Set(ne));const $=await bs({models:ne,messages:Ie.map(D=>({role:D.role,content:D.content})),max_tokens:st.maxTokens,temperature:st.temperature,github_token:i||null},ie.signal);if(await ft($,D=>{if(D.event==="info"&&D.content){const I=String(D.content),y=Ne(I);f(y),D.model_id&&S(h=>h.map(M=>M.id===D.model_id?{...M,statusMessage:y}:M))}if(D.event==="token"&&D.model_id){const I=D.model_id,y=performance.now();ue.has(I)||(ue.add(I),O(h=>({...h,[I]:{...h[I],firstTokenTime:y}})),S(h=>h.map(M=>M.id===I?{...M,statusMessage:void 0}:M))),Ee(I,String(D.content??""))}if(D.event==="done"&&D.model_id){const I=performance.now(),y=D.model_id;O(h=>({...h,[y]:{...h[y],endTime:I}})),N(h=>{const M=new Set(h);return M.delete(y),M})}}),!le){const D=m(me,ne);D&&ee([{role:"assistant",content:D,kind:"compare_summary"}])}return}if(n==="council"){const $=ne;if($.length<2){const w="Select at least 2 participants for Council mode.";b(w),r&&S(_=>_.map(u=>u.id===r?{...u,response:w}:u)),f("Error");return}N(new Set($));const D=ve&&$.length>0?$[0]:r||($.length>0?$[0]:null),I=await ys({query:l,participants:$,chairman_model:D,max_tokens:st.maxTokens,github_token:i||null,completed_responses:fe||null},ie.signal);let y="",h=0,M=0;if(await ft(I,w=>{const _=w.event;if(_==="stage1_start"&&f("Stage 1 Â· Responses"),_==="model_start"&&w.model_id){const u=w.model_id;N(Y=>{const X=new Set(Y);return X.add(u),X})}if(_==="model_chunk"&&w.model_id){const u=w.model_id,Y=performance.now();ue.has(u)||(ue.add(u),O(X=>({...X,[u]:{...X[u],firstTokenTime:Y}}))),Ee(u,String(w.chunk??""))}if(_==="model_response"&&w.model_id){const u=w.model_id,Y=performance.now();O(Z=>({...Z,[u]:{...Z[u],endTime:Y}})),N(Z=>{const de=new Set(Z);return de.delete(u),de});const X=String(w.response??"");ge(u,X,{replace:!0}),fe&&fe[u]||(S(Z=>Z.map(de=>de.id===u?{...de,response:X}:de)),Me(`${q(u)}:
${X}`,"council_turn"))}if(_==="model_error"&&w.model_id){const u=w.model_id,Y=performance.now();O(Z=>({...Z,[u]:{...Z[u],endTime:Y}})),N(Z=>{const de=new Set(Z);return de.delete(u),de});const X=String(w.error??"Error generating response.");oe(u),S(Z=>Z.map(de=>de.id===u?{...de,response:X,error:X}:de)),V(u),ge(u,X,{replace:!0})}if(_==="stage2_start"){const u=$.filter(Y=>!c.current.has(Y));h=u.length,M=0,P([]),f(`Stage 2 Â· Anonymous Review (0/${h})`),b(`Anonymous reviews in progress (0/${h})â€¦`),N(new Set(u))}if(_==="ranking_response"&&w.model_id){const u=w.model_id;N(X=>{const Z=new Set(X);return Z.delete(u),Z}),M+=1,f(`Stage 2 Â· Anonymous Review (${M}/${h||$.length})`),b(`Anonymous reviews in progress (${M}/${h||$.length})â€¦`);const Y=String(w.ranking??"");if(Y.trim()){const X=String(w.model_name??u);P(Z=>[...Z,{reviewer_model_id:u,reviewer_model_name:X,text:Y.trim()}])}}if(_==="ranking_error"&&w.model_id){const u=w.model_id;N(Z=>{const de=new Set(Z);return de.delete(u),de}),V(u),M+=1,f(`Stage 2 Â· Anonymous Review (${M}/${h||$.length})`),b(`Anonymous reviews in progress (${M}/${h||$.length})â€¦`);const Y=String(w.error??"Ranking error."),X=String(w.model_name??u);P(Z=>[...Z,{reviewer_model_id:u,reviewer_model_name:X,text:Y,error:!0}])}if(_==="stage2_complete"){const u=w.aggregate_rankings;if(u){R(u);const Y=u.map((X,Z)=>`${Z+1}. ${X.model_name} (avg: ${X.average_rank}, votes: ${X.votes_count})`).join(`
`);Me(`Anonymous Rankings:
${Y}`,"council_ranking")}}if(_==="chairman_quip"){const u=String(w.quip??"");b(u),D&&Me(`${q(D)}: ${u}`,"council_chairman")}if(_==="stage3_start"&&(f("Stage 3 Â· Synthesis"),se(!0),b(""),r&&N(new Set([r]))),_==="stage3_complete"||_==="stage3_error"){const u=String(w.response??w.error??"Synthesis error.");b(u),y=u,r&&(oe(r),S(Y=>Y.map(X=>X.id===r?{...X,response:u}:X)),ge(r,u,{replace:!0})),se(!1)}if(_==="council_complete"){f(null),se(!1),N(new Set);const u=w.aggregate_rankings;u&&R(u)}if(_==="error"){const u=String(w.error??w.message??"Council error.");b(u),r&&(oe(r),S(Y=>Y.map(X=>X.id===r?{...X,response:u}:X))),f("Error")}}),!le){const w=y.trim();w&&ee([{role:"assistant",content:w,kind:"council_synthesis"}])}return}if(n==="personality"){const $=ne;N(new Set($));const D=await ws({query:l,participants:$,max_tokens:512,github_token:i||null},ie.signal);await ft(D,I=>{const y=I.event;if(y==="personality_start"&&f("Generating Personas"),y==="model_start"&&I.model_id){const h=I.model_id;N(M=>{const w=new Set(M);return w.add(h),w})}if(y==="model_chunk"&&I.model_id){const h=I.model_id,M=performance.now();ue.has(h)||(ue.add(h),O(_=>({..._,[h]:{..._[h],firstTokenTime:M}})));const w=I.persona_info;w&&S(_=>_.map(u=>u.id===h?{...u,personaEmoji:w.persona_emoji||u.personaEmoji,personaName:w.persona_name||u.personaName,personaTrait:w.persona_trait||u.personaTrait}:u)),Ee(h,String(I.chunk??""))}if(y==="model_response"&&I.model_id){const h=I.model_id,M=performance.now();O(_e=>({..._e,[h]:{..._e[h],endTime:M}})),N(_e=>{const Re=new Set(_e);return Re.delete(h),Re});const w=String(I.response??""),_=String(I.persona_emoji??"ðŸŽ­"),u=String(I.persona_name??"Persona"),Y=String(I.persona_trait??"");ge(h,w,{replace:!0}),S(_e=>_e.map(Re=>Re.id===h?{...Re,response:w,personaEmoji:_,personaName:u,personaTrait:Y}:Re));const X=w.split(`
`),Z=X[0]||"",Xe=Z.includes("-")&&(Z.includes("**")||/^[^\w\s]/.test(Z))?X.slice(1).join(`
`).trim():w,he=`${_} **${u}** (${q(h)})${Y?` - ${Y}`:""}

${Xe}`;Me(he,"personality_response")}if(y==="model_error"&&I.model_id){const h=I.model_id,M=performance.now();O(_=>({..._,[h]:{..._[h],endTime:M}})),N(_=>{const u=new Set(_);return u.delete(h),u});const w=String(I.error??"Error generating persona.");oe(h),S(_=>_.map(u=>u.id===h?{...u,response:w,error:w}:u)),V(h)}if(y==="personality_complete"&&(f(null),N(new Set)),y==="error"){const h=String(I.error??"Personality mode error.");f("Error"),b(h)}});return}const T=ne;if(T.length<2){const $="Select at least 2 participants for Roundtable mode.";b($),r&&S(D=>D.map(I=>I.id===r?{...I,response:$}:I)),f("Error");return}r&&N(new Set([r]));const L=await vs({query:l,max_tokens:st.maxTokens,temperature:st.temperature,orchestrator_model:r||null,github_token:i||null,participants:T,turns:2},ie.signal);let A=0,W="";if(await ft(L,$=>{var I;const D=$.event;if(D==="analysis_start"&&(f("Analyzing Query"),r&&N(new Set([r]))),D==="analysis_complete"){f("Orchestrating"),N(new Set);let y="Analysis complete.";if($.analysis){const h=$.analysis,M=Ye(h);M&&(y=M)}b(y),r&&S(h=>h.map(M=>M.id===r?{...M,response:y}:M)),Me(y,"roundtable_analysis")}if(D==="turn_start"){const y=$.turn_number;typeof y=="number"&&(A=y),f(`Round ${A+1}`);const h=$.model_id;h&&N(new Set([h]))}if(D==="turn_chunk"&&$.model_id){const y=$.model_id,h=performance.now();ue.has(y)||(ue.add(y),O(M=>({...M,[y]:{...M[y],firstTokenTime:h}}))),((I=F.current)==null?void 0:I.modelId)!==y&&(F.current={modelId:y,turnNumber:A}),Ee(y,String($.chunk??""))}if(D==="turn_complete"){const y=$.turn,h=y==null?void 0:y.model_id;if(!h)return;const M=performance.now();O(u=>({...u,[h]:{...u[h],endTime:M}}));const w=String((y==null?void 0:y.response)??"");B(u=>{const Y=u[h]||[];return{...u,[h]:[...Y,{turn_number:A,response:w}]}}),S(u=>u.map(Y=>Y.id===h?{...Y,response:w}:Y)),N(u=>{const Y=new Set(u);return Y.delete(h),Y}),ge(h,w,{label:`Round ${A+1}`});const _=q(h);Me(`${_} Â· Round ${A+1}
${w}`,"roundtable_turn")}if(D==="turn_error"&&$.model_id){const y=$.model_id,h=performance.now();O(w=>({...w,[y]:{...w[y],endTime:h}}));const M=String($.error??"Error generating response.");oe(y),S(w=>w.map(_=>_.id===y?{..._,response:M,error:M}:_)),N(w=>{const _=new Set(w);return _.delete(y),_}),V(y),ge(y,M,{replace:!0}),Me(`${q(y)} Â· Round ${A+1}
${M}`,"roundtable_turn")}if(D==="synthesis_start"&&(f("Synthesis"),se(!0),r&&N(new Set([r]))),D==="discussion_complete"){const y=String($.final_response??"");b(y),W=y,r&&(oe(r),S(h=>h.map(M=>M.id===r?{...M,response:y}:M)),ge(r,y,{replace:!0})),f(null),se(!1),N(new Set)}if(D==="error"){const y=String($.error??$.message??"Discussion error.");b(y),r&&(oe(r),S(h=>h.map(M=>M.id===r?{...M,response:y}:M))),f("Error"),se(!1),N(new Set)}}),!le){const $=W.trim();$&&ee([{role:"assistant",content:$,kind:"roundtable_synthesis"}])}}catch(T){if(T.name==="AbortError")return;if(console.error("Chat error:",T),Q.current===ie){const L=T.message||String(T);b(`Session Error: ${L}`),f("Error"),be(),S(A=>A.map(W=>ne.includes(W.id)&&!W.response?{...W,response:"Error generating response."}:W)),ne.forEach(A=>V(A))}}finally{if(Q.current===ie){const T=performance.now();O(L=>{const A={...L};return G.current.forEach(W=>{A[W]&&!A[W].endTime&&(A[W]={...A[W],endTime:T})}),A}),xe(!1),se(!1),f(L=>L==="Error"?L:null),N(new Set)}}}}}function $t(t,n){const r=Math.min(t.x,n.x),p=Math.min(t.y,n.y),d=Math.max(t.x,n.x),i=Math.max(t.y,n.y);return{left:r,top:p,right:d,bottom:i,width:d-r,height:i-p}}function Ns({rootContainerRef:t,visualizationAreaRef:n,arenaOffsetYRef:r,arenaTargetYRef:p,wheelRafRef:d,selectedModels:i,cardRefs:v,selectedCardIds:m,setSelectedCardIds:g,suppressClickRef:x}){const[f,b]=s.useState(null),R=s.useRef(!1);s.useEffect(()=>{R.current=f!=null},[f]),s.useEffect(()=>{const H=V=>{if(V.button!==0||!t.current)return;const c=V.target;if(!c)return;const F=c.closest("[data-card]"),G=c.closest('button, a, input, textarea, select, [role="button"]'),Q=c.closest("[draggable]"),U=c.closest("[data-no-arena-scroll]");if(F||G||Q||U||!t.current.contains(c))return;p.current=r.current,d.current!=null&&(cancelAnimationFrame(d.current),d.current=null);const j=t.current.getBoundingClientRect(),ee={x:V.clientX-j.left,y:V.clientY-j.top};V.preventDefault(),R.current=!0,x.current.card=!1,x.current.background=!1,b({origin:ee,current:ee,active:!1})};return window.addEventListener("mousedown",H,!0),()=>window.removeEventListener("mousedown",H,!0)},[r,p,d,t,n,x]),s.useEffect(()=>{if(!f||!t.current)return;const H=F=>F.preventDefault();document.addEventListener("selectstart",H);const V=F=>{const G=t.current.getBoundingClientRect(),Q={x:F.clientX-G.left,y:F.clientY-G.top};b(U=>{if(!U)return U;const j=$t(U.origin,Q),ee=U.active||j.width>4||j.height>4;return{...U,current:Q,active:ee}})},c=F=>{R.current=!1;const G=t.current.getBoundingClientRect(),Q={x:F.clientX-G.left,y:F.clientY-G.top},U=F.target,j=!!(U&&U.closest("[data-card]"));b(ee=>{if(!ee)return null;const ae=$t(ee.origin,Q);if(ee.active&&ae.width>0&&ae.height>0){const ce=[],S=t.current.getBoundingClientRect(),q={left:S.left+ae.left,right:S.left+ae.right,top:S.top+ae.top,bottom:S.top+ae.bottom};for(const O of i){const xe=v.current.get(O.id);if(!xe)continue;const se=xe.getBoundingClientRect();!(se.right<q.left||se.left>q.right||se.bottom<q.top||se.top>q.bottom)&&ce.push(O.id)}g(new Set(ce)),j?x.current.card=!0:ce.length>0&&(x.current.background=!0)}return null})};return window.addEventListener("mousemove",V),window.addEventListener("mouseup",c),()=>{window.removeEventListener("mousemove",V),window.removeEventListener("mouseup",c),document.removeEventListener("selectstart",H)}},[f,t,n,i,v,m,g,x]);const P=s.useMemo(()=>{if(!f||!f.active)return null;const H=$t(f.origin,f.current);return H.width<=0||H.height<=0?null:{left:H.left,top:H.top,width:H.width,height:H.height}},[f]),B=s.useCallback(()=>{b(null),R.current=!1},[]);return{selectionRect:P,isSelecting:f!=null,dragSelectionActiveRef:R,clearSelection:B}}function _s({visualizationAreaRef:t,cardRefs:n,selected:r,setSelected:p,mode:d,gridCols:i,getCirclePosition:v}){const[m,g]=s.useState(null),x=s.useCallback((f,b)=>{if(f.button!==0||f.target.closest('button, a, input, textarea, select, [role="button"]'))return;f.preventDefault();const P=n.current.get(b);if(!P||!t.current)return;const B=P.getBoundingClientRect(),H=t.current.getBoundingClientRect(),V=B.left+B.width/2,c=B.top+B.height/2;g({activeId:b,currX:f.clientX,currY:f.clientY,offsetX:V-f.clientX,offsetY:c-f.clientY,containerLeft:H.left,containerTop:H.top,containerWidth:H.width,containerHeight:H.height,cardHeight:B.height}),f.target.setPointerCapture(f.pointerId)},[t]);return s.useEffect(()=>{if(!m)return;const f=R=>{if(g(c=>c?{...c,currX:R.clientX,currY:R.clientY}:null),!t.current)return;const P=t.current.getBoundingClientRect(),B=r.indexOf(m.activeId);let H=1/0,V=-1;if(d==="compare"){const c=R.clientX-(P.left+P.width/2),F=R.clientY-P.top,G=(pe.cardWidth+pe.gapX)*i-pe.gapX;r.forEach((Q,U)=>{const j=Math.floor(U/i),ae=U%i*(pe.cardWidth+pe.gapX)-G/2+pe.cardWidth/2,ce=j*(pe.cardHeight+pe.gapY),S=ae,q=ce+pe.cardHeight/2,O=(c-S)**2+(F-q)**2;O<H&&(H=O,V=U)})}else{const c=R.clientX-(P.left+P.width/2),F=R.clientY-(P.top+P.height/2),G=Math.max(pe.baseRadius,pe.minRadius+r.length*pe.radiusPerModel);r.forEach((Q,U)=>{const j=v(U,r.length,d,G),ee=(c-j.x)**2+(F-j.y)**2;ee<H&&(H=ee,V=U)})}if(V!==-1&&V!==B){const c=[...r],[F]=c.splice(B,1);c.splice(V,0,F),p(c)}},b=()=>g(null);return window.addEventListener("pointermove",f),window.addEventListener("pointerup",b),()=>{window.removeEventListener("pointermove",f),window.removeEventListener("pointerup",b)}},[m,t,n,r,p,d,i,v]),{dragState:m,handlePointerDown:x}}const Rs={autoMode:!0,autoModeScope:"local",selectedModelId:null};function Ls(t,n){switch(n.type){case"SET_AUTO_MODE":return{...t,autoMode:n.payload};case"SET_AUTO_MODE_SCOPE":return{...t,autoMode:!0,autoModeScope:n.payload};case"SELECT_MODEL":return{...t,selectedModelId:n.payload};default:return t}}function As(t){const[n,r]=s.useReducer(Ls,{...Rs,...t});return{autoMode:n.autoMode,autoModeScope:n.autoModeScope,selectedModelId:n.selectedModelId,setAutoMode:p=>r({type:"SET_AUTO_MODE",payload:p}),setAutoModeScope:p=>r({type:"SET_AUTO_MODE_SCOPE",payload:p}),selectModel:p=>r({type:"SELECT_MODEL",payload:p})}}const Te=(t,n)=>!t||!t.startsWith("#")?t:t.length===7||t.length===4?`${t}${n}`:t,Is={idle:"Ready",responding:"Responding",done:"Done",waiting:"Waiting",error:"Error"};function Dt({state:t,color:n,size:r=16,label:p,className:d=""}){const i={width:`${r}px`,height:`${r}px`},v=p??Is[t],m=Math.max(2,Math.round(r*.14)),g=Math.max(12,r-2),x="#fbbf24",f=Te(n,"cc"),b=()=>{switch(t){case"responding":return e.jsx("div",{className:"relative flex items-center justify-center",style:i,children:e.jsxs("svg",{width:g,height:g,viewBox:"0 0 24 24",fill:"none",className:"",style:{filter:`drop-shadow(0 0 6px ${Te(x,"55")})`,animation:"spin 0.6s linear infinite"},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"spinnerGradient",gradientUnits:"userSpaceOnUse",x1:"3",y1:"12",x2:"12",y2:"3",children:[e.jsx("stop",{offset:"0%",stopColor:x,stopOpacity:"1"}),e.jsx("stop",{offset:"60%",stopColor:x,stopOpacity:"0.5"}),e.jsx("stop",{offset:"100%",stopColor:x,stopOpacity:"0"})]})}),e.jsx("circle",{cx:"12",cy:"12",r:"9",stroke:Te(x,"15"),strokeWidth:m,fill:"none"}),e.jsx("path",{d:"M 12 3 A 9 9 0 1 1 3 12",stroke:"url(#spinnerGradient)",strokeWidth:m,strokeLinecap:"round",fill:"none"}),e.jsx("circle",{cx:"3",cy:"12",r:m*.7,fill:x})]})});case"done":return e.jsx("div",{className:"flex items-center justify-center rounded-full",style:{...i,background:Te(n,"14"),border:`1px solid ${Te(n,"99")}`},children:e.jsx("svg",{width:g,height:g,viewBox:"0 0 24 24",fill:"none",children:e.jsx("polyline",{points:"5 13 10 18 19 7",stroke:n,strokeWidth:m,strokeLinecap:"round",strokeLinejoin:"round"})})});case"error":const R="#ef4444";return e.jsx("div",{className:"flex items-center justify-center rounded-full",style:{...i,background:Te(R,"14"),border:`1px solid ${Te(R,"99")}`},children:e.jsx("svg",{width:g,height:g,viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M6 6L18 18M6 18L18 6",stroke:R,strokeWidth:m,strokeLinecap:"round",strokeLinejoin:"round"})})});case"waiting":return e.jsxs("div",{className:"relative flex items-center justify-center",style:i,children:[e.jsx("div",{className:"absolute inset-0 rounded-full",style:{border:`1px solid ${Te(f,"99")}`}}),e.jsx("svg",{width:g,height:g,viewBox:"0 0 24 24",fill:"none",style:{animation:"spin 5s linear infinite"},children:e.jsx("circle",{cx:"12",cy:"12",r:"8.5",stroke:Te(f,"44"),strokeWidth:m-1,strokeDasharray:"6 10",strokeLinecap:"round"})}),e.jsx("div",{className:"absolute w-2 h-2 rounded-full",style:{background:Te(f,"aa"),animation:"pulse 1.5s ease-in-out infinite"}})]});default:return e.jsxs("div",{className:"relative flex items-center justify-center",style:i,children:[e.jsx("div",{className:"absolute inset-0 rounded-full",style:{border:"1px solid rgba(71, 85, 105, 0.5)"}}),e.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:"rgba(148, 163, 184, 0.6)",animation:"pulse 2.4s ease-in-out infinite"}})]})}};return e.jsx("div",{className:`inline-flex items-center justify-center ${d}`,title:v,children:b()})}function un({times:t}){const n=(t==null?void 0:t.startTime)!=null,r=(t==null?void 0:t.endTime)!=null,p=(t==null?void 0:t.firstTokenTime)!=null,d=n&&r?((t.endTime-t.startTime)/1e3).toFixed(2):null,i=n&&p?((t.firstTokenTime-t.startTime)/1e3).toFixed(2):null;return e.jsxs("div",{className:"text-[10px] text-slate-500",children:[e.jsx("span",{className:"text-slate-400",children:"TIME"})," ",d?`${d}s`:n&&!r?"...":"â€”",i&&e.jsxs("span",{className:"ml-2 text-slate-600",children:["TTFT ",i,"s"]})]})}const Ot=({text:t,speed:n=5})=>{const[r,p]=s.useState(""),d=s.useRef(0),i=s.useRef(null);return s.useEffect(()=>{!t.startsWith(r)&&r!==""&&(p(""),d.current=0)},[t]),s.useEffect(()=>{i.current!=null&&(clearTimeout(i.current),i.current=null);const v=t.length;if(d.current>=v)return;const m=()=>{const g=d.current,x=v-g;if(x<=0)return;const f=x>120?12:x>40?4:x>10?2:1,b=Math.min(v,g+f);d.current=b,p(t.slice(0,b));const P=v-b>5?0:n;i.current=window.setTimeout(m,P)};return i.current=window.setTimeout(m,n),()=>{i.current!=null&&(clearTimeout(i.current),i.current=null)}},[t,n]),e.jsx("span",{children:r})},ht=256,pn=200,Ke=96;function $s(t){const{mode:n,selectedModels:r,gridCols:p,speaking:d,selectedCardIds:i,setSelectedCardIds:v,executionTimes:m,failedModels:g,cardRefs:x,handlePointerDown:f,dragState:b,setContextMenu:R,suppressClickRef:P,getTailSnippet:B,hoveredCard:H,setHoveredCard:V,layoutRadius:c,getCirclePosition:F,moderatorModel:G,moderatorId:Q,orchestratorTransform:U,orchestratorStatus:j,orchestratorPhaseLabel:ee,moderatorSynthesis:ae,isSynthesizing:ce,isGenerating:S,phaseLabel:q,linesTransitioning:O,lastSelectedCardRef:xe,orchestratorAutoMode:se,orchestratorAutoScope:N,showOrchestratorMenu:re,setShowOrchestratorMenu:oe,setOrchestratorAutoMode:be,setOrchestratorAutoScope:ye,orchestratorMenuRef:te,availableModels:fe,setModerator:ve,councilWinnerId:Ae}=t,le=n!=="compare",We=n==="council"?c-64:0,Ie=j==="responding"?"Responding":j==="waiting"?"Waiting":j==="done"?"Done":"Ready",[$e,je]=s.useState(null);return s.useEffect(()=>{if(!re)return;const l=ne=>{te.current&&!te.current.contains(ne.target)&&(oe(!1),je(null))};return document.addEventListener("mousedown",l,!0),()=>document.removeEventListener("mousedown",l,!0)},[re,te,oe]),e.jsxs(e.Fragment,{children:[r.map((l,ne)=>{var Xe;const me=F(ne,r.length,n,c),ge=Ds(ne,p),ie=d.has(l.id),we=i.has(l.id),ue=g.has(l.id),De=!ie&&!ue&&!!((Xe=m[l.id])!=null&&Xe.endTime)&&l.response.trim().length>0,Pe=!ie&&!De&&!ue&&S&&n==="roundtable",Ye=ue?"error":ie?"responding":De?"done":Pe?"waiting":"idle",Me=ue?"Error":ie?"Responding":De?"Done":Pe?"Waiting":"Ready",Ee="#fbbf24",Ne="#ef4444",T=l.type==="self-hosted"?"#10b981":"#3b82f6",L=ue?Ne:T,A=ie&&!ue,W="rgba(30, 41, 59, 0.85)",$=ue?`linear-gradient(135deg, ${Ne}14, ${W})`:A?`linear-gradient(135deg, ${Ee}14, ${W})`:W,D=ue?`1px solid ${Ne}99`:A?`1px solid ${Ee}99`:we?`1px solid ${T}d0`:"1px solid rgba(71, 85, 105, 0.5)",I=ue?`0 0 24px ${Ne}33, inset 0 1px 1px rgba(255,255,255,0.1)`:A?`0 0 24px ${Ee}33, inset 0 1px 1px rgba(255,255,255,0.1)`:we?`0 0 20px ${T}30, inset 0 1px 1px rgba(255,255,255,0.1)`:"0 4px 20px rgba(0,0,0,0.3), inset 0 1px 1px rgba(255,255,255,0.05)",y=Ps({mode:n,gridX:ge.gridX,gridY:ge.gridY,circleX:me.x,circleY:me.y,dragState:b,modelId:l.id}),h=H===l.id,M=le?Ke:ht,w=le?Ke:pn,_=Math.max(800,c*2+600),u=_/2,Y=u,X=u,Z=u+(0-me.x),de=u+(We-me.y);return e.jsxs("div",{ref:he=>{he?x.current.set(l.id,he):x.current.delete(l.id)},onPointerDown:he=>f(he,l.id),className:"absolute",onContextMenu:he=>{he.preventDefault(),he.stopPropagation(),R({x:he.clientX,y:he.clientY,modelId:l.id})},style:{transform:y,zIndex:le?h?300:we?40:ie?15:5:we?20:ie?10:1,left:"50%",top:le?"50%":"0",transition:(b==null?void 0:b.activeId)===l.id?"none":"transform 300ms cubic-bezier(0.2, 0, 0.2, 1)"},children:[le&&ie&&!ue&&!O&&e.jsxs("svg",{className:"absolute pointer-events-none",style:{width:`${_}px`,height:`${_}px`,top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:-1},viewBox:`0 0 ${_} ${_}`,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:`grad-${l.id}`,gradientUnits:"userSpaceOnUse",x1:Y,y1:X,x2:Z,y2:de,children:[e.jsx("stop",{offset:"0%",stopColor:Ee,stopOpacity:"0.45"}),e.jsx("stop",{offset:"100%",stopColor:Ee,stopOpacity:"0.12"})]})}),e.jsx("line",{x1:Y,y1:X,x2:Z,y2:de,stroke:`url(#grad-${l.id})`,strokeWidth:"2",strokeDasharray:"6,4",strokeLinecap:"round",className:"animate-flow arena-link"})]}),e.jsxs("div",{"data-card":!0,onClick:he=>Os({e:he,modelId:l.id,suppressClickRef:P,setSelectedCardIds:v,selectedModels:r,lastSelectedCardRef:xe}),onMouseEnter:()=>le&&V(l.id),onMouseLeave:()=>le&&V(null),className:`relative cursor-grab active:cursor-grabbing card-hover ${le?"rounded-full":""} ${we?"card-selected":""} ${ie?"card-speaking":""}`,style:{background:$,backdropFilter:le?void 0:"blur(8px)",WebkitBackdropFilter:le?void 0:"blur(8px)",border:D,boxShadow:I,transform:we||A?"scale(1.05)":"scale(1)",width:`${M}px`,height:`${w}px`,borderRadius:le?"50%":"12px",transition:"transform 180ms ease-out, box-shadow 180ms ease-out, border-color 180ms ease-out, width 0.7s cubic-bezier(0.4, 0, 0.2, 1), height 0.7s cubic-bezier(0.4, 0, 0.2, 1), border-radius 0.7s cubic-bezier(0.4, 0, 0.2, 1)"},children:[!le&&e.jsxs("div",{style:Ws,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3 gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5 min-w-0",children:[e.jsx(Dt,{state:Ye,color:L,size:16,label:Me}),e.jsx("span",{className:"text-xs font-semibold text-slate-200 truncate",children:l.name})]}),e.jsx("div",{className:"flex items-center gap-1.5 shrink-0",children:e.jsx("span",{className:`text-[9px] uppercase tracking-wider px-1.5 py-0.5 rounded ${l.type==="self-hosted"?"bg-emerald-500/10 text-emerald-300 border border-emerald-500/30":"bg-blue-500/10 text-blue-300 border border-blue-500/30"}`,children:l.type==="self-hosted"?"Local":"API"})})]}),e.jsx("p",{className:"text-xs text-slate-400 leading-relaxed line-clamp-3 flex-1",children:Bs({model:l,isSpeaking:ie,thinkingFallback:e.jsx("span",{className:"text-slate-500 italic",children:"Thinkingâ€¦"}),getTailSnippet:B})}),e.jsx("div",{className:"flex items-center gap-4 mt-3 pt-3 border-t border-slate-700/50",children:e.jsx(un,{times:m[l.id]})})]}),le&&e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center text-center",style:{transition:"opacity 0.3s ease-out"},children:[e.jsx("div",{className:"absolute inset-[3px] rounded-full border border-white/5",style:{boxShadow:`inset 0 0 20px ${L}15`}}),e.jsx("div",{className:"absolute inset-[-6px] rounded-full opacity-60",style:{background:`radial-gradient(circle, ${L}22 0%, transparent 65%)`,filter:"blur(10px)"}}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center gap-1.5 px-3",children:[e.jsx("div",{className:"text-[7px] tracking-[0.32em] text-slate-400 uppercase",children:Me}),e.jsx("div",{className:"text-[10px] font-semibold text-slate-100 leading-tight",children:l.name}),e.jsx(Dt,{state:Ye,color:L,size:12})]})]})]}),n==="personality"&&le&&l.personaEmoji&&e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 flex items-center justify-center pointer-events-none select-none",style:{bottom:"-12px",fontSize:"20px",zIndex:100,transition:"transform 180ms ease-out",transform:ie?"scale(1.15)":"scale(1)",filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.5)) drop-shadow(0 0 8px rgba(0,0,0,0.3))"},title:l.personaName?`${l.personaName} - ${l.personaTrait}`:"Persona",children:l.personaEmoji}),n==="council"&&le&&Ae===l.id&&!S&&!ce&&e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 flex items-center justify-center pointer-events-none select-none",style:{bottom:"-12px",fontSize:"20px",zIndex:100,filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.5)) drop-shadow(0 0 12px rgba(251, 191, 36, 0.4))",animation:"pulse 2s ease-in-out infinite"},title:"Top Ranked Response",children:"ðŸ†"}),le&&H===l.id&&e.jsxs("div",{"data-card":!0,onClick:he=>he.stopPropagation(),className:"absolute w-64 max-w-[calc(100vw-2rem)] p-4 rounded-xl transition-all duration-300 z-[220]",style:{top:me.y>0?"auto":"100%",bottom:me.y>0?"100%":"auto",left:"50%",transform:"translateX(-50%)",marginTop:me.y>0?0:"12px",marginBottom:me.y>0?"12px":0,background:"rgba(15, 23, 42, 0.95)",backdropFilter:"blur(16px)",border:`1px solid ${L}40`,boxShadow:`0 20px 40px rgba(0,0,0,0.5), 0 0 20px ${L}15`},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:L}}),e.jsx("span",{className:"text-xs font-semibold text-slate-300",children:l.name})]}),n==="personality"&&l.personaEmoji&&l.personaName&&e.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-2 border-b border-slate-700/50",children:[e.jsx("span",{className:"text-base",children:l.personaEmoji}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs font-semibold text-blue-400",children:l.personaName}),l.personaTrait&&e.jsx("div",{className:"text-[10px] text-slate-500",children:l.personaTrait})]})]}),e.jsx("p",{className:"text-xs text-slate-400 leading-relaxed whitespace-pre-wrap",children:zs({model:l,isSpeaking:ie,getTailSnippet:B})}),e.jsx("div",{className:"flex items-center gap-4 mt-3 pt-2 border-t border-slate-700/50",children:e.jsx(un,{times:m[l.id]})})]})]},l.id)}),n!=="compare"&&G&&e.jsxs("div",{"data-card":!0,className:"absolute z-20 transition-all duration-700 ease-out cursor-pointer",style:{opacity:1,transform:U,left:"50%",top:n==="council"?`calc(50% + ${c}px - 64px)`:"50%"},onClick:l=>{l.stopPropagation(),Q&&(v(new Set([Q])),xe.current=Q)},onContextMenu:l=>{l.preventDefault(),l.stopPropagation(),re?(oe(!1),je(null)):(je({x:l.clientX,y:l.clientY}),oe(!0))},onMouseEnter:()=>V("moderator"),onMouseLeave:()=>V(null),children:[e.jsx("div",{className:"relative flex items-center justify-center",style:{width:`${Ke}px`,height:`${Ke}px`},children:(()=>{const l=j==="responding",ne=l?"#fbbf24":G.color;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0 rounded-full animate-pulse",style:{background:`radial-gradient(circle, ${ne}20 0%, transparent 70%)`,transform:"scale(2.2)",filter:"blur(18px)"}}),e.jsxs("div",{className:"relative rounded-full flex items-center justify-center transition-all duration-300",style:{width:`${Ke}px`,height:`${Ke}px`,background:l?"linear-gradient(135deg, rgba(251, 191, 36, 0.08), rgba(15, 23, 42, 0.9))":"rgba(15, 23, 42, 0.9)",backdropFilter:"blur(16px)",border:`2px solid ${ne}${l?"99":"60"}`,boxShadow:`0 0 36px ${ne}${l?"40":"28"}, inset 0 1px 1px rgba(255,255,255,0.1)`},children:[e.jsx("div",{className:"absolute inset-[-4px] rounded-full",style:{background:`conic-gradient(from 0deg, transparent, ${ne}60, transparent)`,animation:"spin 4s linear infinite"}}),e.jsx("div",{className:"absolute inset-[2px] rounded-full",style:{background:"rgba(15, 23, 42, 0.96)"}}),e.jsxs("div",{className:"relative text-center z-10 flex flex-col items-center gap-1.5 px-3",children:[e.jsx("div",{className:"text-[7px] tracking-[0.32em] text-slate-400 uppercase",children:Ie}),e.jsx("div",{className:"text-[10px] font-semibold text-slate-100 leading-tight",children:G.name}),e.jsx(Dt,{state:j,color:ne,size:12})]})]})]})})()}),e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 flex flex-col items-center gap-1 w-max max-w-[200px]",style:{top:"calc(100% + 12px)"},children:e.jsx("span",{className:"text-[10px] text-slate-500",children:ee})}),H==="moderator"&&!re&&(()=>{const l=j==="responding",ne=l?"#fbbf24":G.color;return e.jsxs("div",{"data-card":!0,onClick:me=>me.stopPropagation(),className:"absolute bottom-full mb-4 left-1/2 -translate-x-1/2 w-80 max-w-[calc(100vw-2rem)] p-4 rounded-xl z-[200] transition-all duration-300",style:{background:"rgba(15, 23, 42, 0.95)",backdropFilter:"blur(16px)",border:`1px solid ${ne}40`,boxShadow:`0 20px 40px rgba(0,0,0,0.5), 0 0 30px ${ne}20`},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"text-xs text-slate-400 uppercase tracking-wider",children:"Orchestrator"}),e.jsx("span",{className:"text-xs text-slate-500",children:"Â·"}),e.jsx("span",{className:"text-xs font-medium text-slate-300",children:G.name}),l&&e.jsx("span",{className:"text-[9px] uppercase tracking-wider px-1.5 py-0.5 rounded bg-yellow-500/20 text-yellow-300 border border-yellow-500/30",children:"Working"})]}),e.jsx("p",{className:"text-sm text-slate-300 leading-relaxed",children:Hs({moderatorSynthesis:ae,isSynthesizing:ce,moderatorId:Q,speaking:d,phaseLabel:q,isGenerating:S,getTailSnippet:B})})]})})(),re&&$e&&Fn.createPortal(e.jsx("div",{ref:te,className:"w-64 bg-slate-800 border border-slate-700 rounded-lg shadow-xl overflow-hidden",style:{position:"fixed",top:`${$e.y}px`,left:`${$e.x}px`,transform:"translateY(-50%)",zIndex:9999},onClick:l=>l.stopPropagation(),children:se?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-3 py-2 text-[10px] uppercase tracking-wider text-slate-500 font-semibold border-b border-slate-700/50",children:["Auto Mode: ",N.toUpperCase()]}),["all","local","api"].map(l=>e.jsxs("button",{onClick:()=>{ye(l),oe(!1)},className:`w-full px-3 py-2 text-left text-xs font-medium transition-colors ${N===l?"bg-yellow-500/20 text-yellow-300":"text-slate-300 hover:bg-slate-700/50"}`,children:[l==="all"&&"All",l==="local"&&"Local",l==="api"&&"API",e.jsxs("span",{className:"text-[10px] text-slate-500 ml-1",children:[l==="all"&&"(local â†’ API)",l==="local"&&"(no quota)",l==="api"&&"(cloud only)"]})]},l)),e.jsx("div",{className:"border-t border-slate-700",children:e.jsx("button",{onClick:()=>{be(!1),oe(!1)},className:"w-full px-3 py-2 text-left text-xs font-medium text-slate-400 hover:bg-slate-700/50 transition-colors",children:"Manual Mode"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-3 py-2 text-[10px] uppercase tracking-wider text-slate-500 font-semibold border-b border-slate-700/50",children:"Select Orchestrator"}),fe.filter(l=>l.type==="github"||l.type==="external").length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-3 py-1.5 text-[9px] uppercase tracking-wider text-slate-600 font-semibold",children:"GitHub Models"}),fe.filter(l=>l.type==="github"||l.type==="external").map(l=>e.jsx("button",{onClick:()=>{ve(l.id),oe(!1)},className:`w-full px-4 py-2 text-left text-xs font-medium transition-colors ${Q===l.id?"bg-blue-500/20 text-blue-300":"text-slate-300 hover:bg-slate-700/50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:l.name}),Q===l.id&&e.jsx("span",{className:"text-blue-400",children:"âœ“"})]})},l.id))]}),fe.filter(l=>l.type==="self-hosted").length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-3 py-1.5 text-[9px] uppercase tracking-wider text-slate-600 font-semibold border-t border-slate-700/50 mt-1",children:"Self-Hosted Models"}),fe.filter(l=>l.type==="self-hosted").map(l=>e.jsx("button",{onClick:()=>{ve(l.id),oe(!1)},className:`w-full px-4 py-2 text-left text-xs font-medium transition-colors ${Q===l.id?"bg-blue-500/20 text-blue-300":"text-slate-300 hover:bg-slate-700/50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:l.name}),Q===l.id&&e.jsx("span",{className:"text-blue-400",children:"âœ“"})]})},l.id))]}),e.jsx("div",{className:"border-t border-slate-700",children:e.jsxs("button",{onClick:()=>{be(!0),oe(!1)},className:"w-full px-3 py-2 text-left text-xs font-medium text-yellow-400 hover:bg-slate-700/50 transition-colors flex items-center gap-2",children:[e.jsx(Gn,{size:12}),e.jsx("span",{children:"Enable Auto Mode"})]})})]})}),document.body)]}),n!=="compare"&&e.jsxs("svg",{className:"absolute pointer-events-none transition-opacity duration-700",style:{width:"1000px",height:"1000px",opacity:.2},children:[e.jsx("circle",{cx:"500",cy:"500",r:c,fill:"none",stroke:"url(#circleGrad)",strokeWidth:"1",strokeDasharray:"8,4"}),e.jsx("defs",{children:e.jsxs("linearGradient",{id:"circleGrad",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#3b82f6"}),e.jsx("stop",{offset:"50%",stopColor:"#8b5cf6"}),e.jsx("stop",{offset:"100%",stopColor:"#3b82f6"})]})})]})]})}function Ds(t,n){const r=Math.floor(t/n),p=t%n,d=(ht+pe.gapX)*n-pe.gapX,i=r*(pn+pe.gapY);return{gridX:p*(ht+pe.gapX)-d/2+ht/2,gridY:i}}function Ps({mode:t,gridX:n,gridY:r,circleX:p,circleY:d,dragState:i,modelId:v}){if((i==null?void 0:i.activeId)===v){const m=i.currX+i.offsetX,g=i.currY+i.offsetY;if(t==="compare"){const b=m-(i.containerLeft+i.containerWidth/2),R=g-i.containerTop-i.cardHeight/2;return`translate(calc(-50% + ${b}px), ${R}px)`}const x=m-(i.containerLeft+i.containerWidth/2),f=g-(i.containerTop+i.containerHeight/2);return`translate(calc(-50% + ${x}px), calc(-50% + ${f}px))`}return t==="compare"?`translate(calc(-50% + ${n}px), ${r}px)`:`translate(calc(-50% + ${p}px), calc(-50% + ${d}px))`}function Os({e:t,modelId:n,suppressClickRef:r,setSelectedCardIds:p,selectedModels:d,lastSelectedCardRef:i}){if(t.stopPropagation(),r.current.card){r.current.card=!1;return}const v=t.shiftKey,m=t.metaKey||t.ctrlKey;if(v&&i.current){const g=d.findIndex(f=>f.id===i.current),x=d.findIndex(f=>f.id===n);if(g!==-1&&x!==-1){const f=Math.min(g,x),b=Math.max(g,x),R=d.slice(f,b+1).map(P=>P.id);p(P=>{const B=new Set(P);return R.forEach(H=>B.add(H)),B})}}else m?(p(g=>{const x=new Set(g);return x.has(n)?x.delete(n):x.add(n),x}),i.current=n):(p(new Set([n])),i.current=n)}function Bs({model:t,isSpeaking:n,thinkingFallback:r,getTailSnippet:p}){return t.statusMessage?t.statusMessage.startsWith("<svg")?e.jsx("span",{dangerouslySetInnerHTML:{__html:t.statusMessage}}):t.statusMessage:n?t.response.trim().length>0?t.response.startsWith("<svg")?e.jsx("span",{dangerouslySetInnerHTML:{__html:t.response}}):e.jsx(Ot,{text:t.response,speed:20}):t.thinking&&t.thinking.trim().length>0?e.jsxs("span",{children:[e.jsx("span",{className:"text-slate-500 italic",children:"Thinkingâ€¦ "}),p(t.thinking.trim(),220)]}):r:t.response.startsWith("<svg")?e.jsx("span",{dangerouslySetInnerHTML:{__html:t.response}}):t.response}function zs({model:t,isSpeaking:n,getTailSnippet:r,maxChars:p=220}){return t.statusMessage?t.statusMessage.startsWith("<svg")?e.jsx("span",{dangerouslySetInnerHTML:{__html:t.statusMessage}}):t.statusMessage:n?t.response.trim().length>0?t.response.startsWith("<svg")?e.jsx("span",{dangerouslySetInnerHTML:{__html:t.response}}):e.jsx(Ot,{text:t.response,speed:20}):t.thinking&&t.thinking.trim().length>0?e.jsxs("span",{children:[e.jsx("span",{className:"text-slate-500 italic",children:"Thinkingâ€¦ "}),r(t.thinking.trim(),280)]}):e.jsx("span",{className:"text-slate-500 italic",children:"Thinkingâ€¦"}):t.response?t.response.startsWith("<svg")?e.jsx("span",{dangerouslySetInnerHTML:{__html:t.response}}):r(t.response,p):e.jsx("span",{className:"text-slate-500 italic",children:"No response yet."})}function Hs({moderatorSynthesis:t,isSynthesizing:n,moderatorId:r,speaking:p,phaseLabel:d,isGenerating:i,getTailSnippet:v}){return t?n&&r&&p.has(r)?e.jsx(Ot,{text:t,speed:20}):v(t):n?e.jsx("span",{className:"text-slate-500 italic",children:"Synthesizing responses..."}):i?d&&d.startsWith("<svg")?e.jsx("span",{className:"text-slate-500 italic",dangerouslySetInnerHTML:{__html:d}}):e.jsx("span",{className:"text-slate-500 italic",children:d==="Stage 1 Â· Responses"?"Waiting for model responses...":d||"Orchestrating..."}):e.jsx("span",{className:"text-slate-500 italic",children:"Send a prompt to see the synthesis."})}const Ws={padding:"16px",height:"100%",display:"flex",flexDirection:"column",isolation:"isolate",WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",textRendering:"optimizeLegibility",opacity:1,transition:"opacity 0.3s ease-out"};function Ys({rect:t}){return t?e.jsx("div",{className:"absolute pointer-events-none z-30",style:{left:t.left,top:t.top,width:t.width,height:t.height,border:"2px solid rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)"}}):null}const Xs={twoFingerTapWindow:500,twoFingerTapCooldown:400,twoFingerMinFrames:4,minPointingTime:100,dwellTime:1200,cursorSmoothing:.5},Bt=s.createContext(null);function Fs({children:t}){const[n,r]=s.useState(!1),[p,d]=s.useState("navigation"),[i,v]=s.useState("chat"),[m,g]=s.useState(Xs),[x,f]=s.useState(!1),b=s.useRef({}),R=s.useCallback(S=>{b.current=S},[]),[P,B]=s.useState({gesture:null,progress:0,triggered:!1}),[H,V]=s.useState(null),[c,F]=s.useState(void 0),[G,Q]=s.useState(void 0),[U,j]=s.useState(void 0),[ee,ae]=s.useState(null),ce={isActive:n,setIsActive:r,gestureMode:p,setGestureMode:d,appContext:i,setAppContext:v,gestureConfig:m,setGestureConfig:g,mouseSimulation:x,setMouseSimulation:f,callbacks:b,setCallbacks:R,gestureState:P,setGestureState:B,aslResult:H,setASLResult:V,debugInfo:c,setDebugInfo:F,landmarkData:G,setLandmarkData:Q,performanceMetrics:U,setPerformanceMetrics:j,cameraError:ee,setCameraError:ae};return e.jsx(Bt.Provider,{value:ce,children:t})}function Gs(){const t=s.useContext(Bt);if(!t)throw new Error("useGesture must be used within a GestureProvider");return t}function dr(){return s.useContext(Bt)}class Us extends s.Component{constructor(r){super(r);rn(this,"handleRetry",()=>{var r,p;this.setState({hasError:!1,error:null}),(p=(r=this.props).onRetry)==null||p.call(r)});this.state={hasError:!1,error:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,p){console.error("ErrorBoundary caught an error:",r,p)}render(){var r;return this.state.hasError?this.props.fallback?this.props.fallback:e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-white/70 gap-4 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-amber-400",children:[e.jsx(Un,{size:20}),e.jsx("span",{className:"text-sm font-medium",children:"Something went wrong"})]}),e.jsx("p",{className:"text-xs text-white/40 text-center max-w-xs",children:((r=this.state.error)==null?void 0:r.message)||"Failed to load component"}),e.jsxs("button",{onClick:this.handleRetry,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white/80 bg-slate-700/50 hover:bg-slate-600/50 rounded-lg transition-all active:scale-95 border border-slate-600/50",children:[e.jsx(qn,{size:14}),"Try Again"]})]}):this.props.children}}const qs=s.lazy(()=>rt(()=>import("./SettingsModal-0eA7tsRN.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),Ks=s.lazy(()=>rt(()=>import("./DiscussionTranscript-BR5VYoJZ.js"),__vite__mapDeps([7,1,2,3,4,5,6,8]))),Vs=s.lazy(()=>rt(()=>import("./GestureControl-DOanUbF5.js"),__vite__mapDeps([9,1,2,3,4,5,6]))),Qs=s.lazy(()=>rt(()=>import("./HandBackground-bqIFA56D.js"),__vite__mapDeps([10,1,2,3,4,5,6,11]))),Js=s.lazy(()=>rt(()=>import("./ChatView-DGFRcO4R.js"),__vite__mapDeps([12,1,2,3,4,5,6,8])).then(t=>({default:t.default}))),Zs='button, input, textarea, select, a, [role="button"], [data-no-background], [data-card]';function er(){var nn;const t=Gs();Ms();const{modelsData:n,setModelsData:r,selected:p,setSelected:d,chatModelId:i,setChatModelId:v,moderator:m,setModerator:g,availableModels:x,totalModelsByType:f,allSelectedByType:b,modelIdToName:R,isLoading:P,loadError:B,retryCount:H,retryNow:V}=gs(),[c,F]=He("playground_mode","chat",{serialize:o=>o,deserialize:(o,a)=>["chat","compare","council","roundtable","personality"].includes(o)?o:a}),[G,Q]=s.useState(!1),U=s.useRef(null),[j,ee]=s.useState(null),[ae,ce]=s.useState(!1),[S,q]=s.useState(!1),[O,xe]=s.useState(2),se=s.useRef(0),N=s.useRef(0),re=s.useRef(null),[oe,be]=s.useState(!1),[ye,te]=He("github_models_token","",{serialize:o=>o||null,deserialize:(o,a)=>o??a}),[fe,ve]=He("openrouter_api_key","",{serialize:o=>o||null,deserialize:(o,a)=>o??a}),[Ae,le]=He("show_council_reviewer_names",!1,{serialize:o=>String(o),deserialize:o=>o==="true"}),[We,Ie]=s.useState({}),$e=s.useRef(null),je=s.useRef(null),[l,ne]=s.useState(""),[me,ge]=s.useState(null),ie=s.useRef(null),we=s.useCallback(o=>{ie.current&&clearTimeout(ie.current),ge(o),ie.current=window.setTimeout(()=>{ge(null),ie.current=null},5e3)},[]),ue=s.useCallback(o=>{if(c==="chat"||ye)return!0;const a=n.find(k=>k.id===o);return!a||a.type!=="github"&&a.type!=="external"},[c,ye,n]),De=s.useCallback(()=>!!(c==="chat"||ye),[c,ye]),[Pe,Ye]=s.useState([]),{autoMode:Me,autoModeScope:Ee,setAutoMode:Ne,setAutoModeScope:T}=As({autoMode:!0,autoModeScope:"local"}),[L,A]=s.useState(""),[W,$]=s.useState(!1),{history:D,historyRef:I,pushHistoryEntries:y,clearHistory:h,historyToText:M,buildCarryoverHistory:w}=Es(),_=(o,a)=>{const k=new Set,E=a.filter(Boolean).filter((z,K,J)=>J.indexOf(z)===K),C=[];return E.forEach(z=>{const K=o[z];K&&K.trim()&&(C.push({id:z,text:K.trim()}),k.add(z))}),Object.entries(o).forEach(([z,K])=>{k.has(z)||!K||!K.trim()||C.push({id:z,text:K.trim()})}),C.length?C.map(({id:z,text:K})=>`${R(z)}:
${K}`).join(`

`):null},u=p.map(o=>n.find(a=>a.id===o)).filter(o=>!!o&&(c==="compare"||o.id!==m)),Y=(o,a,k,E)=>{if(k==="council"){const dt=250+o*220/(a-1)-90,pt=dt*Math.PI/180;return{x:Math.cos(pt)*E,y:Math.sin(pt)*E,angle:dt}}const C=o*360/a-90,z=Math.cos(C*Math.PI/180)*E,K=Math.sin(C*Math.PI/180)*E;return{x:z,y:K,angle:C}},X=(o,a)=>{ee(a),o.dataTransfer.effectAllowed="move"},Z=o=>{o.preventDefault(),ce(!0)},de=()=>{ce(!1)},Xe=o=>{if(o.preventDefault(),ce(!1),j){if(c==="chat")v(j);else if(!p.includes(j)){if(!ue(j)){we("Add your GitHub token in Settings for API model access with dedicated quota"),ee(null);return}d(a=>[...a,j])}ee(null)}},he=o=>{if(c==="chat"){v(i===o?null:o);return}if(p.includes(o))if(ze&&xt.current.includes(o)&&l){je.current&&je.current.abort();const k=xt.current.filter(C=>C!==o),E={};if(n.forEach(C=>{k.includes(C.id)&&C.response&&!C.error&&(E[C.id]=C.response)}),d(C=>C.filter(z=>z!==o)),Le.has(o)&&Qe(C=>{const z=new Set(C);return z.delete(o),z}),c==="council"&&k.length<2){et(!1),lt(!1),wt("Council requires at least 2 participants."),Mt("Error");return}Nt(l,E,k,{skipHistory:!0})}else d(k=>k.filter(E=>E!==o));else{if(!ue(o)){we("Add your GitHub token in Settings for API model access with dedicated quota");return}d(a=>[...a,o])}},_e=o=>{const a=n.filter(C=>C.type===o).map(C=>C.id);if(a.length>0&&a.every(C=>p.includes(C))){d(C=>C.filter(z=>!a.includes(z)));return}if((o==="github"||o==="external")&&!De()){we("Add your GitHub token in Settings for API model access with dedicated quota");return}const E=x.filter(C=>C.type===o).map(C=>C.id);E.length>0&&d(C=>[...C,...E])},[Re,Fe]=s.useState(null),[zt,Ht]=s.useState(new Set),[fn,hn]=s.useState(!1),[Le,Qe]=s.useState(new Set),Ge=()=>Qe(new Set),[ot,mn]=s.useState(null),gt=s.useMemo(()=>{if(c==="compare")return 0;const o=Math.max(pe.baseRadius,pe.minRadius+u.length*pe.radiusPerModel);if(!ot)return o;const k=Math.min(ot.width,ot.height)/2-140;return Math.max(o,k)},[c,u.length,ot]);s.useEffect(()=>{const o=()=>{if(!ke.current)return;const{clientWidth:k,clientHeight:E}=ke.current;let C=Math.floor(k/(pe.cardWidth+pe.gapX));C=Math.max(1,C),xe(C),mn({width:k,height:E})},a=new ResizeObserver(k=>{for(let E of k)E.target===ke.current&&o()});return ke.current&&(a.observe(ke.current),o()),()=>{ke.current&&a.unobserve(ke.current)}},[c]);const Ue=s.useRef(null),ke=s.useRef(null),Oe=s.useRef(null),Wt=s.useRef(null),it=s.useRef(new Map),gn=s.useRef(null),Je=s.useRef({card:!1,background:!1}),xn=s.useRef({}),xt=s.useRef([]),{enqueueStreamDelta:bn,clearPendingStreamForModel:yn,resetPendingStream:bt}=Cs(r),{selectionRect:vn,isSelecting:yt,dragSelectionActiveRef:Yt}=Ns({rootContainerRef:Wt,visualizationAreaRef:ke,arenaOffsetYRef:se,arenaTargetYRef:N,wheelRafRef:re,selectedModels:u,cardRefs:it,selectedCardIds:Le,setSelectedCardIds:Qe,suppressClickRef:Je}),{dragState:wn,handlePointerDown:kn}=_s({visualizationAreaRef:ke,cardRefs:it,selected:p,setSelected:d,mode:c,gridCols:O,getCirclePosition:Y});s.useEffect(()=>()=>bt(),[bt]);const[Ce,Be]=s.useState(null);s.useEffect(()=>{const o="arena-selecting",a=document.body;return yt?a.classList.add(o):a.classList.remove(o),()=>{a.classList.remove(o)}},[yt]);const at=s.useCallback(o=>o?!o.closest(Zs):!1,[]),Sn=s.useCallback(o=>{if(at(o.target)){if(Je.current.background){Je.current.background=!1;return}Fe(null),Ge(),Je.current.background=!1}},[at,Ge]),jn=s.useCallback(o=>{at(o.target)&&(o.preventDefault(),Be({x:o.clientX,y:o.clientY,type:"background"}))},[at]),Xt=s.useCallback(()=>{Q(!0),U.current&&clearTimeout(U.current),U.current=window.setTimeout(()=>{Q(!1),U.current=null},350)},[]),Ze=s.useCallback(o=>{o!==c&&(Xt(),et(!1),F(o))},[c,Xt]);s.useEffect(()=>()=>{ie.current&&clearTimeout(ie.current)},[]),s.useEffect(()=>()=>{U.current&&clearTimeout(U.current)},[]),s.useEffect(()=>{const o=()=>Be(null);return window.addEventListener("click",o),()=>window.removeEventListener("click",o)},[]);const[ze,et]=s.useState(!1),[tt,lt]=s.useState(!1),[vt,wt]=s.useState(""),Mn=s.useCallback(()=>{h(),et(!1),lt(!1),wt(""),Mt(null),Gt(null),Ut([]),qt({}),r(o=>o.map(a=>({...a,response:"Ready to generate...",thinking:void 0,error:void 0}))),Ie({}),Ht(new Set)},[h,r]),[En,Cn]=s.useState(!0),[Tn,Nn]=s.useState("api"),[kt,St]=s.useState(!1),jt=s.useRef(null);s.useEffect(()=>{const o=k=>{jt.current&&!jt.current.contains(k.target)&&St(!1)},a=k=>{k.key==="Escape"&&St(!1)};return kt&&(document.addEventListener("mousedown",o),document.addEventListener("keydown",a)),()=>{document.removeEventListener("mousedown",o),document.removeEventListener("keydown",a)}},[kt]);const[Ft,Mt]=s.useState(null),[Et,Gt]=s.useState(null),[,Ut]=s.useState([]),[,qt]=s.useState({}),[_n,Kt]=s.useState(new Set),Ct=s.useRef(new Set),Rn=s.useRef(null),Vt=s.useRef({}),Qt=s.useRef(c),[Tt,Jt]=s.useState(null),Ln=()=>{const o=new Set;Ct.current=o,Kt(o)},An=o=>{Kt(a=>{if(a.has(o))return a;const k=new Set(a);return k.add(o),Ct.current=k,k})},{sendMessage:Nt}=Ts({mode:c,moderator:m,selected:p,selectedCardIds:Le,githubToken:ye,isGenerating:ze,summarizeSessionResponses:_,setLastQuery:ne,setHoveredCard:Fe,setPhaseLabel:Mt,setModeratorSynthesis:wt,setCouncilAggregateRankings:Gt,setCouncilAnonymousReviews:Ut,setDiscussionTurnsByModel:qt,resetFailedModels:Ln,markModelFailed:An,failedModelsRef:Ct,currentDiscussionTurnRef:Rn,sessionModelIdsRef:xt,abortControllerRef:je,thinkingStateRef:xn,conversationHistoryRef:I,pushHistoryEntries:y,historyToText:M,buildCarryoverHistory:w,setModelsData:r,modelIdToName:R,setExecutionTimes:Ie,setIsGenerating:et,setIsSynthesizing:lt,setSpeaking:Ht,enqueueStreamDelta:bn,clearPendingStreamForModel:yn,resetPendingStream:bt});s.useEffect(()=>{const o=a=>{if(a.key==="Escape"){const E=document.activeElement;if(E&&E!==document.body&&E.blur(),oe){be(!1);return}if(Ce){Be(null);return}if(Le.size>0){Ge(),Fe(null);return}if(S){q(!1);return}Fe(null);return}if((a.metaKey||a.ctrlKey)&&(a.key==="a"||a.key==="A")){const E=a.target;if(E.tagName==="INPUT"||E.tagName==="TEXTAREA"||c==="chat")return;a.preventDefault(),p.length>0&&Qe(new Set(p));return}const k=a.target;if(!(k.tagName==="INPUT"||k.tagName==="TEXTAREA")){if(a.key==="ArrowRight"||a.key==="ArrowLeft"){a.preventDefault();const E=["chat","compare","council","roundtable","personality"],C=E.indexOf(c);if(C!==-1){const z=a.key==="ArrowRight"?1:-1,K=(C+z+E.length)%E.length;Ze(E[K])}return}if(a.key==="m"||a.key==="M"){a.preventDefault(),q(!S);return}if((a.key==="Delete"||a.key==="Backspace")&&Le.size>0){a.preventDefault(),d(E=>E.filter(C=>!Le.has(C))),Ge();return}a.key.length===1&&!a.ctrlKey&&!a.metaKey&&!a.altKey&&Ue.current&&Ue.current.focus()}};return window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)}},[S,oe,Ce,Le,c,Ze,Ge]);const ct=s.useRef(!1),_t=s.useRef(0),Zt=o=>{const a=ke.current;a&&a.style.setProperty("--arena-offset-y",`${o}px`)},Rt=o=>Math.max(-200,Math.min(pe.scrollClamp,o)),en=()=>{const o=se.current,a=N.current,k=a-o;if(Math.abs(k)<.5){se.current=a,Zt(a),re.current=null;return}const E=o+k*.35;se.current=E,Zt(E),re.current=requestAnimationFrame(en)},Lt=()=>{re.current==null&&(re.current=requestAnimationFrame(en))};s.useEffect(()=>{const o=z=>{if(Yt.current)return;const K=z.target;if(K&&K.closest("input, textarea, [data-no-arena-scroll]"))return;z.preventDefault();const J=z.deltaY*.9,Se=N.current-J;N.current=Rt(Se),Lt()},a=z=>z?!!z.closest('input, textarea, [data-no-arena-scroll], [data-card], button, a, select, [role="button"]'):!1,k=z=>{if(z.touches.length!==1)return;const K=z.target;a(K)||(ct.current=!0,_t.current=z.touches[0].clientY)},E=z=>{if(Yt.current||!ct.current||z.touches.length!==1)return;const K=z.target;if(a(K)){ct.current=!1;return}const J=z.touches[0].clientY,Se=J-_t.current;_t.current=J,z.preventDefault(),N.current=Rt(N.current+Se),Lt()},C=()=>{ct.current=!1};return window.addEventListener("touchstart",k,{passive:!0}),window.addEventListener("touchmove",E,{passive:!1}),window.addEventListener("touchend",C),window.addEventListener("touchcancel",C),window.addEventListener("wheel",o,{passive:!1}),()=>{window.removeEventListener("touchstart",k),window.removeEventListener("touchmove",E),window.removeEventListener("touchend",C),window.removeEventListener("touchcancel",C),window.removeEventListener("wheel",o),re.current!=null&&cancelAnimationFrame(re.current)}},[]);const[ut,In]=He("playground-bg-style","dots",{serialize:o=>o,deserialize:(o,a)=>o&&is.includes(o)?o:a}),$n=n.find(o=>o.id===m),Dn=tt?"responding":ze?"waiting":vt?"done":"idle",Pn=tt?"Synthesizing...":ze?"Observing":vt?"Complete":"Ready",On=`${Tt?`translate(-50%, -50%) translate(${Tt.x}px, ${Tt.y}px)`:"translate(-50%, -50%)"} scale(1)`;s.useLayoutEffect(()=>{if(c!=="compare")return;const o={};u.forEach(a=>{const k=it.current.get(a.id);k&&(o[a.id]=k.getBoundingClientRect())}),Vt.current=o},[c,u.length,u.map(o=>o.id).join(",")]),s.useEffect(()=>{if(Qt.current==="compare"&&c!=="compare"&&m&&ke.current){const a=Vt.current[m],k=ke.current.getBoundingClientRect();if(a&&k.width>0&&k.height>0){const E=k.left+k.width/2,C=c==="council"?gt-64:0,z=k.top+(k.height*.5+C),K=a.left+a.width/2-E,J=a.top+a.height/2-z;(Math.abs(K)>1||Math.abs(J)>1)&&(Jt({x:K,y:J}),requestAnimationFrame(()=>Jt(null)))}}Qt.current=c},[c,m,gt]);const Bn=ut==="none"?"":`bg-${ut}`,zn=(o,a=280)=>o?o.length<=a?o:`â€¦${o.slice(o.length-a)}`:"",tn=()=>{je.current&&(je.current.abort(),et(!1),lt(!1))};return e.jsxs("div",{ref:Wt,className:`fixed inset-0 overflow-hidden text-white ${Bn}`,style:{backgroundColor:an[c],transition:"background-color 1s ease",...ut==="none"?{background:an[c]}:{},...yt?{userSelect:"none",WebkitUserSelect:"none"}:{}},onClick:Sn,onContextMenu:jn,children:[t.isActive&&!t.mouseSimulation&&e.jsx(s.Suspense,{fallback:null,children:e.jsx(Qs,{onStopGeneration:t.callbacks.current.onStopGeneration,onSendMessage:t.callbacks.current.onSendMessage,onScroll:t.callbacks.current.onScroll,onPinch:t.callbacks.current.onPinch,onHover:t.callbacks.current.onHover,onModeChange:t.callbacks.current.onModeChange,config:t.gestureConfig,mode:t.gestureMode,appContext:t.appContext,onGestureModeToggle:()=>t.setGestureMode(t.gestureMode==="navigation"?"asl":"navigation"),gestureActiveArea:{minX:.7,maxX:1,minY:0,maxY:1},onGestureState:t.setGestureState,onASLResult:t.setASLResult,onError:t.setCameraError,onDebugInfo:t.setDebugInfo,onLandmarkData:t.setLandmarkData,onPerformance:t.setPerformanceMetrics})}),P&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-slate-900/95 backdrop-blur-sm",children:e.jsxs("div",{className:"flex flex-col items-center gap-5 text-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-12 h-12 border-2 border-slate-700 border-t-blue-500 rounded-full animate-spin"}),e.jsx("div",{className:"absolute inset-0 w-12 h-12 border-2 border-transparent border-b-emerald-500/50 rounded-full animate-spin",style:{animationDirection:"reverse",animationDuration:"1.5s"}})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("p",{className:"text-white/80 text-sm font-medium",children:B||"Connecting to models..."}),H>0&&e.jsxs("p",{className:"text-white/40 text-xs tabular-nums",children:["Attempt ",H," of 8"]})]}),e.jsxs("button",{onClick:V,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white/70 hover:text-white bg-white/5 hover:bg-white/10 border border-white/10 hover:border-white/20 rounded-lg transition-all active:scale-95",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh Now"]})]})}),e.jsx(us,{mode:c,setMode:Ze,setHoveredCard:Fe,clearSelection:Ge,showDock:S,setShowDock:q,onOpenSettings:()=>be(!0),gestureButtonSlot:e.jsx(s.Suspense,{fallback:null,children:e.jsx(Vs,{inHeader:!0,appContext:c,onStopGeneration:()=>{if(c==="chat"&&Oe.current){Oe.current.stopGeneration();return}tn()},onSendMessage:o=>{if(c==="chat"&&Oe.current){Oe.current.sendMessage(o,!0);return}const a=c==="compare"||c==="council"||c==="roundtable"||c==="personality"?p:[];a.length>0&&Nt(o,{},a)},onScroll:o=>{if(c==="chat"&&Oe.current){Oe.current.scroll(o);return}N.current=Rt(N.current+o),Lt()},onHover:(o,a)=>{const k=o*window.innerWidth,E=a*window.innerHeight,C=document.elementFromPoint(k,E);if(C){const z=C.closest("[data-gesture-mode-track]");if(z){const Se=z.getBoundingClientRect(),sn=k-Se.left,dt=Se.width,pt=Math.floor(sn/dt*5),At=["chat","compare","council","roundtable","personality"][Math.max(0,Math.min(4,pt))];At&&At!==c&&Ze(At);return}const K=document.querySelector('[data-gesture-hovered="true"]'),J=C.closest('button, a, [role="button"], [data-clickable], .cursor-pointer, [onclick]')||C;J!==K?(K&&(K.removeAttribute("data-gesture-hovered"),K.dispatchEvent(new PointerEvent("pointerleave",{bubbles:!1,cancelable:!0})),K.dispatchEvent(new MouseEvent("mouseleave",{bubbles:!1,cancelable:!0})),K.dispatchEvent(new MouseEvent("mouseout",{bubbles:!0,cancelable:!0}))),J.setAttribute("data-gesture-hovered","true"),J.dispatchEvent(new PointerEvent("pointerenter",{bubbles:!1,cancelable:!0,clientX:k,clientY:E})),J.dispatchEvent(new PointerEvent("pointermove",{bubbles:!0,cancelable:!0,clientX:k,clientY:E})),J.dispatchEvent(new MouseEvent("mouseenter",{bubbles:!1,cancelable:!0,clientX:k,clientY:E})),J.dispatchEvent(new MouseEvent("mouseover",{bubbles:!0,cancelable:!0,clientX:k,clientY:E}))):J===K&&(J.dispatchEvent(new PointerEvent("pointermove",{bubbles:!0,cancelable:!0,clientX:k,clientY:E})),J.dispatchEvent(new MouseEvent("mousemove",{bubbles:!0,cancelable:!0,clientX:k,clientY:E})))}},onPinch:(o,a)=>{const k=o*window.innerWidth,E=a*window.innerHeight,C=document.elementFromPoint(k,E);if(C){const z=Se=>{Se.dispatchEvent(new PointerEvent("pointerdown",{bubbles:!0,cancelable:!0,clientX:k,clientY:E,pointerId:1,pointerType:"touch",isPrimary:!0})),Se.dispatchEvent(new PointerEvent("pointerup",{bubbles:!0,cancelable:!0,clientX:k,clientY:E,pointerId:1,pointerType:"touch",isPrimary:!0})),Se.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0,clientX:k,clientY:E})),Se.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0,cancelable:!0,clientX:k,clientY:E})),Se.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,clientX:k,clientY:E}))},K=C.closest('button, a, [role="button"], [data-clickable], .cursor-pointer, [onclick]');z(K||C);const J=document.createElement("div");J.style.position="fixed",J.style.left=`${k}px`,J.style.top=`${E}px`,J.style.width="20px",J.style.height="20px",J.style.background="rgba(236, 72, 153, 0.5)",J.style.borderRadius="50%",J.style.transform="translate(-50%, -50%)",J.style.pointerEvents="none",J.style.zIndex="9999",document.body.appendChild(J),J.animate([{transform:"translate(-50%, -50%) scale(1)",opacity:1},{transform:"translate(-50%, -50%) scale(4)",opacity:0}],{duration:400}).onfinish=()=>J.remove()}},onModeChange:o=>{const a=["chat","compare","council","roundtable","personality"],k=a.indexOf(c);let E;o==="next"?E=(k+1)%a.length:E=(k-1+a.length)%a.length,Ze(a[E])}})})}),e.jsxs("div",{style:{paddingLeft:"1.5rem",paddingRight:"0"},children:[S&&e.jsx("div",{className:"fixed inset-0 z-[55] bg-black/10 backdrop-blur-[1px] transition-opacity duration-300",onClick:()=>q(!1)}),e.jsx(as,{showDock:S,availableModels:x,allSelectedByType:b,totalModelsByType:f,handleDragStart:X,handleModelToggle:he,handleAddGroup:_e,dockRef:$e}),c==="chat"&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex h-screen w-full relative z-[10]",children:e.jsx("div",{className:"flex-1 relative px-2 sm:px-6 pt-20 pb-6",children:e.jsx(Us,{children:e.jsx(s.Suspense,{fallback:e.jsxs("div",{className:"flex items-center justify-center h-full text-white/50 gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/20 border-t-white/60 rounded-full animate-spin"}),"Loading..."]}),children:e.jsx(Js,{ref:Oe,models:n,selectedModelId:i,onSelectModel:v,githubToken:ye,openrouterKey:fe,messages:Pe,setMessages:Ye,autoMode:Me,setAutoMode:Ne,autoModeScope:Ee,setAutoModeScope:T,currentResponse:L,setCurrentResponse:A,isGenerating:W,setIsGenerating:$,onModelUsed:v,gesturesActive:t.isActive})})})})})}),c!=="chat"&&e.jsxs("div",{className:"flex h-screen w-full relative",children:[e.jsx("div",{className:"relative flex-1 transition-all duration-300 flex flex-col pt-24",children:e.jsx("div",{ref:ke,onDragOver:Z,onDragLeave:de,onDrop:Xe,className:"relative w-full h-full z-10 transition-all duration-300",style:{position:"relative",display:"flex",alignItems:c==="compare"?"flex-start":"center",justifyContent:"center","--arena-offset-y":`${se.current}px`,transform:c==="council"||c==="roundtable"||c==="personality"?`translateY(calc(var(--arena-offset-y) - 50px)) scale(${ae?1.02:1})`:`translateY(var(--arena-offset-y)) scale(${ae?1.02:1})`,willChange:"transform",border:ae?"2px dashed rgba(59, 130, 246, 0.4)":"2px dashed transparent",borderRadius:ae?"24px":"0px",transition:"transform 0s linear",...c==="compare"?{minHeight:"300px",paddingBottom:"120px"}:c==="council"||c==="roundtable"||c==="personality"?{height:"100%",minHeight:"100%",overflow:"hidden"}:{height:"100%",minHeight:"100%",overflow:"hidden"},...ae?{background:"rgba(59, 130, 246, 0.05)"}:{}},children:e.jsx($s,{mode:c,selectedModels:u,gridCols:O,speaking:zt,selectedCardIds:Le,setSelectedCardIds:Qe,executionTimes:We,failedModels:_n,cardRefs:it,handlePointerDown:kn,dragState:wn,handleModelToggle:he,setContextMenu:Be,suppressClickRef:Je,getTailSnippet:zn,hoveredCard:Re,setHoveredCard:Fe,layoutRadius:gt,getCirclePosition:Y,moderatorModel:$n,moderatorId:m,orchestratorTransform:On,orchestratorStatus:Dn,orchestratorPhaseLabel:Pn,moderatorSynthesis:vt,isSynthesizing:tt,isGenerating:ze,phaseLabel:Ft,linesTransitioning:G,lastSelectedCardRef:gn,orchestratorAutoMode:En,orchestratorAutoScope:Tn,showOrchestratorMenu:kt,setShowOrchestratorMenu:St,setOrchestratorAutoMode:Cn,setOrchestratorAutoScope:Nn,orchestratorMenuRef:jt,availableModels:x,setModerator:g,councilWinnerId:(nn=Et==null?void 0:Et[0])==null?void 0:nn.model_id})})}),c!=="compare"&&e.jsx("div",{className:"transcript-panel w-[400px] xl:w-[480px] flex flex-col border-l border-white/5 bg-slate-900/20 backdrop-blur-sm z-40 relative h-full",children:e.jsx(s.Suspense,{fallback:null,children:e.jsx(Ks,{history:D,models:n,mode:c,onSelectPrompt:o=>{Ue.current&&(Ue.current.value=o,Ue.current.focus())},onNewSession:Mn,className:"pt-24 pb-6 mask-fade-top",phaseLabel:Ft,isGenerating:ze,isSynthesizing:tt,speakingCount:zt.size,totalParticipants:u.length})})})]})]}),e.jsx(Ys,{rect:vn}),me&&e.jsx("div",{className:"fixed bottom-20 left-1/2 -translate-x-1/2 z-[200] animate-in slide-in-from-bottom-4 fade-in duration-300",children:e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 rounded-xl bg-amber-500/10 border border-amber-500/30 backdrop-blur-md shadow-xl",children:[e.jsx("svg",{className:"w-5 h-5 text-amber-400 shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsx("span",{className:"text-sm text-amber-100",children:me}),e.jsx("button",{onClick:()=>{ge(null),be(!0)},className:"ml-2 px-3 py-1 text-xs font-medium text-amber-900 bg-amber-400 hover:bg-amber-300 rounded-md transition-colors",children:"Open Settings"}),e.jsx("button",{onClick:()=>ge(null),className:"ml-1 p-1 text-amber-400/60 hover:text-amber-400 transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsx(s.Suspense,{fallback:null,children:e.jsx(qs,{open:oe,onClose:()=>be(!1),token:ye,setToken:te,openrouterKey:fe,setOpenrouterKey:ve,showCouncilReviewerNames:Ae,setShowCouncilReviewerNames:le,bgStyle:ut,setBgStyle:In})}),(c==="compare"||c==="council"||c==="roundtable"||c==="personality")&&e.jsx(ls,{inputRef:Ue,inputFocused:fn,setInputFocused:hn,onSendMessage:Nt,isGenerating:ze||tt,onStop:tn,placeholder:c==="compare"?void 0:c==="personality"?"Ask the personas...":"Steer the discussion...",className:`fixed bottom-0 left-0 z-[100] pb-6 px-3 sm:px-4 flex justify-center items-end pointer-events-none transition-all duration-300 ${c==="compare"?"right-0":"right-[400px] xl:right-[480px]"}`,style:{paddingBottom:"calc(1.5rem + env(safe-area-inset-bottom))"}}),Ce&&e.jsx("div",{className:"fixed bg-slate-800 border border-slate-700 rounded-lg shadow-xl py-1 z-[200] min-w-[160px]",style:{top:Ce.y,left:Ce.x},onClick:o=>o.stopPropagation(),children:Ce.type==="background"?e.jsxs("button",{className:"w-full text-left px-4 py-2 text-sm text-slate-200 hover:bg-slate-700 transition-colors flex items-center gap-2",onClick:()=>{q(!0),Be(null)},children:[e.jsx("svg",{className:"w-4 h-4 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Model"]}):Ce.modelId?e.jsxs(e.Fragment,{children:[c!=="compare"&&Ce.modelId!==m&&e.jsxs("button",{className:"w-full text-left px-4 py-2 text-sm text-slate-200 hover:bg-slate-700 transition-colors flex items-center gap-2",onClick:()=>{g(Ce.modelId),Be(null)},children:[e.jsx("svg",{className:"w-4 h-4 text-orange-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})}),"Set as Orchestrator"]}),e.jsxs("button",{className:"w-full text-left px-4 py-2 text-sm text-red-400 hover:bg-slate-700 transition-colors flex items-center gap-2",onClick:()=>{const o=Ce.modelId===m;if(he(Ce.modelId),o&&c!=="compare"){const a=p.filter(k=>k!==Ce.modelId);a.length>0?g(a[0]):g("")}Be(null)},children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Remove"]})]}):null})]})}function tr(){return e.jsx(Fs,{children:e.jsx(er,{})})}Kn.createRoot(document.getElementById("root")).render(e.jsx(Vn.StrictMode,{children:e.jsx(tr,{})}));export{is as B,ur as M,ls as P,Ys as S,dr as a,bs as f,cr as g,ft as s,Gs as u};
