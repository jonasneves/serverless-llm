import{c as b,r as n,j as e,R,S as z,i as se,n as ye,g as ve,h as _e}from"./index.js";import{P as Ce,C as Se,A as le,S as Me,a as ne}from"./settings.js";import{C as oe,S as Be,a as Ee}from"./server.js";import{M as re}from"./message-square.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],F=b("circle-alert",$e);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],G=b("circle-check-big",De);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],ce=b("circle-x",Le);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ie=b("clock",Pe);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],He=b("database",Ae);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],ue=b("external-link",Re);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Ue=b("eye-off",Te);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],qe=b("eye",Ie);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],de=b("globe",Oe);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]],Fe=b("link-2",ze);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],pe=b("rocket",Ge);/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],be=b("wifi-off",We),Z="jonasneves",ee="serverless-llm",me=[{name:"Chat",path:"chat-interface.yml"},{name:"Build Images",path:"build-push-images.yml"}];function te(c){return c.trim().replace(/\/+$/,"")}function Ve(c){try{return new URL(c).host}catch{return c}}const xe=({githubToken:c,chatApiBaseUrl:i,modelsBaseDomain:s,showOnlyBackend:d=!1,onBackendStatusChange:f})=>{const[T,B]=n.useState(new Map),[W,V]=n.useState(new Map),[y,h]=n.useState(!0),[E,g]=n.useState(null),[$,j]=n.useState(null),[w,v]=n.useState("checking"),[p,_]=n.useState("unknown"),[D,U]=n.useState(null),[N,C]=n.useState(!1),[A,L]=n.useState(null),[k,t]=n.useState(null),[r,m]=n.useState(null),P=n.useRef(!1),H=n.useRef(new Map),K={Authorization:`Bearer ${c}`,Accept:"application/vnd.github.v3+json","X-GitHub-Api-Version":"2022-11-28"},I=n.useCallback(async()=>{v("checking");try{const a=te(i)||"http://localhost:8080",o=await fetch(`${a}/health`,{method:"GET",mode:"cors",credentials:"omit",signal:AbortSignal.timeout(5e3)});v(o.ok?"ok":"down")}catch(a){console.log("Health check failed:",a),v("down")}},[i]),fe=()=>{var a;return typeof chrome<"u"&&!!((a=chrome.runtime)!=null&&a.sendMessage)},q=async a=>fe()?await new Promise(o=>{try{chrome.runtime.sendMessage({type:"native_backend",payload:a},l=>{var u;const x=(u=chrome.runtime.lastError)==null?void 0:u.message;o(x?{ok:!1,error:x}:l)})}catch(l){o({ok:!1,error:(l==null?void 0:l.message)||String(l)})}}):{ok:!1,error:"Native messaging unavailable"},O=n.useCallback(async()=>{const a=te(i)||"http://localhost:8080",o=await q({action:"status",chatApiBaseUrl:a});if(o!=null&&o.ok){const l=o.status==="running"?"running":"stopped",x=o.mode??null;_(l),U(o.pid??null),m(x),t(null),f==null||f({process:l,mode:x});return}t((o==null?void 0:o.error)||null),_("unknown"),U(null),m(null),f==null||f({process:"unknown",mode:null})},[i,f]),ge=async()=>{if(C(!0),L(null),t(null),!(i.includes("localhost")||i.includes("127.0.0.1"))){t("Backend start only works with local chat API (localhost:8080)"),C(!1);return}const l=await q({action:"start",mode:s?"dev-remote":"dev-interface-local"});!(l!=null&&l.ok)&&(l!=null&&l.logTail)&&L(l.logTail),!(l!=null&&l.ok)&&(l!=null&&l.error)&&t(l.error),await O(),await I(),C(!1)},je=async()=>{C(!0),L(null),t(null),await q({action:"stop"}),await O(),await I(),C(!1)},we=async()=>{const a=await q({action:"logs"});a!=null&&a.ok&&L(a.logTail||null),!(a!=null&&a.ok)&&(a!=null&&a.error)&&t(a.error)},ae=n.useCallback(async()=>{if(!c){g("GitHub token required"),h(!1);return}try{const a=await fetch(`https://api.github.com/repos/${Z}/${ee}/actions/workflows`,{headers:K,signal:AbortSignal.timeout(8e3)});if(!a.ok)throw new Error(`GitHub API error: ${a.status}`);const o=await a.json(),l=new Map;for(const x of o.workflows){const u=me.find(S=>x.path.endsWith(S.path));u&&l.set(u.name,{id:x.id,name:u.name,path:x.path})}return H.current=l,B(l),l}catch(a){return g(a.message),null}},[c]),Q=n.useCallback(async a=>{const o=a||H.current;if(o.size===0)return;const l=new Map;await Promise.all(Array.from(o.entries()).map(async([x,u])=>{try{const S=await fetch(`https://api.github.com/repos/${Z}/${ee}/actions/workflows/${u.id}/runs?per_page=1`,{headers:K,signal:AbortSignal.timeout(8e3)});if(S.ok){const Y=await S.json();if(Y.workflow_runs&&Y.workflow_runs.length>0){const M=Y.workflow_runs[0];l.set(x,{id:M.id,name:M.name,status:M.status,conclusion:M.conclusion,created_at:M.created_at,updated_at:M.updated_at,html_url:M.html_url})}else l.set(x,null)}}catch{l.set(x,null)}})),V(l),h(!1)},[c]),X=async a=>{const o=H.current.get(a)||T.get(a);if(!(!o||!c)){j(a);try{const l=await fetch(`https://api.github.com/repos/${Z}/${ee}/actions/workflows/${o.id}/dispatches`,{method:"POST",headers:{...K,"Content-Type":"application/json"},body:JSON.stringify({ref:"main",...a==="Build Images"&&{inputs:{models:"chat-interface"}}}),signal:AbortSignal.timeout(8e3)});if(!l.ok&&l.status!==204)throw new Error(`Failed to trigger: ${l.status}`);setTimeout(()=>{Q(),j(null)},2e3)}catch(l){console.error("Failed to trigger workflow:",l),j(null)}}},J=n.useCallback(async()=>{if(!P.current){P.current=!0,h(!0),g(null);try{const a=await ae();a&&await Q(a),await Promise.all([I(),O()])}finally{P.current=!1,h(!1)}}},[ae,Q,I,O]);n.useEffect(()=>{J();const a=setInterval(J,3e4);return()=>clearInterval(a)},[c,i]);const Ne=a=>a?a.status==="in_progress"||a.status==="queued"?e.jsx(R,{className:"w-4 h-4 text-yellow-400 animate-spin"}):a.conclusion==="success"?e.jsx(G,{className:"w-4 h-4 text-green-500"}):a.conclusion==="failure"?e.jsx(ce,{className:"w-4 h-4 text-red-500"}):e.jsx(ie,{className:"w-4 h-4 text-gray-400"}):e.jsx(ie,{className:"w-4 h-4 text-gray-400"}),ke=a=>{const o=new Date(a),x=new Date().getTime()-o.getTime(),u=Math.floor(x/6e4);if(u<1)return"just now";if(u<60)return`${u}m ago`;const S=Math.floor(u/60);return S<24?`${S}h ago`:o.toLocaleDateString()};return c?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-3 rounded-lg bg-slate-800/50 border border-slate-700/50",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[w==="ok"&&e.jsx(G,{className:"w-4 h-4 text-green-500"}),w==="down"&&e.jsx(ce,{className:"w-4 h-4 text-red-500"}),w==="checking"&&e.jsx(R,{className:"w-4 h-4 text-gray-400 animate-spin"}),e.jsx("span",{className:"text-sm text-slate-300",children:"Backend"})]}),e.jsx("span",{className:"text-xs text-slate-500 truncate",children:Ve(te(i)||"http://localhost:8080")})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsx("div",{className:"text-xs text-slate-500",children:p==="running"&&D?e.jsxs("span",{children:["Process: running (pid ",D,")",r&&e.jsxs("span",{className:"text-slate-600",children:[" | ",r]})]}):`Process: ${p}`}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:we,className:"text-xs text-slate-400 hover:text-white transition-colors",disabled:N,children:"Logs"}),p!=="running"?e.jsx("button",{onClick:ge,disabled:N||!(i.includes("localhost")||i.includes("127.0.0.1")),className:`px-2 py-1 text-xs rounded transition-colors ${i.includes("localhost")||i.includes("127.0.0.1")?"bg-emerald-600/20 text-emerald-400 hover:bg-emerald-600/30":"bg-slate-700/50 text-slate-500 cursor-not-allowed"}`,title:i.includes("localhost")||i.includes("127.0.0.1")?s?"Start with remote models":"Start with local models":"Backend start only available for localhost",children:s?"Start (remote)":"Start (local)"}):e.jsx("button",{onClick:je,disabled:N,className:"px-2 py-1 text-xs rounded bg-red-600/20 text-red-400 hover:bg-red-600/30 transition-colors",children:"Stop"})]})]}),A&&e.jsx("pre",{className:"mt-2 max-h-40 overflow-auto text-[10px] leading-snug bg-slate-950/40 border border-slate-700/40 rounded p-2 text-slate-300 whitespace-pre-wrap",children:A}),k&&e.jsxs("div",{className:"mt-2 text-[11px] text-amber-300/90",children:["Native host: ",k]}),d&&p==="stopped"&&!N&&e.jsxs("div",{className:"mt-3 p-4 text-center bg-slate-900/50 rounded border border-slate-700/30",children:[e.jsx(be,{className:"w-8 h-8 mx-auto mb-2 text-slate-600"}),e.jsx("p",{className:"text-sm text-slate-400 mb-1",children:"Backend is stopped"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Click Start to launch the local chat server"})]})]}),!d&&E&&e.jsx("div",{className:"p-3 rounded-lg bg-red-900/20 border border-red-700/50 text-red-400 text-xs",children:E}),!d&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-sm font-medium text-slate-300 flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4"}),"Deployments"]}),e.jsxs("button",{onClick:J,disabled:y,className:"text-xs text-slate-400 hover:text-white transition-colors flex items-center gap-1",children:[e.jsx(R,{className:`w-3 h-3 ${y?"animate-spin":""}`}),"Refresh"]})]}),e.jsx("div",{className:"space-y-2",children:me.map(a=>{const o=W.get(a.name),l=$===a.name;return e.jsxs("div",{className:"p-3 rounded-lg bg-slate-800/50 border border-slate-700/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[Ne(o??null),e.jsx("span",{className:"text-sm font-medium text-slate-200",children:a.name})]}),o&&e.jsx("a",{href:o.html_url,target:"_blank",rel:"noopener noreferrer",className:"text-slate-400 hover:text-white transition-colors",title:"View on GitHub",children:e.jsx(ue,{className:"w-3 h-3"})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-slate-500",children:o?ke(o.updated_at):"No runs"}),e.jsxs("button",{onClick:()=>X(a.name),disabled:l||y,className:`flex items-center gap-1 px-2 py-1 text-xs rounded transition-colors ${l?"bg-slate-700 text-slate-400":"bg-blue-600/20 text-blue-400 hover:bg-blue-600/30"}`,children:[l?e.jsx(R,{className:"w-3 h-3 animate-spin"}):e.jsx(Ce,{className:"w-3 h-3"}),l?"Triggering...":"Deploy"]})]})]},a.name)})}),e.jsxs("div",{className:"pt-3 border-t border-slate-700/50",children:[e.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("button",{onClick:()=>X("Chat"),disabled:$==="Chat"||y,className:"px-3 py-2 text-xs bg-emerald-600/20 text-emerald-400 hover:bg-emerald-600/30 rounded transition-colors",children:"ðŸš€ Redeploy Chat"}),e.jsx("button",{onClick:()=>X("Build Images"),disabled:$==="Build Images"||y,className:"px-3 py-2 text-xs bg-purple-600/20 text-purple-400 hover:bg-purple-600/30 rounded transition-colors",children:"ðŸ”¨ Rebuild Images"})]})]})]})]}):e.jsxs("div",{className:"p-4 text-center text-slate-400",children:[e.jsx(F,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Configure GitHub token in Settings to use deployments"})]})},he={githubToken:"",profile:"local_all",chatApiBaseUrl:"http://localhost:8080",modelsBaseDomain:"",modelsUseHttps:!1};function Ke(c,i){const s={};for(const d of z)s[d.key]=se(d.key,d.localPort,c,i);return s}const Qe=()=>{const[c,i]=n.useState([]),[s,d]=n.useState(he),[f,T]=n.useState(!1),[B,W]=n.useState(!1),[V,y]=n.useState(new Date),[h,E]=n.useState("backend"),[g,$]=n.useState({process:"unknown",mode:null}),[j,w]=n.useState(!1),v=n.useCallback(t=>z.map(r=>({key:r.key,name:r.name,endpoint:se(r.key,r.localPort,t.modelsBaseDomain,t.modelsUseHttps),status:"checking"})),[]),p=n.useCallback(async t=>{y(new Date);const r=await Promise.all(t.map(async m=>{try{const P=await fetch(`${m.endpoint}/health`,{method:"GET",signal:AbortSignal.timeout(3e3)});return{...m,status:P.ok?"ok":"down"}}catch{return{...m,status:"down"}}}));i(r)},[]);n.useEffect(()=>{chrome.storage.local.get(["envConfig"],t=>{const r=ye(t.envConfig||he);d(r);const m=v(r);i(m),h==="services"&&setTimeout(()=>p(m),500)})},[v,p]),n.useEffect(()=>{if(h!=="services")return;const t=setInterval(()=>{i(r=>(r.length>0&&p(r),r))},1e4);return()=>clearInterval(t)},[h,p]);const _=()=>{const t=Ke(s.modelsBaseDomain,s.modelsUseHttps),r={...s,qwenEndpoint:t.qwen,phiEndpoint:t.phi,llamaEndpoint:t.llama,mistralEndpoint:t.mistral,gemmaEndpoint:t.gemma,r1qwenEndpoint:t.r1qwen,rnjEndpoint:t.rnj};chrome.storage.local.set({envConfig:r},()=>{const m=v(s);i(m),h==="services"&&p(m)})},D=()=>{chrome.tabs.create({url:chrome.runtime.getURL("index.html")})},U=t=>t==="ok"?e.jsx(G,{className:"w-4 h-4 text-green-500"}):t==="down"?e.jsx(F,{className:"w-4 h-4 text-red-500"}):e.jsx(R,{className:"w-4 h-4 text-gray-400 animate-spin"}),N=c.filter(t=>t.status==="ok").length,C=!!s.modelsBaseDomain,A=t=>t==="remote_all"?"Production (Cloud)":t==="local_chat_remote_models"?"Development (Local+Cloud)":t==="local_all"?"Offline (Fully Local)":"Custom",L=t=>t==="remote_all"?"text-emerald-400":t==="local_chat_remote_models"?"text-blue-400":t==="local_all"?"text-amber-400":"text-slate-400",k=t=>{if(t==="remote_all"){d({...s,profile:t,chatApiBaseUrl:"https://chat.neevs.io",modelsBaseDomain:"neevs.io",modelsUseHttps:!0}),_();return}if(t==="local_chat_remote_models"){d({...s,profile:t,chatApiBaseUrl:"http://localhost:8080",modelsBaseDomain:"neevs.io",modelsUseHttps:!0}),_();return}if(t==="local_all"){d({...s,profile:t,chatApiBaseUrl:"http://localhost:8080",modelsBaseDomain:"",modelsUseHttps:!1}),_();return}d({...s,profile:"custom"})};return n.useEffect(()=>{const t=r=>{if(r.ctrlKey||r.metaKey)if(r.key==="p"){r.preventDefault();const m=["remote_all","local_chat_remote_models","local_all"],H=(m.indexOf(s.profile)+1)%m.length;k(m[H])}else r.key==="o"&&(r.preventDefault(),D())};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[s.profile]),n.useEffect(()=>{const t=r=>{const m=r.target;j&&!m.closest(".relative")&&w(!1)};if(j)return document.addEventListener("click",t),()=>document.removeEventListener("click",t)},[j]),e.jsxs("div",{className:`p-4 min-h-screen font-sans transition-colors ${s.profile==="remote_all"||s.profile==="local_chat_remote_models","bg-slate-900"}`,children:[e.jsxs("div",{className:"mb-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${s.profile==="remote_all"?"bg-blue-600/20":s.profile==="local_chat_remote_models"?"bg-emerald-600/20":"bg-amber-600/20"}`,children:s.profile==="remote_all"?e.jsx(oe,{className:"w-5 h-5 text-blue-400"}):s.profile==="local_chat_remote_models"?e.jsx(Fe,{className:"w-5 h-5 text-emerald-400"}):e.jsx(Be,{className:"w-5 h-5 text-amber-400"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-lg font-semibold flex items-center gap-2 text-white",children:[A(s.profile),e.jsx("span",{title:"Ctrl+P to cycle profiles, Ctrl+O to open chat",children:e.jsx(Se,{className:"w-3.5 h-3.5 text-slate-400 cursor-help"})})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-300",children:[e.jsx("span",{className:"truncate",children:s.chatApiBaseUrl.includes("localhost")?"localhost":"cloud"}),e.jsx(le,{className:"w-3 h-3"}),e.jsx("span",{className:"truncate",children:s.modelsBaseDomain||"localhost"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex",children:[e.jsxs("button",{onClick:D,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-l font-medium transition-colors text-sm text-white",title:"Open extension chat (Ctrl+O)",children:[e.jsx(re,{className:"w-4 h-4"}),"Open Chat"]}),e.jsx("button",{onClick:()=>w(!j),className:"px-2 py-2 bg-blue-600 hover:bg-blue-700 rounded-r border-l border-blue-700 transition-colors text-white",title:"More options",children:e.jsx(Ee,{className:"w-4 h-4"})})]}),j&&e.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-slate-800 border border-slate-700 rounded-lg shadow-lg z-10",children:[e.jsxs("button",{onClick:()=>{D(),w(!1)},className:"w-full px-4 py-2 text-left text-sm text-slate-200 hover:bg-slate-700 rounded-t-lg flex items-center gap-2",children:[e.jsx(re,{className:"w-4 h-4"}),e.jsx("span",{children:"Extension Dashboard"})]}),(s.chatApiBaseUrl.includes("localhost")||s.chatApiBaseUrl.includes("127.0.0.1")||s.chatApiBaseUrl.includes("0.0.0.0"))&&e.jsxs("button",{onClick:()=>{window.open("http://localhost:8080","_blank"),w(!1)},className:"w-full px-4 py-2 text-left text-sm text-slate-200 hover:bg-slate-700 flex items-center gap-2",children:[e.jsx(ue,{className:"w-4 h-4"}),e.jsx("span",{children:"Local Web (localhost:8080)"})]}),s.profile==="remote_all"&&e.jsxs("button",{onClick:()=>{window.open("https://chat.neevs.io","_blank"),w(!1)},className:"w-full px-4 py-2 text-left text-sm text-slate-200 hover:bg-slate-700 rounded-b-lg flex items-center gap-2",children:[e.jsx(oe,{className:"w-4 h-4"}),e.jsx("span",{children:"Remote Web (chat.neevs.io)"})]})]})]}),e.jsx("button",{onClick:()=>T(!f),className:"p-2 hover:bg-slate-800 rounded transition-colors text-slate-300 hover:text-white",title:"Settings",children:e.jsx(Me,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-800/50 rounded-lg border border-slate-700/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-slate-500",children:"Quick Switch:"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>k("local_chat_remote_models"),className:`px-2 py-1 text-xs rounded transition-colors ${s.profile==="local_chat_remote_models"?"bg-emerald-600 text-white":"bg-slate-700 text-slate-400 hover:bg-slate-600"}`,title:"Development mode (Ctrl+P)",children:"Dev"}),e.jsx("button",{onClick:()=>k("remote_all"),className:`px-2 py-1 text-xs rounded transition-colors ${s.profile==="remote_all"?"bg-blue-600 text-white":"bg-slate-700 text-slate-400 hover:bg-slate-600"}`,title:"Production mode (Ctrl+P)",children:"Prod"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${g.process==="running"?"bg-green-500":g.process==="stopped"?"bg-red-500":"bg-slate-500"}`}),e.jsxs("span",{className:"text-xs text-slate-300",children:["Backend: ",g.process,g.mode&&e.jsxs("span",{className:"text-slate-500",children:[" (",g.mode,")"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[N===c.length?e.jsx(G,{className:"w-3.5 h-3.5 text-green-500"}):N>0?e.jsx(F,{className:"w-3.5 h-3.5 text-amber-500"}):e.jsx(be,{className:"w-3.5 h-3.5 text-red-500"}),e.jsxs("span",{className:"text-xs text-slate-300",children:["Models: ",N,"/",c.length]})]})]})]}),!s.githubToken&&e.jsxs("div",{className:"p-3 bg-amber-900/20 border border-amber-700/50 rounded-lg flex items-center gap-2 text-amber-300",children:[e.jsx(F,{className:"w-4 h-4"}),e.jsxs("span",{className:"text-xs",children:["GitHub token required for deployments.",e.jsx("button",{onClick:()=>T(!0),className:"ml-2 underline hover:text-amber-200",children:"Configure â†’"})]})]})]}),f?e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Environment Profile"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-2",children:[e.jsxs("button",{onClick:()=>k("remote_all"),className:`p-3 rounded-lg border-2 transition-all text-left ${s.profile==="remote_all"?"border-blue-500 bg-blue-500/10":"border-slate-700 bg-slate-800/50 hover:border-slate-600"}`,children:[e.jsx("div",{className:"text-xs font-medium text-white mb-1",children:"Production"}),e.jsx("div",{className:"text-[10px] text-slate-300",children:"Chat: Cloud"}),e.jsx("div",{className:"text-[10px] text-slate-300",children:"Models: Cloud"}),e.jsx("div",{className:"text-[10px] text-blue-400 mt-1",children:"No setup"})]}),e.jsxs("button",{onClick:()=>k("local_chat_remote_models"),className:`p-3 rounded-lg border-2 transition-all text-left ${s.profile==="local_chat_remote_models"?"border-emerald-500 bg-emerald-500/10":"border-slate-700 bg-slate-800/50 hover:border-slate-600"}`,children:[e.jsx("div",{className:"text-xs font-medium text-white mb-1",children:"Development"}),e.jsx("div",{className:"text-[10px] text-slate-300",children:"Chat: Local"}),e.jsx("div",{className:"text-[10px] text-slate-300",children:"Models: Cloud"}),e.jsx("div",{className:"text-[10px] text-emerald-400 mt-1",children:"Click Start"})]}),e.jsxs("button",{onClick:()=>k("local_all"),className:`p-3 rounded-lg border-2 transition-all text-left ${s.profile==="local_all"?"border-amber-500 bg-amber-500/10":"border-slate-700 bg-slate-800/50 hover:border-slate-600"}`,children:[e.jsx("div",{className:"text-xs font-medium text-white mb-1",children:"Offline"}),e.jsx("div",{className:"text-[10px] text-slate-300",children:"Chat: Local"}),e.jsx("div",{className:"text-[10px] text-slate-300",children:"Models: Local"}),e.jsx("div",{className:"text-[10px] text-amber-400 mt-1",children:"Requires models"})]})]}),e.jsx("button",{onClick:()=>d({...s,profile:"custom"}),className:`w-full px-3 py-2 rounded border text-xs transition-colors ${s.profile==="custom"?"border-blue-500 bg-blue-500/10 text-blue-400":"border-slate-700 bg-slate-800/50 text-slate-400 hover:border-slate-600"}`,children:"Custom Configuration"})]}),e.jsxs("div",{className:"pt-3 border-t border-slate-700",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Chat API Base URL"}),e.jsx("input",{type:"text",value:s.chatApiBaseUrl,onChange:t=>d({...s,profile:"custom",chatApiBaseUrl:t.target.value}),className:"w-full px-3 py-2 bg-slate-800 border border-slate-700 rounded text-sm text-slate-200 placeholder-slate-500 focus:outline-none focus:border-blue-500",placeholder:"http://localhost:8080"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Used by the main app streaming API and the Deploy tab health check."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"GitHub Token"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:B?"text":"password",value:s.githubToken,onChange:t=>d({...s,githubToken:t.target.value}),className:"w-full px-3 py-2 pr-10 bg-slate-800 border border-slate-700 rounded text-sm text-slate-200 placeholder-slate-500 focus:outline-none focus:border-blue-500",placeholder:"github_pat_..."}),e.jsx("button",{type:"button",onClick:()=>W(!B),className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 text-slate-400 hover:text-slate-200 transition-colors",title:B?"Hide token":"Show token",children:B?e.jsx(Ue,{className:"w-4 h-4"}):e.jsx(qe,{className:"w-4 h-4"})})]}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Required for API models & deployments."," ",e.jsx("a",{href:"https://github.com/settings/tokens/new?description=Serverless+LLM+Extension&scopes=repo,workflow&default_expires_at=none",target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 underline",children:"Create token â†’"})]})]}),e.jsxs("div",{className:"pt-3 border-t border-slate-700",children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-1 flex items-center gap-2",children:[e.jsx(de,{className:"w-4 h-4"}),"Models Base Domain"]}),e.jsx("input",{type:"text",value:s.modelsBaseDomain,onChange:t=>d({...s,profile:"custom",modelsBaseDomain:t.target.value.trim()}),className:"w-full px-3 py-2 bg-slate-800 border border-slate-700 rounded text-sm text-slate-200 placeholder-slate-500 focus:outline-none focus:border-blue-500",placeholder:"neevs.io"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:s.modelsBaseDomain?`Endpoints: ${s.modelsUseHttps?"https":"http"}://[service].${s.modelsBaseDomain}`:"Leave empty for localhost (default ports)"})]}),s.modelsBaseDomain&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"modelsUseHttps",checked:s.modelsUseHttps,onChange:t=>d({...s,profile:"custom",modelsUseHttps:t.target.checked}),className:"w-4 h-4 rounded bg-slate-800 border-slate-700"}),e.jsx("label",{htmlFor:"modelsUseHttps",className:"text-sm text-slate-400",children:"Use HTTPS"})]}),s.modelsBaseDomain&&e.jsxs("div",{className:"p-3 bg-slate-800/50 rounded border border-slate-700/50",children:[e.jsx("p",{className:"text-xs font-medium text-slate-400 mb-2",children:"Endpoint Preview"}),e.jsxs("div",{className:"space-y-1 text-xs text-slate-500 font-mono",children:[z.slice(0,3).map(t=>e.jsx("div",{children:se(t.key,t.localPort,s.modelsBaseDomain,s.modelsUseHttps)},t.key)),e.jsxs("div",{className:"text-slate-600",children:["...and ",z.length-3," more"]})]})]}),e.jsx("button",{onClick:_,className:"w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded font-medium transition-colors text-sm",children:"Save Configuration"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4 p-3 rounded-lg bg-slate-800/50 border border-slate-700/50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${L(s.profile).replace("text-","bg-")}`}),e.jsx("span",{className:"text-sm font-medium text-slate-300",children:A(s.profile)})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:[e.jsx("span",{className:"truncate max-w-[100px]",children:s.chatApiBaseUrl.includes("localhost")?"localhost":new URL(s.chatApiBaseUrl).host}),e.jsx(le,{className:"w-3 h-3"}),e.jsx("span",{className:"truncate max-w-[100px]",children:s.modelsBaseDomain||"localhost"})]})]})}),e.jsxs("div",{className:"flex border-b border-slate-700 mb-4",children:[e.jsxs("button",{onClick:()=>E("backend"),className:`flex items-center gap-1.5 px-3 py-2 text-sm border-b-2 transition-colors ${h==="backend"?"border-blue-500 text-blue-400":"border-transparent text-slate-400 hover:text-white"}`,children:[e.jsx(He,{className:"w-3.5 h-3.5"}),"Backend"]}),e.jsxs("button",{onClick:()=>E("deployments"),className:`flex items-center gap-1.5 px-3 py-2 text-sm border-b-2 transition-colors ${h==="deployments"?"border-blue-500 text-blue-400":"border-transparent text-slate-400 hover:text-white"}`,children:[e.jsx(pe,{className:"w-3.5 h-3.5"}),"Deploy"]}),e.jsxs("button",{onClick:()=>{E("services"),p(c)},className:`flex items-center gap-1.5 px-3 py-2 text-sm border-b-2 transition-colors ${h==="services"?"border-blue-500 text-blue-400":"border-transparent text-slate-400 hover:text-white"}`,children:[e.jsx(ne,{className:"w-3.5 h-3.5"}),"Services"]})]}),h==="backend"?e.jsx(xe,{githubToken:s.githubToken,chatApiBaseUrl:s.chatApiBaseUrl,modelsBaseDomain:s.modelsBaseDomain,showOnlyBackend:!0,onBackendStatusChange:$}):h==="deployments"?e.jsx(xe,{githubToken:s.githubToken,chatApiBaseUrl:s.chatApiBaseUrl,modelsBaseDomain:s.modelsBaseDomain,showOnlyBackend:!1,onBackendStatusChange:$}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4 p-3 rounded-lg bg-slate-800/50 border border-slate-700/50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(de,{className:"w-4 h-4 text-slate-400"}),e.jsx("span",{className:"text-sm text-slate-300",children:C?s.modelsBaseDomain:"localhost"})]}),e.jsxs("div",{className:"text-xs text-slate-500",children:[N,"/",c.length," online"]})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h2",{className:"text-sm font-medium text-slate-300 flex items-center gap-2",children:[e.jsx(ne,{className:"w-4 h-4"}),"Service Health"]}),e.jsx("button",{onClick:()=>p(c),className:"text-xs text-slate-400 hover:text-white transition-colors",children:"Refresh"})]}),e.jsx("div",{className:"space-y-2",children:c.map(t=>e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-slate-800 rounded",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[U(t.status),e.jsx("span",{className:"text-sm",children:t.name})]}),e.jsx("span",{className:"text-xs text-slate-500 truncate max-w-[120px]",title:t.endpoint,children:t.endpoint.replace("https://","").replace("http://","")})]},t.key))}),e.jsxs("div",{className:"mt-3 text-xs text-slate-500",children:["Last check: ",V.toLocaleTimeString()]})]})]})]})]})};ve.createRoot(document.getElementById("sidepanel-root")).render(e.jsx(_e.StrictMode,{children:e.jsx(Qe,{})}));
