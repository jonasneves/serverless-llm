import{r as o,j as l}from"./index.js";const E=1800;function S({content:i,onSelect:m}){const[f,v]=o.useState([]),[c,u]=o.useState(null),[x,g]=o.useState({}),p=o.useRef(0),d=o.useRef(0);o.useEffect(()=>{const e=i.match(/```json\s*([\s\S]*?)\s*```/);if(e)try{let t=e[1];t=t.replace(/[\\']/g,'"').replace(/,\s*}/g,"}").replace(/,\s*]/g,"]").replace(/}\s*[\\]+\s*$/g,"}").replace(/"\s*"\s*$/g,"").trim();const r=JSON.parse(t);if(r.options&&Array.isArray(r.options)){const n=r.options.filter(s=>s.id&&s.label&&s.value);n.length>0?v(n):console.warn("No valid gesture options found in JSON")}}catch(t){console.error("Failed to parse gesture options:",t),console.error("JSON content:",e[1])}},[i]),o.useEffect(()=>{const e=t=>{var n;const r=(n=t.detail)==null?void 0:n.target;if(r&&r.hasAttribute("data-gesture-option")){const s=r.getAttribute("data-gesture-option");s&&s!==c&&(u(s),h(s))}else c&&(u(null),a())};return window.addEventListener("gesture-hover",e),()=>{window.removeEventListener("gesture-hover",e),a()}},[c]);const h=e=>{a(),p.current=Date.now();const t=()=>{const r=Date.now()-p.current,n=Math.min(r/E*100,100);if(g(s=>({...s,[e]:n})),n>=100){const s=f.find(j=>j.id===e);s&&(m(s.value),a())}else d.current=requestAnimationFrame(t)};d.current=requestAnimationFrame(t)},a=()=>{d.current&&cancelAnimationFrame(d.current),g({})},b=e=>{u(e),h(e)},w=()=>{u(null),a()};return f.length===0?null:l.jsx("div",{className:"w-full px-4",children:l.jsx("div",{className:"flex flex-col gap-3 items-center",children:f.map(e=>{const t=x[e.id]||0,r=c===e.id;return l.jsxs("button",{onClick:()=>m(e.value),onMouseEnter:()=>b(e.id),onMouseLeave:w,"data-gesture-option":e.id,className:`
                relative overflow-hidden rounded-xl font-medium text-sm
                border transition-all duration-200 w-[85%] max-w-[340px]
                text-left min-h-[44px] flex items-center px-5 py-3
                ${r?"bg-blue-500/20 border-blue-500/50 text-white shadow-lg shadow-blue-500/10":"bg-slate-800/60 border-slate-700/60 text-slate-200 hover:bg-slate-800/80 hover:border-slate-700/80"}
              `,children:[r&&t>0&&l.jsx("div",{className:"absolute bottom-0 left-0 h-1 bg-gradient-to-r from-blue-400 to-blue-500 transition-all duration-75",style:{width:`${t}%`}}),l.jsx("span",{className:"relative z-10",children:e.label})]},e.id)})})})}function A(i){return i.replace(/```json[\s\S]*?```/g,"").trim()}export{S as G,A as e};
