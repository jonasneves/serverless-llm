import{c as C,r as o,j as t}from"./index.js";import{a as y,C as j,b as S}from"./main.js";import{S as E}from"./sparkles.js";import{X as w}from"./x.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],R=C("search",L),$=5;function D(s,n){let r=n||1;const a=()=>(r^=r<<13,r^=r>>17,r^=r<<5,Math.abs(r));return[...s].map(c=>({value:c,sort:a()})).sort((c,u)=>c.sort-u.sort).map(c=>c.value)}function U(s,n){const r=new Date,a=+`${r.getUTCFullYear()}${String(r.getUTCMonth()+1).padStart(2,"0")}${String(r.getUTCDate()).padStart(2,"0")}`;return D(s,a).slice(0,n)}function _(s){const n=s.url?`
Link: ${s.url}`:"";return`${s.source?`Source: ${s.source}. `:""}Give a concise, balanced take on: "${s.title}". Summarize in 5 bullets, list 3 implications, and one action item.${n}`}function M({open:s,onClose:n,onSelectPrompt:r}){const[a,c]=o.useState(""),[u,f]=o.useState(y),[v,m]=o.useState(!1),p=o.useRef(!1),h=o.useRef(null),N=o.useMemo(()=>U(j,$),[]),b=o.useMemo(()=>{const e=u.map(l=>{var i;return{id:`trend-${l.id}`,label:l.title,prompt:_(l),category:((i=l.tags)==null?void 0:i[0])||"Trending",tags:l.tags||["trending"]}});return[...j,...e]},[u]),x=o.useMemo(()=>{if(!a.trim())return[];const e=a.toLowerCase();return b.filter(l=>{var i,d;return l.label.toLowerCase().includes(e)||((i=l.category)==null?void 0:i.toLowerCase().includes(e))||((d=l.tags)==null?void 0:d.some(T=>T.toLowerCase().includes(e)))||l.prompt.toLowerCase().includes(e)}).slice(0,8)},[a,b]),k=a.trim().length>0&&x.length>0;o.useEffect(()=>{if(!s)return;const e=l=>{l.key==="Escape"&&(l.preventDefault(),a?c(""):n())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[s,n,a]),o.useEffect(()=>{if(!s||p.current)return;let e=!1;return(async()=>{m(!0);try{const i=await fetch(S);if(!i.ok)throw new Error(`HTTP ${i.status}`);const d=await i.json();if(!Array.isArray(d))throw new Error("Unexpected feed shape");e||(f(d),p.current=!0)}catch{e||f(y)}finally{!e&&m(!1)}})(),()=>{e=!0}},[s]),o.useEffect(()=>{s||c("")},[s]);const g=e=>{r(e),n()};return s?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"fixed inset-0 z-[100] bg-black/20",onClick:n}),t.jsx("div",{"data-no-arena-scroll":!0,className:"fixed bottom-24 left-1/2 -translate-x-1/2 z-[101] w-[min(640px,calc(100vw-2rem))] animate-in slide-in-from-bottom-4 fade-in duration-200",onClick:e=>e.stopPropagation(),children:t.jsxs("div",{className:"rounded-2xl border border-slate-700/60 bg-slate-900/95 backdrop-blur-xl shadow-2xl overflow-hidden",children:[t.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-slate-800/50",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(E,{size:14,className:"text-amber-400"}),t.jsx("span",{className:"text-sm font-medium text-slate-200",children:"Quick Topics"})]}),t.jsx("button",{onClick:n,className:"w-6 h-6 rounded-md flex items-center justify-center text-slate-500 hover:text-white hover:bg-slate-800/60 transition-colors","aria-label":"Close",children:t.jsx(w,{size:14})})]}),t.jsx("div",{className:"px-4 py-3 flex flex-wrap gap-2",children:N.map(e=>t.jsx("button",{onClick:()=>g(e.prompt),className:"group px-3 py-1.5 rounded-full text-xs font-medium bg-slate-800/70 hover:bg-blue-600/80 text-slate-300 hover:text-white border border-slate-700/50 hover:border-blue-500/50 transition-all duration-150 max-w-[180px] truncate",title:e.label,children:e.label},e.id))}),t.jsxs("div",{className:"px-4 pb-3",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-500",children:t.jsx(R,{size:14})}),t.jsx("input",{ref:h,type:"text",value:a,onChange:e=>c(e.target.value),placeholder:"Search all topics...",className:"w-full pl-9 pr-8 py-2 text-sm bg-slate-800/50 border border-slate-700/50 rounded-lg text-slate-200 placeholder:text-slate-500 focus:outline-none focus:border-slate-600 focus:bg-slate-800/70 transition-colors"}),a&&t.jsx("button",{onClick:()=>{var e;c(""),(e=h.current)==null||e.focus()},className:"absolute right-2 top-1/2 -translate-y-1/2 w-5 h-5 rounded flex items-center justify-center text-slate-500 hover:text-slate-300 transition-colors",children:t.jsx(w,{size:12})})]}),k&&t.jsx("div",{className:"mt-2 max-h-[200px] overflow-y-auto rounded-lg border border-slate-700/50 bg-slate-800/50 divide-y divide-slate-700/30",children:x.map(e=>t.jsx("button",{onClick:()=>g(e.prompt),className:"w-full px-3 py-2.5 text-left hover:bg-slate-700/50 transition-colors group",children:t.jsxs("div",{className:"flex items-center justify-between gap-2",children:[t.jsx("span",{className:"text-sm text-slate-200 group-hover:text-white truncate",children:e.label}),e.category&&t.jsx("span",{className:"text-[10px] text-slate-500 px-1.5 py-0.5 rounded bg-slate-800/80 shrink-0",children:e.category})]})},e.id))}),a.trim()&&x.length===0&&!v&&t.jsxs("div",{className:"mt-2 px-3 py-3 text-center text-xs text-slate-500 bg-slate-800/30 rounded-lg border border-slate-700/30",children:['No topics found for "',a,'"']})]}),t.jsx("div",{className:"px-4 py-2 border-t border-slate-800/50 bg-slate-950/50",children:t.jsxs("span",{className:"text-[10px] text-slate-500",children:["Click a topic to use it as your prompt Â· ",t.jsx("kbd",{className:"px-1 py-0.5 rounded bg-slate-800/80 text-slate-400",children:"esc"})," to close"]})})]})})]}):null}export{M as default};
