{% extends "layout.html" %}

{% block title %}Compare Models{% endblock %}
{% block subtitle %}Side-by-side response comparison{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="/static/chat.css?v={{ chat_css }}">
{% endblock %}

{% block extra_js %}
<script src="/static/model-selector.js?v={{ model_selector_js }}"></script>
<script defer src="/static/chat.js?v={{ chat_js }}"></script>
{% endblock %}

{% block content %}
<!-- Model Dock Panel (slides in from left) -->
<div id="modelDock" class="model-dock">
  <div class="model-dock-header">
    <h2>Available Models</h2>
    <p>Click to select models</p>
  </div>
  <div class="model-dock-content">
    <div class="model-dock-section">
      <div class="model-dock-section-header">
        <div class="model-dock-section-title">
          <span>Local Models</span>
          <span class="model-dock-count" id="localDockCount">(0)</span>
        </div>
        <button class="model-dock-toggle-all" data-type="local">+ Add All</button>
      </div>
      <div class="model-dock-list" id="localDockList">
        <!-- Populated by JS -->
      </div>
    </div>
    <div class="model-dock-section">
      <div class="model-dock-section-header">
        <div class="model-dock-section-title">
          <span>API Models</span>
          <span class="model-dock-count" id="apiDockCount">(0)</span>
        </div>
        <button class="model-dock-toggle-all" data-type="api">+ Add All</button>
      </div>
      <div class="model-dock-list" id="apiDockList">
        <!-- Populated by JS -->
      </div>
    </div>
  </div>
  <div class="model-dock-footer">
    <p>Press <kbd>M</kbd> to toggle this panel</p>
  </div>
</div>

<!-- Dock overlay (closes dock when clicked) -->
<div id="dockOverlay" class="dock-overlay"></div>

<div id="chatHistory" class="chat-history">
  <div class="welcome-card">
    <div class="welcome-title">Chat with Multiple Models</div>
    <div class="welcome-subtitle">
      Select one or more models and see their responses side-by-side.
      Each response includes metrics like tokens and response time.
    </div>
    <div class="api-notice">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="12" y1="16" x2="12" y2="12"></line>
        <line x1="12" y1="8" x2="12.01" y2="8"></line>
      </svg>
      <span>API models use GitHub Models with free quota and may experience rate limiting. Configure your own token in Settings for dedicated quota.</span>
    </div>
    <div class="tools-demo-section">
      <div class="welcome-subtitle">Try these examples:</div>
      <div class="examples-container">
        <button class="example-prompt"
          data-prompt="How many times does the letter 'r' appear in the word 'irregularity'?">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
            stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"></circle>
            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
            <line x1="12" y1="17" x2="12.01" y2="17"></line>
          </svg>
          <span>Count how many times 'r' appears in irregularity</span>
        </button>
        <button class="example-prompt" data-prompt="Which number is larger: 7.09 or 7.9?">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
            stroke-linecap="round" stroke-linejoin="round">
            <path d="M18 20V10"></path>
            <path d="M12 20V4"></path>
            <path d="M6 20v-6"></path>
          </svg>
          <span>Compare decimal numbers and identify the larger one</span>
        </button>
        <button class="example-prompt"
          data-prompt="Alice has 4 brothers and 5 sisters. How many sisters does Alice's brother have?">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
            stroke-linecap="round" stroke-linejoin="round">
            <path
              d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z">
            </path>
            <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
            <line x1="12" y1="22.08" x2="12" y2="12"></line>
          </svg>
          <span>Solve logical reasoning puzzles about relationships</span>
        </button>
        <button class="example-prompt"
          data-prompt="A shipping company has 48 boxes and each pallet holds 6 boxes. How many pallets are needed? Do we need an extra pallet?">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
            stroke-linecap="round" stroke-linejoin="round">
            <polyline points="16 18 22 12 16 6"></polyline>
            <polyline points="8 6 2 12 8 18"></polyline>
          </svg>
          <span>Calculate division problems and check edge cases</span>
        </button>
      </div>
    </div>
  </div>
</div>

<div class="typing-indicator" id="typingIndicator">
  <span class="model-badge streaming-badge">Generating...</span>
</div>

<div class="input-container">
  <div class="controls-row">
    <div class="selected-models-container">
      <div class="model-selector" id="selectedModelsDisplay">
        <!-- Selected model chips populated by JS -->
      </div>
    </div>

    <button id="clearBtn" class="input-icon-btn" type="button" title="Clear chat">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <polyline points="3 6 5 6 21 6"></polyline>
        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
      </svg>
    </button>
  </div>

  <div class="input-wrapper">
    <textarea id="userInput" placeholder="Ask a question to compare model responses..." rows="1"></textarea>
    <button id="sendBtn" class="send-btn" disabled aria-label="Send message">
      <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path d="M12 4L12 20M12 4L6 10M12 4L18 10" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"
          stroke-linejoin="round" fill="none" />
      </svg>
    </button>
  </div>
</div>
{% endblock %}